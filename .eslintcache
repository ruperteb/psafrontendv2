[{"C:\\Users\\ruper\\Desktop\\Web\\Own Projects\\Property Stock App V2\\psafrontendv2\\src\\index.tsx":"1","C:\\Users\\ruper\\Desktop\\Web\\Own Projects\\Property Stock App V2\\psafrontendv2\\src\\reportWebVitals.ts":"2","C:\\Users\\ruper\\Desktop\\Web\\Own Projects\\Property Stock App V2\\psafrontendv2\\src\\resolvers.tsx":"3","C:\\Users\\ruper\\Desktop\\Web\\Own Projects\\Property Stock App V2\\psafrontendv2\\src\\App.tsx":"4","C:\\Users\\ruper\\Desktop\\Web\\Own Projects\\Property Stock App V2\\psafrontendv2\\src\\cache\\cache.tsx":"5","C:\\Users\\ruper\\Desktop\\Web\\Own Projects\\Property Stock App V2\\psafrontendv2\\src\\components\\Navigation.tsx":"6","C:\\Users\\ruper\\Desktop\\Web\\Own Projects\\Property Stock App V2\\psafrontendv2\\src\\components\\Loading.tsx":"7","C:\\Users\\ruper\\Desktop\\Web\\Own Projects\\Property Stock App V2\\psafrontendv2\\src\\components\\PropertyList.tsx":"8","C:\\Users\\ruper\\Desktop\\Web\\Own Projects\\Property Stock App V2\\psafrontendv2\\src\\components\\SelectedPropertyListPanel.tsx":"9","C:\\Users\\ruper\\Desktop\\Web\\Own Projects\\Property Stock App V2\\psafrontendv2\\src\\components\\NewPropertyModal.tsx":"10","C:\\Users\\ruper\\Desktop\\Web\\Own Projects\\Property Stock App V2\\psafrontendv2\\src\\components\\ManageLandlordsPanel.tsx":"11","C:\\Users\\ruper\\Desktop\\Web\\Own Projects\\Property Stock App V2\\psafrontendv2\\src\\components\\PreviewPDFPanel.tsx":"12","C:\\Users\\ruper\\Desktop\\Web\\Own Projects\\Property Stock App V2\\psafrontendv2\\src\\components\\SavedListsPanel.tsx":"13","C:\\Users\\ruper\\Desktop\\Web\\Own Projects\\Property Stock App V2\\psafrontendv2\\src\\reactivevariables\\reactivevariables.tsx":"14","C:\\Users\\ruper\\Desktop\\Web\\Own Projects\\Property Stock App V2\\psafrontendv2\\src\\gql\\gql.tsx":"15","C:\\Users\\ruper\\Desktop\\Web\\Own Projects\\Property Stock App V2\\psafrontendv2\\src\\components\\SelectedPropertyPanel.tsx":"16","C:\\Users\\ruper\\Desktop\\Web\\Own Projects\\Property Stock App V2\\psafrontendv2\\src\\components\\SavedListItem.tsx":"17","C:\\Users\\ruper\\Desktop\\Web\\Own Projects\\Property Stock App V2\\psafrontendv2\\src\\components\\LandlordListItem.tsx":"18","C:\\Users\\ruper\\Desktop\\Web\\Own Projects\\Property Stock App V2\\psafrontendv2\\src\\components\\PDFOutput\\PropertyListLargeImagesPDF.tsx":"19","C:\\Users\\ruper\\Desktop\\Web\\Own Projects\\Property Stock App V2\\psafrontendv2\\src\\components\\PDFOutput\\SelectedPropertyListPDF.tsx":"20","C:\\Users\\ruper\\Desktop\\Web\\Own Projects\\Property Stock App V2\\psafrontendv2\\src\\components\\UpdatePropertyModal.tsx":"21","C:\\Users\\ruper\\Desktop\\Web\\Own Projects\\Property Stock App V2\\psafrontendv2\\src\\components\\DuplicatePremisesModal.tsx":"22","C:\\Users\\ruper\\Desktop\\Web\\Own Projects\\Property Stock App V2\\psafrontendv2\\src\\components\\PremisesNotesModal.tsx":"23","C:\\Users\\ruper\\Desktop\\Web\\Own Projects\\Property Stock App V2\\psafrontendv2\\src\\components\\UpdatePremisesModal.tsx":"24","C:\\Users\\ruper\\Desktop\\Web\\Own Projects\\Property Stock App V2\\psafrontendv2\\src\\components\\ContactListItem.tsx":"25","C:\\Users\\ruper\\Desktop\\Web\\Own Projects\\Property Stock App V2\\psafrontendv2\\src\\components\\PremisesList.tsx":"26","C:\\Users\\ruper\\Desktop\\Web\\Own Projects\\Property Stock App V2\\psafrontendv2\\src\\components\\ImageGalleryModal.tsx":"27","C:\\Users\\ruper\\Desktop\\Web\\Own Projects\\Property Stock App V2\\psafrontendv2\\src\\components\\NewPremisesModal.tsx":"28","C:\\Users\\ruper\\Desktop\\Web\\Own Projects\\Property Stock App V2\\psafrontendv2\\src\\components\\Map.tsx":"29","C:\\Users\\ruper\\Desktop\\Web\\Own Projects\\Property Stock App V2\\psafrontendv2\\src\\components\\PropertyListItem.tsx":"30","C:\\Users\\ruper\\Desktop\\Web\\Own Projects\\Property Stock App V2\\psafrontendv2\\src\\assets\\svgIcons.js":"31","C:\\Users\\ruper\\Desktop\\Web\\Own Projects\\Property Stock App V2\\psafrontendv2\\src\\assets\\pin.js":"32","C:\\Users\\ruper\\Desktop\\Web\\Own Projects\\Property Stock App V2\\psafrontendv2\\src\\components\\PremisesListItem.tsx":"33","C:\\Users\\ruper\\Desktop\\Web\\Own Projects\\Property Stock App V2\\psafrontendv2\\src\\components\\ImageSlider.tsx":"34","C:\\Users\\ruper\\Desktop\\Web\\Own Projects\\Property Stock App V2\\psafrontendv2\\src\\components\\PDFOutput\\PropertyListScheduleNoImages.tsx":"35","C:\\Users\\ruper\\Desktop\\Web\\Own Projects\\Property Stock App V2\\psafrontendv2\\src\\components\\FilterModal.tsx":"36","C:\\Users\\ruper\\Desktop\\Web\\Own Projects\\Property Stock App V2\\psafrontendv2\\src\\components\\AnimatedListItem.tsx":"37"},{"size":1453,"mtime":1608641103063,"results":"38","hashOfConfig":"39"},{"size":425,"mtime":499162500000,"results":"40","hashOfConfig":"39"},{"size":466,"mtime":1608629691275,"results":"41","hashOfConfig":"39"},{"size":13896,"mtime":1616775719506,"results":"42","hashOfConfig":"39"},{"size":1532,"mtime":1616419968593,"results":"43","hashOfConfig":"39"},{"size":9493,"mtime":1616775780225,"results":"44","hashOfConfig":"39"},{"size":2514,"mtime":1608636235276,"results":"45","hashOfConfig":"39"},{"size":6767,"mtime":1616765000313,"results":"46","hashOfConfig":"39"},{"size":32208,"mtime":1616145791485,"results":"47","hashOfConfig":"39"},{"size":27378,"mtime":1616767112119,"results":"48","hashOfConfig":"39"},{"size":10817,"mtime":1612128484847,"results":"49","hashOfConfig":"39"},{"size":8996,"mtime":1614512462620,"results":"50","hashOfConfig":"39"},{"size":8670,"mtime":1614535337070,"results":"51","hashOfConfig":"39"},{"size":2205,"mtime":1616594770128,"results":"52","hashOfConfig":"39"},{"size":18591,"mtime":1616590327307,"results":"53","hashOfConfig":"39"},{"size":37199,"mtime":1614421012099,"results":"54","hashOfConfig":"39"},{"size":22997,"mtime":1616156268380,"results":"55","hashOfConfig":"39"},{"size":17858,"mtime":1612102937862,"results":"56","hashOfConfig":"39"},{"size":57317,"mtime":1616251543153,"results":"57","hashOfConfig":"39"},{"size":29000,"mtime":1614424169855,"results":"58","hashOfConfig":"39"},{"size":28455,"mtime":1612115194679,"results":"59","hashOfConfig":"39"},{"size":46134,"mtime":1614421012094,"results":"60","hashOfConfig":"39"},{"size":8735,"mtime":1612292797481,"results":"61","hashOfConfig":"39"},{"size":52138,"mtime":1614421012100,"results":"62","hashOfConfig":"39"},{"size":16156,"mtime":1612017522292,"results":"63","hashOfConfig":"39"},{"size":13427,"mtime":1612292015332,"results":"64","hashOfConfig":"39"},{"size":3813,"mtime":1609501155635,"results":"65","hashOfConfig":"39"},{"size":48812,"mtime":1614421012096,"results":"66","hashOfConfig":"39"},{"size":6556,"mtime":1616160815554,"results":"67","hashOfConfig":"39"},{"size":10350,"mtime":1616760398992,"results":"68","hashOfConfig":"39"},{"size":18904,"mtime":1609075640674,"results":"69","hashOfConfig":"39"},{"size":657,"mtime":1609328772225,"results":"70","hashOfConfig":"39"},{"size":17931,"mtime":1614421012098,"results":"71","hashOfConfig":"39"},{"size":24602,"mtime":1616162010609,"results":"72","hashOfConfig":"39"},{"size":29095,"mtime":1616256106737,"results":"73","hashOfConfig":"39"},{"size":29160,"mtime":1616756918486,"results":"74","hashOfConfig":"39"},{"size":403,"mtime":1616770562318,"results":"75","hashOfConfig":"39"},{"filePath":"76","messages":"77","errorCount":0,"warningCount":7,"fixableErrorCount":0,"fixableWarningCount":0,"source":"78","usedDeprecatedRules":"79"},"12t0a0m",{"filePath":"80","messages":"81","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"79"},{"filePath":"82","messages":"83","errorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"84","usedDeprecatedRules":"79"},{"filePath":"85","messages":"86","errorCount":0,"warningCount":28,"fixableErrorCount":0,"fixableWarningCount":0,"source":null},{"filePath":"87","messages":"88","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"79"},{"filePath":"89","messages":"90","errorCount":0,"warningCount":15,"fixableErrorCount":0,"fixableWarningCount":0,"source":null},{"filePath":"91","messages":"92","errorCount":0,"warningCount":12,"fixableErrorCount":0,"fixableWarningCount":0,"source":"93","usedDeprecatedRules":"79"},{"filePath":"94","messages":"95","errorCount":0,"warningCount":12,"fixableErrorCount":0,"fixableWarningCount":0,"source":null},{"filePath":"96","messages":"97","errorCount":0,"warningCount":47,"fixableErrorCount":0,"fixableWarningCount":0,"source":"98","usedDeprecatedRules":"79"},{"filePath":"99","messages":"100","errorCount":0,"warningCount":20,"fixableErrorCount":0,"fixableWarningCount":0,"source":null},{"filePath":"101","messages":"102","errorCount":0,"warningCount":40,"fixableErrorCount":0,"fixableWarningCount":0,"source":"103","usedDeprecatedRules":"79"},{"filePath":"104","messages":"105","errorCount":0,"warningCount":53,"fixableErrorCount":0,"fixableWarningCount":0,"source":"106","usedDeprecatedRules":"79"},{"filePath":"107","messages":"108","errorCount":0,"warningCount":56,"fixableErrorCount":0,"fixableWarningCount":0,"source":"109","usedDeprecatedRules":"79"},{"filePath":"110","messages":"111","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"79"},{"filePath":"112","messages":"113","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"79"},{"filePath":"114","messages":"115","errorCount":0,"warningCount":32,"fixableErrorCount":0,"fixableWarningCount":0,"source":"116","usedDeprecatedRules":"79"},{"filePath":"117","messages":"118","errorCount":0,"warningCount":10,"fixableErrorCount":0,"fixableWarningCount":0,"source":"119","usedDeprecatedRules":"79"},{"filePath":"120","messages":"121","errorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"122","usedDeprecatedRules":"79"},{"filePath":"123","messages":"124","errorCount":0,"warningCount":13,"fixableErrorCount":0,"fixableWarningCount":0,"source":"125","usedDeprecatedRules":"79"},{"filePath":"126","messages":"127","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"128","messages":"129","errorCount":0,"warningCount":21,"fixableErrorCount":0,"fixableWarningCount":0,"source":"130","usedDeprecatedRules":"79"},{"filePath":"131","messages":"132","errorCount":0,"warningCount":34,"fixableErrorCount":0,"fixableWarningCount":0,"source":"133","usedDeprecatedRules":"79"},{"filePath":"134","messages":"135","errorCount":0,"warningCount":13,"fixableErrorCount":0,"fixableWarningCount":0,"source":"136","usedDeprecatedRules":"79"},{"filePath":"137","messages":"138","errorCount":0,"warningCount":34,"fixableErrorCount":0,"fixableWarningCount":0,"source":"139","usedDeprecatedRules":"79"},{"filePath":"140","messages":"141","errorCount":0,"warningCount":31,"fixableErrorCount":0,"fixableWarningCount":0,"source":"142","usedDeprecatedRules":"79"},{"filePath":"143","messages":"144","errorCount":0,"warningCount":9,"fixableErrorCount":0,"fixableWarningCount":0,"source":"145","usedDeprecatedRules":"79"},{"filePath":"146","messages":"147","errorCount":0,"warningCount":15,"fixableErrorCount":0,"fixableWarningCount":0,"source":"148","usedDeprecatedRules":"79"},{"filePath":"149","messages":"150","errorCount":0,"warningCount":32,"fixableErrorCount":0,"fixableWarningCount":0,"source":"151","usedDeprecatedRules":"79"},{"filePath":"152","messages":"153","errorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"154","usedDeprecatedRules":"79"},{"filePath":"155","messages":"156","errorCount":0,"warningCount":15,"fixableErrorCount":0,"fixableWarningCount":0,"source":null},{"filePath":"157","messages":"158","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"159"},{"filePath":"160","messages":"161","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"159"},{"filePath":"162","messages":"163","errorCount":0,"warningCount":28,"fixableErrorCount":0,"fixableWarningCount":0,"source":"164","usedDeprecatedRules":"79"},{"filePath":"165","messages":"166","errorCount":0,"warningCount":26,"fixableErrorCount":0,"fixableWarningCount":0,"source":"167","usedDeprecatedRules":"79"},{"filePath":"168","messages":"169","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"79"},{"filePath":"170","messages":"171","errorCount":0,"warningCount":49,"fixableErrorCount":0,"fixableWarningCount":0,"source":"172","usedDeprecatedRules":"79"},{"filePath":"173","messages":"174","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},"C:\\Users\\ruper\\Desktop\\Web\\Own Projects\\Property Stock App V2\\psafrontendv2\\src\\index.tsx",["175","176","177","178","179","180","181"],"import React from 'react';\nimport ReactDOM from 'react-dom';\nimport reportWebVitals from './reportWebVitals';\nimport './index.css';\nimport App from './App';\nimport { Customizer, mergeStyles } from 'office-ui-fabric-react';\n\nimport { AUTH_TOKEN } from './constants'\nimport { resolvers, typeDefs } from './resolvers';\n\nimport {\n  ApolloClient,\n  InMemoryCache,\n  gql,\n  NormalizedCacheObject,\n  ApolloProvider,\n  ApolloLink,\n  HttpLink, useQuery\n} from '@apollo/client';\n\n\nimport { cache } from './cache/cache';\n\nconst client: ApolloClient<NormalizedCacheObject> = new ApolloClient({\n  cache,\n  link: new HttpLink({\n    uri: \"https://psabackendv2.herokuapp.com/\",\n    credentials: 'include',\n    headers: {\n      authorization: localStorage.getItem('token'),\n    },\n   /*  fetchOptions: {\n      mode: 'no-cors',\n    }, */\n  }),\n \n  typeDefs,\n  resolvers: {},\n\n\n  \n});\n\n\n\n// Inject some global styles\nmergeStyles({\n  selectors: {\n    ':global(body), :global(html), :global(#root)': {\n      margin: 0,\n      padding: 0,\n      height: '100vh'\n    }\n  }\n});\n\n\nReactDOM.render(\n  <React.StrictMode>\n  <ApolloProvider client={client}>\n    <App />\n    </ApolloProvider>\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n",["182","183"],"C:\\Users\\ruper\\Desktop\\Web\\Own Projects\\Property Stock App V2\\psafrontendv2\\src\\reportWebVitals.ts",[],"C:\\Users\\ruper\\Desktop\\Web\\Own Projects\\Property Stock App V2\\psafrontendv2\\src\\resolvers.tsx",["184","185"],"import { gql, ApolloCache, Resolvers } from '@apollo/client';\r\n\r\n\r\nexport const typeDefs = gql`\r\n  extend type Query {\r\n    isLoggedIn: Boolean!\r\n    \r\n  }\r\n`;\r\n\r\ntype ResolverFn = (\r\n  parent: any,\r\n  args: any,\r\n  { cache } : { cache: ApolloCache<any> }\r\n) => any;\r\n\r\ninterface ResolverMap {\r\n  [field: string]: ResolverFn;\r\n}\r\n\r\ninterface AppResolvers extends Resolvers {\r\n  // We will update this with our app's resolvers later\r\n}\r\n\r\nexport const resolvers = {};","C:\\Users\\ruper\\Desktop\\Web\\Own Projects\\Property Stock App V2\\psafrontendv2\\src\\App.tsx",["186","187","188","189","190","191","192","193","194","195","196","197","198","199","200","201","202","203","204","205","206","207","208","209","210","211","212","213"],"C:\\Users\\ruper\\Desktop\\Web\\Own Projects\\Property Stock App V2\\psafrontendv2\\src\\cache\\cache.tsx",[],"C:\\Users\\ruper\\Desktop\\Web\\Own Projects\\Property Stock App V2\\psafrontendv2\\src\\components\\Navigation.tsx",["214","215","216","217","218","219","220","221","222","223","224","225","226","227","228"],"C:\\Users\\ruper\\Desktop\\Web\\Own Projects\\Property Stock App V2\\psafrontendv2\\src\\components\\Loading.tsx",["229","230","231","232","233","234","235","236","237","238","239","240"],"import React, { memo } from 'react';\r\nimport { TextField, ITextFieldStyles } from 'office-ui-fabric-react/lib/TextField';\r\nimport { Image, IImageProps, ImageFit } from 'office-ui-fabric-react/lib/Image';\r\nimport HeaderImage from \"../assets/EBLogoHeader.png\"\r\nimport { IStackStyles, Stack } from 'office-ui-fabric-react/lib/Stack';\r\nimport { Spinner, SpinnerSize } from 'office-ui-fabric-react/lib/Spinner';\r\nimport {\r\n  getTheme,\r\n  mergeStyleSets,\r\n  FontWeights,\r\n  ContextualMenu,\r\n  Text,\r\n  DefaultButton,\r\n  IButtonStyles,\r\n  PrimaryButton,\r\n  IconButton,\r\n  IIconProps,\r\n\r\n} from 'office-ui-fabric-react';\r\n\r\n\r\nconst headerStackStyles: Partial<IStackStyles> = { root: { width: \"100vw\", backgroundColor: \"#20314b\", marginBottom: \"10px\" } };\r\nconst headerImageStyles: Partial<IStackStyles> = { root: { marginLeft: \"auto\", marginRight: \"auto\" } };\r\nconst textFieldStyles: Partial<ITextFieldStyles> = { fieldGroup: { width: 250 } };\r\nconst primaryButtonStyles: Partial<IButtonStyles> = { root: { /* width: 150, */ marginTop: \"20px !important\" } };\r\nconst signInIcon: IIconProps = { iconName: 'SignIn' };\r\n\r\nconst imageProps: IImageProps = {\r\n  src: HeaderImage,\r\n  imageFit: ImageFit.contain,\r\n};\r\n\r\nexport const Loading: React.FC = memo(() => {\r\n\r\n\r\n  return (\r\n    <Stack\r\n      horizontalAlign=\"center\"\r\n      verticalAlign=\"start\"\r\n      verticalFill\r\n      styles={{\r\n        root: {\r\n          /*  width: '960px', */\r\n          margin: '0 auto',\r\n          textAlign: 'center',\r\n          color: '#605e5c',\r\n         /*  backgroundColor: \"rgba(177, 140, 72, 0.1);\" */\r\n\r\n        }\r\n      }}\r\n      gap={15}>\r\n\r\n      <Stack styles={headerStackStyles} horizontal>\r\n        <Image\r\n          {...imageProps}\r\n          alt='Header Image'\r\n          width={400}\r\n          height={100}\r\n          styles={headerImageStyles}\r\n        />\r\n\r\n\r\n      </Stack>\r\n\r\n      <Stack \r\n      horizontalAlign=\"center\"\r\n      verticalAlign=\"start\"\r\n      \r\n      styles={{\r\n        root: {\r\n          /*  width: '960px', */\r\n          margin: '0 auto',\r\n          textAlign: 'center',\r\n         /*  color: 'white',\r\n          backgroundColor:\"white\",\r\n          border: \"1px solid rgb(138, 136, 134)\",\r\n          boxShadow: \"2px 3px 11px 7px #00000026\", */\r\n          padding: \"30px\",\r\n          marginTop: \"75px !important\",\r\n\r\n        }\r\n      }}>\r\n\r\n\r\n       \r\n<Spinner styles={{circle: {width: 80, height: 80}}} size={SpinnerSize.large} />\r\n\r\n\r\n      </Stack>\r\n\r\n    </Stack>\r\n\r\n  )\r\n\r\n\r\n\r\n})\r\n\r\nexport default Loading","C:\\Users\\ruper\\Desktop\\Web\\Own Projects\\Property Stock App V2\\psafrontendv2\\src\\components\\PropertyList.tsx",["241","242","243","244","245","246","247","248","249","250","251","252"],"C:\\Users\\ruper\\Desktop\\Web\\Own Projects\\Property Stock App V2\\psafrontendv2\\src\\components\\SelectedPropertyListPanel.tsx",["253","254","255","256","257","258","259","260","261","262","263","264","265","266","267","268","269","270","271","272","273","274","275","276","277","278","279","280","281","282","283","284","285","286","287","288","289","290","291","292","293","294","295","296","297","298","299"],"import * as React from 'react';\r\nimport { CommandBarButton, IButtonStyles, ILayerStyleProps, ILayerStyles, ILayerProps } from 'office-ui-fabric-react';\r\nimport { Panel, PanelType, IPanelProps, IPanelStyles, IPanelStyleProps, } from 'office-ui-fabric-react/lib/Panel';\r\nimport { IRenderFunction, IStyleFunctionOrObject } from 'office-ui-fabric-react/lib/Utilities';\r\nimport { Dropdown, IDropdownOption } from 'office-ui-fabric-react/lib/Dropdown';\r\nimport { Link } from 'office-ui-fabric-react/lib/Link';\r\nimport { useBoolean } from '@uifabric/react-hooks';\r\nimport { GET_SELECTED_PROPERTIES, GET_NAV_STATE, GET_DISTINCT_SUBURBS, GET_DISTINCT_REGIONS, UPDATE_IMAGES, GET_PDF_VARIABLES, GET_MULTI_PROPERTY, NEW_PROPERTY_LIST, GET_PROPERTY_LISTS } from \"../gql/gql\"\r\nimport { useMutation, useQuery } from '@apollo/client';\r\nimport { Mutation, QueryMultiPropertyArgs, Query, NavigationState, Premises, SelectedPropertyList, Property, Agent, MutationPostPropertyListArgs, PropertyList } from \"../schematypes/schematypes\"\r\nimport { navigationState as navigationStateVar, selectedPropertyList as selectedPropertyListVar, pdfVariables as pdfVariablesVar } from \"../reactivevariables/reactivevariables\"\r\nimport { PDFDownloadLink, BlobProvider } from '@react-pdf/renderer';\r\nimport { Icon } from '@fluentui/react/lib/Icon';\r\nimport PreviewPDFPanel from \"./PreviewPDFPanel\"\r\nimport \"./SelectedPropertyListPanel.css\"\r\n\r\n\r\n\r\n\r\nimport {\r\n    getTheme,\r\n    mergeStyleSets,\r\n    FontWeights,\r\n    ContextualMenu,\r\n    Toggle,\r\n    IToggleStyles,\r\n    DefaultButton,\r\n    PrimaryButton,\r\n    Modal,\r\n    IDragOptions,\r\n    IconButton,\r\n    IIconProps,\r\n    IModalStyles,\r\n    mergeStyles,\r\n    ComboBox,\r\n    Fabric,\r\n    IComboBoxOption,\r\n    IComboBox,\r\n    SelectableOptionMenuItemType,\r\n    IComboBoxStyles,\r\n    Stack,\r\n    Text,\r\n    IStackStyles,\r\n    TextField,\r\n    ITextFieldStyles,\r\n    IDropdownStyles,\r\n    IContextualMenuProps,\r\n    DirectionalHint,\r\n    IContextualMenuStyleProps,\r\n    IContextualMenuStyles,\r\n    FocusTrapCallout,\r\n    FocusZone,\r\n    IContextualMenuItem,\r\n    Checkbox,\r\n    ICheckboxProps,\r\n    ICheckboxStyles\r\n\r\n} from 'office-ui-fabric-react';\r\nimport SelectedPropertyListPDF from './PDFOutput/SelectedPropertyListPDF';\r\n\r\n\r\ninterface Props {\r\n    showSelectedPropertyListPanel: boolean\r\n    propertyIdList: number[]\r\n\r\n}\r\n\r\nconst SelectedPropertyListPanel: React.FunctionComponent<Props> = ({ showSelectedPropertyListPanel, propertyIdList = [] }) => {\r\n\r\n    const {\r\n        data: pdfVariables,\r\n        loading: pdfLoading,\r\n        error: pdfError\r\n    } = useQuery<Query>(GET_PDF_VARIABLES);\r\n\r\nconsole.log(pdfVariables)\r\n\r\n    const {\r\n        data: propertyListData,\r\n        loading: propertyListDataLoading,\r\n        error: propertyListDataError\r\n    } = useQuery<Query>(GET_MULTI_PROPERTY, {\r\n        variables: { propertyIdList: propertyIdList },\r\n    });\r\n\r\n    const [enquiryName, setEnquiryName] = React.useState<string | undefined>(pdfVariables?.pdfVariables?.enquiryName);\r\n    const [customTitle, setCustomTitle] = React.useState<string | undefined>(pdfVariables?.pdfVariables?.customTitle);\r\n\r\n    React.useEffect(() => {\r\n        setEnquiryName(pdfVariables?.pdfVariables?.enquiryName)\r\n        setCustomTitle(pdfVariables?.pdfVariables?.customTitle)\r\n    }, [pdfVariables?.pdfVariables?.enquiryName, pdfVariables?.pdfVariables?.customTitle])\r\n\r\n    const [postPropertyList, { data: postPropertyListData }] = useMutation<Mutation, MutationPostPropertyListArgs>(NEW_PROPERTY_LIST);\r\n\r\n    const postPropertyListButton = () => {\r\n\r\n        postPropertyList({\r\n            variables: {\r\n\r\n                enquiryName: enquiryName,\r\n                customTitle: customTitle,\r\n                enquiryDate: new Date(),\r\n                propertyIdList: propertyIdList\r\n\r\n            },\r\n\r\n            update(cache, { data }) {\r\n\r\n                if (!data) {\r\n                    return null;\r\n                }\r\n\r\n                const getExistingPropertyLists = cache.readQuery<Query>({ query: GET_PROPERTY_LISTS });\r\n\r\n                const existingPropertyLists = getExistingPropertyLists ? getExistingPropertyLists.propertyLists : [];\r\n                const newPropertyList = data.postPropertyList!/* .returning[0] */;\r\n\r\n                if (existingPropertyLists)\r\n                    cache.writeQuery<Query>({\r\n                        query: GET_PROPERTY_LISTS,\r\n                        data: { propertyLists: [newPropertyList, ...existingPropertyLists] }\r\n                    });\r\n            }\r\n\r\n        })\r\n\r\n\r\n    }\r\n\r\n    console.log(pdfVariables?.pdfVariables?.enquiryName)\r\n\r\n\r\n    console.log(enquiryName)\r\n\r\n    const onChangeEnquiryName = React.useCallback(\r\n        (event: React.FormEvent<HTMLInputElement | HTMLTextAreaElement>, newValue?: string) => {\r\n            setEnquiryName(newValue || '');\r\n            pdfVariablesVar({ ...pdfVariablesVar(), enquiryName: (newValue || '') })\r\n        },\r\n        [],\r\n    );\r\n\r\n    const onChangeCustomTitle = React.useCallback(\r\n        (event: React.FormEvent<HTMLInputElement | HTMLTextAreaElement>, newValue?: string) => {\r\n            setCustomTitle(newValue || '');\r\n            pdfVariablesVar({ ...pdfVariablesVar(), customTitle: (newValue || '') })\r\n        },\r\n        [],\r\n    );\r\n\r\n    const [selectedAgent, setSelectedAgent] = React.useState<IDropdownOption>();\r\n    /* const [selectedAgentDetails, setSelectedAgentDetails] = React.useState<Agent>(); */\r\n\r\n    const agentOptions = [\r\n\r\n        { key: 'Sean Ellis Brown', text: 'Sean Ellis Brown' },\r\n        { key: 'Mark Ellis Brown', text: 'Mark Ellis Brown' },\r\n\r\n    ]\r\n\r\n    const [selectedOutputType, setSelectedOutputType] = React.useState<IDropdownOption>({ key: 'Large Images', text: 'Large Images' });\r\n    /* const [selectedAgentDetails, setSelectedAgentDetails] = React.useState<Agent>(); */\r\n\r\n    const outputTypeOptions = [\r\n\r\n        { key: 'Large Images', text: 'Large Images' },\r\n        { key: 'Schedule', text: 'Schedule' },\r\n\r\n    ]\r\n\r\n    const [selectedImageLimit, setSelectedImageLimit] = React.useState<IDropdownOption>({ key: 'All', text: 'All' });\r\n    /* const [selectedAgentDetails, setSelectedAgentDetails] = React.useState<Agent>(); */\r\n\r\n    const imageLimitOptions = [\r\n\r\n        { key: 'All', text: 'All' },\r\n        { key: \"1\", text: \"1\" },\r\n        { key: \"2\", text: \"2\" },\r\n        { key: \"3\", text: \"3\" },\r\n        { key: \"4\", text: \"4\" },\r\n        { key: \"5\", text: \"5\" },\r\n        { key: \"6\", text: \"6\" },\r\n\r\n    ]\r\n\r\n\r\n    const onChangeAgent = (event: React.FormEvent<HTMLDivElement>, item: IDropdownOption | undefined): void => {\r\n        if (item !== undefined && item.key === 'Sean Ellis Brown') {\r\n            setSelectedAgent(item)\r\n            /*  setSelectedAgentDetails({name: \"Sean Ellis Brown\", mobile: \"082 4555 183\", email: \"sean@ellisbrown.co.za\" });  */\r\n            pdfVariablesVar({ ...pdfVariablesVar(), agent: { name: \"Sean Ellis Brown\", mobile: \"082 4555 183\", email: \"sean@ellisbrown.co.za\" } })\r\n        }\r\n        if (item !== undefined && item.key === 'Mark Ellis Brown') {\r\n            setSelectedAgent(item)\r\n            /*  setSelectedAgentDetails({name: \"Mark Ellis Brown\", mobile: \"082 4555 183\", email: \"mark@ellisbrown.co.za\" });  */\r\n            pdfVariablesVar({ ...pdfVariablesVar(), agent: { name: \"Mark Ellis Brown\", mobile: \"082 4555 183\", email: \"mark@ellisbrown.co.za\" } })\r\n        }\r\n    };\r\n\r\n    const onChangeOutputType = (event: React.FormEvent<HTMLDivElement>, item: IDropdownOption | undefined): void => {\r\n        if (item !== undefined && item.key === 'Large Images') {\r\n            setSelectedOutputType(item)\r\n            /*  setSelectedAgentDetails({name: \"Sean Ellis Brown\", mobile: \"082 4555 183\", email: \"sean@ellisbrown.co.za\" });  */\r\n            pdfVariablesVar({ ...pdfVariablesVar(), outputType: item.key })\r\n        }\r\n        if (item !== undefined && item.key === 'Schedule') {\r\n            setSelectedOutputType(item)\r\n            /*  setSelectedAgentDetails({name: \"Mark Ellis Brown\", mobile: \"082 4555 183\", email: \"mark@ellisbrown.co.za\" });  */\r\n            pdfVariablesVar({ ...pdfVariablesVar(), outputType: item.key })\r\n        }\r\n    };\r\n\r\n    const onChangeOnlyShowVacantToggle = React.useCallback((ev?: React.FormEvent<HTMLElement | HTMLInputElement> | undefined, checked?: boolean | undefined) => {\r\n        if (pdfVariables?.pdfVariables?.onlyShowVacant === false) {\r\n            pdfVariablesVar({ ...pdfVariablesVar(), onlyShowVacant: true })\r\n\r\n        } else {\r\n            pdfVariablesVar({ ...pdfVariablesVar(), onlyShowVacant: false })\r\n        }\r\n\r\n    }, [pdfVariables?.pdfVariables?.onlyShowVacant])\r\n\r\n    const onChangeImageLimit = (event: React.FormEvent<HTMLDivElement>, item: IDropdownOption | undefined): void => {\r\n        if (item !== undefined && item.key === 'All') {\r\n            setSelectedImageLimit(item)\r\n            /*  setSelectedAgentDetails({name: \"Sean Ellis Brown\", mobile: \"082 4555 183\", email: \"sean@ellisbrown.co.za\" });  */\r\n            pdfVariablesVar({ ...pdfVariablesVar(), imageLimit: item.key })\r\n        }\r\n        if (item !== undefined && item.key === \"1\") {\r\n            setSelectedImageLimit(item)\r\n            /*  setSelectedAgentDetails({name: \"Mark Ellis Brown\", mobile: \"082 4555 183\", email: \"mark@ellisbrown.co.za\" });  */\r\n            pdfVariablesVar({ ...pdfVariablesVar(), imageLimit: parseInt(item.key) })\r\n        }\r\n        if (item !== undefined && item.key === \"2\") {\r\n            setSelectedImageLimit(item)\r\n            /*  setSelectedAgentDetails({name: \"Mark Ellis Brown\", mobile: \"082 4555 183\", email: \"mark@ellisbrown.co.za\" });  */\r\n            pdfVariablesVar({ ...pdfVariablesVar(), imageLimit: parseInt(item.key) })\r\n        }\r\n        if (item !== undefined && item.key === \"3\") {\r\n            setSelectedImageLimit(item)\r\n            /*  setSelectedAgentDetails({name: \"Mark Ellis Brown\", mobile: \"082 4555 183\", email: \"mark@ellisbrown.co.za\" });  */\r\n            pdfVariablesVar({ ...pdfVariablesVar(), imageLimit: parseInt(item.key) })\r\n        }\r\n        if (item !== undefined && item.key === \"4\") {\r\n            setSelectedImageLimit(item)\r\n            /*  setSelectedAgentDetails({name: \"Mark Ellis Brown\", mobile: \"082 4555 183\", email: \"mark@ellisbrown.co.za\" });  */\r\n            pdfVariablesVar({ ...pdfVariablesVar(), imageLimit: parseInt(item.key) })\r\n        }\r\n        if (item !== undefined && item.key === \"5\") {\r\n            setSelectedImageLimit(item)\r\n            /*  setSelectedAgentDetails({name: \"Mark Ellis Brown\", mobile: \"082 4555 183\", email: \"mark@ellisbrown.co.za\" });  */\r\n            pdfVariablesVar({ ...pdfVariablesVar(), imageLimit: parseInt(item.key) })\r\n        }\r\n        if (item !== undefined && item.key === \"6\") {\r\n            setSelectedImageLimit(item)\r\n            /*  setSelectedAgentDetails({name: \"Mark Ellis Brown\", mobile: \"082 4555 183\", email: \"mark@ellisbrown.co.za\" });  */\r\n            pdfVariablesVar({ ...pdfVariablesVar(), imageLimit: parseInt(item.key) })\r\n        }\r\n    };\r\n\r\n    const onChangeShowImagesToggle = React.useCallback((ev?: React.FormEvent<HTMLElement | HTMLInputElement> | undefined, checked?: boolean | undefined) => {\r\n        if (pdfVariables?.pdfVariables?.showImages === false) {\r\n            pdfVariablesVar({ ...pdfVariablesVar(), showImages: true })\r\n\r\n        } else {\r\n            pdfVariablesVar({ ...pdfVariablesVar(), showImages: false })\r\n        }\r\n\r\n    }, [pdfVariables?.pdfVariables?.showImages])\r\n\r\n    const onChangeShowLocalityToggle = React.useCallback((ev?: React.FormEvent<HTMLElement | HTMLInputElement> | undefined, checked?: boolean | undefined) => {\r\n        if (pdfVariables?.pdfVariables?.showLocality === false) {\r\n            pdfVariablesVar({ ...pdfVariablesVar(), showLocality: true })\r\n\r\n        } else {\r\n            pdfVariablesVar({ ...pdfVariablesVar(), showLocality: false })\r\n        }\r\n\r\n    }, [pdfVariables?.pdfVariables?.showLocality])\r\n\r\n    const onChangeShowAerialToggle = React.useCallback((ev?: React.FormEvent<HTMLElement | HTMLInputElement> | undefined, checked?: boolean | undefined) => {\r\n        if (pdfVariables?.pdfVariables?.showAerial === false) {\r\n            pdfVariablesVar({ ...pdfVariablesVar(), showAerial: true })\r\n\r\n        } else {\r\n            pdfVariablesVar({ ...pdfVariablesVar(), showAerial: false })\r\n        }\r\n\r\n    }, [pdfVariables?.pdfVariables?.showAerial])\r\n\r\n\r\n    const handlePanelDismiss = () => {\r\n        navigationStateVar({ ...navigationStateVar(), showSelectedPropertyListPanel: false })\r\n\r\n    }\r\n\r\n    const handleClearSelectedProperties = () => {\r\n        selectedPropertyListVar([])\r\n\r\n    }\r\n\r\n    const handleRemoveProperty = (propertyId: number) => {\r\n        var updatedPropertyList = propertyListData!.multiProperty!.filter(property => {\r\n            return property.propertyId !== propertyId\r\n        })\r\n        selectedPropertyListVar(updatedPropertyList)\r\n\r\n    }\r\n\r\n    const handlePreviewPDF = () => {\r\n        pdfVariablesVar({ ...pdfVariablesVar(), enquiryName: (enquiryName || '') })\r\n        navigationStateVar({ ...navigationStateVar(), showPreviewPDFPanel: true })\r\n\r\n    }\r\n\r\n    const handlePDFDDownload = () => {\r\n        pdfVariablesVar({ ...pdfVariablesVar(), enquiryName: (enquiryName || '') })\r\n        navigationStateVar({ ...navigationStateVar(), showSelectedPropertyListPanel: false })\r\n\r\n    }\r\n\r\n\r\n    const handleManageLists = (ev?: React.MouseEvent<HTMLElement, MouseEvent> | React.KeyboardEvent<HTMLElement> | undefined, item?: IContextualMenuItem | undefined) => {\r\n\r\n        navigationStateVar({ ...navigationStateVar(), showSavedListsPanel: true })\r\n\r\n    }\r\n\r\n\r\n\r\n\r\n\r\n\r\n    const theme = getTheme();\r\n    const cancelIconStyles = {\r\n        root: {\r\n            color: theme.palette.neutralPrimary,\r\n            /*   marginLeft: \"10px !important\",\r\n              marginTop: '4px',\r\n              marginRight: '2px', */\r\n\r\n        },\r\n        rootHovered: {\r\n            color: theme.palette.neutralDark,\r\n        },\r\n        icon: {\r\n            fontSize: \"24px\",\r\n\r\n        }\r\n    };\r\n\r\n    const clearIconStyles = {\r\n        root: {\r\n            color: theme.palette.neutralPrimary,\r\n            marginLeft: \"10px !important\",\r\n        },\r\n        rootHovered: {\r\n            color: theme.palette.neutralDark,\r\n        },\r\n        icon: {\r\n            fontSize: \"24px\",\r\n        }\r\n    };\r\n\r\n    const deleteIconStyles = {\r\n        root: {\r\n            color: theme.palette.neutralPrimary,\r\n            marginLeft: \"auto\",\r\n            marginRight: 30\r\n\r\n        },\r\n        rootHovered: {\r\n            color: theme.palette.neutralDark,\r\n        },\r\n        icon: {\r\n            fontSize: \"14px\",\r\n\r\n        }\r\n    };\r\n\r\n    const cancelIcon: IIconProps = { iconName: 'Cancel' };\r\n    const clearIcon: IIconProps = { iconName: 'RemoveFromShoppingList' };\r\n\r\n    const deleteIcon: IIconProps = { iconName: 'Delete' };\r\n\r\n    const commandBarStyles: Partial<IButtonStyles> = { root: { border: \"1px solid rgb(161, 159, 157);\", padding: 10 } };\r\n    const panelStyles: IStyleFunctionOrObject<IPanelStyleProps, IPanelStyles> = {\r\n        /*   root: {}, */\r\n        navigation: {\r\n            justifyContent: \"flex-start\",\r\n            paddingLeft: 24,\r\n            paddingRight: 24,\r\n            paddingTop: 20\r\n        },\r\n        header: {},\r\n        headerText: { fontSize: 24, marginLeft: 5 },\r\n\r\n\r\n    }\r\n\r\n    const layerStyles: IStyleFunctionOrObject<ILayerStyleProps, ILayerStyles> = {\r\n        root: { zIndex: 50000 },\r\n    }\r\n\r\n    const layerProps: ILayerProps = {\r\n        styles: layerStyles\r\n    }\r\n\r\n\r\n    const boldStyle = { root: { fontWeight: FontWeights.semibold } };\r\n    const propertyDetailsStyles = { alignSelf: \"start\", fontSize: \"18px\", paddingLeft: \"15px\" }\r\n\r\n    const boldStyle2 = { root: { fontWeight: FontWeights.bold } };\r\n    const propertyDetailsHeadingStyles = { /* alignSelf: \"start\", */ fontSize: \"20px\", marginLeft: \"auto\", marginRight: \"auto\", marginTop: 10, marginBottom: 10 }\r\n    const propertyNotesStyles = { alignSelf: \"start\", fontSize: \"16px\", paddingLeft: \"15px\", marginTop: 0 }\r\n\r\n    const buttonStyles = { root: { marginRight: 8, marginBottom: 0, marginTop: \"20px !important\" }, };\r\n\r\n    const saveListButtonStyles: IButtonStyles = {\r\n        root: { marginBottom: 0, marginTop: \"auto !important\", },\r\n        flexContainer: { marginBottom: 0, marginTop: \"auto !important\", },\r\n\r\n        splitButtonMenuButton: { backgroundColor: 'rgb(0, 120, 212)', width: 28, border: 'none' },\r\n        splitButtonMenuIcon: { fontSize: '7px' },\r\n        splitButtonDivider: { backgroundColor: '#c8c8c8', width: 1, right: 26, position: 'absolute', top: 4, bottom: 4 },\r\n        splitButtonContainer: {\r\n            height: \"fit-content\",\r\n            marginBottom: 0, marginTop: \"auto !important\",\r\n        },\r\n    }\r\n\r\n\r\n    const textFieldStyles: Partial<ITextFieldStyles> = { fieldGroup: { marginRight: 20, /* marginBottom: 10, */ }, root: { width: \"100%\", } };\r\n    const textFieldStylesCustomTitle: Partial<ITextFieldStyles> = { fieldGroup: { marginRight: 0, /* marginBottom: 10, */ }, root: { width: \"100%\", } };\r\n\r\n    const dropdownStyles: Partial<IDropdownStyles> = { dropdown: { width: 130, marginRight: 10 } };\r\n    const dropdownStylesImageLimit: Partial<IDropdownStyles> = { dropdown: { width: 90, marginRight: 10 } };\r\n\r\n    const checkboxStyles: Partial<ICheckboxStyles> = { root: { marginTop: \"10px !important\", marginRight: 10 }, label: { marginLeft: 0 } };\r\n\r\n\r\n    const onRenderNavigationContent: IRenderFunction<IPanelProps> = React.useCallback(\r\n        (props, defaultRender) => (\r\n            <>\r\n                <IconButton\r\n                    styles={cancelIconStyles}\r\n                    iconProps={cancelIcon}\r\n                    ariaLabel=\"Close panel\"\r\n                    onClick={handlePanelDismiss}\r\n                />\r\n                {<IconButton\r\n                    styles={clearIconStyles}\r\n                    iconProps={clearIcon}\r\n                    ariaLabel=\"Edit Property Details\"\r\n                    onClick={handleClearSelectedProperties}\r\n                />}\r\n\r\n\r\n\r\n            </>\r\n        ),\r\n        [],\r\n    );\r\n\r\n    const dropdownMenuStyles: IStyleFunctionOrObject<IContextualMenuStyleProps, IContextualMenuStyles> = { container: { width: 125 } };\r\n\r\n    const menuPropsPDF: IContextualMenuProps = {\r\n        styles: dropdownMenuStyles,\r\n        // For example: disable dismiss if shift key is held down while dismissing\r\n        directionalHint: DirectionalHint.topRightEdge,\r\n        items: [\r\n            {\r\n                key: 'ManageLists',\r\n                text: 'Manage Lists',\r\n                iconProps: { iconName: 'List' },\r\n                onClick: handleManageLists\r\n            },\r\n\r\n        ],\r\n    };\r\n\r\n    const [isOutputOptionsCalloutVisible, { toggle: toggleIsOutputOptionsCalloutVisible }] = useBoolean(false);\r\n\r\n    const outputOptionsStyles = mergeStyleSets({\r\n        /*  buttonArea: {\r\n           verticalAlign: 'top',\r\n           display: 'inline-block',\r\n           textAlign: 'center',\r\n           margin: '0 100px',\r\n           minWidth: 130,\r\n           height: 32,\r\n         }, */\r\n        callout: {\r\n            maxWidth: 600,\r\n        },\r\n        header: {\r\n            padding: '18px 24px 12px',\r\n        },\r\n        title: [\r\n            {\r\n                margin: 0,\r\n                fontWeight: FontWeights.bold,\r\n            },\r\n        ],\r\n        inner: {\r\n            height: '100%',\r\n            padding: '0 24px 20px',\r\n        },\r\n        actions: {\r\n            position: 'relative',\r\n            marginTop: 20,\r\n            width: '100%',\r\n            whiteSpace: 'nowrap',\r\n        },\r\n        buttons: {\r\n            display: 'flex',\r\n            justifyContent: 'flex-end',\r\n            padding: '0 24px 24px',\r\n        },\r\n        subtext: [\r\n            {\r\n                margin: 0,\r\n                fontWeight: FontWeights.semilight,\r\n            },\r\n        ],\r\n    });\r\n\r\n\r\n\r\n    const onRenderFooterContent = React.useCallback(\r\n        () => (\r\n            <Stack styles={{\r\n                root: {\r\n                    flexFlow: \"row wrap\",\r\n                    marginBottom: 20\r\n                }\r\n            }\r\n            }>\r\n                <TextField\r\n                    label=\"Enquiry Name\"\r\n                    value={enquiryName}\r\n                    onChange={onChangeEnquiryName}\r\n\r\n                    styles={textFieldStyles}\r\n                />\r\n                <Dropdown\r\n                    label=\"Agent\"\r\n                    selectedKey={selectedAgent ? selectedAgent.key : undefined}\r\n                    // eslint-disable-next-line react/jsx-no-bind\r\n                    onChange={onChangeAgent}\r\n                    placeholder=\"Select Agent\"\r\n                    options={agentOptions}\r\n                    styles={dropdownStyles}\r\n                />\r\n                <PrimaryButton\r\n                    split\r\n                    menuProps={menuPropsPDF}\r\n                    onClick={postPropertyListButton} styles={saveListButtonStyles}>\r\n                    Save List\r\n            </PrimaryButton>\r\n\r\n\r\n                <PrimaryButton\r\n                    /* menuProps={menuPropsPDF} */\r\n                    onClick={handlePreviewPDF} styles={buttonStyles}>\r\n                    Preview PDF\r\n            </PrimaryButton>\r\n\r\n                <PrimaryButton\r\n                    id=\"OutputOptionsButton\"\r\n                    /* menuProps={menuPropsPDF} */\r\n                    onClick={toggleIsOutputOptionsCalloutVisible} styles={buttonStyles}>\r\n                    Output Options\r\n            </PrimaryButton>\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n            </Stack>\r\n        ),\r\n        [enquiryName],\r\n    );\r\n\r\n\r\n    var selectedPropertyList: SelectedPropertyList = propertyListData?.multiProperty!\r\n\r\n\r\n\r\n\r\n\r\n    /* const propertyList = () =>  {\r\n\r\n       \r\n\r\n           var list=  selectedPropertyList.map(property => {\r\n                return (\r\n                    <Stack styles={{ root: { marginLeft: 10, marginTop: \"10px !important\", alignItems: \"center\" } }} horizontal>\r\n                        {property.propertyName}\r\n                        <IconButton\r\n                            styles={deleteIconStyles}\r\n                            iconProps={deleteIcon}\r\n                            ariaLabel=\"Remove Property\"\r\n                            onClick={() => handleRemoveProperty(property.propertyId)}\r\n                        />\r\n        \r\n                    </Stack>\r\n                )\r\n            })\r\n            \r\n       return list\r\n    } */\r\n\r\n\r\n\r\n    const propertyList = selectedPropertyList?.map(property => {\r\n        return (\r\n            <Stack styles={{ root: { marginLeft: 10, marginTop: \"10px !important\", alignItems: \"center\" } }} horizontal>\r\n                {property.propertyName}\r\n                <IconButton\r\n                    styles={deleteIconStyles}\r\n                    iconProps={deleteIcon}\r\n                    ariaLabel=\"Remove Property\"\r\n                    onClick={() => handleRemoveProperty(property.propertyId)}\r\n                />\r\n\r\n            </Stack>\r\n        )\r\n    })\r\n\r\n\r\n    /* if (propertyListDataLoading) return <div>Loading</div>; */\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n    return (\r\n        <div >\r\n            <Panel\r\n                isOpen={showSelectedPropertyListPanel}\r\n                onDismiss={handlePanelDismiss}\r\n                type={PanelType.smallFixedFar}\r\n                onRenderNavigationContent={onRenderNavigationContent}\r\n                /* customWidth={panelType === PanelType.custom || panelType === PanelType.customNear ? '888px' : undefined} */\r\n                closeButtonAriaLabel=\"Close\"\r\n                headerText=\"Selected Property List\"\r\n                styles={panelStyles}\r\n                layerProps={layerProps}\r\n                isBlocking={false}\r\n                onRenderFooterContent={onRenderFooterContent}\r\n                isFooterAtBottom={true}\r\n                id=\"SelectedPropertyListPanel\"\r\n            >\r\n\r\n                <Stack verticalFill styles={{\r\n                    root: {\r\n                        display: \"flex\",\r\n                        flexFlow: \"column\",\r\n                        paddingTop: 10\r\n                        /* maxWidth: \"fit-content\" */\r\n                        /*  marginTop: \"0 !important\" */\r\n                    }\r\n                }}>\r\n\r\n\r\n                    {selectedPropertyList !== undefined ? propertyList : <div>loading</div>}\r\n\r\n\r\n                </Stack>\r\n\r\n                {isOutputOptionsCalloutVisible ? (\r\n                    <div>\r\n                        <FocusTrapCallout\r\n                            role=\"alertdialog\"\r\n                            className={outputOptionsStyles.callout}\r\n                            gapSpace={0}\r\n                            target={`#OutputOptionsButton`}\r\n                            onDismiss={toggleIsOutputOptionsCalloutVisible}\r\n                            setInitialFocus\r\n                        >\r\n                            <div className={outputOptionsStyles.header}>\r\n                                <Text className={outputOptionsStyles.title}>Output Options</Text>\r\n                            </div>\r\n                            <div className={outputOptionsStyles.inner}>\r\n                                <div>\r\n\r\n                                    <Stack>\r\n\r\n                                        <Stack horizontal>\r\n\r\n                                            <Dropdown\r\n                                                label=\"Output Type\"\r\n                                                selectedKey={selectedOutputType ? selectedOutputType.key : undefined}\r\n                                                // eslint-disable-next-line react/jsx-no-bind\r\n                                                onChange={onChangeOutputType}\r\n                                                placeholder=\"Output Type\"\r\n                                                options={outputTypeOptions}\r\n                                                styles={dropdownStyles}\r\n                                            />\r\n\r\n                                            <Dropdown\r\n                                                label=\"Image Limit\"\r\n                                                selectedKey={selectedImageLimit ? selectedImageLimit.key : undefined}\r\n                                                // eslint-disable-next-line react/jsx-no-bind\r\n                                                onChange={onChangeImageLimit}\r\n                                                placeholder=\"Image Limit\"\r\n                                                options={imageLimitOptions}\r\n                                                styles={dropdownStylesImageLimit}\r\n                                            />\r\n\r\n                                            {/*  <Toggle\r\n                                                onText=\"Vacant\"\r\n                                                offText=\"All\"\r\n                                                styles={toggleStyles}\r\n                                                label=\"Display:\"\r\n                                                checked={pdfVariables?.pdfVariables?.onlyShowVacant}\r\n                                                onChange={onChangeOnlyShowVacantToggle}\r\n                                            /> */}\r\n\r\n                                        </Stack>\r\n\r\n                                        {/* <Stack horizontal>\r\n\r\n\r\n\r\n                                            <Toggle\r\n                                                onText=\"Yes\"\r\n                                                offText=\"No\"\r\n                                                styles={toggleStyles}\r\n                                                label=\"Show Images?\"\r\n                                                checked={pdfVariables?.pdfVariables?.showImages}\r\n                                                onChange={onChangeShowImagesToggle}\r\n                                            />\r\n\r\n                                        </Stack> */}\r\n\r\n                                        {/* <Stack horizontal>\r\n\r\n                                            <Toggle\r\n                                                onText=\"Yes\"\r\n                                                offText=\"No\"\r\n                                                styles={toggleStyles}\r\n                                                label=\"Show Locality?\"\r\n                                                checked={pdfVariables?.pdfVariables?.showLocality}\r\n                                                onChange={onChangeShowLocalityToggle}\r\n                                            />\r\n\r\n                                            <Toggle\r\n                                                onText=\"Yes\"\r\n                                                offText=\"No\"\r\n                                                styles={toggleStylesAerial}\r\n                                                label=\"Show Aerial?\"\r\n                                                checked={pdfVariables?.pdfVariables?.showAerial}\r\n                                                onChange={onChangeShowAerialToggle}\r\n                                            />\r\n\r\n                                        </Stack> */}\r\n\r\n                                        <Stack horizontal styles={{ root: { marginTop: \"5px !important\" } }}>\r\n\r\n                                            <Stack verticalFill>\r\n\r\n                                                <Checkbox styles={checkboxStyles} label=\"Show Locality\" checked={pdfVariables?.pdfVariables?.showLocality} onChange={onChangeShowLocalityToggle} />\r\n\r\n                                                <Checkbox styles={checkboxStyles} label=\"Show Aerial\" checked={pdfVariables?.pdfVariables?.showAerial} onChange={onChangeShowAerialToggle} />\r\n\r\n\r\n                                            </Stack>\r\n\r\n                                            <Stack verticalFill>\r\n\r\n                                                <Checkbox styles={checkboxStyles} label=\"Show Images\" checked={pdfVariables?.pdfVariables?.showImages} onChange={onChangeShowImagesToggle} />\r\n\r\n                                                <Checkbox styles={checkboxStyles} label=\"Vacant Only\" checked={pdfVariables?.pdfVariables?.onlyShowVacant} onChange={onChangeOnlyShowVacantToggle} />\r\n\r\n                                            </Stack>\r\n\r\n\r\n\r\n                                        </Stack>\r\n\r\n                                        <Stack>\r\n\r\n                                            <TextField\r\n                                                label=\"Custom Title\"\r\n                                                value={customTitle}\r\n                                                onChange={onChangeCustomTitle}\r\n                                                styles={textFieldStylesCustomTitle}\r\n                                                multiline rows={2}\r\n                                                \r\n                                            />\r\n\r\n                                        </Stack>\r\n\r\n\r\n\r\n\r\n\r\n\r\n                                    </Stack>\r\n                                    {/* <Text className={outputOptionsStyles.subtext}>\r\n                                        Are you sure you want to delete this image?\r\n</Text> */}\r\n                                </div>\r\n                            </div>\r\n                            <FocusZone>\r\n                                <Stack className={outputOptionsStyles.buttons} gap={8} horizontal>\r\n\r\n                                    <DefaultButton style={{ marginLeft: 0, marginRight: \"auto\" }} onClick={toggleIsOutputOptionsCalloutVisible}>Close</DefaultButton>\r\n                                </Stack>\r\n                            </FocusZone>\r\n                        </FocusTrapCallout>\r\n                    </div>\r\n                ) : null}\r\n\r\n\r\n\r\n\r\n\r\n            </Panel>\r\n\r\n\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default SelectedPropertyListPanel\r\n\r\n","C:\\Users\\ruper\\Desktop\\Web\\Own Projects\\Property Stock App V2\\psafrontendv2\\src\\components\\NewPropertyModal.tsx",["300","301","302","303","304","305","306","307","308","309","310","311","312","313","314","315","316","317","318","319"],"C:\\Users\\ruper\\Desktop\\Web\\Own Projects\\Property Stock App V2\\psafrontendv2\\src\\components\\ManageLandlordsPanel.tsx",["320","321","322","323","324","325","326","327","328","329","330","331","332","333","334","335","336","337","338","339","340","341","342","343","344","345","346","347","348","349","350","351","352","353","354","355","356","357","358","359"],"import * as React from 'react';\r\nimport { CommandBarButton, IButtonStyles, ILayerStyleProps, ILayerStyles, ILayerProps, FocusTrapCallout, FocusZone, PrimaryButton, TextField, ITextFieldStyles } from 'office-ui-fabric-react';\r\nimport { Panel, PanelType, IPanelProps, IPanelStyles, IPanelStyleProps, } from 'office-ui-fabric-react/lib/Panel';\r\nimport { IRenderFunction, IStyleFunctionOrObject } from 'office-ui-fabric-react/lib/Utilities';\r\nimport { Dropdown, IDropdownOption } from 'office-ui-fabric-react/lib/Dropdown';\r\nimport { Link } from 'office-ui-fabric-react/lib/Link';\r\nimport { useBoolean } from '@uifabric/react-hooks';\r\nimport { GET_SINGLE_PROPERTY, GET_NAV_STATE, GET_DISTINCT_SUBURBS, GET_DISTINCT_REGIONS, UPDATE_IMAGES, NEW_LANDLORD, GET_LANDLORDS } from \"../gql/gql\"\r\nimport { useMutation, useQuery } from '@apollo/client';\r\nimport { Mutation, MutationPostLandlordArgs, Query, NavigationState, Premises, Landlord } from \"../schematypes/schematypes\"\r\nimport { navigationState as navigationStateVar } from \"../reactivevariables/reactivevariables\"\r\nimport { Icon } from '@fluentui/react/lib/Icon';\r\n\r\nimport LandlordListItem from \"./LandlordListItem\"\r\n\r\nimport { SearchBox, ISearchBoxStyles, } from 'office-ui-fabric-react/lib/SearchBox';\r\n\r\nimport {\r\n  getTheme,\r\n  mergeStyleSets,\r\n  FontWeights,\r\n  ContextualMenu,\r\n  Toggle,\r\n  IToggleStyles,\r\n  DefaultButton,\r\n  Modal,\r\n  IDragOptions,\r\n  IconButton,\r\n  IIconProps,\r\n  IModalStyles,\r\n  mergeStyles,\r\n  ComboBox,\r\n  Fabric,\r\n  IComboBoxOption,\r\n  IComboBox,\r\n  SelectableOptionMenuItemType,\r\n  IComboBoxStyles,\r\n  Stack,\r\n  Text,\r\n  IStackStyles\r\n\r\n} from 'office-ui-fabric-react';\r\n\r\n\r\ninterface Props {\r\n  showManageLandlordsPanel: boolean\r\n  landLordsList: Landlord[]\r\n\r\n}\r\n\r\nconst ManageLandlordsPanel: React.FunctionComponent<Props> = ({ showManageLandlordsPanel, landLordsList }) => {\r\n\r\n\r\n\r\n  const [isAddCalloutVisible, { toggle: toggleIsAddCalloutVisible }] = useBoolean(false);\r\n\r\n  const [addLandlordName, setAddLandlordName] = React.useState(\"\")\r\n\r\n\r\n\r\n  const handlePanelDismiss = () => {\r\n    navigationStateVar({ ...navigationStateVar(), showManageLandlordsPanel: false })\r\n\r\n  }\r\n\r\n\r\n  const [postLandlord, { data }] = useMutation<Mutation, MutationPostLandlordArgs>(NEW_LANDLORD);\r\n\r\n  const saveNewLandlord = () => {\r\n\r\n    postLandlord({\r\n      variables: {\r\n\r\n        landlordName: addLandlordName\r\n\r\n      },\r\n\r\n      update(cache, { data }) {\r\n\r\n        if (!data) {\r\n          return null;\r\n        }\r\n\r\n        const getExistingLandlords = cache.readQuery<Query>({ query: GET_LANDLORDS });\r\n        // Add the new todo to the cache\r\n        const existingLandlords = getExistingLandlords ? getExistingLandlords.landlords : [];\r\n        const newLandlord = data.postLandlord!/* .returning[0] */;\r\n        if (existingLandlords)\r\n          cache.writeQuery<Query>({\r\n            query: GET_LANDLORDS,\r\n            data: { landlords: [newLandlord, ...existingLandlords] }\r\n          });\r\n      }\r\n\r\n\r\n    })\r\n\r\n    setAddLandlordName(\"\")\r\n    toggleIsAddCalloutVisible()\r\n  }\r\n\r\n\r\n\r\n  const onChangeLandlordName = React.useCallback(\r\n    (event: React.FormEvent<HTMLInputElement | HTMLTextAreaElement>, newValue?: string) => {\r\n      setAddLandlordName(newValue!);\r\n    },\r\n    [addLandlordName],\r\n  );\r\n\r\n\r\n\r\n\r\n\r\n  const theme = getTheme();\r\n  const deleteIconStyles = {\r\n    root: {\r\n      color: theme.palette.neutralPrimary,\r\n      /*   marginLeft: \"10px !important\",\r\n        marginTop: '4px',\r\n        marginRight: '2px', */\r\n\r\n    },\r\n    rootHovered: {\r\n      color: theme.palette.neutralDark,\r\n    },\r\n    icon: {\r\n      fontSize: \"24px\",\r\n\r\n    }\r\n  };\r\n\r\n  const addIconStyles = {\r\n    root: {\r\n      color: theme.palette.neutralPrimary,\r\n      marginLeft: 20\r\n\r\n    },\r\n    rootHovered: {\r\n      color: theme.palette.neutralDark,\r\n    },\r\n    icon: {\r\n      fontSize: \"24px\",\r\n\r\n    }\r\n  };\r\n\r\n  const cancelIcon: IIconProps = { iconName: 'Cancel' };\r\n  const addIcon: IIconProps = { iconName: 'Add' };\r\n  const editIcon: IIconProps = { iconName: 'Edit' };\r\n  const photoCollectionIcon: IIconProps = { iconName: 'PhotoCollection' };\r\n  const commandBarStyles: Partial<IButtonStyles> = { root: { border: \"1px solid rgb(161, 159, 157);\", padding: 10 } };\r\n  const panelStyles: IStyleFunctionOrObject<IPanelStyleProps, IPanelStyles> = {\r\n    /*   root: {}, */\r\n    navigation: {\r\n      justifyContent: \"flex-start\",\r\n      paddingLeft: 24,\r\n      paddingRight: 24,\r\n      paddingTop: 20\r\n    },\r\n    header: { marginBottom: 10 },\r\n    headerText: { fontSize: 24, marginLeft: 15 },\r\n\r\n  }\r\n\r\n  const layerStyles: IStyleFunctionOrObject<ILayerStyleProps, ILayerStyles> = {\r\n    root: { zIndex: 100000 },\r\n  }\r\n\r\n  const layerProps: ILayerProps = {\r\n    styles: layerStyles\r\n  }\r\n\r\n\r\n  const boldStyle = { root: { fontWeight: FontWeights.semibold } };\r\n  const propertyDetailsStyles = { alignSelf: \"start\", fontSize: \"18px\", paddingLeft: \"15px\" }\r\n  const propertyDetailsLandlordStyles = { alignSelf: \"start\", fontSize: \"18px\", paddingLeft: \"15px\", width: 125 }\r\n\r\n  const boldStyle2 = { root: { fontWeight: FontWeights.bold } };\r\n  const propertyDetailsHeadingStyles = { /* alignSelf: \"start\", */ fontSize: \"20px\", marginLeft: \"auto\", marginRight: \"auto\", marginTop: 10, marginBottom: 10 }\r\n  const propertyNotesStyles = { alignSelf: \"start\", fontSize: \"16px\", paddingLeft: \"15px\", marginTop: 0 }\r\n\r\n  const textFieldStyles: Partial<ITextFieldStyles> = { fieldGroup: { width: 300 } };\r\n\r\n  const searchBoxStyles: Partial<ISearchBoxStyles> = { root: { width: 300, height: 44 } };\r\n\r\n  const styles = mergeStyleSets({\r\n\r\n    callout: {\r\n      maxWidth: 600,\r\n    },\r\n    header: {\r\n      padding: '18px 24px 12px',\r\n    },\r\n    title: [\r\n      {\r\n        margin: 0,\r\n        fontWeight: FontWeights.bold,\r\n      },\r\n    ],\r\n    inner: {\r\n      height: '100%',\r\n      padding: '0 24px 20px',\r\n    },\r\n    actions: {\r\n      position: 'relative',\r\n      marginTop: 20,\r\n      width: '100%',\r\n      whiteSpace: 'nowrap',\r\n    },\r\n    buttons: {\r\n      display: 'flex',\r\n      justifyContent: 'flex-end',\r\n      padding: '0 24px 24px',\r\n    },\r\n    subtext: [\r\n      {\r\n        margin: 0,\r\n        fontWeight: FontWeights.semilight,\r\n      },\r\n    ],\r\n  });\r\n\r\n  const [landlordSearch, setLandlordSearch] = React.useState<string | undefined> (\"\")\r\n\r\n\r\n  const onChangeLandlordSearch = React.useCallback(\r\n    (event?: React.ChangeEvent<HTMLInputElement>, newValue?: string) => {\r\n\r\n    setLandlordSearch(newValue)\r\n  },[setLandlordSearch])\r\n\r\n  console.log(landLordsList)\r\n  console.log(landlordSearch)\r\n\r\n  const searchSortedlandlords = landLordsList?.filter(landlord => {\r\n    if (landlord !== null && landlord !== undefined) {\r\n      if (landlord?.landlordName !== null && landlord?.landlordName !== undefined) {\r\n        if (landlord?.contactsList !== null && landlord?.contactsList !== undefined) {\r\n\r\n         /*  let item = landlord.contactsList.some((contact)=>  contact.name!.includes(landlordSearch!.toLowerCase()))\r\n          return item */\r\n          \r\n              return landlord?.landlordName.toLowerCase().includes(landlordSearch!.toLowerCase()) /* || landlord?.contactsList.filter((contact)=> { return contact.name?.toLowerCase().includes(landlordSearch!.toLowerCase())} ) */\r\n           \r\n        }\r\n      }\r\n    }\r\n  })\r\n\r\n\r\n  const onRenderNavigationContent: IRenderFunction<IPanelProps> = React.useCallback(\r\n    (props, defaultRender) => (\r\n      <>\r\n        <IconButton\r\n          styles={deleteIconStyles}\r\n          iconProps={cancelIcon}\r\n          ariaLabel=\"Close panel\"\r\n          onClick={handlePanelDismiss}\r\n        />\r\n        <IconButton\r\n          styles={addIconStyles}\r\n          iconProps={addIcon}\r\n          ariaLabel=\"Add Landlord\"\r\n          onClick={toggleIsAddCalloutVisible}\r\n          id=\"addLandlordButton\"\r\n        />\r\n\r\n\r\n\r\n\r\n      </>\r\n    ),\r\n    [],\r\n  );\r\n\r\n\r\n  const [expanded, setExpanded] = React.useState<false | number>(0);\r\n\r\n\r\n\r\n\r\n  return (\r\n    <div>\r\n      <Panel\r\n        isOpen={showManageLandlordsPanel}\r\n        onDismiss={handlePanelDismiss}\r\n\r\n        type={PanelType.medium}\r\n        onRenderNavigationContent={onRenderNavigationContent}\r\n        /* customWidth={panelType === PanelType.custom || panelType === PanelType.customNear ? '888px' : undefined} */\r\n        closeButtonAriaLabel=\"Close\"\r\n        headerText={\"Manage Landlords\"}\r\n        styles={panelStyles}\r\n        layerProps={layerProps}\r\n      >\r\n\r\n        <Stack id=\"Landlord List Container\" styles={{\r\n          root: {\r\n            display: \"flex\",\r\n            flexFlow: \"column\",\r\n            marginLeft: 10\r\n            /* maxWidth: \"fit-content\" */\r\n            /*  marginTop: \"0 !important\" */\r\n          }\r\n        }}>\r\n\r\n          <SearchBox\r\n            styles={searchBoxStyles}\r\n            placeholder=\"Search\"\r\n            onEscape={ev => {\r\n              console.log('Custom onEscape Called');\r\n            }}\r\n            onClear={ev => {\r\n              console.log('Custom onClear Called');\r\n            }}\r\n            onChange={onChangeLandlordSearch}\r\n            onSearch={newValue => console.log('SearchBox onSearch fired: ' + newValue)}\r\n          />\r\n\r\n          {searchSortedlandlords !== undefined ? searchSortedlandlords.map((landlord) => {\r\n\r\n            return <LandlordListItem landlord={landlord} key={landlord.landlordId} expanded={expanded} setExpanded={setExpanded}></LandlordListItem>\r\n\r\n          }) : <Text></Text>}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n        </Stack>\r\n\r\n\r\n        {isAddCalloutVisible ? (\r\n          <div>\r\n            <FocusTrapCallout\r\n              role=\"alertdialog\"\r\n              className={styles.callout}\r\n              gapSpace={0}\r\n              target={`#addLandlordButton`}\r\n              onDismiss={toggleIsAddCalloutVisible}\r\n              setInitialFocus\r\n            >\r\n              <div className={styles.header}>\r\n                <Text className={styles.title}>Add Landlord</Text>\r\n              </div>\r\n              <div className={styles.inner}>\r\n                <div>\r\n\r\n                  <TextField\r\n                    styles={textFieldStyles}\r\n                    label=\"Landlord Name\"\r\n\r\n                    value={addLandlordName}\r\n                    onChange={onChangeLandlordName}></TextField>\r\n                </div>\r\n              </div>\r\n              <FocusZone>\r\n                <Stack className={styles.buttons} gap={8} horizontal>\r\n                  <PrimaryButton onClick={saveNewLandlord}>Confirm</PrimaryButton>\r\n                  <DefaultButton onClick={toggleIsAddCalloutVisible}>Cancel</DefaultButton>\r\n                </Stack>\r\n              </FocusZone>\r\n            </FocusTrapCallout>\r\n          </div>\r\n        ) : null}\r\n\r\n      </Panel>\r\n\r\n\r\n\r\n\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ManageLandlordsPanel\r\n\r\n","C:\\Users\\ruper\\Desktop\\Web\\Own Projects\\Property Stock App V2\\psafrontendv2\\src\\components\\PreviewPDFPanel.tsx",["360","361","362","363","364","365","366","367","368","369","370","371","372","373","374","375","376","377","378","379","380","381","382","383","384","385","386","387","388","389","390","391","392","393","394","395","396","397","398","399","400","401","402","403","404","405","406","407","408","409","410","411","412"],"import * as React from 'react';\r\nimport { CommandBarButton, IButtonStyles, ILayerStyleProps, ILayerStyles, ILayerProps } from 'office-ui-fabric-react';\r\nimport { Panel, PanelType, IPanelProps, IPanelStyles, IPanelStyleProps, } from 'office-ui-fabric-react/lib/Panel';\r\nimport { IRenderFunction, IStyleFunctionOrObject } from 'office-ui-fabric-react/lib/Utilities';\r\nimport { Dropdown, IDropdownOption } from 'office-ui-fabric-react/lib/Dropdown';\r\nimport { Link } from 'office-ui-fabric-react/lib/Link';\r\nimport { useBoolean } from '@uifabric/react-hooks';\r\nimport { GET_SELECTED_PROPERTIES, GET_NAV_STATE, GET_DISTINCT_SUBURBS, GET_DISTINCT_REGIONS, UPDATE_IMAGES, GET_MULTI_PROPERTY, GET_PDF_VARIABLES } from \"../gql/gql\"\r\nimport { useMutation, useQuery } from '@apollo/client';\r\nimport { Mutation, MutationUpdatePropertyArgs, Query, NavigationState, Premises, SelectedPropertyList, Property, Agent } from \"../schematypes/schematypes\"\r\nimport { navigationState as navigationStateVar, selectedPropertyList as selectedPropertyListVar } from \"../reactivevariables/reactivevariables\"\r\nimport { Icon } from '@fluentui/react/lib/Icon';\r\n\r\n\r\nimport SelectedPropertyListPDF from \"./PDFOutput/SelectedPropertyListPDF\"\r\nimport PropertyListLargeImagesPDF from \"./PDFOutput/PropertyListLargeImagesPDF\"\r\nimport PropertyListScheduleNoImages from \"./PDFOutput/PropertyListScheduleNoImages\"\r\nimport { PDFViewer, PDFDownloadLink, Document, Page } from '@react-pdf/renderer';\r\n\r\n\r\n\r\n\r\nimport {\r\n    getTheme,\r\n    mergeStyleSets,\r\n    FontWeights,\r\n    ContextualMenu,\r\n    Toggle,\r\n    IToggleStyles,\r\n    DefaultButton,\r\n    Modal,\r\n    IDragOptions,\r\n    IconButton,\r\n    IIconProps,\r\n    IModalStyles,\r\n    mergeStyles,\r\n    ComboBox,\r\n    Fabric,\r\n    IComboBoxOption,\r\n    IComboBox,\r\n    SelectableOptionMenuItemType,\r\n    IComboBoxStyles,\r\n    Stack,\r\n    Text,\r\n    IStackStyles\r\n\r\n} from 'office-ui-fabric-react';\r\n\r\n\r\n\r\ninterface Props {\r\n    showPreviewPDFPanel: boolean\r\n    enquiryName: string,\r\n    agent: Agent\r\n    propertyIdList: number[]\r\n}\r\n\r\nconst PreviewPDFPanel: React.FunctionComponent<Props> = ({ showPreviewPDFPanel, enquiryName, agent, propertyIdList = [] }) => {\r\n\r\n    const {\r\n        data: pdfVariables,\r\n        loading: pdfLoading,\r\n        error: pdfError\r\n    } = useQuery<Query>(GET_PDF_VARIABLES);\r\n\r\n    const {\r\n        data: propertyListData,\r\n        loading: propertyListDataLoading,\r\n        error: propertyListDataError\r\n    } = useQuery<Query>(GET_MULTI_PROPERTY, {\r\n        variables: { propertyIdList: propertyIdList }, fetchPolicy: \"network-only\"\r\n    });\r\n\r\n    var selectedPropertyList: SelectedPropertyList = propertyListData?.multiProperty!\r\n\r\n    var filteredPropertyList = selectedPropertyList?.map((property) => {\r\n        if (pdfVariables?.pdfVariables?.onlyShowVacant === true) {\r\n            let filteredPremises = property.premisesList!.filter((premises) => {\r\n                return premises.vacant === \"true\"\r\n            })\r\n            let premisesFilteredProperty = { ...property, premisesList: filteredPremises }\r\n            return premisesFilteredProperty\r\n        } else {\r\n            return property\r\n        }\r\n    })\r\n\r\n\r\n\r\n    const handlePanelDismiss = () => {\r\n        navigationStateVar({ ...navigationStateVar(), showPreviewPDFPanel: false })\r\n\r\n    }\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n    const theme = getTheme();\r\n    const cancelIconStyles = {\r\n        root: {\r\n            color: theme.palette.neutralPrimary,\r\n            /*   marginLeft: \"10px !important\",\r\n              marginTop: '4px',\r\n              marginRight: '2px', */\r\n\r\n        },\r\n        rootHovered: {\r\n            color: theme.palette.neutralDark,\r\n        },\r\n        icon: {\r\n            fontSize: \"24px\",\r\n\r\n        }\r\n    };\r\n\r\n\r\n\r\n    const cancelIcon: IIconProps = { iconName: 'Cancel' };\r\n    const addIcon: IIconProps = { iconName: 'Add' };\r\n    const editIcon: IIconProps = { iconName: 'Edit' };\r\n    const deleteIcon: IIconProps = { iconName: 'Delete' };\r\n\r\n    const commandBarStyles: Partial<IButtonStyles> = { root: { border: \"1px solid rgb(161, 159, 157);\", padding: 10 } };\r\n    const panelStyles: IStyleFunctionOrObject<IPanelStyleProps, IPanelStyles> = {\r\n        /*   root: {}, */\r\n        navigation: {\r\n            justifyContent: \"flex-start\",\r\n            paddingLeft: 24,\r\n            paddingRight: 24,\r\n            paddingTop: 20\r\n        },\r\n        header: {},\r\n        headerText: { fontSize: 24, marginLeft: 5 },\r\n\r\n    }\r\n\r\n    const layerStyles: IStyleFunctionOrObject<ILayerStyleProps, ILayerStyles> = {\r\n        root: { zIndex: 50000 },\r\n    }\r\n\r\n    const layerProps: ILayerProps = {\r\n        styles: layerStyles\r\n    }\r\n\r\n\r\n    const boldStyle = { root: { fontWeight: FontWeights.semibold } };\r\n    const propertyDetailsStyles = { alignSelf: \"start\", fontSize: \"18px\", paddingLeft: \"15px\" }\r\n\r\n    const boldStyle2 = { root: { fontWeight: FontWeights.bold } };\r\n    const propertyDetailsHeadingStyles = { /* alignSelf: \"start\", */ fontSize: \"20px\", marginLeft: \"auto\", marginRight: \"auto\", marginTop: 10, marginBottom: 10 }\r\n    const propertyNotesStyles = { alignSelf: \"start\", fontSize: \"16px\", paddingLeft: \"15px\", marginTop: 0 }\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n    const onRenderNavigationContent: IRenderFunction<IPanelProps> = React.useCallback(\r\n        (props, defaultRender) => (\r\n            <>\r\n                <IconButton\r\n                    styles={cancelIconStyles}\r\n                    iconProps={cancelIcon}\r\n                    ariaLabel=\"Close panel\"\r\n                    onClick={handlePanelDismiss}\r\n                />\r\n                {/* <IconButton\r\n                    styles={editIconStyles}\r\n                    iconProps={editIcon}\r\n                    ariaLabel=\"Edit Property Details\"\r\n                    onClick={handleEditProperty}\r\n                /> */}\r\n\r\n\r\n\r\n            </>\r\n        ),\r\n        [],\r\n    );\r\n\r\n\r\n\r\n    const showPDF = () => {\r\n\r\n        switch (pdfVariables?.pdfVariables?.outputType) {\r\n            case \"Large Images\":\r\n\r\n                return (\r\n\r\n                    <div style={{ height: '85vh' }}>\r\n                        <PDFViewer width=\"100%\" height=\"100%\">\r\n                            <PropertyListLargeImagesPDF enquiryName={enquiryName} customTitle={pdfVariables.pdfVariables.customTitle} agent={agent} selectedPropertyList={filteredPropertyList} imageLimit={pdfVariables.pdfVariables.imageLimit} showLocality={pdfVariables.pdfVariables.showLocality} showAerial={pdfVariables.pdfVariables.showAerial} showImages={pdfVariables.pdfVariables.showImages} />\r\n                        </PDFViewer>\r\n\r\n                    </div>\r\n\r\n                )\r\n\r\n            case \"Schedule\":\r\n\r\n                return (\r\n\r\n                    <div style={{ height: '85vh' }}>\r\n                        <PDFViewer width=\"100%\" height=\"100%\">\r\n                            <PropertyListScheduleNoImages enquiryName={enquiryName} customTitle={pdfVariables.pdfVariables.customTitle} agent={agent} selectedPropertyList={filteredPropertyList} imageLimit={pdfVariables!.pdfVariables!.imageLimit} showImages={pdfVariables!.pdfVariables!.showImages} />\r\n                        </PDFViewer>\r\n\r\n                    </div>\r\n\r\n                )\r\n\r\n            default:\r\n\r\n                {/* <div style={{ height: '85vh' }}>\r\n                    <PDFViewer width=\"100%\" height=\"100%\">\r\n                        <PropertyListLargeImagesPDF enquiryName={enquiryName} customTitle={pdfVariables!.pdfVariables!.customTitle} agent={agent} selectedPropertyList={filteredPropertyList} imageLimit={pdfVariables!.pdfVariables!.imageLimit} showLocality={pdfVariables!.pdfVariables!.showLocality} showAerial={pdfVariables!.pdfVariables!.showAerial} showImages={pdfVariables!.pdfVariables!.showImages} />\r\n                    </PDFViewer>\r\n\r\n                </div> */}\r\n        }\r\n\r\n    }\r\n\r\n\r\n\r\n\r\n\r\n    return (\r\n        <div >\r\n            <Panel\r\n                isOpen={showPreviewPDFPanel}\r\n                onDismiss={handlePanelDismiss}\r\n                type={PanelType.extraLarge}\r\n                onRenderNavigationContent={onRenderNavigationContent}\r\n                /* customWidth={panelType === PanelType.custom || panelType === PanelType.customNear ? '888px' : undefined} */\r\n                closeButtonAriaLabel=\"Close\"\r\n                headerText=\"Preview PDF\"\r\n                styles={panelStyles}\r\n                layerProps={layerProps}\r\n                isBlocking={false}\r\n            >\r\n\r\n                <Stack verticalFill styles={{\r\n                    root: {\r\n                        display: \"flex\",\r\n                        flexFlow: \"column\",\r\n                        paddingTop: 10\r\n                        /* maxWidth: \"fit-content\" */\r\n                        /*  marginTop: \"0 !important\" */\r\n                    }\r\n                }}>\r\n\r\n\r\n\r\n\r\n                    {showPDF()}\r\n\r\n\r\n                </Stack>\r\n\r\n\r\n\r\n\r\n\r\n            </Panel>\r\n\r\n\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default PreviewPDFPanel\r\n\r\n","C:\\Users\\ruper\\Desktop\\Web\\Own Projects\\Property Stock App V2\\psafrontendv2\\src\\components\\SavedListsPanel.tsx",["413","414","415","416","417","418","419","420","421","422","423","424","425","426","427","428","429","430","431","432","433","434","435","436","437","438","439","440","441","442","443","444","445","446","447","448","449","450","451","452","453","454","455","456","457","458","459","460","461","462","463","464","465","466","467","468"],"import * as React from 'react';\r\nimport { CommandBarButton, IButtonStyles, ILayerStyleProps, ILayerStyles, ILayerProps, FocusTrapCallout, FocusZone, PrimaryButton, TextField, ITextFieldStyles } from 'office-ui-fabric-react';\r\nimport { Panel, PanelType, IPanelProps, IPanelStyles, IPanelStyleProps, } from 'office-ui-fabric-react/lib/Panel';\r\nimport { IRenderFunction, IStyleFunctionOrObject } from 'office-ui-fabric-react/lib/Utilities';\r\nimport { Dropdown, IDropdownOption } from 'office-ui-fabric-react/lib/Dropdown';\r\nimport { Link } from 'office-ui-fabric-react/lib/Link';\r\nimport { useBoolean } from '@uifabric/react-hooks';\r\nimport { GET_SINGLE_PROPERTY, GET_NAV_STATE, GET_DISTINCT_SUBURBS, GET_DISTINCT_REGIONS, UPDATE_IMAGES, NEW_LANDLORD, GET_LANDLORDS } from \"../gql/gql\"\r\nimport { useMutation, useQuery } from '@apollo/client';\r\nimport { Mutation, MutationPostLandlordArgs, Query, NavigationState, Premises, Landlord, PropertyList, SelectedPropertyList } from \"../schematypes/schematypes\"\r\nimport { navigationState as navigationStateVar, selectedPropertyList as selectedPropertyListVar } from \"../reactivevariables/reactivevariables\"\r\nimport { Icon } from '@fluentui/react/lib/Icon';\r\n\r\nimport SavedListItem from \"./SavedListItem\"\r\n\r\nimport \"./SavedListsPanel.css\"\r\n\r\nimport { SearchBox, ISearchBoxStyles, } from 'office-ui-fabric-react/lib/SearchBox';\r\n\r\nimport {\r\n  getTheme,\r\n  mergeStyleSets,\r\n  FontWeights,\r\n  ContextualMenu,\r\n  Toggle,\r\n  IToggleStyles,\r\n  DefaultButton,\r\n  Modal,\r\n  IDragOptions,\r\n  IconButton,\r\n  IIconProps,\r\n  IModalStyles,\r\n  mergeStyles,\r\n  ComboBox,\r\n  Fabric,\r\n  IComboBoxOption,\r\n  IComboBox,\r\n  SelectableOptionMenuItemType,\r\n  IComboBoxStyles,\r\n  Stack,\r\n  Text,\r\n  IStackStyles\r\n\r\n} from 'office-ui-fabric-react';\r\n\r\n\r\ninterface Props {\r\n  showSavedListsPanel: boolean\r\n  propertyLists: PropertyList[]\r\n  propertyIdList: number[]\r\n}\r\n\r\nconst SavedListsPanel: React.FunctionComponent<Props> = ({ showSavedListsPanel, propertyLists, propertyIdList }) => {\r\n\r\n\r\n  const handlePanelDismiss = () => {\r\n    navigationStateVar({ ...navigationStateVar(), showSavedListsPanel: false })\r\n\r\n  }\r\n\r\n  const handleClearSelectedProperties = () => {\r\n    selectedPropertyListVar([])\r\n\r\n  }\r\n\r\n\r\n\r\n\r\n  const theme = getTheme();\r\n  const deleteIconStyles = {\r\n    root: {\r\n      color: theme.palette.neutralPrimary,\r\n      /*   marginLeft: \"10px !important\",\r\n        marginTop: '4px',\r\n        marginRight: '2px', */\r\n\r\n    },\r\n    rootHovered: {\r\n      color: theme.palette.neutralDark,\r\n    },\r\n    icon: {\r\n      fontSize: \"24px\",\r\n\r\n    }\r\n  };\r\n\r\n  const clearIconStyles = {\r\n    root: {\r\n      color: theme.palette.neutralPrimary,\r\n      marginLeft: \"10px !important\",\r\n    },\r\n    rootHovered: {\r\n      color: theme.palette.neutralDark,\r\n    },\r\n    icon: {\r\n      fontSize: \"24px\",\r\n    }\r\n  };\r\n\r\n  const addIconStyles = {\r\n    root: {\r\n      color: theme.palette.neutralPrimary,\r\n      marginLeft: 20\r\n\r\n    },\r\n    rootHovered: {\r\n      color: theme.palette.neutralDark,\r\n    },\r\n    icon: {\r\n      fontSize: \"24px\",\r\n\r\n    }\r\n  };\r\n\r\n  const cancelIcon: IIconProps = { iconName: 'Cancel' };\r\n  const clearIcon: IIconProps = { iconName: 'RemoveFromShoppingList' };\r\n  const addIcon: IIconProps = { iconName: 'Add' };\r\n  const editIcon: IIconProps = { iconName: 'Edit' };\r\n  const photoCollectionIcon: IIconProps = { iconName: 'PhotoCollection' };\r\n  const commandBarStyles: Partial<IButtonStyles> = { root: { border: \"1px solid rgb(161, 159, 157);\", padding: 10 } };\r\n  const panelStyles: IStyleFunctionOrObject<IPanelStyleProps, IPanelStyles> = {\r\n    /*   root: {}, */\r\n    navigation: {\r\n      justifyContent: \"flex-start\",\r\n      paddingLeft: 24,\r\n      paddingRight: 24,\r\n      paddingTop: 20\r\n    },\r\n    header: { marginBottom: 10 },\r\n    headerText: { fontSize: 24, marginLeft: 15 },\r\n    content: {\r\n      paddingLeft: 12,\r\n      paddingRight: 20,\r\n      \r\n    },\r\n    /* scrollableContent: { overflowY: \"hidden\"} */\r\n\r\n  }\r\n\r\n  const layerStyles: IStyleFunctionOrObject<ILayerStyleProps, ILayerStyles> = {\r\n    root: { zIndex: 100000 },\r\n  }\r\n\r\n  const layerProps: ILayerProps = {\r\n    styles: layerStyles\r\n  }\r\n\r\n\r\n  const boldStyle = { root: { fontWeight: FontWeights.semibold } };\r\n  const propertyDetailsStyles = { alignSelf: \"start\", fontSize: \"18px\", paddingLeft: \"15px\" }\r\n  const propertyDetailsLandlordStyles = { alignSelf: \"start\", fontSize: \"18px\", paddingLeft: \"15px\", width: 125 }\r\n\r\n  const boldStyle2 = { root: { fontWeight: FontWeights.bold } };\r\n  const propertyDetailsHeadingStyles = { /* alignSelf: \"start\", */ fontSize: \"20px\", marginLeft: \"auto\", marginRight: \"auto\", marginTop: 10, marginBottom: 10 }\r\n  const propertyNotesStyles = { alignSelf: \"start\", fontSize: \"16px\", paddingLeft: \"15px\", marginTop: 0 }\r\n\r\n  const textFieldStyles: Partial<ITextFieldStyles> = { fieldGroup: { width: 300 } };\r\n\r\n  const searchBoxStyles: Partial<ISearchBoxStyles> = { root: { width: 300, height: 44 } };\r\n\r\n  const styles = mergeStyleSets({\r\n\r\n    callout: {\r\n      maxWidth: 600,\r\n    },\r\n    header: {\r\n      padding: '18px 24px 12px',\r\n    },\r\n    title: [\r\n      {\r\n        margin: 0,\r\n        fontWeight: FontWeights.bold,\r\n      },\r\n    ],\r\n    inner: {\r\n      height: '100%',\r\n      padding: '0 24px 20px',\r\n    },\r\n    actions: {\r\n      position: 'relative',\r\n      marginTop: 20,\r\n      width: '100%',\r\n      whiteSpace: 'nowrap',\r\n    },\r\n    buttons: {\r\n      display: 'flex',\r\n      justifyContent: 'flex-end',\r\n      padding: '0 24px 24px',\r\n    },\r\n    subtext: [\r\n      {\r\n        margin: 0,\r\n        fontWeight: FontWeights.semilight,\r\n      },\r\n    ],\r\n  });\r\n\r\n  const [propertyListSearch, setPropertyListSearch] = React.useState<string | undefined>(\"\")\r\n\r\n\r\n  const onChangeLandlordSearch = React.useCallback(\r\n    (event?: React.ChangeEvent<HTMLInputElement>, newValue?: string) => {\r\n\r\n      setPropertyListSearch(newValue)\r\n    }, [setPropertyListSearch])\r\n\r\n\r\n  console.log(propertyListSearch)\r\n\r\n  const searchSortedPropertyLists = propertyLists?.filter(propertyList => {\r\n    if (propertyList !== null && propertyList !== undefined) {\r\n      if (propertyList?.enquiryName !== null && propertyList?.enquiryName !== undefined) {\r\n        return propertyList?.enquiryName.toLowerCase().includes(propertyListSearch!.toLowerCase())\r\n      }\r\n    }\r\n  })\r\n\r\n\r\n  const onRenderNavigationContent: IRenderFunction<IPanelProps> = React.useCallback(\r\n    (props, defaultRender) => (\r\n      <>\r\n        <IconButton\r\n          styles={deleteIconStyles}\r\n          iconProps={cancelIcon}\r\n          ariaLabel=\"Close panel\"\r\n          onClick={handlePanelDismiss}\r\n        />\r\n\r\n        <IconButton\r\n          styles={clearIconStyles}\r\n          iconProps={clearIcon}\r\n          ariaLabel=\"Close panel\"\r\n          onClick={handleClearSelectedProperties}\r\n        />\r\n\r\n      </>\r\n    ),\r\n    [],\r\n  );\r\n\r\n\r\n  const [expanded, setExpanded] = React.useState<false | number>(0);\r\n\r\n\r\n\r\n\r\n  return (\r\n    <div>\r\n      <Panel\r\n        isOpen={showSavedListsPanel}\r\n        onDismiss={handlePanelDismiss}\r\n        isBlocking={false}\r\n        type={PanelType.smallFixedFar}\r\n        onRenderNavigationContent={onRenderNavigationContent}\r\n        /* customWidth={panelType === PanelType.custom || panelType === PanelType.customNear ? '888px' : undefined} */\r\n        closeButtonAriaLabel=\"Close\"\r\n        headerText={\"Manage Saved Lists\"}\r\n        styles={panelStyles}\r\n        layerProps={layerProps}\r\n        className=\"savedListsPanel\"\r\n      >\r\n\r\n        <Stack id=\"Property List Container\" styles={{\r\n          root: {\r\n            display: \"flex\",\r\n            flexFlow: \"column\",\r\n            marginLeft: 10\r\n            /* maxWidth: \"fit-content\" */\r\n            /*  marginTop: \"0 !important\" */\r\n          }\r\n        }}>\r\n\r\n          <SearchBox\r\n            styles={searchBoxStyles}\r\n            placeholder=\"Search\"\r\n            onEscape={ev => {\r\n              console.log('Custom onEscape Called');\r\n            }}\r\n            onClear={ev => {\r\n              console.log('Custom onClear Called');\r\n            }}\r\n            onChange={onChangeLandlordSearch}\r\n            onSearch={newValue => console.log('SearchBox onSearch fired: ' + newValue)}\r\n          />\r\n\r\n          {searchSortedPropertyLists !== undefined ? searchSortedPropertyLists.map((propertyList) => {\r\n\r\n            return <SavedListItem propertyList={propertyList} key={propertyList.propertyListId} expanded={expanded} setExpanded={setExpanded} propertyIdList={propertyIdList}></SavedListItem>\r\n\r\n          }) : <Text></Text>}\r\n\r\n\r\n        </Stack>\r\n      </Panel>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default SavedListsPanel\r\n\r\n","C:\\Users\\ruper\\Desktop\\Web\\Own Projects\\Property Stock App V2\\psafrontendv2\\src\\reactivevariables\\reactivevariables.tsx",[],"C:\\Users\\ruper\\Desktop\\Web\\Own Projects\\Property Stock App V2\\psafrontendv2\\src\\gql\\gql.tsx",[],"C:\\Users\\ruper\\Desktop\\Web\\Own Projects\\Property Stock App V2\\psafrontendv2\\src\\components\\SelectedPropertyPanel.tsx",["469","470","471","472","473","474","475","476","477","478","479","480","481","482","483","484","485","486","487","488","489","490","491","492","493","494","495","496","497","498","499","500"],"import * as React from 'react';\r\nimport { CommandBarButton, IButtonStyles, ILayerStyleProps, ILayerStyles, ILayerProps } from 'office-ui-fabric-react';\r\nimport { Panel, PanelType, IPanelProps, IPanelStyles, IPanelStyleProps, } from 'office-ui-fabric-react/lib/Panel';\r\nimport { IRenderFunction, IStyleFunctionOrObject } from 'office-ui-fabric-react/lib/Utilities';\r\nimport { Dropdown, IDropdownOption } from 'office-ui-fabric-react/lib/Dropdown';\r\nimport { Link } from 'office-ui-fabric-react/lib/Link';\r\nimport { useBoolean } from '@uifabric/react-hooks';\r\nimport { GET_SINGLE_PROPERTY, GET_NAV_STATE, GET_DISTINCT_SUBURBS, GET_DISTINCT_REGIONS, UPDATE_IMAGES } from \"../gql/gql\"\r\nimport { useMutation, useQuery } from '@apollo/client';\r\nimport { Mutation, MutationUpdatePropertyArgs, Query, NavigationState, Premises, Property } from \"../schematypes/schematypes\"\r\nimport { navigationState as navigationStateVar } from \"../reactivevariables/reactivevariables\"\r\nimport { Icon } from '@fluentui/react/lib/Icon';\r\nimport Map from \"./Map\"\r\nimport ImageGalleryModal from \"./ImageGalleryModal\"\r\nimport PremisesList from \"./PremisesList\"\r\nimport NewPremisesModal from \"./NewPremisesModal\"\r\nimport PremisesNotesModal from \"./PremisesNotesModal\"\r\nimport UpdatePremisesModal from \"./UpdatePremisesModal\"\r\nimport DuplicatePremisesModal from \"./DuplicatePremisesModal\"\r\nimport UpdatePropertyModal from \"./UpdatePropertyModal\"\r\n\r\n\r\n\r\n\r\nimport {\r\n    getTheme,\r\n    mergeStyleSets,\r\n    FontWeights,\r\n    ContextualMenu,\r\n    Toggle,\r\n    IToggleStyles,\r\n    DefaultButton,\r\n    Modal,\r\n    IDragOptions,\r\n    IconButton,\r\n    IIconProps,\r\n    IModalStyles,\r\n    mergeStyles,\r\n    ComboBox,\r\n    Fabric,\r\n    IComboBoxOption,\r\n    IComboBox,\r\n    SelectableOptionMenuItemType,\r\n    IComboBoxStyles,\r\n    Stack,\r\n    Text,\r\n    IStackStyles\r\n\r\n} from 'office-ui-fabric-react';\r\n\r\n\r\ninterface Props {\r\n    distinctSuburbsOptions: IComboBoxOption[];\r\n    distinctRegionsOptions: IComboBoxOption[];\r\n    landlordsOptions: IComboBoxOption[];\r\n\r\n}\r\n\r\nconst SelectedPropertyPanel: React.FunctionComponent<Props> = ({ distinctSuburbsOptions, distinctRegionsOptions, landlordsOptions }) => {\r\n\r\n    /* var containerRef = React.useRef<HTMLDivElement>(null); */\r\n\r\n\r\n\r\n\r\n    const [containerWidth, setContainerWidth] = React.useState<number>(0);\r\n\r\n\r\n    const containerRef = React.useCallback(node => {\r\n        if (node !== null) {\r\n            setContainerWidth(node.offsetWidth);\r\n        }\r\n    }, []);\r\n\r\n    const {\r\n        data: navigationStateData,\r\n        loading: navigationLoading,\r\n        error: navigationError\r\n    } = useQuery<Query>(GET_NAV_STATE);\r\n\r\n    /* var navigationState: NavigationState = {\r\n        showNewPropertyModal: false,\r\n        showUpdatePropertyModal: false,\r\n        showNewPremisesModal: false,\r\n        showUpdatePremisesModal: false,\r\n        showDuplicatePremisesModal: false,\r\n        showPremisesNotesModal: false,\r\n        showPreviewPDFPanel: false,\r\n        showFilterModal: false,\r\n        showImageGalleryModal: false,\r\n        selectedPropertyType: \"all\",\r\n        search: \"\",\r\n        showSelectedPropertyListPanel: false,\r\n        selectedPropertyId: 0,\r\n        selectedPremisesId: 0,\r\n        showManageLandlordsPanel: false,\r\n    } */\r\n\r\n    /* if (navigationStateData !== undefined) { */\r\n    var navigationState = navigationStateData!.navigationState!\r\n    /* } */\r\n\r\n    const {\r\n        data: propertyData,\r\n        loading: propertyLoading,\r\n        error: propertyError\r\n    } = useQuery<Query>(GET_SINGLE_PROPERTY, {\r\n        variables: { propertyId: navigationState.selectedPropertyId },\r\n    });\r\n\r\n\r\n\r\n\r\n\r\n    const handlePanelDismiss = () => {\r\n        navigationStateVar({ ...navigationStateVar(), showSelectedPropertyPanel: false })\r\n        /* dismissPanel() */\r\n    }\r\n\r\n    const handleEditProperty = () => {\r\n        navigationStateVar({ ...navigationStateVar(), showUpdatePropertyModal: true })\r\n\r\n    }\r\n\r\n\r\n\r\n    const [isOpen, { setTrue: openPanel, setFalse: dismissPanel }] = useBoolean(false);\r\n\r\n    const theme = getTheme();\r\n    const deleteIconStyles = {\r\n        root: {\r\n            color: theme.palette.neutralPrimary,\r\n            /*   marginLeft: \"10px !important\",\r\n              marginTop: '4px',\r\n              marginRight: '2px', */\r\n\r\n        },\r\n        rootHovered: {\r\n            color: theme.palette.neutralDark,\r\n        },\r\n        icon: {\r\n            fontSize: \"24px\",\r\n\r\n        }\r\n    };\r\n\r\n    const editIconStyles = {\r\n        root: {\r\n            color: theme.palette.neutralPrimary,\r\n            marginLeft: 20\r\n\r\n        },\r\n        rootHovered: {\r\n            color: theme.palette.neutralDark,\r\n        },\r\n        icon: {\r\n            fontSize: \"24px\",\r\n\r\n        }\r\n    };\r\n\r\n    const cancelIcon: IIconProps = { iconName: 'Cancel' };\r\n    const addIcon: IIconProps = { iconName: 'Add' };\r\n    const editIcon: IIconProps = { iconName: 'Edit' };\r\n    const photoCollectionIcon: IIconProps = { iconName: 'PhotoCollection' };\r\n    const commandBarStyles: Partial<IButtonStyles> = { root: { border: \"1px solid rgb(161, 159, 157);\", padding: 10, width: \"fit-content\", marginLeft: \"auto\", marginRight: \"auto\", } };\r\n    const panelStyles: IStyleFunctionOrObject<IPanelStyleProps, IPanelStyles> = {\r\n        /*   root: {}, */\r\n        navigation: {\r\n            justifyContent: \"flex-start\",\r\n            paddingLeft: 24,\r\n            paddingRight: 24,\r\n            paddingTop: 20\r\n        },\r\n        header: {},\r\n        headerText: { fontSize: 24, marginLeft: 75 },\r\n\r\n    }\r\n\r\n    const layerStyles: IStyleFunctionOrObject<ILayerStyleProps, ILayerStyles> = {\r\n        root: { zIndex: 50000 },\r\n    }\r\n\r\n    const layerProps: ILayerProps = {\r\n        styles: layerStyles\r\n    }\r\n\r\n\r\n    const boldStyle = { root: { fontWeight: FontWeights.semibold } };\r\n    const propertyDetailsStyles = { alignSelf: \"start\", fontSize: \"16px\", paddingLeft: 10, paddingRight: 10, \"white-space\": \"nowrap\" }\r\n    const propertyDetailsLandlordStyles = { alignSelf: \"start\", fontSize: \"16px\", paddingLeft: 10, paddingRight: 10, \"white-space\": \"nowrap\" }\r\n\r\n    const boldStyle2 = { root: { fontWeight: FontWeights.bold } };\r\n    const propertyDetailsHeadingStyles = { /* alignSelf: \"start\", */ fontSize: \"18px\", marginLeft: \"auto\", marginRight: \"auto\", marginTop: 10, marginBottom: 10, \"white-space\": \"nowrap\" }\r\n    const propertyDetailsLandlordHeadingStyles = { /* alignSelf: \"start\", */ fontSize: \"18px\", marginLeft: \"auto\", marginRight: \"auto\", marginTop: 10, marginBottom: 10, paddingLeft: 20, paddingRight: 20, \"white-space\": \"nowrap\" }\r\n    const propertyNotesStyles = { alignSelf: \"start\", fontSize: \"14px\", paddingLeft: \"15px\", marginTop: 0 }\r\n\r\n\r\n\r\n\r\n    const getEarliestOccDate = () => {\r\n\r\n        var premises = propertyData?.singleProperty?.premisesList\r\n        var premisesByOccDates: Premises[] = []\r\n        var date: Date = new Date()\r\n        if (premises !== undefined) {\r\n            premisesByOccDates = premises.slice().sort((a, b) => {\r\n                return Date.parse(a.occupation) - Date.parse(b.occupation)\r\n            });\r\n        }\r\n\r\n        if (premisesByOccDates[0] !== undefined) {\r\n            date = new Date(premisesByOccDates[0].occupation)\r\n        }\r\n        return date.toLocaleDateString(\r\n            'en-gb',\r\n            {\r\n                year: 'numeric',\r\n                month: 'long',\r\n                day: 'numeric'\r\n            }\r\n        );\r\n    }\r\n\r\n    const getEarliestExpDate = () => {\r\n\r\n        var premises = propertyData?.singleProperty?.premisesList\r\n        var premisesByOccDates: Premises[] = []\r\n        var date: Date = new Date()\r\n        if (premises !== undefined) {\r\n            premisesByOccDates = premises.slice().sort((a, b) => {\r\n                return Date.parse(a.leaseExpiry) - Date.parse(b.leaseExpiry)\r\n            });\r\n        }\r\n\r\n        if (premisesByOccDates[0] !== undefined) {\r\n            date = new Date(premisesByOccDates[0].leaseExpiry)\r\n        }\r\n        return date.toLocaleDateString(\r\n            'en-gb',\r\n            {\r\n                year: 'numeric',\r\n                month: 'long',\r\n                day: 'numeric'\r\n            }\r\n        );\r\n    }\r\n\r\n    const getVacantGLA = () => {\r\n        var vacantGLA = 0\r\n        propertyData?.singleProperty?.premisesList!.map(premises => {\r\n            if (premises.vacant === \"true\") {\r\n                vacantGLA += premises.area!\r\n            }\r\n        })\r\n        return vacantGLA\r\n    }\r\n\r\n    const onRenderNavigationContent: IRenderFunction<IPanelProps> = React.useCallback(\r\n        (props, defaultRender) => (\r\n            <>\r\n                <IconButton\r\n                    styles={deleteIconStyles}\r\n                    iconProps={cancelIcon}\r\n                    ariaLabel=\"Close panel\"\r\n                    onClick={handlePanelDismiss}\r\n                />\r\n                <IconButton\r\n                    styles={editIconStyles}\r\n                    iconProps={editIcon}\r\n                    ariaLabel=\"Edit Property Details\"\r\n                    onClick={handleEditProperty}\r\n                />\r\n\r\n\r\n\r\n            </>\r\n        ),\r\n        [],\r\n    );\r\n\r\n    var coordinatesArray: string[] | undefined = []\r\n\r\n\r\n    if (propertyData?.singleProperty?.coordinates !== null) {\r\n        coordinatesArray = propertyData?.singleProperty?.coordinates!.split(',');\r\n    }\r\n\r\n\r\n    const getLatitude = () => {\r\n        if (coordinatesArray !== undefined && coordinatesArray !== null)\r\n            return Number(coordinatesArray[0]).toFixed(2)\r\n        else return \"\"\r\n    }\r\n\r\n    const getLongitude = () => {\r\n        if (coordinatesArray !== undefined && coordinatesArray !== null)\r\n            return Number(coordinatesArray[1]).toFixed(2)\r\n        else return \"\"\r\n    }\r\n\r\n    var checkUploadResult = (resultEvent: any) => {\r\n\r\n        if (resultEvent.event === \"success\") {\r\n            console.log(resultEvent.info.secure_url)\r\n            console.log(resultEvent.info.public_id)\r\n            saveNewImage(resultEvent.info.public_id)\r\n        }\r\n    }\r\n\r\n\r\n    // @ts-ignore: Unreachable code error\r\n    var widget = window.cloudinary.createUploadWidget({\r\n        cloudName: \"drlfedqyz\", uploadPreset: \"xblzxkc8\"\r\n    }, (error: any, result: any) => { checkUploadResult(result) });\r\n\r\n    const showUploadWidget = () => {\r\n        widget.open()\r\n\r\n    }\r\n\r\n    const getContactId = () => {\r\n        if (propertyData?.singleProperty?.contact?.contactId === undefined || propertyData?.singleProperty?.contact?.contactId === null) {\r\n            return 45\r\n        } else {\r\n            return propertyData?.singleProperty?.contact?.contactId\r\n        }\r\n    }\r\n\r\n    const [updateProperty, { data }] = useMutation<Mutation, MutationUpdatePropertyArgs>(UPDATE_IMAGES);\r\n\r\n    const saveNewImage = (image: string) => {\r\n\r\n        updateProperty({\r\n            variables: {\r\n                propertyId: navigationState.selectedPropertyId,\r\n                images: propertyData?.singleProperty?.images?.concat(image),\r\n                contactId: getContactId()\r\n            },\r\n\r\n            update(cache, { data }) {\r\n\r\n                if (!data) {\r\n                    return null;\r\n                }\r\n\r\n                const getExistingProperty = cache.readQuery<Query>({ query: GET_SINGLE_PROPERTY, variables: { propertyId: navigationState.selectedPropertyId } })\r\n                const existingProperty: Property = getExistingProperty ? getExistingProperty.singleProperty! : { propertyId: 1, propertyName: \"\" };\r\n\r\n                const updatedProperty = {\r\n                    ...existingProperty,\r\n                    images: data.updateProperty.images,\r\n                    contact: { ...existingProperty.contact, contactId: data.updateProperty.contact?.contactId! }\r\n                }\r\n                console.log(updatedProperty)\r\n                if (getExistingProperty)\r\n                    cache.writeQuery<Query>({\r\n                        query: GET_SINGLE_PROPERTY,\r\n                        variables: { propertyId: navigationState.selectedPropertyId },\r\n                        data: { singleProperty: updatedProperty }\r\n                    });\r\n            }\r\n        })\r\n    }\r\n\r\n    if (navigationLoading) return <div>Loading</div>;\r\n    if (propertyLoading) return <div>Loading</div>;\r\n\r\n    return (\r\n        <div>\r\n            <Panel\r\n                isOpen={navigationState.showSelectedPropertyPanel}\r\n                /*  onDismiss={handlePanelDismiss} */\r\n                type={PanelType.extraLarge}\r\n                onRenderNavigationContent={onRenderNavigationContent}\r\n                /* customWidth={panelType === PanelType.custom || panelType === PanelType.customNear ? '888px' : undefined} */\r\n                closeButtonAriaLabel=\"Close\"\r\n                headerText={propertyData?.singleProperty?.propertyName}\r\n                styles={panelStyles}\r\n                layerProps={layerProps}\r\n            >\r\n\r\n                <Stack id=\"Details to Maps Container\" styles={{\r\n                    root: {\r\n                        display: \"flex\",\r\n                        flexFlow: \"row\",\r\n                        /* maxWidth: \"fit-content\" */\r\n                        /*  marginTop: \"0 !important\" */\r\n                    }\r\n                }}>\r\n\r\n                    <Stack id=\"Details, Landlord and Notes Container\" styles={{\r\n                        root: {\r\n                            /*   display: \"flex\",\r\n                              flexFlow: \"row\", */\r\n                            /*  maxWidth: \"fit-content\", */\r\n                            marginLeft: 10,\r\n                            marginTop: 20\r\n                            /*  marginTop: \"0 !important\" */\r\n                        }\r\n                    }}>\r\n\r\n                        <Stack id=\"Details and Landlord Container\" styles={{\r\n                            root: {\r\n                                display: \"flex\",\r\n                                flexFlow: \"row\",\r\n                                /* maxWidth: \"fit-content\" */\r\n                                /*  marginTop: \"0 !important\" */\r\n                            }\r\n                        }}>\r\n\r\n                            <Stack id=\"Property Details\" styles={{\r\n                                root: {\r\n                                    /* width: \"fit-content\", */\r\n                                    marginTop: \"20 !important\",\r\n                                    marginBottom: 10,\r\n                                    marginRight: 10,\r\n                                    padding: '10px',\r\n                                    textAlign: 'left',\r\n                                    color: '#605e5c',\r\n                                    alignItems: \"left\",\r\n                                    display: \"flex\",\r\n                                    flexFlow: \"column\",\r\n                                    /*  borderTop: \"4px solid #2557a2;\",\r\n                                     borderBottom: \"4px solid #2557a2;\", */\r\n                                    backgroundColor: \"white\",\r\n                                    /*  background: isChecked() ? \"rgb(104 113 140 / 14%)\" : \"white\", */\r\n                                    /*  boxShadow: \"-1px 1px 7px 2px #d4cece\",\r\n                                     selectors: {\r\n                                         '&:hover': { background: \"rgb(104 113 140 / 14%)\" },\r\n                                     }, */\r\n                                    /* maxWidth: \"fit-content\" */\r\n\r\n                                }\r\n                            }}\r\n                                gap={15}>\r\n                                <div style={{ display: \"flex\", /* borderTop: \"3px solid rgb(204 171 124 / 42%)\" */  backgroundColor: \"#faebd775\", transform: \"translate(-2px,0px)\", boxShadow: \"rgb(0 0 0 / 30%) 1px 3px 6px 0px\", width: containerWidth }}>\r\n                                    <Text styles={boldStyle2} style={propertyDetailsHeadingStyles}>Property Details:</Text>\r\n                                </div>\r\n\r\n                                <div ref={containerRef} style={{ marginTop: 0, width: \"fit-content\" }}>\r\n\r\n                                    <Stack styles={{\r\n                                        root: {\r\n                                            /* width: 700, */\r\n                                            /*  marginTop: 20,\r\n                                             marginBottom: 10, */\r\n                                            /*   padding: '10px', */\r\n                                            textAlign: 'left',\r\n                                            color: '#605e5c',\r\n                                            alignItems: \"left\",\r\n                                            display: \"flex\",\r\n                                            flexFlow: \"row\",\r\n                                            /*  borderTop: \"4px solid #2557a2;\",\r\n                                             borderBottom: \"4px solid #2557a2;\", */\r\n                                            backgroundColor: \"#d7e0e024\",\r\n                                            boxShadow: \"rgb(0 0 0 / 24%) 1px 3px 6px 0px\",\r\n                                            /*  background: isChecked() ? \"rgb(104 113 140 / 14%)\" : \"white\", */\r\n                                            /*  boxShadow: \"-1px 1px 7px 2px #d4cece\",\r\n                                             selectors: {\r\n                                                 '&:hover': { background: \"rgb(104 113 140 / 14%)\" },\r\n                                             }, */\r\n                                            marginTop: \"0 !important\",\r\n                                            /*  borderBottom: \"3px solid rgb(204 171 124 / 42%)\", */\r\n\r\n\r\n\r\n                                        }\r\n                                    }}\r\n                                        gap={15}>\r\n\r\n                                        <Stack styles={{\r\n                                            root: {\r\n                                                padding: '10px',\r\n                                                textAlign: 'left',\r\n                                                alignItems: \"left\",\r\n                                                display: \"flex\",\r\n                                                flexFlow: \"row\",\r\n\r\n                                            }\r\n                                        }}>\r\n\r\n                                            <Stack verticalFill styles={{\r\n                                                root: {\r\n                                                    marginTop: \"0 !important\"\r\n                                                },\r\n                                            }}\r\n                                                gap={15}>\r\n                                                <Text styles={boldStyle} style={propertyDetailsStyles}>Address:</Text>\r\n                                                <Text styles={boldStyle} style={propertyDetailsStyles}>Suburb:</Text>\r\n                                                <Text styles={boldStyle} style={propertyDetailsStyles}>Region:</Text>\r\n                                                <Text styles={boldStyle} style={propertyDetailsStyles}>Province:</Text>\r\n                                                <Text styles={boldStyle} style={propertyDetailsStyles}>Building Type:</Text>\r\n\r\n                                            </Stack>\r\n\r\n\r\n                                            <Stack verticalFill styles={{\r\n                                                root: {\r\n                                                    marginTop: \"0 !important\",\r\n                                                    marginLeft: 0\r\n                                                },\r\n                                            }}\r\n                                                gap={15}>\r\n                                                <Text style={propertyDetailsStyles}>{propertyData?.singleProperty?.address !== \"\" ? propertyData?.singleProperty?.address : \"-\"}</Text>\r\n                                                <Text style={propertyDetailsStyles}>{propertyData?.singleProperty?.suburb !== \"\" ? propertyData?.singleProperty?.suburb : \"-\"}</Text>\r\n                                                <Text style={propertyDetailsStyles}>{propertyData?.singleProperty?.region !== \"\" ? propertyData?.singleProperty?.region : \"-\"}</Text>\r\n                                                <Text style={propertyDetailsStyles}>{propertyData?.singleProperty?.province !== \"\" ? propertyData?.singleProperty?.province : \"-\"}</Text>\r\n                                                <Text style={propertyDetailsStyles}>{propertyData?.singleProperty?.buildingType !== \"\" ? propertyData?.singleProperty?.buildingType : \"-\"}</Text>\r\n                                            </Stack>\r\n\r\n                                        </Stack>\r\n\r\n                                        <Stack styles={{\r\n                                            root: {\r\n                                                padding: '10px',\r\n                                                textAlign: 'left',\r\n                                                alignItems: \"left\",\r\n                                                display: \"flex\",\r\n                                                flexFlow: \"row\",\r\n                                                marginTop: \"0 !important\"\r\n                                            }\r\n                                        }}>\r\n\r\n                                            <Stack verticalFill styles={{\r\n                                                root: {\r\n                                                    marginTop: \"0 !important\"\r\n                                                },\r\n                                            }}\r\n                                                gap={15}>\r\n\r\n                                                <Text styles={boldStyle} style={propertyDetailsStyles}>Erf Extent:</Text>\r\n                                                <Text styles={boldStyle} style={propertyDetailsStyles}>Total GLA:</Text>\r\n                                                <Text styles={boldStyle} style={propertyDetailsStyles}>Vacant GLA:</Text>\r\n                                                <Text styles={boldStyle} style={propertyDetailsStyles}>Earliest Occupation:</Text>\r\n                                                <Text styles={boldStyle} style={propertyDetailsStyles}>Earliest Expiry:</Text>\r\n                                            </Stack>\r\n\r\n\r\n                                            <Stack verticalFill styles={{\r\n                                                root: {\r\n                                                    marginTop: \"0 !important\",\r\n                                                    marginLeft: 0\r\n                                                },\r\n                                            }}\r\n                                                gap={15}>\r\n\r\n                                                <Text style={propertyDetailsStyles}>{`${propertyData?.singleProperty?.erfExtent} m²`}</Text>\r\n                                                <Text style={propertyDetailsStyles}>{`${propertyData?.singleProperty?.totalGLA} m²`}</Text>\r\n                                                <Text style={propertyDetailsStyles}>{`${getVacantGLA().toFixed(2).replace(/[.,]00$/, \"\")} m²`}</Text>\r\n                                                <Text style={propertyDetailsStyles}>{getEarliestOccDate()}</Text>\r\n                                                <Text style={propertyDetailsStyles}>{getEarliestExpDate()}</Text>\r\n                                            </Stack>\r\n\r\n                                        </Stack>\r\n\r\n                                    </Stack>\r\n\r\n                                </div>\r\n\r\n\r\n                                <Stack id=\"Notes\" styles={{\r\n                                    root: {\r\n                                        width: containerWidth,\r\n                                        /*   marginTop: 10, */\r\n                                        marginBottom: 10,\r\n                                        /*  padding: '10px', */\r\n                                        textAlign: 'left',\r\n                                        color: '#605e5c',\r\n                                        alignItems: \"left\",\r\n                                        display: \"flex\",\r\n                                        flexFlow: \"column\",\r\n                                        /*  borderTop: \"4px solid #2557a2;\",\r\n                                         borderBottom: \"4px solid #2557a2;\", */\r\n                                        backgroundColor: \"white\",\r\n                                        /*  borderBottom: \"3px solid rgb(204 171 124 / 42%)\" */\r\n                                        /*  background: isChecked() ? \"rgb(104 113 140 / 14%)\" : \"white\", */\r\n                                        /*  boxShadow: \"-1px 1px 7px 2px #d4cece\",\r\n                                         selectors: {\r\n                                             '&:hover': { background: \"rgb(104 113 140 / 14%)\" },\r\n                                         }, */\r\n                                        /* maxWidth: \"fit-content\" */\r\n\r\n                                    }\r\n                                }}\r\n                                    gap={15}>\r\n\r\n                                    <div style={{ display: \"flex\",  /* borderTop: \"3px solid rgb(204 171 124 / 42%)\" , */ marginTop: \"0 !important\", backgroundColor: \"#faebd775\", transform: \"translate(-2px,0px)\", boxShadow: \"rgb(0 0 0 / 30%) 1px 3px 6px 0px\", }}>\r\n                                        <Text styles={boldStyle2} style={propertyDetailsHeadingStyles}>Notes:</Text>\r\n\r\n                                    </div>\r\n                                    <div style={{ display: \"flex\", /* borderBottom: \"3px solid rgb(204 171 124 / 42%)\", */ margin: 0, paddingBottom: 10, paddingTop: 10, paddingLeft: 5, paddingRight: 5, backgroundColor: \"#d7e0e024\", boxShadow: \"rgb(0 0 0 / 24%) 1px 3px 6px 0px\", }}>\r\n                                        <Text style={propertyNotesStyles}>{propertyData?.singleProperty?.notes}</Text>\r\n\r\n                                    </div>\r\n\r\n\r\n                                </Stack>\r\n\r\n                            </Stack>\r\n\r\n                            <Stack id=\"Landlord Details\" styles={{\r\n                                root: {\r\n                                    /* width: 700, */\r\n                                    marginTop: 20,\r\n                                    marginBottom: 10,\r\n                                    padding: '10px',\r\n                                    textAlign: 'left',\r\n                                    color: '#605e5c',\r\n                                    alignItems: \"left\",\r\n                                    display: \"flex\",\r\n                                    flexFlow: \"column\",\r\n                                    /*  borderTop: \"4px solid #2557a2;\",\r\n                                     borderBottom: \"4px solid #2557a2;\", */\r\n                                    backgroundColor: \"white\",\r\n                                    /*  background: isChecked() ? \"rgb(104 113 140 / 14%)\" : \"white\", */\r\n                                    /*  boxShadow: \"-1px 1px 7px 2px #d4cece\",\r\n                                     selectors: {\r\n                                         '&:hover': { background: \"rgb(104 113 140 / 14%)\" },\r\n                                     }, */\r\n                                    /*  maxWidth: \"fit-content\" */\r\n\r\n                                }\r\n                            }}\r\n                                gap={15}>\r\n                                <div style={{ display: \"flex\", /* borderTop: \"3px solid rgb(204 171 124 / 42%)\"  */ backgroundColor: \"#faebd775\", transform: \"translate(-2px,0px)\", boxShadow: \"rgb(0 0 0 / 30%) 1px 3px 6px 0px\" }}>\r\n                                    <Text styles={boldStyle2} style={propertyDetailsLandlordHeadingStyles}>Landlord Details:</Text>\r\n                                </div>\r\n\r\n\r\n                                <Stack styles={{\r\n                                    root: {\r\n                                        /* width: 700, */\r\n                                        /*  marginTop: 20,\r\n                                         marginBottom: 10, */\r\n                                        /*   padding: '10px', */\r\n                                        textAlign: 'left',\r\n                                        color: '#605e5c',\r\n                                        alignItems: \"left\",\r\n                                        display: \"flex\",\r\n                                        flexFlow: \"row\",\r\n                                        /*  borderTop: \"4px solid #2557a2;\",\r\n                                         borderBottom: \"4px solid #2557a2;\", */\r\n                                        backgroundColor: \"#d7e0e024\",\r\n                                        boxShadow: \"rgb(0 0 0 / 24%) 1px 3px 6px 0px\",\r\n                                        /*  background: isChecked() ? \"rgb(104 113 140 / 14%)\" : \"white\", */\r\n                                        /*  boxShadow: \"-1px 1px 7px 2px #d4cece\",\r\n                                         selectors: {\r\n                                             '&:hover': { background: \"rgb(104 113 140 / 14%)\" },\r\n                                         }, */\r\n                                        marginTop: \"0 !important\",\r\n                                        /*  borderBottom: \"3px solid rgb(204 171 124 / 42%)\" */\r\n\r\n\r\n                                    }\r\n                                }}\r\n                                    gap={15}>\r\n\r\n                                    <Stack styles={{\r\n                                        root: {\r\n                                            padding: '10px',\r\n                                            textAlign: 'left',\r\n                                            alignItems: \"left\",\r\n                                            display: \"flex\",\r\n                                            flexFlow: \"row\",\r\n\r\n                                        }\r\n                                    }}>\r\n\r\n                                        <Stack verticalFill styles={{\r\n                                            root: {\r\n                                                marginTop: \"0 !important\"\r\n                                            },\r\n                                        }}\r\n                                            gap={15}>\r\n                                            <Text styles={boldStyle} style={propertyDetailsStyles}>Landlord:</Text>\r\n                                            <Text styles={boldStyle} style={propertyDetailsStyles}>Contact:</Text>\r\n                                            <Text styles={boldStyle} style={propertyDetailsStyles}>Email:</Text>\r\n                                            <Text styles={boldStyle} style={propertyDetailsStyles}>Office:</Text>\r\n                                            <Text styles={boldStyle} style={propertyDetailsStyles}>Mobile:</Text>\r\n                                        </Stack>\r\n\r\n\r\n                                        <Stack verticalFill styles={{\r\n                                            root: {\r\n                                                marginTop: \"0 !important\",\r\n                                                marginLeft: 0\r\n                                            },\r\n                                        }}\r\n                                            gap={15}>\r\n                                            <Text style={propertyDetailsLandlordStyles}>{propertyData?.singleProperty?.contact?.landlordName?.landlordName !== \"\" ? propertyData?.singleProperty?.contact?.landlordName?.landlordName : \"-\"}</Text>\r\n                                            <Text style={propertyDetailsLandlordStyles}>{propertyData?.singleProperty?.contact?.name !== \"\" ? propertyData?.singleProperty?.contact?.name : \"-\"}</Text>\r\n                                            <Text style={propertyDetailsLandlordStyles}>{propertyData?.singleProperty?.contact?.email !== \"\" ? propertyData?.singleProperty?.contact?.email : \"-\"}</Text>\r\n                                            <Text style={propertyDetailsLandlordStyles}>{propertyData?.singleProperty?.contact?.mobileNo !== \"\" ? propertyData?.singleProperty?.contact?.mobileNo : \"-\"}</Text>\r\n                                            <Text style={propertyDetailsLandlordStyles}>{propertyData?.singleProperty?.contact?.officeNo !== \"\" ? propertyData?.singleProperty?.contact?.officeNo : \"-\"}</Text>\r\n                                        </Stack>\r\n\r\n                                    </Stack>\r\n                                </Stack>\r\n\r\n                                <Stack verticalFill styles={{\r\n                                    root: {\r\n                                        marginTop: \"20px !important\",\r\n                                        padding: 10\r\n                                    },\r\n                                }}\r\n                                    gap={15}>\r\n\r\n                                    <CommandBarButton\r\n                                        iconProps={photoCollectionIcon}\r\n                                        text=\"Image Gallery\"\r\n                                        onClick={() => navigationStateVar({ ...navigationStateVar(), showImageGalleryModal: true })}\r\n                                        styles={commandBarStyles}\r\n                                    // Set split=true to render a SplitButton instead of a regular button with a menu\r\n                                    // split={true}\r\n\r\n                                    />\r\n\r\n                                    <CommandBarButton\r\n                                        iconProps={addIcon}\r\n                                        text=\"Upload Images\"\r\n                                        onClick={() => showUploadWidget()}\r\n                                        styles={commandBarStyles}\r\n                                    // Set split=true to render a SplitButton instead of a regular button with a menu\r\n                                    // split={true}\r\n\r\n                                    />\r\n\r\n                                </Stack>\r\n\r\n                            </Stack>\r\n\r\n                        </Stack>\r\n\r\n\r\n\r\n\r\n\r\n                    </Stack>\r\n\r\n\r\n\r\n                    <Stack id=\"mapContainer\" styles={{\r\n                        root: {\r\n                            marginLeft: 10,\r\n                            marginRight: \"auto\",\r\n                            padding: '10px',\r\n                            marginTop: \"20px !important\",\r\n\r\n                        }\r\n                    }}>\r\n\r\n                        <Map coordinatesArray={coordinatesArray} propertyId={propertyData?.singleProperty?.propertyId!} contactId={propertyData?.singleProperty?.contact?.contactId!}></Map>\r\n\r\n                    </Stack>\r\n\r\n\r\n\r\n                </Stack>\r\n\r\n                <ImageGalleryModal showImageGalleryModal={navigationStateData?.navigationState?.showImageGalleryModal!} propertyId={navigationStateData?.navigationState?.selectedPropertyId!}></ImageGalleryModal>\r\n\r\n\r\n\r\n                <PremisesList singleProperty={propertyData?.singleProperty!}></PremisesList>\r\n\r\n                <UpdatePropertyModal showUpdatePropertyModal={navigationStateData?.navigationState?.showUpdatePropertyModal!} distinctSuburbsOptions={distinctSuburbsOptions} distinctRegionsOptions={distinctRegionsOptions} propertyId={navigationStateData?.navigationState?.selectedPropertyId!} propertyData={propertyData?.singleProperty!} landlordsOptions={landlordsOptions} ></UpdatePropertyModal>\r\n\r\n                <NewPremisesModal showNewPremisesModal={navigationStateData?.navigationState?.showNewPremisesModal!} propertyId={navigationStateData?.navigationState?.selectedPropertyId!}></NewPremisesModal>\r\n\r\n                <PremisesNotesModal showPremisesNotesModal={navigationStateData?.navigationState?.showPremisesNotesModal!} propertyId={navigationStateData?.navigationState?.selectedPropertyId!} premisesId={navigationStateData?.navigationState?.selectedPremisesId!} ></PremisesNotesModal>\r\n\r\n                <UpdatePremisesModal showUpdatePremisesModal={navigationStateData?.navigationState?.showUpdatePremisesModal!} propertyId={navigationStateData?.navigationState?.selectedPropertyId!} premisesId={navigationStateData?.navigationState?.selectedPremisesId!}></UpdatePremisesModal>\r\n\r\n                <DuplicatePremisesModal showDuplicatePremisesModal={navigationStateData?.navigationState?.showDuplicatePremisesModal!} propertyId={navigationStateData?.navigationState?.selectedPropertyId!} premisesId={navigationStateData?.navigationState?.selectedPremisesId!}></DuplicatePremisesModal>\r\n\r\n\r\n\r\n            </Panel>\r\n\r\n\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default SelectedPropertyPanel\r\n\r\n","C:\\Users\\ruper\\Desktop\\Web\\Own Projects\\Property Stock App V2\\psafrontendv2\\src\\components\\SavedListItem.tsx",["501","502","503","504","505","506","507","508","509","510"],"import * as React from 'react';\r\nimport { getTheme } from '@fluentui/react';\r\nimport { Icon } from 'office-ui-fabric-react/lib/Icon';\r\nimport { Query, Mutation, MutationDeletePropertyListArgs, MutationUpdatePropertyListArgs, MutationPostPropertyListArgs, PropertyList, SelectedPropertyList } from \"../schematypes/schematypes\"\r\nimport { DELETE_PROPERTY_LIST, GET_PROPERTY_LISTS, UPDATE_PROPERTY_LIST, NEW_PROPERTY_LIST } from \"../gql/gql\"\r\nimport { useMutation, } from '@apollo/client';\r\nimport { mergeStyles } from 'office-ui-fabric-react/lib/Styling';\r\nimport { IContextualMenuProps, Stack, Text, FontWeights, IconButton, IIconProps, DefaultButton, FocusTrapCallout, FocusZone, PrimaryButton, mergeStyleSets, TextField, ITextFieldStyles, Checkbox, ICheckboxProps, ICheckboxStyles } from 'office-ui-fabric-react';\r\nimport { useBoolean } from '@uifabric/react-hooks';\r\nimport { motion, AnimatePresence } from \"framer-motion\";\r\nimport ContactListItem from \"./ContactListItem\"\r\n\r\nimport { selectedPropertyList as selectedPropertyListVar, pdfVariables } from \"../reactivevariables/reactivevariables\"\r\n\r\n\r\ninterface Props {\r\n  propertyList: PropertyList\r\n  key: any\r\n  expanded: number | false\r\n  setExpanded: React.Dispatch<React.SetStateAction<number | false>>\r\n  propertyIdList: number[]\r\n}\r\n\r\nexport const SavedListItem: React.FunctionComponent<Props> = ({ propertyList, expanded, setExpanded, propertyIdList }) => {\r\n\r\n var sortedPropertyList = propertyList.properties?.slice().sort((a,b) => {return (a.propertyName < b.propertyName) ? -1 : (a.propertyName > b.propertyName) ? 1 : 0})\r\n\r\n  const [isOpen, setIsOpen] = React.useState(false)\r\n\r\n  React.useEffect(() => {\r\n\r\n    if (expanded === propertyList.propertyListId) {\r\n      setIsOpen(true)\r\n    } else { setIsOpen(false) }\r\n\r\n  }, [expanded, propertyList.propertyListId])\r\n\r\n  const [isDeleteCalloutVisible, { toggle: toggleIsDeleteCalloutVisible }] = useBoolean(false);\r\n  const [isEditCalloutVisible, { toggle: toggleIsEditCalloutVisible }] = useBoolean(false);\r\n  /* const [isAddContactCalloutVisible, { toggle: toggleIsAddContactCalloutVisible }] = useBoolean(false); */\r\n\r\n  console.log(propertyList)\r\n\r\n  const [editPropertyList, setEditPropertyList] = React.useState<MutationUpdatePropertyListArgs>({\r\n    propertyListId: propertyList.propertyListId,\r\n    enquiryName: propertyList.enquiryName,\r\n    customTitle: propertyList.customTitle,\r\n    enquiryDate: propertyList.enquiryDate,\r\n    propertyIdList: propertyList.properties?.map((property) => { return property.propertyId })\r\n  })\r\n\r\n  /* const [addContact, setAddContact] = React.useState({\r\n    name: \"\",\r\n    email: \"\",\r\n    mobileNo: \"\",\r\n    officeNo: \"\"\r\n  }) */\r\n\r\n  const handleExpand = (propertyListId: number) => {\r\n    if (isOpen === false) {\r\n      setExpanded(propertyListId)\r\n    } else { setExpanded(false) }\r\n\r\n\r\n\r\n  }\r\n\r\n  const [deletePropertyList, { data: deletePropertyListData }] = useMutation<Mutation, MutationDeletePropertyListArgs>(DELETE_PROPERTY_LIST);\r\n\r\n  const deletePropertyListButton = () => {\r\n\r\n    deletePropertyList({\r\n      variables: {\r\n        propertyListId: propertyList.propertyListId\r\n      },\r\n      update(cache, { data }) {\r\n\r\n        if (!data) {\r\n          return null;\r\n        }\r\n\r\n        const getExistingPropertyLists = cache.readQuery<Query>({ query: GET_PROPERTY_LISTS });\r\n\r\n        const existingPropertyLists = getExistingPropertyLists ? getExistingPropertyLists.propertyLists : [];\r\n        const newPropertyLists = existingPropertyLists!.filter(t => {\r\n\r\n          return (t.propertyListId !== propertyList.propertyListId)\r\n        });\r\n        if (existingPropertyLists)\r\n          cache.writeQuery<Query>({\r\n            query: GET_PROPERTY_LISTS,\r\n            data: { propertyLists: newPropertyLists }\r\n          });\r\n      }\r\n\r\n    })\r\n    toggleIsDeleteCalloutVisible()\r\n  }\r\n\r\n  const [updatePropertyList, { data: updatePropertyListData }] = useMutation<Mutation, MutationUpdatePropertyListArgs>(UPDATE_PROPERTY_LIST);\r\n\r\n  const updatePropertyListButton = () => {\r\n\r\n    updatePropertyList({\r\n      variables: {\r\n        propertyListId: propertyList.propertyListId,\r\n        enquiryName: editPropertyList.enquiryName,\r\n        customTitle: editPropertyList.customTitle,\r\n        enquiryDate: editPropertyList.enquiryDate,\r\n        propertyIdList: editPropertyList.propertyIdList\r\n\r\n      },\r\n\r\n      update(cache, { data }) {\r\n\r\n        if (!data) {\r\n          return null;\r\n        }\r\n\r\n        const getExistingPropertyLists = cache.readQuery<Query>({ query: GET_PROPERTY_LISTS });\r\n\r\n        const existingPropertyLists = getExistingPropertyLists ? getExistingPropertyLists.propertyLists : [];\r\n        const updatedPropertyList = data.updatePropertyList!/* .returning[0] */;\r\n        const otherPropertyLists = existingPropertyLists!.filter(t => {\r\n          return t.propertyListId !== propertyList.propertyListId\r\n        })\r\n        if (existingPropertyLists)\r\n          cache.writeQuery<Query>({\r\n            query: GET_PROPERTY_LISTS,\r\n            data: { propertyLists: [updatedPropertyList, ...otherPropertyLists] }\r\n          });\r\n      }\r\n\r\n    })\r\n    /* setEditLandlordName(\"\") */\r\n    toggleIsEditCalloutVisible()\r\n  }\r\n\r\n  /*  const [postContact, { data }] = useMutation<Mutation, MutationPostLandlordContactArgs>(NEW_LANDLORD_CONTACT);\r\n \r\n   const saveNewContactButton = () => {\r\n \r\n     postContact({\r\n       variables: {\r\n         landlordId: landlord.landlordId,\r\n         name: addContact.name,\r\n         email: addContact.email,\r\n         mobileNo: addContact.mobileNo,\r\n         officeNo: addContact.officeNo,\r\n \r\n       },\r\n \r\n       update(cache, { data }) {\r\n \r\n         if (!data) {\r\n           return null;\r\n         }\r\n \r\n         const getExistingLandlords = cache.readQuery<Query>({ query: GET_LANDLORDS });\r\n         \r\n         const existingLandlords = getExistingLandlords ? getExistingLandlords.landlords : [];\r\n         const selectedLandlord = existingLandlords!.find(t =>\r\n           t.landlordId === landlord.landlordId\r\n         )\r\n         const otherLandlords = existingLandlords!.filter(t => {\r\n           return t.landlordId !== landlord.landlordId\r\n         })\r\n         const existingContacts = selectedLandlord?.contactsList\r\n         const newContact = data.postLandlordContact!;\r\n         const updatedLandlord = { landlordId: selectedLandlord!.landlordId, landlordName: selectedLandlord!.landlordName, contactsList: [...existingContacts!, newContact] }\r\n         if (existingLandlords)\r\n           cache.writeQuery<Query>({\r\n             query: GET_LANDLORDS,\r\n             data: { landlords: [updatedLandlord!, ...otherLandlords] }\r\n           });\r\n       }\r\n \r\n \r\n     })\r\n \r\n     setAddContact({\r\n       name: \"\",\r\n       email: \"\",\r\n       mobileNo: \"\",\r\n       officeNo: \"\"\r\n     })\r\n     toggleIsAddContactCalloutVisible()\r\n     setIsOpen(true)\r\n   } */\r\n\r\n\r\n\r\n\r\n  const styles = mergeStyleSets({\r\n\r\n    callout: {\r\n      maxWidth: 300,\r\n    },\r\n    header: {\r\n      padding: '18px 24px 12px',\r\n    },\r\n    title: [\r\n      {\r\n        margin: 0,\r\n        fontWeight: FontWeights.bold,\r\n      },\r\n    ],\r\n    inner: {\r\n      height: '100%',\r\n      padding: '0 24px 20px',\r\n    },\r\n    actions: {\r\n      position: 'relative',\r\n      marginTop: 20,\r\n      width: '100%',\r\n      whiteSpace: 'nowrap',\r\n    },\r\n    buttons: {\r\n      display: 'flex',\r\n      justifyContent: 'flex-end',\r\n      padding: '0 24px 24px',\r\n    },\r\n    subtext: [\r\n      {\r\n        margin: 0,\r\n        fontWeight: FontWeights.semilight,\r\n      },\r\n    ],\r\n  });\r\n\r\n\r\n\r\n\r\n\r\n\r\n  const chevronClass = mergeStyles({\r\n    alignSelf: 'center',\r\n    marginLeft: \"auto\",\r\n    marginRight: \"auto\",\r\n    /*  marginRight: 5, */\r\n    marginTop: \"0 !important\",\r\n    /* color: palette.neutralTertiary, */\r\n    fontSize: 16,\r\n    flexShrink: 0,\r\n    cursor: \"pointer\",\r\n    /* selectors: {\r\n      '&:hover': { \"transition\": \"all .2s ease-in-out\", transform: \"scale(1.1)\" },\r\n    }, */\r\n\r\n  });\r\n\r\n\r\n\r\n  const chevronIconDiv = mergeStyles({\r\n    /* fontSize: 50, */\r\n    height: 30,\r\n    width: 30,\r\n    lineHeight: 30,\r\n    textAlign: \"center\",\r\n    /* marginLeft: \"auto !important\",\r\n    marginRight: 15, */\r\n    marginTop: \"0px !important\",\r\n    marginBottom: \"0px !important\",\r\n    /* padding: \"5px\", */\r\n    selectors: {\r\n      '&:hover': { backgroundColor: \"rgb(0 13 255 / 14%)\", borderRadius: 30, \"transition\": \"all .2s ease-in-out\", transform: \"scale(1.2)\" },\r\n    },\r\n\r\n  });\r\n\r\n  const chevronDiv = mergeStyles({\r\n\r\n    marginTop: \"0px !important\",\r\n    marginRight: 5,\r\n    marginLeft: \"auto !important\",\r\n  });\r\n\r\n  const boldStyle = { root: { fontWeight: FontWeights.semibold } };\r\n  const propertyHeadingStyles = { alignSelf: \"start\", fontSize: \"18px\", paddingLeft: 5, paddingBottom: 2 }\r\n\r\n  const checkboxStyles: Partial<ICheckboxStyles> = { root: { marginTop: 5, marginRight: 30, marginLeft: \"auto\", width: \"fit-content\" }, label: { marginLeft: 4 } };\r\n\r\n  const theme = getTheme();\r\n\r\n\r\n\r\n  const menuProps: IContextualMenuProps = {\r\n    items: [\r\n      {\r\n        key: 'Delete Property List',\r\n        text: 'Delete Property List',\r\n        iconProps: { iconName: 'Delete' },\r\n        onClick: toggleIsDeleteCalloutVisible\r\n      },\r\n      {\r\n        key: 'Edit Property List',\r\n        text: 'Edit Property List',\r\n        iconProps: { iconName: 'Edit' },\r\n        onClick: toggleIsEditCalloutVisible\r\n      },\r\n      /* {\r\n        key: 'Add Contact',\r\n        text: 'Add Contact',\r\n        iconProps: { iconName: 'Add' },\r\n        onClick: toggleIsAddContactCalloutVisible\r\n      }, */\r\n    ],\r\n    directionalHintFixed: false,\r\n    styles: { container: { width: 175 } }\r\n  };\r\n\r\n  const iconButtonStyles = {\r\n    root: {\r\n      color: theme.palette.neutralPrimary,\r\n      /* marginLeft: 5, */\r\n      marginTop: '0px !important',\r\n      /* marginRight: 5, */\r\n      /*  width: 35,\r\n       height: 35, */\r\n      /*  visibility: isChecked() ? \"visible\" : \"hidden\", */\r\n\r\n    },\r\n    rootHovered: {\r\n      color: theme.palette.neutralDark,\r\n      backgroundColor: \"rgb(3 122 212 / 16%);\",\r\n      /* borderRadius: 30, */\r\n      \"transition\": \"all .2s ease-in-out\", transform: \"scale(1.1)\"\r\n\r\n    },\r\n    icon: {\r\n      fontSize: \"20px\",\r\n      marginLeft: 2\r\n\r\n    }\r\n  };\r\n\r\n\r\n  const menuIcon: IIconProps = { iconName: 'SingleColumnEdit' };\r\n\r\n  const textFieldStyles: Partial<ITextFieldStyles> = { fieldGroup: { width: 200 } };\r\n  const textFieldContactStyles: Partial<ITextFieldStyles> = { fieldGroup: { width: 250 } };\r\n\r\n  const onChangeEnquiryName = React.useCallback(\r\n    (event: React.FormEvent<HTMLInputElement | HTMLTextAreaElement>, newValue?: string) => {\r\n      setEditPropertyList({ ...editPropertyList, enquiryName: newValue! });\r\n    },\r\n    [setEditPropertyList],\r\n  );\r\n\r\n  /* const onChangeContactName = React.useCallback(\r\n    (event: React.FormEvent<HTMLInputElement | HTMLTextAreaElement>, newValue?: string) => {\r\n      setAddContact({ ...addContact, name: newValue! });\r\n    },\r\n    [addContact],\r\n  );\r\n\r\n  const onChangeContactEmail = React.useCallback(\r\n    (event: React.FormEvent<HTMLInputElement | HTMLTextAreaElement>, newValue?: string) => {\r\n      setAddContact({ ...addContact, email: newValue! });\r\n    },\r\n    [addContact],\r\n  );\r\n\r\n  const onChangeContactMobileNo = React.useCallback(\r\n    (event: React.FormEvent<HTMLInputElement | HTMLTextAreaElement>, newValue?: string) => {\r\n      setAddContact({ ...addContact, mobileNo: newValue! });\r\n    },\r\n    [addContact],\r\n  );\r\n\r\n  const onChangeContactOfficeNo = React.useCallback(\r\n    (event: React.FormEvent<HTMLInputElement | HTMLTextAreaElement>, newValue?: string) => {\r\n      setAddContact({ ...addContact, officeNo: newValue! });\r\n    },\r\n    [addContact],\r\n  ); */\r\n\r\n\r\n  const handleSetSelectedProperties = React.useCallback( () => {\r\n\r\n    selectedPropertyListVar(propertyList.properties)\r\n    pdfVariables({...pdfVariables(),\r\n      enquiryName: editPropertyList.enquiryName!,\r\n      \r\n    })\r\n    /* pdfVariables({...pdfVariables(),\r\n      \r\n      customTitle: editPropertyList.customTitle!,\r\n    }) */\r\n\r\n  },[editPropertyList.enquiryName, propertyList.properties, editPropertyList.customTitle ])\r\n\r\n  const [isCurrentListChecked, setIsCurrentListChecked] = React.useState(false);\r\n\r\n  const onChangeSetCurrentListToggle = React.useCallback((ev?: React.FormEvent<HTMLInputElement | HTMLElement> | undefined, checked?: boolean | undefined) => {\r\n    if (isCurrentListChecked) {\r\n      setIsCurrentListChecked(false)\r\n      setEditPropertyList({ ...editPropertyList, propertyIdList: propertyList.properties?.map((property) => { return property.propertyId }) })\r\n    } else {\r\n      setIsCurrentListChecked(true)\r\n      setEditPropertyList({ ...editPropertyList, propertyIdList: propertyIdList })\r\n    }\r\n\r\n\r\n  }, [editPropertyList, propertyIdList, isCurrentListChecked, setIsCurrentListChecked, propertyList.properties])\r\n\r\n  const [isCurrentDateChecked, setIsCurrentDateChecked] = React.useState(false);\r\n\r\n  const onChangeSetCurrentDateToggle = React.useCallback((ev?: React.FormEvent<HTMLInputElement | HTMLElement> | undefined, checked?: boolean | undefined) => {\r\n    if (isCurrentDateChecked) {\r\n      setIsCurrentDateChecked(false)\r\n      setEditPropertyList({ ...editPropertyList, enquiryDate: propertyList.enquiryDate })\r\n    } else {\r\n      setIsCurrentDateChecked(true)\r\n      setEditPropertyList({ ...editPropertyList, enquiryDate: new Date() })\r\n    }\r\n\r\n\r\n  }, [editPropertyList, isCurrentDateChecked, setIsCurrentDateChecked, propertyList.enquiryDate])\r\n\r\n  const getPropertyListDate = () => {\r\n\r\n\r\n    var date: Date = new Date()\r\n\r\n    if (propertyList.enquiryDate !== undefined) {\r\n      date = new Date(propertyList.enquiryDate)\r\n    }\r\n    return date.toLocaleDateString(\r\n      'en-gb',\r\n      {\r\n        year: 'numeric',\r\n        month: 'long',\r\n        day: 'numeric'\r\n      }\r\n    );\r\n  }\r\n\r\n\r\n\r\n  const [height, setHeight] = React.useState<number>()\r\nconsole.log(height)\r\n\r\n  const heightRef = React.useCallback((heightRef) => {\r\n\r\n    setHeight(heightRef?.getBoundingClientRect().bottom - heightRef?.getBoundingClientRect().top -100);\r\n  }, []);\r\n\r\n\r\n\r\n  return (\r\n\r\n    <Stack styles={{ root: { marginTop: 20 } }} verticalFill>\r\n\r\n      <Stack\r\n        horizontalAlign=\"start\"\r\n        verticalAlign=\"start\"\r\n        id=\"card\"\r\n\r\n        styles={{\r\n          root: {\r\n            /* width: 580, */\r\n            marginBottom: 10,\r\n            marginTop: 10,\r\n            padding: '5px',\r\n            textAlign: 'center',\r\n            color: '#605e5c',\r\n            alignItems: \"center\",\r\n            display: \"flex\",\r\n            flexFlow: \"row\",\r\n            /*  borderTop: \"4px solid #2557a2;\",\r\n             borderBottom: \"4px solid #2557a2;\", */\r\n            backgroundColor: \"white\",\r\n            background: /* isChecked() ? \"rgb(104 113 140 / 14%)\" : */ \"white\",\r\n            boxShadow: \"-1px 1px 7px 2px #d4cece\",\r\n            selectors: {\r\n              '&:hover': { background: /* palette.neutralLight */  \"rgb(104 113 140 / 14%)\" },\r\n            },\r\n\r\n          }\r\n        }}\r\n        gap={15}>\r\n\r\n        <div className={chevronIconDiv} onClick={handleSetSelectedProperties}><Icon className={chevronClass} iconName={'ChevronLeft'} /></div>\r\n\r\n        <IconButton\r\n          styles={iconButtonStyles}\r\n          id={`comboButton${propertyList.propertyListId}`}\r\n          menuProps={menuProps}\r\n          iconProps={menuIcon}\r\n          ariaLabel=\"Combo Button\"\r\n        />\r\n\r\n        <Stack styles={{ root: { paddingTop: 0, marginTop: \"0 !important\", marginBottom: \"auto\" } }} verticalFill>\r\n          <Text styles={boldStyle} style={propertyHeadingStyles}>{propertyList.enquiryName} </Text>\r\n          <Text style={{ paddingLeft: 5 }}>{getPropertyListDate()}</Text>\r\n\r\n\r\n        </Stack>\r\n\r\n\r\n        {isDeleteCalloutVisible ? (\r\n          <div>\r\n            <FocusTrapCallout\r\n              role=\"alertdialog\"\r\n              className={styles.callout}\r\n              gapSpace={0}\r\n              target={`#comboButton${propertyList.propertyListId}`}\r\n              onDismiss={toggleIsDeleteCalloutVisible}\r\n              setInitialFocus\r\n            >\r\n              <div className={styles.header}>\r\n                <Text className={styles.title}>Delete List</Text>\r\n              </div>\r\n              <div className={styles.inner}>\r\n                <div>\r\n                  <Text className={styles.subtext}>\r\n                    Are you sure you want to delete this list?\r\n                </Text>\r\n                </div>\r\n              </div>\r\n              <FocusZone>\r\n                <Stack className={styles.buttons} gap={8} horizontal>\r\n                  <PrimaryButton onClick={deletePropertyListButton}>Confirm</PrimaryButton>\r\n                  <DefaultButton onClick={toggleIsDeleteCalloutVisible}>Cancel</DefaultButton>\r\n                </Stack>\r\n              </FocusZone>\r\n            </FocusTrapCallout>\r\n          </div>\r\n        ) : null}\r\n\r\n        {isEditCalloutVisible ? (\r\n          <div>\r\n            <FocusTrapCallout\r\n              role=\"alertdialog\"\r\n              className={styles.callout}\r\n              gapSpace={0}\r\n              target={`#comboButton${propertyList.propertyListId}`}\r\n              onDismiss={toggleIsEditCalloutVisible}\r\n              setInitialFocus\r\n            >\r\n              <div className={styles.header}>\r\n                <Text className={styles.title}>Edit List</Text>\r\n              </div>\r\n              <div className={styles.inner}>\r\n                <div>\r\n\r\n                  <TextField\r\n                    styles={textFieldStyles}\r\n                    label=\"Enquiry Name\"\r\n\r\n                    value={editPropertyList.enquiryName}\r\n                    onChange={onChangeEnquiryName}></TextField>\r\n                  <Checkbox boxSide=\"end\" styles={checkboxStyles} label=\"Set Current List?\" checked={isCurrentListChecked} onChange={onChangeSetCurrentListToggle} />\r\n                  <Checkbox boxSide=\"end\" styles={checkboxStyles} label=\"Set Current Date?\" checked={isCurrentDateChecked} onChange={onChangeSetCurrentDateToggle} />\r\n                </div>\r\n              </div>\r\n              <FocusZone>\r\n                <Stack className={styles.buttons} gap={8} horizontal>\r\n                  <PrimaryButton onClick={updatePropertyListButton}>Confirm</PrimaryButton>\r\n                  <DefaultButton onClick={toggleIsEditCalloutVisible}>Cancel</DefaultButton>\r\n                </Stack>\r\n              </FocusZone>\r\n            </FocusTrapCallout>\r\n          </div>\r\n        ) : null}\r\n\r\n        {/* {isAddContactCalloutVisible ? (\r\n          <div>\r\n            <FocusTrapCallout\r\n              role=\"alertdialog\"\r\n              className={styles.callout}\r\n              gapSpace={0}\r\n              target={`#comboButton${landlord.landlordId}`}\r\n              onDismiss={toggleIsAddContactCalloutVisible}\r\n              setInitialFocus\r\n            >\r\n              <div className={styles.header}>\r\n                <Text className={styles.title}>Add Contact</Text>\r\n              </div>\r\n              <div className={styles.inner}>\r\n                <div>\r\n\r\n                  <TextField\r\n                    styles={textFieldContactStyles}\r\n                    label=\"Name\"\r\n                    value={addContact.name}\r\n                    onChange={onChangeContactName}>\r\n                  </TextField>\r\n                  <TextField\r\n                    styles={textFieldContactStyles}\r\n                    label=\"Email\"\r\n                    value={addContact.email}\r\n                    onChange={onChangeContactEmail}>\r\n                  </TextField>\r\n                  <TextField\r\n                    styles={textFieldContactStyles}\r\n                    label=\"Mobile No\"\r\n                    value={addContact.mobileNo}\r\n                    onChange={onChangeContactMobileNo}>\r\n                  </TextField>\r\n                  <TextField\r\n                    styles={textFieldContactStyles}\r\n                    label=\"Office No\"\r\n                    value={addContact.officeNo}\r\n                    onChange={onChangeContactOfficeNo}>\r\n                  </TextField>\r\n                </div>\r\n              </div>\r\n              <FocusZone>\r\n                <Stack className={styles.buttons} gap={8} horizontal>\r\n                  <PrimaryButton onClick={saveNewContactButton}>Confirm</PrimaryButton>\r\n                  <DefaultButton onClick={toggleIsAddContactCalloutVisible}>Cancel</DefaultButton>\r\n                </Stack>\r\n              </FocusZone>\r\n            </FocusTrapCallout>\r\n          </div>\r\n        ) : null} */}\r\n\r\n        <motion.section\r\n          className={chevronDiv}\r\n          /*  key=\"chevron\"\r\n           initial=\"collapsed\" */\r\n          animate={isOpen ? \"open\" : \"collapsed\"}\r\n          /*  exit=\"collapsed\" */\r\n          variants={{\r\n            open: { transform: \"rotate(270deg)\" },\r\n            collapsed: { transform: \"rotate(90deg)\" }\r\n          }}\r\n          transition={{ duration: 0.4, ease: [0.04, 0.62, 0.23, 0.98] }}\r\n        >\r\n\r\n          <div className={chevronIconDiv} onClick={() => handleExpand(propertyList.propertyListId)}><Icon className={chevronClass} iconName={'ChevronRight'} /></div>\r\n\r\n        </motion.section>\r\n\r\n\r\n\r\n\r\n      </Stack>\r\n\r\n\r\n      <AnimatePresence initial={false}>\r\n        {isOpen && (\r\n          <motion.section\r\n            key=\"content\"\r\n            initial=\"collapsed\"\r\n            animate=\"open\"\r\n            exit=\"collapsed\"\r\n            variants={{\r\n              open: { opacity: 1, height: \"auto\" },\r\n              collapsed: { opacity: 0, height: 0 }\r\n            }}\r\n            transition={{ duration: 0.4, ease: [0.04, 0.62, 0.23, 0.98] }}\r\n          >\r\n            <div ref={heightRef} >\r\n              <Stack verticalFill styles={{\r\n                root: {\r\n                  /* width: 580, */\r\n                  display: \"flex\",\r\n                  maxHeight: height,\r\n                  overflowY: \"auto\"\r\n                  /*  flexFlow: \"row wrap\" */\r\n\r\n                }\r\n              }} >\r\n\r\n                {sortedPropertyList?.map((property) => {\r\n                  return (\r\n\r\n                    <Stack styles={{ root: { marginLeft: 20, marginTop: \"10px !important\", alignItems: \"center\" } }} horizontal>\r\n\r\n                      <Text styles={boldStyle} style={propertyHeadingStyles}>{property.propertyName} </Text>\r\n\r\n                      {/* <IconButton\r\n                        styles={deleteIconStyles}\r\n                        iconProps={deleteIcon}\r\n                        ariaLabel=\"Remove Property\"\r\n                        onClick={() => handleRemoveProperty(property.propertyId)}\r\n                    /> */}\r\n\r\n                    </Stack>\r\n\r\n\r\n                  )\r\n\r\n                })}\r\n\r\n              </Stack>\r\n            </div>\r\n          </motion.section>\r\n        )}\r\n      </AnimatePresence>\r\n\r\n    </Stack>\r\n\r\n\r\n\r\n  );\r\n};\r\n\r\nexport default SavedListItem","C:\\Users\\ruper\\Desktop\\Web\\Own Projects\\Property Stock App V2\\psafrontendv2\\src\\components\\LandlordListItem.tsx",["511","512","513","514"],"import * as React from 'react';\r\nimport { getTheme } from '@fluentui/react';\r\nimport { Icon } from 'office-ui-fabric-react/lib/Icon';\r\nimport { Query, Mutation, MutationDeleteLandlordArgs, MutationUpdateLandlordArgs, MutationPostLandlordContactArgs, Landlord } from \"../schematypes/schematypes\"\r\nimport { DELETE_LANDLORD, GET_LANDLORDS, UPDATE_LANDLORD, NEW_LANDLORD_CONTACT } from \"../gql/gql\"\r\nimport { useMutation, } from '@apollo/client';\r\nimport { mergeStyles } from 'office-ui-fabric-react/lib/Styling';\r\nimport {IContextualMenuProps, Stack, Text, FontWeights, IconButton, IIconProps, DefaultButton, FocusTrapCallout, FocusZone, PrimaryButton, mergeStyleSets, TextField, ITextFieldStyles } from 'office-ui-fabric-react';\r\nimport { useBoolean } from '@uifabric/react-hooks';\r\nimport { motion, AnimatePresence } from \"framer-motion\";\r\nimport ContactListItem from \"./ContactListItem\"\r\n\r\n\r\ninterface Props {\r\n  landlord: Landlord\r\n  key: any\r\n  expanded: number | false\r\n  setExpanded: React.Dispatch<React.SetStateAction<number | false>>\r\n}\r\n\r\nexport const LandlordListItem: React.FunctionComponent<Props> = ({ landlord, expanded, setExpanded }) => {\r\n\r\n  const [isOpen, setIsOpen] = React.useState(false)\r\n\r\n\r\n\r\n  React.useEffect(() => {\r\n\r\n    if (expanded === landlord.landlordId) {\r\n      setIsOpen(true)\r\n    } else { setIsOpen(false) }\r\n\r\n  }, [expanded, landlord.landlordId])\r\n\r\n  const [isDeleteCalloutVisible, { toggle: toggleIsDeleteCalloutVisible }] = useBoolean(false);\r\n  const [isEditCalloutVisible, { toggle: toggleIsEditCalloutVisible }] = useBoolean(false);\r\n  const [isAddContactCalloutVisible, { toggle: toggleIsAddContactCalloutVisible }] = useBoolean(false);\r\n\r\n  const [editLandlordName, setEditLandlordName] = React.useState(landlord.landlordName)\r\n\r\n  const [addContact, setAddContact] = React.useState({\r\n    name: \"\",\r\n    email: \"\",\r\n    mobileNo: \"\",\r\n    officeNo: \"\"\r\n  })\r\n\r\n  const handleExpand = (landlordId: number) => {\r\n    if (isOpen === false) {\r\n      setExpanded(landlordId)\r\n    } else { setExpanded(false) }\r\n\r\n\r\n\r\n  }\r\n\r\n  const [deleteLandlord, { data: deleteLandlordData }] = useMutation<Mutation, MutationDeleteLandlordArgs>(DELETE_LANDLORD);\r\n\r\n  const deleteLandlordButton = () => {\r\n\r\n    deleteLandlord({\r\n      variables: {\r\n        landlordId: landlord.landlordId\r\n      },\r\n      update(cache, { data }) {\r\n\r\n        if (!data) {\r\n          return null;\r\n        }\r\n\r\n        const getExistingLandlords = cache.readQuery<Query>({ query: GET_LANDLORDS });\r\n\r\n        const existingLandlords = getExistingLandlords ? getExistingLandlords.landlords : [];\r\n        const newLandlords = existingLandlords!.filter(t => {\r\n\r\n          return (t.landlordId !== landlord.landlordId)\r\n        });\r\n        if (existingLandlords)\r\n          cache.writeQuery<Query>({\r\n            query: GET_LANDLORDS,\r\n            data: { landlords: newLandlords }\r\n          });\r\n      }\r\n\r\n    })\r\n    toggleIsDeleteCalloutVisible()\r\n  }\r\n\r\n  const [updateLandlord, { data: updateLandlordData }] = useMutation<Mutation, MutationUpdateLandlordArgs>(UPDATE_LANDLORD);\r\n\r\n  const updateLandlordButton = () => {\r\n\r\n    updateLandlord({\r\n      variables: {\r\n        landlordId: landlord.landlordId,\r\n        landlordName: editLandlordName\r\n\r\n      },\r\n\r\n      update(cache, { data }) {\r\n\r\n        if (!data) {\r\n          return null;\r\n        }\r\n\r\n        const getExistingLandlords = cache.readQuery<Query>({ query: GET_LANDLORDS });\r\n\r\n        const existingLandlords = getExistingLandlords ? getExistingLandlords.landlords : [];\r\n        const updatedLandlord = data.updateLandlord!/* .returning[0] */;\r\n        const otherLandlords = existingLandlords!.filter(t => {\r\n          return t.landlordId !== landlord.landlordId\r\n        })\r\n        if (existingLandlords)\r\n          cache.writeQuery<Query>({\r\n            query: GET_LANDLORDS,\r\n            data: { landlords: [updatedLandlord, ...otherLandlords] }\r\n          });\r\n      }\r\n\r\n    })\r\n    setEditLandlordName(\"\")\r\n    toggleIsEditCalloutVisible()\r\n  }\r\n\r\n  const [postContact, { data }] = useMutation<Mutation, MutationPostLandlordContactArgs>(NEW_LANDLORD_CONTACT);\r\n\r\n  const saveNewContactButton = () => {\r\n\r\n    postContact({\r\n      variables: {\r\n        landlordId: landlord.landlordId,\r\n        name: addContact.name,\r\n        email: addContact.email,\r\n        mobileNo: addContact.mobileNo,\r\n        officeNo: addContact.officeNo,\r\n\r\n      },\r\n\r\n      update(cache, { data }) {\r\n\r\n        if (!data) {\r\n          return null;\r\n        }\r\n\r\n        const getExistingLandlords = cache.readQuery<Query>({ query: GET_LANDLORDS });\r\n        // Add the new todo to the cache\r\n        const existingLandlords = getExistingLandlords ? getExistingLandlords.landlords : [];\r\n        const selectedLandlord = existingLandlords!.find(t =>\r\n          t.landlordId === landlord.landlordId\r\n        )\r\n        const otherLandlords = existingLandlords!.filter(t => {\r\n          return t.landlordId !== landlord.landlordId\r\n        })\r\n        const existingContacts = selectedLandlord?.contactsList\r\n        const newContact = data.postLandlordContact!/* .returning[0] */;\r\n        const updatedLandlord = { landlordId: selectedLandlord!.landlordId, landlordName: selectedLandlord!.landlordName, contactsList: [...existingContacts!, newContact] }\r\n        if (existingLandlords)\r\n          cache.writeQuery<Query>({\r\n            query: GET_LANDLORDS,\r\n            data: { landlords: [updatedLandlord!, ...otherLandlords] }\r\n          });\r\n      }\r\n\r\n\r\n    })\r\n\r\n    setAddContact({\r\n      name: \"\",\r\n      email: \"\",\r\n      mobileNo: \"\",\r\n      officeNo: \"\"\r\n    })\r\n    toggleIsAddContactCalloutVisible()\r\n    setIsOpen(true)\r\n  }\r\n\r\n\r\n\r\n\r\n  const styles = mergeStyleSets({\r\n\r\n    callout: {\r\n      maxWidth: 400,\r\n    },\r\n    header: {\r\n      padding: '18px 24px 12px',\r\n    },\r\n    title: [\r\n      {\r\n        margin: 0,\r\n        fontWeight: FontWeights.bold,\r\n      },\r\n    ],\r\n    inner: {\r\n      height: '100%',\r\n      padding: '0 24px 20px',\r\n    },\r\n    actions: {\r\n      position: 'relative',\r\n      marginTop: 20,\r\n      width: '100%',\r\n      whiteSpace: 'nowrap',\r\n    },\r\n    buttons: {\r\n      display: 'flex',\r\n      justifyContent: 'flex-end',\r\n      padding: '0 24px 24px',\r\n    },\r\n    subtext: [\r\n      {\r\n        margin: 0,\r\n        fontWeight: FontWeights.semilight,\r\n      },\r\n    ],\r\n  });\r\n\r\n\r\n\r\n\r\n\r\n\r\n  const chevronClass = mergeStyles({\r\n    alignSelf: 'center',\r\n    marginLeft: 2,\r\n    /*  marginRight: 5, */\r\n    marginTop: \"0 !important\",\r\n    /* color: palette.neutralTertiary, */\r\n    fontSize: 20,\r\n    flexShrink: 0,\r\n    cursor: \"pointer\",\r\n    /* selectors: {\r\n      '&:hover': { \"transition\": \"all .2s ease-in-out\", transform: \"scale(1.1)\" },\r\n    }, */\r\n\r\n  });\r\n\r\n  \r\n\r\n  const chevronIconDiv = mergeStyles({\r\n    /* fontSize: 50, */\r\n    height: 40,\r\n    width: 40,\r\n    lineHeight: 40,\r\n    textAlign: \"center\",\r\n    /* marginLeft: \"auto !important\",\r\n    marginRight: 15, */\r\n    marginTop: \"0px !important\",\r\n    marginBottom: \"0px !important\",\r\n    /* padding: \"5px\", */\r\n    selectors: {\r\n      '&:hover': { backgroundColor: \"rgb(0 13 255 / 14%)\", borderRadius: 30, \"transition\": \"all .2s ease-in-out\", transform: \"scale(1.2)\" },\r\n    },\r\n\r\n  });\r\n\r\n  const chevronDiv = mergeStyles({\r\n\r\n    marginTop: \"0px !important\",\r\n    marginRight: 15,\r\n    marginLeft: \"auto !important\",\r\n  });\r\n\r\n  const boldStyle = { root: { fontWeight: FontWeights.semibold } };\r\n  const propertyHeadingStyles = { alignSelf: \"start\", fontSize: \"23px\", padding: 5, paddingLeft: \"25px\" }\r\n  \r\n  const theme = getTheme();\r\n \r\n  \r\n\r\n  const menuProps: IContextualMenuProps = {\r\n    items: [\r\n      {\r\n        key: 'Delete Landlord',\r\n        text: 'Delete Landlord',\r\n        iconProps: { iconName: 'Delete' },\r\n        onClick: toggleIsDeleteCalloutVisible\r\n      },\r\n      {\r\n        key: 'Edit Landlord',\r\n        text: 'Edit Landlord',\r\n        iconProps: { iconName: 'Edit' },\r\n        onClick: toggleIsEditCalloutVisible\r\n      },\r\n      {\r\n        key: 'Add Contact',\r\n        text: 'Add Contact',\r\n        iconProps: { iconName: 'Add' },\r\n        onClick: toggleIsAddContactCalloutVisible\r\n      },\r\n    ],\r\n    directionalHintFixed: false,\r\n    styles: {container: {width: 150}}\r\n  };\r\n\r\n  const iconButtonStyles = {\r\n    root: {\r\n      color: theme.palette.neutralPrimary,\r\n      marginLeft: 5,\r\n      marginTop: '0px !important',\r\n      marginRight: 5,\r\n      width: 35,\r\n      height: 35,\r\n      /*  visibility: isChecked() ? \"visible\" : \"hidden\", */\r\n\r\n    },\r\n    rootHovered: {\r\n      color: theme.palette.neutralDark,\r\n      backgroundColor: \"rgb(3 122 212 / 16%);\",\r\n      /* borderRadius: 30, */\r\n      \"transition\": \"all .2s ease-in-out\", transform: \"scale(1.1)\"\r\n\r\n    },\r\n    icon: {\r\n      fontSize: \"24px\",\r\n      marginLeft: 6\r\n\r\n    }\r\n  };\r\n\r\n  \r\n  const menuIcon: IIconProps = { iconName: 'SingleColumnEdit' };\r\n\r\n  const textFieldStyles: Partial<ITextFieldStyles> = { fieldGroup: { width: 300 } };\r\n  const textFieldContactStyles: Partial<ITextFieldStyles> = { fieldGroup: { width: 250 } };\r\n\r\n  const onChangeLandlordName = React.useCallback(\r\n    (event: React.FormEvent<HTMLInputElement | HTMLTextAreaElement>, newValue?: string) => {\r\n      setEditLandlordName(newValue!);\r\n    },\r\n    [editLandlordName],\r\n  );\r\n\r\n  const onChangeContactName = React.useCallback(\r\n    (event: React.FormEvent<HTMLInputElement | HTMLTextAreaElement>, newValue?: string) => {\r\n      setAddContact({ ...addContact, name: newValue! });\r\n    },\r\n    [addContact],\r\n  );\r\n\r\n  const onChangeContactEmail = React.useCallback(\r\n    (event: React.FormEvent<HTMLInputElement | HTMLTextAreaElement>, newValue?: string) => {\r\n      setAddContact({ ...addContact, email: newValue! });\r\n    },\r\n    [addContact],\r\n  );\r\n\r\n  const onChangeContactMobileNo = React.useCallback(\r\n    (event: React.FormEvent<HTMLInputElement | HTMLTextAreaElement>, newValue?: string) => {\r\n      setAddContact({ ...addContact, mobileNo: newValue! });\r\n    },\r\n    [addContact],\r\n  );\r\n\r\n  const onChangeContactOfficeNo = React.useCallback(\r\n    (event: React.FormEvent<HTMLInputElement | HTMLTextAreaElement>, newValue?: string) => {\r\n      setAddContact({ ...addContact, officeNo: newValue! });\r\n    },\r\n    [addContact],\r\n  );\r\n\r\n  return (\r\n\r\n    <Stack styles={{ root: { marginTop: 20 } }} verticalFill>\r\n\r\n      <Stack\r\n        horizontalAlign=\"start\"\r\n        verticalAlign=\"start\"\r\n        id=\"card\"\r\n\r\n        styles={{\r\n          root: {\r\n            width: 580,\r\n            marginBottom: 10,\r\n            marginTop: 10,\r\n            padding: '10px',\r\n            textAlign: 'center',\r\n            color: '#605e5c',\r\n            alignItems: \"center\",\r\n            display: \"flex\",\r\n            flexFlow: \"row\",\r\n            /*  borderTop: \"4px solid #2557a2;\",\r\n             borderBottom: \"4px solid #2557a2;\", */\r\n            backgroundColor: \"white\",\r\n            background: /* isChecked() ? \"rgb(104 113 140 / 14%)\" : */ \"white\",\r\n            boxShadow: \"-1px 1px 7px 2px #d4cece\",\r\n            selectors: {\r\n              '&:hover': { background: /* palette.neutralLight */  \"rgb(104 113 140 / 14%)\" },\r\n            },\r\n\r\n          }\r\n        }}\r\n        gap={15}>\r\n\r\n\r\n\r\n        <IconButton\r\n          styles={iconButtonStyles}\r\n          id={`comboButton${landlord.landlordId}`}\r\n          menuProps={menuProps}\r\n          iconProps={menuIcon}\r\n          ariaLabel=\"Combo Button\"\r\n        />\r\n\r\n        <Stack styles={{ root: { paddingTop: 0, marginTop: \"0 !important\", marginBottom: \"auto\" } }} verticalFill>\r\n          <Text styles={boldStyle} style={propertyHeadingStyles}>{landlord.landlordName}</Text>\r\n\r\n\r\n\r\n        </Stack>\r\n\r\n\r\n        {isDeleteCalloutVisible ? (\r\n          <div>\r\n            <FocusTrapCallout\r\n              role=\"alertdialog\"\r\n              className={styles.callout}\r\n              gapSpace={0}\r\n              target={`#comboButton${landlord.landlordId}`}\r\n              onDismiss={toggleIsDeleteCalloutVisible}\r\n              setInitialFocus\r\n            >\r\n              <div className={styles.header}>\r\n                <Text className={styles.title}>Delete Landlord</Text>\r\n              </div>\r\n              <div className={styles.inner}>\r\n                <div>\r\n                  <Text className={styles.subtext}>\r\n                    Are you sure you want to delete this landlord?\r\n                </Text>\r\n                </div>\r\n              </div>\r\n              <FocusZone>\r\n                <Stack className={styles.buttons} gap={8} horizontal>\r\n                  <PrimaryButton onClick={deleteLandlordButton}>Confirm</PrimaryButton>\r\n                  <DefaultButton onClick={toggleIsDeleteCalloutVisible}>Cancel</DefaultButton>\r\n                </Stack>\r\n              </FocusZone>\r\n            </FocusTrapCallout>\r\n          </div>\r\n        ) : null}\r\n       \r\n        {isEditCalloutVisible ? (\r\n          <div>\r\n            <FocusTrapCallout\r\n              role=\"alertdialog\"\r\n              className={styles.callout}\r\n              gapSpace={0}\r\n              target={`#comboButton${landlord.landlordId}`}\r\n              onDismiss={toggleIsEditCalloutVisible}\r\n              setInitialFocus\r\n            >\r\n              <div className={styles.header}>\r\n                <Text className={styles.title}>Edit Landlord</Text>\r\n              </div>\r\n              <div className={styles.inner}>\r\n                <div>\r\n\r\n                  <TextField\r\n                    styles={textFieldStyles}\r\n                    label=\"Landlord Name\"\r\n\r\n                    value={editLandlordName}\r\n                    onChange={onChangeLandlordName}></TextField>\r\n                </div>\r\n              </div>\r\n              <FocusZone>\r\n                <Stack className={styles.buttons} gap={8} horizontal>\r\n                  <PrimaryButton onClick={updateLandlordButton}>Confirm</PrimaryButton>\r\n                  <DefaultButton onClick={toggleIsEditCalloutVisible}>Cancel</DefaultButton>\r\n                </Stack>\r\n              </FocusZone>\r\n            </FocusTrapCallout>\r\n          </div>\r\n        ) : null}\r\n\r\n        {isAddContactCalloutVisible ? (\r\n          <div>\r\n            <FocusTrapCallout\r\n              role=\"alertdialog\"\r\n              className={styles.callout}\r\n              gapSpace={0}\r\n              target={`#comboButton${landlord.landlordId}`}\r\n              onDismiss={toggleIsAddContactCalloutVisible}\r\n              setInitialFocus\r\n            >\r\n              <div className={styles.header}>\r\n                <Text className={styles.title}>Add Contact</Text>\r\n              </div>\r\n              <div className={styles.inner}>\r\n                <div>\r\n\r\n                  <TextField\r\n                    styles={textFieldContactStyles}\r\n                    label=\"Name\"\r\n                    value={addContact.name}\r\n                    onChange={onChangeContactName}>\r\n                  </TextField>\r\n                  <TextField\r\n                    styles={textFieldContactStyles}\r\n                    label=\"Email\"\r\n                    value={addContact.email}\r\n                    onChange={onChangeContactEmail}>\r\n                  </TextField>\r\n                  <TextField\r\n                    styles={textFieldContactStyles}\r\n                    label=\"Mobile No\"\r\n                    value={addContact.mobileNo}\r\n                    onChange={onChangeContactMobileNo}>\r\n                  </TextField>\r\n                  <TextField\r\n                    styles={textFieldContactStyles}\r\n                    label=\"Office No\"\r\n                    value={addContact.officeNo}\r\n                    onChange={onChangeContactOfficeNo}>\r\n                  </TextField>\r\n                </div>\r\n              </div>\r\n              <FocusZone>\r\n                <Stack className={styles.buttons} gap={8} horizontal>\r\n                  <PrimaryButton onClick={saveNewContactButton}>Confirm</PrimaryButton>\r\n                  <DefaultButton onClick={toggleIsAddContactCalloutVisible}>Cancel</DefaultButton>\r\n                </Stack>\r\n              </FocusZone>\r\n            </FocusTrapCallout>\r\n          </div>\r\n        ) : null}\r\n\r\n        <motion.section\r\n          className={chevronDiv}\r\n          /*  key=\"chevron\"\r\n           initial=\"collapsed\" */\r\n          animate={isOpen ? \"open\" : \"collapsed\"}\r\n          /*  exit=\"collapsed\" */\r\n          variants={{\r\n            open: { transform: \"rotate(270deg)\" },\r\n            collapsed: { transform: \"rotate(90deg)\" }\r\n          }}\r\n          transition={{ duration: 0.4, ease: [0.04, 0.62, 0.23, 0.98] }}\r\n        >\r\n\r\n          <div className={chevronIconDiv} onClick={() => handleExpand(landlord.landlordId)}><Icon className={chevronClass} iconName={'ChevronRight'} /></div>\r\n\r\n        </motion.section>\r\n\r\n\r\n\r\n\r\n      </Stack>\r\n\r\n\r\n      <AnimatePresence initial={false}>\r\n        {isOpen && (\r\n          <motion.section\r\n            key=\"content\"\r\n            initial=\"collapsed\"\r\n            animate=\"open\"\r\n            exit=\"collapsed\"\r\n            variants={{\r\n              open: { opacity: 1, height: \"auto\" },\r\n              collapsed: { opacity: 0, height: 0 }\r\n            }}\r\n            transition={{ duration: 0.4, ease: [0.04, 0.62, 0.23, 0.98] }}\r\n          >\r\n            <Stack horizontal styles={{\r\n              root: {\r\n                width: 580,\r\n                display: \"flex\",\r\n                flexFlow: \"row wrap\"\r\n\r\n              }\r\n            }} >\r\n\r\n              {landlord.contactsList?.map((contact) => {\r\n                return <ContactListItem landlordId={landlord.landlordId} contact={contact} key={contact.contactId}></ContactListItem>\r\n\r\n              })}\r\n\r\n            </Stack>\r\n          </motion.section>\r\n        )}\r\n      </AnimatePresence>\r\n\r\n    </Stack>\r\n\r\n\r\n\r\n  );\r\n};\r\n\r\nexport default LandlordListItem","C:\\Users\\ruper\\Desktop\\Web\\Own Projects\\Property Stock App V2\\psafrontendv2\\src\\components\\PDFOutput\\PropertyListLargeImagesPDF.tsx",["515","516","517","518","519","520","521","522","523","524","525","526","527"],"import React from 'react';\r\nimport { Page, Text, View, Document, StyleSheet, Image } from '@react-pdf/renderer';\r\n\r\nimport { Font } from '@react-pdf/renderer'\r\nimport SegoeUI from \"../../assets/fonts/SegoeUI.ttf\"\r\nimport SegoeUIBold from \"../../assets/fonts/SegoeUIBold.ttf\"\r\n\r\nimport { GET_SELECTED_PROPERTIES, GET_NAV_STATE, GET_DISTINCT_SUBURBS, GET_DISTINCT_REGIONS, UPDATE_IMAGES } from \"../../gql/gql\"\r\nimport { useMutation, useQuery } from '@apollo/client';\r\nimport { Mutation, MutationUpdatePropertyArgs, Query, NavigationState, Premises, SelectedPropertyList, Property, Agent } from \"../../schematypes/schematypes\"\r\nimport { navigationState as navigationStateVar, selectedPropertyList as selectedPropertyListVar } from \"../../reactivevariables/reactivevariables\"\r\nimport { Cloudinary } from \"cloudinary-core\"\r\n\r\n\r\n\r\nvar cl = new Cloudinary({ cloud_name: \"drlfedqyz\", secure: true });\r\n\r\n\r\nconst styles = StyleSheet.create({\r\n    page: {\r\n        flexDirection: 'column',\r\n        backgroundColor: 'white',\r\n        /* borderStyle: \"solid\",\r\n        borderWidth: 2, */\r\n        /* margin: \"10px\" */\r\n\r\n    },\r\n    frontPage: {\r\n        flexDirection: 'column',\r\n        backgroundColor: '#20314b',\r\n        /* borderStyle: \"solid\",\r\n        borderWidth: 2, */\r\n        /* margin: \"10px\" */\r\n\r\n    },\r\n    contactPage: {\r\n        flexDirection: 'column',\r\n        backgroundColor: 'white',\r\n        /* borderStyle: \"solid\",\r\n        borderWidth: 2, */\r\n        /* margin: \"10px\" */\r\n\r\n    },\r\n    overallContainer: {\r\n        fontFamily: 'SegoeUI',\r\n        display: \"flex\",\r\n        flexDirection: \"column\",\r\n        width: \"100%\",\r\n\r\n    },\r\n\r\n    initialPageContainer: {\r\n        fontFamily: 'SegoeUI',\r\n        display: \"flex\",\r\n        flexDirection: \"row\",\r\n        /*  margin: 5, */\r\n        marginLeft: \"auto\",\r\n        marginRight: \"auto\",\r\n        width: \"100%\",\r\n    },\r\n    primaryImageContainer: {\r\n        display: \"flex\",\r\n        flexDirection: \"row\",\r\n        /*  marginLeft: 20, */\r\n        marginRight: 0,\r\n        marginLeft: 20,\r\n        marginTop: 0,\r\n        marginBottom: \"auto\",\r\n    },\r\n    primaryImage: {\r\n        width: 600,\r\n        height: 400,\r\n        marginTop: 30,\r\n        marginBottom: \"auto\"\r\n    },\r\n    premisesDetailsContainer: {\r\n        display: \"flex\",\r\n        flexDirection: \"column\",\r\n        marginTop: 30,\r\n        marginBottom: \"auto\",\r\n        marginLeft: 20\r\n        /*  height: 500 */\r\n        /* width: 120 */\r\n    },\r\n    propertyNumberColumn: {\r\n        display: \"flex\",\r\n        flexDirection: \"row\",\r\n\r\n        /*  marginTop: 0,\r\n         marginBottom: \"auto\", */\r\n        /*  marginLeft: 10,\r\n         paddingTop: 4, */\r\n        /* width: \"10%\", */\r\n        /* borderStyle: \"solid\",\r\n        borderWidth: 1, */\r\n        /*    flexGrow: 1, */\r\n    },\r\n    secondaryPageContainer: {\r\n        fontFamily: 'SegoeUI',\r\n        display: \"flex\",\r\n        flexDirection: \"row\",\r\n        margin: 5,\r\n        marginLeft: \"auto\",\r\n        marginRight: \"auto\",\r\n        width: \"100%\",\r\n    },\r\n    secondaryImageContainers: {\r\n        display: \"flex\",\r\n        flexDirection: \"row\",\r\n        /*  marginLeft: 20, */\r\n        marginRight: \"auto\",\r\n        marginLeft: \"auto\",\r\n        marginTop: \"auto\",\r\n        marginBottom: \"auto\",\r\n    },\r\n    secondaryImage: {\r\n        width: 660,\r\n        height: 440,\r\n        marginTop: 13,\r\n        marginBottom: \"auto\"\r\n    },\r\n    /*  detailsSection: {\r\n         fontFamily: 'SegoeUI',\r\n         display: \"flex\",\r\n         flexDirection: \"row\",\r\n         margin: 5,\r\n         marginLeft: \"auto\",\r\n         marginRight: \"auto\",\r\n \r\n \r\n         width: \"100%\",\r\n         \r\n     }, */\r\n    premisesInfo: {\r\n        fontFamily: 'SegoeUI',\r\n        display: \"flex\",\r\n        flexDirection: \"row\",\r\n        marginTop: 10,\r\n        marginLeft: 5,\r\n        marginRight: 0,\r\n        alignItems: \"flex-start\",\r\n        width: 175\r\n    },\r\n    premisesInfoHeadings: {\r\n\r\n        fontSize: 12,\r\n        fontFamily: \"SegoeUI\",\r\n        fontWeight: \"bold\",\r\n        color: \"black\",\r\n\r\n    },\r\n    premisesInfoText: {\r\n        marginLeft: 5,\r\n        fontSize: 10,\r\n        fontFamily: \"SegoeUI\",\r\n        color: \"black\",\r\n        paddingTop: 2\r\n\r\n    },\r\n    imagesSection: {\r\n        fontFamily: 'SegoeUI',\r\n        display: \"flex\",\r\n        flexDirection: \"row\",\r\n        margin: 5,\r\n        marginLeft: \"auto\",\r\n        marginRight: \"auto\",\r\n        paddingLeft: 80,\r\n\r\n        width: \"100%\",\r\n\r\n        /*  borderStyle: \"solid\",\r\n         borderWidth: 1, */\r\n        /*    flexGrow: 1, */\r\n    },\r\n    footerSection: {\r\n        display: \"flex\",\r\n        flexDirection: \"row\",\r\n        marginTop: \"auto\",\r\n        marginBottom: 0\r\n\r\n    },\r\n    headerText: {\r\n        margin: \"auto\",\r\n        fontSize: 20,\r\n        fontFamily: \"SegoeUI\",\r\n\r\n        color: \"white\",\r\n\r\n    },\r\n    footerImageSection: {\r\n        display: \"flex\",\r\n        flexDirection: \"row\",\r\n        \"backgroundColor\": '#1f304a',\r\n        width: \"100vw\",\r\n        height: \"65px\",\r\n\r\n\r\n    },\r\n    frontPageSection: {\r\n        /*  display: \"flex\",\r\n         flexDirection: \"row\", */\r\n        \"backgroundColor\": '#20314b',\r\n        /* width: \"100vw\",\r\n        height: \"auto\", */\r\n    },\r\n    frontPageBackground: {\r\n        /*  display: \"flex\",\r\n         flexDirection: \"row\", */\r\n        /*  \"backgroundColor\": '#20314b', */\r\n\r\n        position: \"absolute\",\r\n        top: 0,\r\n        left: 0,\r\n        width: '100vw',\r\n        height: 'auto',\r\n\r\n        /*  marginTop: \"auto\",\r\n         marginBottom: \"auto\", */\r\n        /* \"backgroundColor\": '#20314b', */\r\n\r\n\r\n    },\r\n    contactPageBackground: {\r\n        /*  display: \"flex\",\r\n         flexDirection: \"row\", */\r\n        /*  \"backgroundColor\": '#20314b', */\r\n\r\n        position: \"absolute\",\r\n        top: 88,\r\n        left: 0,\r\n        width: 245.7,\r\n        height: 441,\r\n\r\n        /*  marginTop: \"auto\",\r\n         marginBottom: \"auto\", */\r\n        /* \"backgroundColor\": '#20314b', */\r\n\r\n\r\n    },\r\n    frontPageText1: {\r\n        fontSize: 30,\r\n        fontFamily: \"SegoeUI\",\r\n        fontWeight: \"bold\",\r\n        color: \"white\",\r\n\r\n        marginLeft: \"40%\",\r\n        marginRight: \"auto\",\r\n        marginTop: \"20%\",\r\n    },\r\n    frontPageText2: {\r\n        fontSize: 30,\r\n        fontFamily: \"SegoeUI\",\r\n        fontWeight: \"bold\",\r\n        color: \"white\",\r\n        marginLeft: \"40%\",\r\n        marginRight: \"auto\",\r\n        marginTop: 10\r\n    },\r\n    contactPageText1: {\r\n        fontSize: 18,\r\n        fontFamily: \"SegoeUI\",\r\n        /* fontWeight: \"bold\", */\r\n        color: \"black\",\r\n\r\n        marginLeft: \"40%\",\r\n        marginRight: \"auto\",\r\n        marginTop: \"15%\",\r\n        marginBottom: 10\r\n    },\r\n    contactPageText2: {\r\n        fontSize: 24,\r\n        fontFamily: \"SegoeUI\",\r\n        fontWeight: \"bold\",\r\n        color: \"black\",\r\n        marginLeft: \"40%\",\r\n        marginRight: \"auto\",\r\n        marginTop: 10\r\n    },\r\n    contactPageText3: {\r\n        fontSize: 12,\r\n        fontFamily: \"SegoeUI\",\r\n        /* fontWeight: \"bold\", */\r\n        color: \"black\",\r\n        marginLeft: \"30%\",\r\n        marginRight: \"10%\",\r\n        marginBottom: 10,\r\n        marginTop: 100\r\n    },\r\n    headerSection: {\r\n        /* position: 'absolute',\r\n        bottom: 0,\r\n        left: 0, */\r\n        display: \"flex\",\r\n        flexDirection: \"row\",\r\n        \"backgroundColor\": '#20314b',\r\n        width: \"100vw\",\r\n        height: \"65px\",\r\n        marginTop: 0,\r\n        marginBottom: 0,\r\n        marginLeft: 0,\r\n    },\r\n    footerImageStyles: {\r\n        display: \"flex\",\r\n        flexDirection: \"row\",\r\n        marginLeft: \"auto\",\r\n        marginRight: \"auto\",\r\n\r\n    },\r\n    pageNumbers: {\r\n        position: \"absolute\",\r\n        top: 15,\r\n        right: 40,\r\n        fontSize: 10,\r\n        color: \"white\",\r\n    },\r\n    enquiryHeading: {\r\n        fontFamily: 'SegoeUI',\r\n        margin: 10,\r\n        marginLeft: 40,\r\n        padding: 10,\r\n    },\r\n    propertyHeading: {\r\n        fontSize: 12,\r\n        fontFamily: \"SegoeUI\",\r\n        fontWeight: \"bold\",\r\n        color: \"black\",\r\n        /*  width: 125, */\r\n        /*  height: \"20px\", */\r\n        paddingLeft: 10,\r\n        paddingRight: 10,\r\n        paddingTop: 1.5,\r\n        /* marginTop: \"auto\",\r\n        marginBottom: \"auto\",\r\n        marginLeft: \"auto\",\r\n        marginRight: 'auto',\r\n        textAlign: 'center', */\r\n    },\r\n    propertyText: {\r\n        fontSize: 10,\r\n        color: \"black\",\r\n        width: \"100%\",\r\n        /*  height: \"30px\", */\r\n        paddingLeft: 10,\r\n        /* paddingTop: 1.5, */\r\n    },\r\n    propertyNumber: {\r\n\r\n        fontSize: 12,\r\n        borderStyle: \"solid\",\r\n        height: 20,\r\n        width: 20,\r\n        borderWidth: 1,\r\n        borderRadius: 20,\r\n        paddingLeft: 6.95,\r\n        paddingTop: 1.35,\r\n        \"backgroundColor\": '#20314b',\r\n        color: \"white\",\r\n        fontFamily: \"SegoeUI\",\r\n        fontWeight: \"bold\",\r\n    },\r\n    propertyNumber10plus: {\r\n\r\n        fontSize: 10,\r\n        borderStyle: \"solid\",\r\n        height: 20,\r\n        width: 20,\r\n        borderWidth: 1,\r\n        borderRadius: 20,\r\n        paddingLeft: 4.75,\r\n        paddingTop: 2.15,\r\n        \"backgroundColor\": '#20314b',\r\n        color: \"white\",\r\n        fontFamily: \"SegoeUI\",\r\n        fontWeight: \"bold\",\r\n    },\r\n\r\n    propertyDetails: {\r\n        display: \"flex\",\r\n        flexDirection: \"column\",\r\n        flexWrap: \"wrap\",\r\n        width: 125,\r\n        marginBottom: 10,\r\n        marginTop: 5,\r\n        /* borderStyle: \"solid\",\r\n        borderWidth: 1, */\r\n        /*    flexGrow: 1, */\r\n    },\r\n\r\n    premisesDetailsHeading: {\r\n        marginLeft: \"auto\",\r\n        marginRight: \"auto\",\r\n        fontSize: 12,\r\n        fontFamily: \"SegoeUI\",\r\n        fontWeight: \"bold\",\r\n        color: \"black\",\r\n        marginTop: 10,\r\n        marginBottom: 5\r\n    },\r\n    parkingDetailsHeading: {\r\n        marginLeft: \"auto\",\r\n        marginRight: \"auto\",\r\n        fontSize: 12,\r\n        fontFamily: \"SegoeUI\",\r\n        fontWeight: \"bold\",\r\n        color: \"black\",\r\n        marginTop: 10,\r\n        marginBottom: 5\r\n    },\r\n\r\n\r\n\r\n    premisesHeadings: {\r\n        display: \"flex\",\r\n        flexDirection: \"row\",\r\n        flexWrap: \"wrap\",\r\n        /*  width: \"25%\", */\r\n        borderStyle: \"solid\",\r\n        borderWidth: 1,\r\n        /*    flexGrow: 1, */\r\n        \"backgroundColor\": '#20314b',\r\n    },\r\n    premisesDetails: {\r\n        display: \"flex\",\r\n        flexDirection: \"row\",\r\n        flexWrap: \"wrap\",\r\n        /*  width: \"25%\", */\r\n        /*  borderStyle: \"solid\",\r\n         borderWidth: 1, */\r\n        /*    flexGrow: 1, */\r\n    },\r\n    premisesContainer: {\r\n        /* width: \"20%\", */\r\n      /*   paddingLeft: 5,\r\n        paddingRight: 5, */\r\n        display: \"flex\",\r\n        flexDirection: \"column\",\r\n        /* borderBottomWidth: 1,\r\n        borderBottomStyle: \"solid\", */\r\n        /*  height: 35, */\r\n        /*  height: \"30px\", */\r\n    },\r\n    premisesHeadingText: {\r\n        fontSize: 10,\r\n        marginTop: \"auto\",\r\n        marginBottom: \"auto\",\r\n        textAlign: 'center',\r\n        color: \"white\",\r\n    },\r\n    premisesText: {\r\n        fontSize: 8,\r\n        marginTop: \"auto\",\r\n        marginBottom: \"auto\",\r\n        textAlign: 'center',\r\n\r\n    },\r\n    premisesHeadingSubText: {\r\n        fontSize: 6,\r\n        textAlign: 'center',\r\n        height: 10,\r\n        color: \"white\",\r\n    },\r\n    imagesContainer: {\r\n        display: \"flex\",\r\n        flexDirection: \"row\",\r\n        /*  marginLeft: 20, */\r\n        marginRight: 40,\r\n\r\n\r\n    },\r\n    /*  image: {\r\n         width: 200,\r\n \r\n \r\n     }, */\r\n\r\n\r\n});\r\n\r\nFont.registerHyphenationCallback(word => [word]);\r\n\r\n\r\nFont.register({\r\n    family: 'SegoeUI', fonts: [\r\n        { src: SegoeUI }, { src: SegoeUIBold, fontStyle: 'normal', fontWeight: \"bold\" },\r\n        /*  { src: source2, fontStyle: 'italic' },\r\n         { src: source3, fontStyle: 'italic', fontWeight: 700 }, */\r\n    ]\r\n});\r\n\r\nconst getParkingRowsLength = (premises: Premises[]) => {\r\n    var count = 0\r\n    if(premises.reduce((acc, premises) => {\r\n        return acc + premises.openRate!\r\n    }, 0) > 0 ) {\r\n        count += 1\r\n    }\r\n\r\n    if(premises.reduce((acc, premises) => {\r\n        return acc + premises.coveredRate!\r\n    }, 0) > 0 ) {\r\n        count += 1\r\n    }\r\n\r\n    if(premises.reduce((acc, premises) => {\r\n        return acc + premises.shadedRate!\r\n    }, 0) > 0 ) {\r\n        count += 1\r\n    }\r\n    return count\r\n}\r\n\r\nconst getParkingRowsOrder = (premises: Premises[], rowType: string) => {\r\n    var parking = {covered: false, shaded: false, open: false}\r\n    \r\n\r\n    if(premises.reduce((acc, premises) => {\r\n        return acc + premises.coveredRate!\r\n    }, 0) > 0 ) {\r\n        parking.covered = true\r\n    } else {parking.covered = false}\r\n\r\n    if(premises.reduce((acc, premises) => {\r\n        return acc + premises.shadedRate!\r\n    }, 0) > 0 ) {\r\n        parking.shaded = true\r\n    } else {parking.shaded = false}\r\n\r\n    if(premises.reduce((acc, premises) => {\r\n        return acc + premises.openRate!\r\n    }, 0) > 0 ) {\r\n        parking.open = true\r\n    } else {parking.open = false}\r\n\r\n    //true true true\r\n\r\n    if(parking.covered === true && parking.shaded === true && parking.open === true && rowType === \"covered\" )\r\n    return true\r\n\r\n    if(parking.covered === true && parking.shaded === true && parking.open === true && rowType === \"shaded\" )\r\n    return false\r\n\r\n    if(parking.covered === true && parking.shaded === true && parking.open === true && rowType === \"open\" )\r\n    return true\r\n\r\n    //false true true\r\n\r\n    if(parking.covered === false && parking.shaded === true && parking.open === true && rowType === \"covered\" )\r\n    return true\r\n\r\n    if(parking.covered === false && parking.shaded === true && parking.open === true && rowType === \"shaded\" )\r\n    return true\r\n\r\n    if(parking.covered === false && parking.shaded === true && parking.open === true && rowType === \"open\" )\r\n    return false\r\n\r\n    //false false true\r\n\r\n    if(parking.covered === false && parking.shaded === false && parking.open === true && rowType === \"covered\" )\r\n    return false\r\n\r\n    if(parking.covered === false && parking.shaded === false && parking.open === true && rowType === \"shaded\" )\r\n    return false\r\n\r\n    if(parking.covered === false && parking.shaded === false && parking.open === true && rowType === \"open\" )\r\n    return true\r\n\r\n    //true false true\r\n\r\n    if(parking.covered === true && parking.shaded === false && parking.open === true && rowType === \"covered\" )\r\n    return true\r\n\r\n    if(parking.covered === true && parking.shaded === false && parking.open === true && rowType === \"shaded\" )\r\n    return false\r\n\r\n    if(parking.covered === true && parking.shaded === false && parking.open === true && rowType === \"open\" )\r\n    return false\r\n\r\n    //true true false\r\n\r\n    if(parking.covered === true && parking.shaded === true && parking.open === false && rowType === \"covered\" )\r\n    return true\r\n\r\n    if(parking.covered === true && parking.shaded === true && parking.open === false && rowType === \"shaded\" )\r\n    return false\r\n\r\n    if(parking.covered === true && parking.shaded === true && parking.open === false && rowType === \"open\" )\r\n    return false\r\n\r\n    //false true false\r\n\r\n    if(parking.covered === false && parking.shaded === true && parking.open === false && rowType === \"covered\" )\r\n    return false\r\n\r\n    if(parking.covered === false && parking.shaded === true && parking.open === false && rowType === \"shaded\" )\r\n    return true\r\n\r\n    if(parking.covered === false && parking.shaded === true && parking.open === false && rowType === \"open\" )\r\n    return false\r\n\r\n    //true false false\r\n\r\n    if(parking.covered === true && parking.shaded === false && parking.open === false && rowType === \"covered\" )\r\n    return true\r\n\r\n    if(parking.covered === true && parking.shaded === false && parking.open === false && rowType === \"shaded\" )\r\n    return false\r\n\r\n    if(parking.covered === true && parking.shaded === false && parking.open === false && rowType === \"open\" )\r\n    return false\r\n\r\n\r\n}\r\n\r\n\r\nconst getEarliestOccDate = (premises: Premises[]) => {\r\n\r\n\r\n    var premisesByOccDates: Premises[] = []\r\n    var date: Date = new Date()\r\n    if (premises !== undefined) {\r\n        premisesByOccDates = premises.slice().sort((a, b) => {\r\n            return Date.parse(a.occupation) - Date.parse(b.occupation)\r\n        });\r\n    }\r\n\r\n    if (premisesByOccDates[0] !== undefined) {\r\n        date = new Date(premisesByOccDates[0].occupation)\r\n    }\r\n    return date.toLocaleDateString(\r\n        'en-gb',\r\n        {\r\n            year: 'numeric',\r\n            month: 'long',\r\n            day: 'numeric'\r\n        }\r\n    );\r\n}\r\n\r\nconst getLowestHighestEsc = (premises: Premises[]) => {\r\n\r\n\r\n    var premisesByEsc: Premises[] = []\r\n    var escPair: number[] = []\r\n    if (premises !== undefined) {\r\n        premisesByEsc = premises.slice().sort((a, b) => {\r\n            return a.esc! - b.esc!\r\n        });\r\n    }\r\n\r\n    if (premisesByEsc[0] !== undefined) {\r\n        escPair = [premisesByEsc[0].esc!, premisesByEsc[premisesByEsc.length - 1].esc!]\r\n    }\r\n    return escPair\r\n}\r\n\r\nconst getLowestHighestYard = (premises: Premises[]) => {\r\n    var filteredPremises: Premises[] = []\r\n    var premisesByYard: Premises[] = []\r\n    var yardPair: number[] = []\r\n    if (premises !== undefined) {\r\n\r\n        filteredPremises = premises.filter((premises)=> {\r\n            return premises.area !== 0 && premises.yard !== 0 \r\n        })\r\n\r\n        premisesByYard = filteredPremises.slice().sort((a, b) => {\r\n            return a.yard! - b.yard!\r\n        });\r\n    }\r\n\r\n    if (premisesByYard[0] !== undefined ) {\r\n       \r\n            yardPair = [premisesByYard[0].yard!, premisesByYard[premisesByYard.length - 1].yard!]\r\n          \r\n    } \r\n    if(yardPair[0] !== undefined) {\r\n        return yardPair\r\n    } else return [0,0]\r\n    \r\n}\r\n\r\nconst getLowestHighestHeight = (premises: Premises[]) => {\r\n\r\n    var filteredPremises: Premises[] = []\r\n    var premisesByHeight: Premises[] = []\r\n    var heightPair: number[] = []\r\n    if (premises !== undefined) {\r\n\r\n        filteredPremises = premises.filter((premises)=> {\r\n            return premises.area !== 0 && premises.height !== 0\r\n        })\r\n\r\n        premisesByHeight = filteredPremises.slice().sort((a, b) => {\r\n            return a.height! - b.height!\r\n        });\r\n    }\r\n\r\n    if (premisesByHeight[0] !== undefined) {\r\n        heightPair = [premisesByHeight[0].height!, premisesByHeight[premisesByHeight.length - 1].height!]\r\n    }\r\n    if(heightPair[0] !== undefined) {\r\n        return heightPair\r\n    } else return [0,0]\r\n}\r\n\r\nconst getLowestHighestDoors = (premises: Premises[]) => {\r\n\r\n    var filteredPremises: Premises[] = []\r\n    var premisesByDoors: Premises[] = []\r\n    var doorPair: number[] = []\r\n    if (premises !== undefined) {\r\n\r\n        filteredPremises = premises.filter((premises)=> {\r\n            return premises.area !== 0 && premises.doors !== 0\r\n        })\r\n\r\n        premisesByDoors = filteredPremises.slice().sort((a, b) => {\r\n            return a.doors! - b.doors!\r\n        });\r\n    }\r\n\r\n    if (premisesByDoors[0] !== undefined) {\r\n        doorPair = [premisesByDoors[0].doors!, premisesByDoors[premisesByDoors.length - 1].doors!]\r\n    }\r\n    if(doorPair[0] !== undefined) {\r\n        return doorPair\r\n    } else return [0,0]\r\n}\r\n\r\nconst getLoading = (premises: Premises[]) => {\r\n    var filteredPremises: Premises[] = []\r\n    var premisesByArea: Premises[] = []\r\n    \r\n    if (premises !== undefined) {\r\n\r\n        filteredPremises = premises.filter((premises)=> {\r\n            return premises.area !== 0 && premises.loading !== \"\" && premises.loading !== undefined\r\n        })\r\n        premisesByArea = filteredPremises.slice().sort((a, b) => {\r\n            return a.area! - b.area!\r\n        });\r\n    }\r\n\r\n   if(premisesByArea[premisesByArea.length - 1] !== undefined) {\r\n    return premisesByArea[premisesByArea.length - 1].loading!\r\n   } else { return \"\"}\r\n    \r\n}\r\n\r\nconst getSprinklered = (premises: Premises[]) => {\r\n    var filteredPremises: Premises[] = []\r\n    var premisesByArea: Premises[] = []\r\n    \r\n    if (premises !== undefined) {\r\n        filteredPremises = premises.filter((premises)=> {\r\n            return premises.area !== 0 && premises.sprinklered !== \"\" && premises.sprinklered !== undefined\r\n        })\r\n        premisesByArea = filteredPremises.slice().sort((a, b) => {\r\n            return a.area! - b.area!\r\n        });\r\n    }\r\n\r\n    if(premisesByArea[premisesByArea.length - 1] !== undefined) {\r\n        return premisesByArea[premisesByArea.length - 1].sprinklered!\r\n    } else { return \"\"}\r\n    \r\n}\r\n\r\nconst getCanopies = (premises: Premises[]) => {\r\n    var filteredPremises: Premises[] = []\r\n    var premisesByArea: Premises[] = []\r\n    \r\n    if (premises !== undefined) {\r\n        filteredPremises = premises.filter((premises)=> {\r\n            return premises.area !== 0 && premises.canopies !== \"\" && premises.canopies !== undefined\r\n        })\r\n        premisesByArea = filteredPremises.slice().sort((a, b) => {\r\n            return a.area! - b.area!\r\n        });\r\n    }\r\n\r\n    if(premisesByArea[premisesByArea.length - 1] !== undefined) {\r\n        return premisesByArea[premisesByArea.length - 1].canopies!\r\n    } else {return \"\"}\r\n    \r\n}\r\n\r\nconst getPower = (premises: Premises[]) => {\r\n    var filteredPremises: Premises[] = []\r\n    var premisesByArea: Premises[] = []\r\n    \r\n    if (premises !== undefined) {\r\n        filteredPremises = premises.filter((premises)=> {\r\n            return premises.area !== 0 && premises.power !== \"\" && premises.power !== undefined\r\n        })\r\n        premisesByArea = filteredPremises.slice().sort((a, b) => {\r\n            return a.area! - b.area!\r\n        });\r\n    }\r\n\r\n    if(premisesByArea[premisesByArea.length - 1] !== undefined) {\r\n        return premisesByArea[premisesByArea.length - 1].power!\r\n    } else {return \"\"}\r\n   \r\n}\r\n\r\nconst getImageLimit = (imageLimit:any, showImages: boolean) => {\r\n    if(showImages === true) {\r\n        if(isNaN(imageLimit) === false )  {\r\n            return imageLimit\r\n        }\r\n    } else return 1\r\n}\r\n\r\nconst sortPremises = (premises: Premises[]) => {\r\n\r\n    var indexSortedPremises = premises.slice().sort((a, b) => {\r\n        return (a.premisesIndex!) - (b.premisesIndex!)\r\n    });\r\n\r\n    var floorSortedPremises = indexSortedPremises.slice().sort((a, b) => {\r\n        var floorA = a.floor!.toUpperCase();\r\n        var floorB = b.floor!.toUpperCase();\r\n        if (floorA < floorB && a.premisesIndex=== b.premisesIndex) {\r\n            return -1;\r\n        }\r\n        if (floorA > floorB && a.premisesIndex=== b.premisesIndex) {\r\n            return 1;\r\n        }\r\n        return 0;\r\n    });\r\n\r\n    return floorSortedPremises\r\n}\r\n\r\nconst getPropertyImages = (property: Property, showLocality: boolean, showAerial: boolean) => {\r\n\r\n   var locality = property.locality!\r\n   var aerial = property.aerial!\r\n   var imagesArray = property.images!\r\n   var combinedArray: string[] = []\r\n\r\n    if (locality !== \"\" && locality !== null && locality !== undefined && showLocality !== false) {\r\n        combinedArray = [locality]\r\n    }\r\n    if (aerial !== \"\" && aerial !== null && aerial !== undefined && showAerial !== false) {\r\n        combinedArray = [...combinedArray, aerial]\r\n    }\r\n    combinedArray = [...combinedArray, ...imagesArray]\r\n\r\n    return combinedArray\r\n\r\n}\r\n\r\nconst getCustomTitle = (customTitle: string | null) => {\r\n\r\n    if (customTitle === \"\") {\r\n        return \"Schedule of Accomodation:\"\r\n    } else return customTitle\r\n\r\n}\r\n\r\nconst getType = (type:string) => {\r\n\r\nif(type === \"Warehouse\") {\r\n    return \"W/H\"\r\n} else return type\r\n\r\n}\r\n\r\nconst showIndFeatures =(buildingType:string, premisesList: Premises[]) => {\r\nvar showFeatures = false\r\nif(buildingType === \"Industrial\") {\r\n    if (getLowestHighestYard(premisesList)[0] !==0 || getLowestHighestHeight(premisesList)[0] !==0 || getLowestHighestDoors(premisesList)[0] !==0 || getLoading(premisesList) !== \"\" || getSprinklered(premisesList) !== \"\" || getCanopies(premisesList) !== \"\" || getPower(premisesList) !== \"\" ) {\r\n        showFeatures = true\r\n    } \r\n}\r\nreturn showFeatures\r\n}\r\n\r\nconst CLOUD_NAME = process.env.REACT_APP_CLOUD_NAME\r\n\r\ninterface Props {\r\n\r\n    selectedPropertyList: SelectedPropertyList,\r\n    enquiryName: string,\r\n    customTitle: null | string\r\n    agent: Agent,\r\n    imageLimit: number | string,\r\n    showLocality: boolean,\r\n    showAerial: boolean,\r\n    showImages: boolean,\r\n\r\n    /* enquiryName: string */\r\n\r\n}\r\n\r\n\r\n\r\nconst PropertyListLargeImagesPDF: React.FC<Props> = ({ selectedPropertyList, enquiryName, customTitle, agent, imageLimit, showImages, showLocality, showAerial }) => (\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n    <Document >\r\n\r\n        <Page orientation=\"landscape\" size=\"A4\" style={styles.frontPage}>\r\n\r\n            <Image style={styles.frontPageBackground} src={`https://res.cloudinary.com/${CLOUD_NAME}/image/upload/v1610358103/background_2_duzy8o.jpg`}></Image>\r\n\r\n            <Text style={styles.frontPageText1} >{getCustomTitle(customTitle)}</Text>\r\n            <Text style={styles.frontPageText2} >{enquiryName}</Text>\r\n\r\n\r\n\r\n        </Page>\r\n        <Page wrap orientation=\"landscape\" size=\"A4\" style={styles.page}>\r\n            <View fixed style={styles.headerSection}>\r\n\r\n                <Text style={styles.headerText}>Property Details</Text>\r\n\r\n\r\n\r\n\r\n                <Text style={styles.pageNumbers} render={({ pageNumber, totalPages }) => (\r\n                    `${pageNumber - 1} / ${totalPages - 2}`\r\n                )} fixed />\r\n\r\n            </View>\r\n\r\n\r\n\r\n\r\n\r\n\r\n            {selectedPropertyList.map((property, index) => (\r\n\r\n\r\n                <View /* minPresenceAhead={50} */ /* wrap={false} */ key={property.propertyId} style={styles.overallContainer}>\r\n\r\n                    <View style={styles.initialPageContainer}>\r\n\r\n                        <View style={styles.primaryImageContainer} >\r\n                            {selectedPropertyList[index].images!.length !== 0 ? <Image style={styles.primaryImage} src={cl.url(`${getPropertyImages(property, showLocality, showAerial)[0]}`)}></Image> : <Image style={styles.primaryImage} src={cl.url(\"https://res.cloudinary.com/drlfedqyz/image/upload/v1610357447/background_eocbnx.jpg\")}></Image>}\r\n                        </View>\r\n\r\n                        <View wrap={false} style={styles.premisesDetailsContainer}>\r\n\r\n\r\n                            <View style={styles.propertyNumberColumn}>\r\n                                <Text style={index < 9 ? styles.propertyNumber : styles.propertyNumber10plus}>{index + 1}</Text>\r\n                                <Text style={styles.propertyHeading}>{property.propertyName}</Text>\r\n                            </View>\r\n\r\n\r\n\r\n                            <Text style={[styles.propertyText, { marginLeft: 20 }]}>{`${property.address}, ${property.suburb} `}</Text>\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n                            <Text style={styles.premisesDetailsHeading} >Premises Details</Text>\r\n\r\n\r\n                            <View style={styles.premisesHeadings}>\r\n                                <View style={[styles.premisesContainer, { width: 60 }]}>\r\n                                    <Text style={[styles.premisesHeadingText, { textAlign: \"left\", marginLeft: 5 }]} >Floor/ Unit</Text>\r\n                                    <Text style={styles.premisesHeadingSubText} ></Text>\r\n                                </View>\r\n                                <View style={[styles.premisesContainer, { width: 40 }]}>\r\n                                    <Text style={[styles.premisesHeadingText, /* { textAlign: \"left\", marginLeft: 5 } */]} >Type</Text>\r\n                                    <Text style={styles.premisesHeadingSubText} ></Text>\r\n                                </View>\r\n                                <View style={[styles.premisesContainer, { width: 40 }]}>\r\n                                    <Text style={styles.premisesHeadingText} >Area</Text>\r\n                                    <Text style={[styles.premisesHeadingSubText]}>m²</Text>\r\n                                </View>\r\n                                <View style={[styles.premisesContainer, { width: 50 }]}>\r\n                                    <Text style={styles.premisesHeadingText} >Gross Rental</Text>\r\n                                    <Text style={[styles.premisesHeadingSubText]}>R/m²/month</Text>\r\n                                </View>\r\n\r\n                            </View>\r\n\r\n\r\n                            {sortPremises(selectedPropertyList[index].premisesList!).map((premises, index) => (\r\n                                <View style={index % 2 !== 0 ? styles.premisesDetails : [styles.premisesDetails, { backgroundColor: \"#ede6e6\" }]}>\r\n                                    <View style={[styles.premisesContainer, { width: 60 }]}>\r\n                                        <Text style={[styles.premisesText, { textAlign: \"left\", marginLeft: 5 }]} >{premises.floor}</Text>\r\n                                    </View>\r\n                                    <View style={[styles.premisesContainer, { width: 40 }]}>\r\n                                        <Text style={[styles.premisesText, /* { textAlign: \"left\", marginLeft: 5 } */]} >{getType(premises.type!)}</Text>\r\n                                    </View>\r\n                                    <View style={[styles.premisesContainer, { width: 40 }]}>\r\n                                        <Text style={[styles.premisesText]} >{premises.area}</Text>\r\n                                    </View>\r\n                                    <View style={[styles.premisesContainer, { width: 50 }]}>\r\n                                        <Text style={[styles.premisesText]} >{premises.grossRental}</Text>\r\n                                    </View>\r\n\r\n\r\n                                </View>\r\n\r\n\r\n                            ))}\r\n\r\n                            {selectedPropertyList[index].premisesList!.length>1?\r\n                            <View style={(selectedPropertyList[index].premisesList!.length) % 2 !== 0 ? [styles.premisesDetails, {borderTop: 0.5}] : [styles.premisesDetails, { backgroundColor: \"#ede6e6\" , borderTop: 0.5}]}>\r\n                                <View style={[styles.premisesContainer, { width: 60 }]}>\r\n                                    {/*  <Text style={styles.premisesText} >{premises.floor}</Text> */}\r\n                                </View>\r\n                                <View style={[styles.premisesContainer, { width: 40 }]}>\r\n                                    {/*  <Text style={styles.premisesText} >{premises.floor}</Text> */}\r\n                                </View>\r\n                                <View style={[styles.premisesContainer, { width: 40 }]}>\r\n                                    <Text style={[styles.premisesText]} > {selectedPropertyList[index].premisesList!.length !== 0 ?\r\n                                        selectedPropertyList[index].premisesList!.reduce((acc, premises) => {\r\n                                            return acc + premises.area!\r\n                                        }, 0) : 0\r\n                                    } </Text>\r\n                                </View>\r\n                                <View style={[styles.premisesContainer, { width: 50 }]}>\r\n                                    {/*  <Text style={[styles.premisesText, { width: 50 }]} >{premises.grossRental}</Text> */}\r\n                                </View>\r\n                            </View>: <Text></Text>}\r\n\r\n                            <Text style={styles.parkingDetailsHeading} >Parking Details</Text>\r\n\r\n                            <View style={styles.premisesHeadings}>\r\n                                <View style={[styles.premisesContainer, { width: 40 }]}>\r\n                                    <Text style={[styles.premisesHeadingText, { textAlign: \"left\", marginLeft: 5 }]} >Type</Text>\r\n                                    {<Text style={[styles.premisesHeadingSubText]} ></Text>}\r\n                                </View>\r\n                                <View style={[styles.premisesContainer, { width: 40 }]}>\r\n                                    <Text style={[styles.premisesHeadingText]} >Bays</Text>\r\n                                    <Text style={[styles.premisesHeadingSubText]}></Text>\r\n                                </View>\r\n                                <View style={[styles.premisesContainer, { width: 40 }]}>\r\n                                    <Text style={[styles.premisesHeadingText]} >Ratio</Text>\r\n                                    <Text style={[styles.premisesHeadingSubText]}>bays/100m²</Text>\r\n                                </View>\r\n                                <View style={[styles.premisesContainer, { width: 50 }]}>\r\n                                    <Text style={[styles.premisesHeadingText]} >Avg Rate</Text>\r\n                                    <Text style={[styles.premisesHeadingSubText]}>R/bay/month</Text>\r\n                                </View>\r\n\r\n                            </View>\r\n\r\n                            {selectedPropertyList[index].premisesList!.reduce((acc, premises) => {\r\n                                return acc + premises.coveredRate!\r\n                            }, 0) > 0 && property.buildingType !== \"Industrial\" ?\r\n                                <View style={getParkingRowsOrder(selectedPropertyList[index].premisesList!,\"covered\")?[styles.premisesDetails, { backgroundColor: \"#ede6e6\" }]:[styles.premisesDetails]}>\r\n                                    <View style={[styles.premisesContainer, { width: 40 }]}>\r\n                                        <Text style={[styles.premisesText, { textAlign: \"left\", marginLeft: 5  }]} >Covered</Text>\r\n                                    </View>\r\n                                    <View style={[styles.premisesContainer, { width: 40 }]}>\r\n                                        <Text style={[styles.premisesText]} >{selectedPropertyList[index].premisesList!.length !== 0 && selectedPropertyList[index].premisesList!.reduce((acc, premises) => {\r\n                                            return acc + premises.coveredBays!\r\n                                        }, 0) > 0 ?\r\n                                            selectedPropertyList[index].premisesList!.reduce((acc, premises) => {\r\n                                                return acc + premises.coveredBays!\r\n                                            }, 0).toFixed(0) : \"-\"\r\n                                        }</Text>\r\n                                    </View>\r\n                                    <View style={[styles.premisesContainer, { width: 40 }]}>\r\n                                        <Text style={[styles.premisesText]} >{selectedPropertyList[index].premisesList!.length !== 0 && selectedPropertyList[index].premisesList!.reduce((acc, premises) => {\r\n                                            return acc + premises.coveredBays!\r\n                                        }, 0) > 0 ?\r\n                                            (selectedPropertyList[index].premisesList!.reduce((acc, premises) => {\r\n                                                return acc + premises.coveredBays!\r\n                                            }, 0) / selectedPropertyList[index].premisesList!.reduce((acc, premises) => {\r\n                                                return acc + premises.area!\r\n                                            }, 0) * 100).toFixed(1) : \"-\"\r\n                                        }</Text>\r\n                                    </View>\r\n                                    <View style={[styles.premisesContainer, { width: 50 }]}>\r\n                                        <Text style={[styles.premisesText]} >{selectedPropertyList[index].premisesList!.length !== 0 ?\r\n                                            (selectedPropertyList[index].premisesList!.reduce((acc, premises) => {\r\n                                                if (premises.coveredBays! === 0) {\r\n                                                    return acc + premises.coveredRate!\r\n                                                } else {\r\n                                                    return acc + (premises.coveredRate! * premises.coveredBays!)\r\n                                                }\r\n                                            }, 0) / selectedPropertyList[index].premisesList!.reduce((acc, premises) => {\r\n                                                if (premises.coveredBays! === 0) {\r\n                                                    return acc + 1\r\n                                                } else {\r\n                                                    return acc + premises.coveredBays!\r\n                                                }\r\n                                            }, 0)).toFixed(2) : 0\r\n                                        }</Text>\r\n                                    </View>\r\n                                </View> : <Text></Text>}\r\n\r\n                            {selectedPropertyList[index].premisesList!.reduce((acc, premises) => {\r\n                                return acc + premises.shadedRate!\r\n                            }, 0) > 0 && property.buildingType !== \"Industrial\" ?\r\n                            <View style={getParkingRowsOrder(selectedPropertyList[index].premisesList!,\"shaded\")?[styles.premisesDetails, { backgroundColor: \"#ede6e6\" }]:[styles.premisesDetails]}>\r\n                                    <View style={[styles.premisesContainer, { width: 40 }]}>\r\n                                        <Text style={[styles.premisesText, { textAlign: \"left\", marginLeft: 5  }]} >Shaded</Text>\r\n                                    </View>\r\n                                    <View style={[styles.premisesContainer, { width: 40 }]}>\r\n                                        <Text style={[styles.premisesText]} >{selectedPropertyList[index].premisesList!.length !== 0 && selectedPropertyList[index].premisesList!.reduce((acc, premises) => {\r\n                                            return acc + premises.shadedBays!\r\n                                        }, 0) > 0 ?\r\n                                            selectedPropertyList[index].premisesList!.reduce((acc, premises) => {\r\n                                                return acc + premises.shadedBays!\r\n                                            }, 0).toFixed(0) : \"-\"\r\n                                        }</Text>\r\n                                    </View>\r\n                                    <View style={[styles.premisesContainer, { width: 40 }]}>\r\n                                        <Text style={[styles.premisesText]} >{selectedPropertyList[index].premisesList!.length !== 0 && selectedPropertyList[index].premisesList!.reduce((acc, premises) => {\r\n                                            return acc + premises.shadedBays!\r\n                                        }, 0) > 0 ?\r\n                                            (selectedPropertyList[index].premisesList!.reduce((acc, premises) => {\r\n                                                return acc + premises.shadedBays!\r\n                                            }, 0) / selectedPropertyList[index].premisesList!.reduce((acc, premises) => {\r\n                                                return acc + premises.area!\r\n                                            }, 0) * 100).toFixed(1) : \"-\"\r\n                                        }</Text>\r\n                                    </View>\r\n                                    <View style={[styles.premisesContainer, { width: 50 }]}>\r\n                                        <Text style={[styles.premisesText]} >{selectedPropertyList[index].premisesList!.length !== 0 ?\r\n                                            (selectedPropertyList[index].premisesList!.reduce((acc, premises) => {\r\n                                                if (premises.shadedBays! === 0) {\r\n                                                    return acc + premises.shadedRate!\r\n                                                } else {\r\n                                                    return acc + (premises.shadedRate! * premises.shadedBays!)\r\n                                                }\r\n                                            }, 0) / selectedPropertyList[index].premisesList!.reduce((acc, premises) => {\r\n                                                if (premises.shadedBays! === 0) {\r\n                                                    return acc + 1\r\n                                                } else {\r\n                                                    return acc + premises.shadedBays!\r\n                                                }\r\n                                            }, 0)).toFixed(2) : 0\r\n                                        }</Text>\r\n                                    </View>\r\n                                </View> : <Text></Text>}\r\n\r\n                            {selectedPropertyList[index].premisesList!.reduce((acc, premises) => {\r\n                                return acc + premises.openRate!\r\n                            }, 0) > 0 && property.buildingType !== \"Industrial\" ?\r\n                            <View style={getParkingRowsOrder(selectedPropertyList[index].premisesList!,\"open\")?[styles.premisesDetails, { backgroundColor: \"#ede6e6\" }]:[styles.premisesDetails]}>\r\n                                    <View style={[styles.premisesContainer, { width: 40 }]}>\r\n                                        <Text style={[styles.premisesText, { textAlign: \"left\", marginLeft: 5  }]} >Open</Text>\r\n                                    </View>\r\n                                    <View style={[styles.premisesContainer, { width: 40 }]}>\r\n                                        <Text style={[styles.premisesText]} >\r\n                                            {selectedPropertyList[index].premisesList!.length !== 0 && selectedPropertyList[index].premisesList!.reduce((acc, premises) => {\r\n                                                return acc + premises.openBays!\r\n                                            }, 0) > 0 ?\r\n                                                selectedPropertyList[index].premisesList!.reduce((acc, premises) => {\r\n                                                    return acc + premises.openBays!\r\n                                                }, 0).toFixed(0) : \"-\"\r\n                                            }</Text>\r\n                                    </View>\r\n                                    <View style={[styles.premisesContainer, { width: 40 }]}>\r\n                                        <Text style={[styles.premisesText]} >{selectedPropertyList[index].premisesList!.length !== 0 && selectedPropertyList[index].premisesList!.reduce((acc, premises) => {\r\n                                            return acc + premises.openBays!\r\n                                        }, 0) > 0 ?\r\n                                            (selectedPropertyList[index].premisesList!.reduce((acc, premises) => {\r\n                                                return acc + premises.openBays!\r\n                                            }, 0) / selectedPropertyList[index].premisesList!.reduce((acc, premises) => {\r\n                                                return acc + premises.area!\r\n                                            }, 0) * 100).toFixed(1) : \"-\"\r\n                                        }</Text>\r\n                                    </View>\r\n                                    <View style={[styles.premisesContainer, { width: 50 }]}>\r\n                                        <Text style={[styles.premisesText]} >{selectedPropertyList[index].premisesList!.length !== 0 ?\r\n                                            (selectedPropertyList[index].premisesList!.reduce((acc, premises) => {\r\n                                                if (premises.openBays! === 0) {\r\n                                                    return acc + premises.openRate!\r\n                                                } else {\r\n                                                    return acc + (premises.openRate! * premises.openBays!)\r\n                                                }\r\n                                            }, 0) / selectedPropertyList[index].premisesList!.reduce((acc, premises) => {\r\n                                                if (premises.openBays! === 0) {\r\n                                                    return acc + 1\r\n                                                } else {\r\n                                                    return acc + premises.openBays!\r\n                                                }\r\n                                            }, 0)).toFixed(2) : 0\r\n                                        }</Text>\r\n                                    </View>\r\n                                </View> : <Text></Text>}\r\n\r\n                            {getParkingRowsLength(selectedPropertyList[index].premisesList!)>1? <View style={getParkingRowsLength(selectedPropertyList[index].premisesList!)!==3?[styles.premisesDetails, { backgroundColor: \"#ede6e6\", borderTop: 0.5 }]: [styles.premisesDetails, {borderTop: 0.5}]}>\r\n                                <View style={[styles.premisesContainer, { width: 40 }]}>\r\n                                    <Text style={[styles.premisesText, { textAlign: \"left\", marginLeft: 5  }]} >Overall</Text>\r\n                                </View>\r\n                                <View style={[styles.premisesContainer, { width: 40 }]}>\r\n                                    <Text style={[styles.premisesText]} >{selectedPropertyList[index].premisesList!.length !== 0 ?\r\n                                        selectedPropertyList[index].premisesList!.reduce((acc, premises) => {\r\n                                            if (premises.openBays! === 0 && premises.shadedBays! === 0 && premises.coveredBays! === 0) {\r\n                                                return acc + premises.parkingRatio! * (premises.area! / 100)\r\n                                            } else {\r\n                                                return acc + premises.openBays! + premises.shadedBays! + premises.coveredBays!\r\n                                            }\r\n                                        }, 0).toFixed(0) : 0\r\n                                    }</Text>\r\n                                </View>\r\n                                <View style={[styles.premisesContainer, { width: 40 }]}>\r\n                                    <Text style={[styles.premisesText]} >{selectedPropertyList[index].premisesList!.length !== 0 ?\r\n                                        (selectedPropertyList[index].premisesList!.reduce((acc, premises) => {\r\n                                            if (premises.openBays! === 0 && premises.shadedBays! === 0 && premises.coveredBays! === 0) {\r\n                                                return acc + premises.parkingRatio! * (premises.area! / 100)\r\n                                            } else {\r\n                                                return acc + premises.openBays! + premises.shadedBays! + premises.coveredBays!\r\n                                            }\r\n\r\n                                        }, 0) / selectedPropertyList[index].premisesList!.reduce((acc, premises) => {\r\n                                            return acc + premises.area!\r\n                                        }, 0) * 100).toFixed(1) : 0\r\n                                    }</Text>\r\n                                </View>\r\n                                <View style={[styles.premisesContainer, { width: 50 }]}>\r\n                                    <Text style={[styles.premisesText]} >{selectedPropertyList[index].premisesList!.length !== 0 && selectedPropertyList[index].premisesList!.reduce((acc, premises) => {\r\n                                        return acc + premises.openBays! + premises.shadedBays! + premises.coveredBays!\r\n                                    }, 0) > 0 ?\r\n                                        (selectedPropertyList[index].premisesList!.reduce((acc, premises) => {\r\n\r\n                                            return acc + (premises.openRate! * premises.openBays!) + (premises.shadedRate! * premises.shadedBays!) + (premises.coveredRate! * premises.coveredBays!)\r\n                                        }, 0) / selectedPropertyList[index].premisesList!.reduce((acc, premises) => {\r\n                                            return acc + premises.openBays! + premises.shadedBays! + premises.coveredBays!\r\n                                        }, 0)).toFixed(2) : \"-\"\r\n                                    }</Text>\r\n                                </View>\r\n                            </View> : <Text></Text>}\r\n\r\n\r\n\r\n\r\n\r\n                            <View>\r\n\r\n                                <View style={[styles.premisesInfo, { marginTop: 20 }]}>\r\n                                    <Text style={[styles.premisesInfoHeadings, { width: 75 }]}>Occupation:</Text>\r\n                                    <Text style={styles.premisesInfoText}>{`${getEarliestOccDate(selectedPropertyList[index].premisesList!)} +`}\r\n                                    </Text>\r\n\r\n                                </View>\r\n\r\n                                <View style={styles.premisesInfo}>\r\n                                    <Text style={[styles.premisesInfoHeadings, { width: 75 }]}>Escalation:</Text>\r\n                                    {getLowestHighestEsc(selectedPropertyList[index].premisesList!)[0] !== undefined ?\r\n                                        <Text style={styles.premisesInfoText}>{getLowestHighestEsc(selectedPropertyList[index].premisesList!)[0] !== getLowestHighestEsc(selectedPropertyList[index].premisesList!)[1] ?\r\n                                            `${getLowestHighestEsc(selectedPropertyList[index].premisesList!)[0]}% to ${getLowestHighestEsc(selectedPropertyList[index].premisesList!)[1]}% `\r\n                                            : `${getLowestHighestEsc(selectedPropertyList[index].premisesList!)[0]}%`}\r\n                                        </Text> : <Text></Text>}\r\n\r\n                                </View>\r\n\r\n                                {showIndFeatures(property.buildingType!, property.premisesList!) ? <View style={[styles.premisesInfo, { flexDirection: \"column\" }]}>\r\n                                    <Text style={[styles.premisesInfoHeadings, { width: 75, marginLeft: 0 }]}>Features:</Text>\r\n\r\n                                    <Text style={[styles.premisesInfoText, { marginLeft: 0, fontSize: 8 }]}>\r\n                                        {getLowestHighestYard(selectedPropertyList[index].premisesList!)[0] !== getLowestHighestYard(selectedPropertyList[index].premisesList!)[1] || getLowestHighestYard(selectedPropertyList[index].premisesList!)[1] !== 0  ? \r\n                                        `• Yard Size: ${getLowestHighestYard(selectedPropertyList[index].premisesList!)[0] !== getLowestHighestYard(selectedPropertyList[index].premisesList!)[1] ?\r\n                                            `${getLowestHighestYard(selectedPropertyList[index].premisesList!)[0]}m² to ${getLowestHighestYard(selectedPropertyList[index].premisesList!)[1]}m²`\r\n                                            : `${getLowestHighestYard(selectedPropertyList[index].premisesList!)[0]}m²`} `: \"\"} \r\n\r\n                                         {getLowestHighestHeight(selectedPropertyList[index].premisesList!)[0] !== getLowestHighestHeight(selectedPropertyList[index].premisesList!)[1] || getLowestHighestHeight(selectedPropertyList[index].premisesList!)[1] !== 0  ? \r\n                                         `• Floor to Eave Height:  ${getLowestHighestHeight(selectedPropertyList[index].premisesList!)[0] !== getLowestHighestHeight(selectedPropertyList[index].premisesList!)[1] ?\r\n                                            `${getLowestHighestHeight(selectedPropertyList[index].premisesList!)[0]}m to ${getLowestHighestHeight(selectedPropertyList[index].premisesList!)[1]}m`\r\n                                            : `${getLowestHighestHeight(selectedPropertyList[index].premisesList!)[0]}m`} `: \"\"} \r\n                                            \r\n                                            {getLowestHighestDoors(selectedPropertyList[index].premisesList!)[0] !== getLowestHighestDoors(selectedPropertyList[index].premisesList!)[1] || getLowestHighestDoors(selectedPropertyList[index].premisesList!)[1] !== 0   ? \r\n                                            `• Doors: ${getLowestHighestDoors(selectedPropertyList[index].premisesList!)[0] !== getLowestHighestDoors(selectedPropertyList[index].premisesList!)[1] ?\r\n                                            `${getLowestHighestDoors(selectedPropertyList[index].premisesList!)[0]} to ${getLowestHighestDoors(selectedPropertyList[index].premisesList!)[1]}`\r\n                                            : `${getLowestHighestDoors(selectedPropertyList[index].premisesList!)[0]}`} ` : \"\"}\r\n\r\n                                            {getLoading(property.premisesList!) !== \"\" ? `• Loading Type: ${getLoading(property.premisesList!)} `  : \"\"}\r\n\r\n                                            {getSprinklered(property.premisesList!) !== \"\" ? `• Sprinkler Type: ${getSprinklered(property.premisesList!)} `  : \"\"}\r\n\r\n                                            {getCanopies(property.premisesList!) !== \"\" ? `• Canopy Details: ${getCanopies(property.premisesList!)} `  : \"\"}\r\n\r\n                                            {getPower(property.premisesList!) !== \"\" ? `• Power: ${getPower(property.premisesList!)}`  : \"\"}\r\n                                            \r\n                                            </Text>\r\n\r\n\r\n                                </View> : <Text></Text>}\r\n\r\n                               \r\n\r\n                                {property.notes !== \"\" ? <View style={[styles.premisesInfo, { flexDirection: \"column\" }]}>\r\n                                    <Text style={[styles.premisesInfoHeadings, { width: 75, marginLeft: 0 }]}>Notes:</Text>\r\n\r\n                                    <Text style={[styles.premisesInfoText, { marginLeft: 0, fontSize: 8 }]}>{property.notes}</Text>\r\n\r\n\r\n                                </View> : <Text></Text>}\r\n\r\n                            </View>\r\n\r\n\r\n                        </View>\r\n\r\n\r\n                    </View>\r\n\r\n                    {imageLimit === \"Any\" ? getPropertyImages(property, showLocality, showAerial).slice(1).map((image) => (\r\n\r\n                        <View style={styles.secondaryImageContainers} >\r\n                            {selectedPropertyList[index].images!.length !== 0 ? <Image style={styles.secondaryImage} src={cl.url(`${image}`, /* { width: 600, crop: \"fit\" } */)}></Image> : <Text></Text>}\r\n                        </View>\r\n\r\n                    )) : \r\n                    getPropertyImages(property, showLocality, showAerial).slice(1, getImageLimit(imageLimit, showImages)).map((image) => (\r\n\r\n                        <View style={styles.secondaryImageContainers} >\r\n                            {selectedPropertyList[index].images!.length !== 0 ? <Image style={styles.secondaryImage} src={cl.url(`${image}`, /* { width: 600, crop: \"fit\" } */)}></Image> : <Text></Text>}\r\n                        </View>\r\n\r\n                    ))\r\n                    }\r\n\r\n                </View>\r\n\r\n\r\n            ))}\r\n\r\n            <View fixed style={styles.footerSection}>\r\n                <View style={styles.footerImageSection}>\r\n                    <Image style={styles.footerImageStyles} src={`https://res.cloudinary.com/${CLOUD_NAME}/image/upload/v1610187102/EBLogoHeader_ypjyj5.jpg`}></Image>\r\n                </View>\r\n            </View>\r\n\r\n\r\n        </Page>\r\n        <Page orientation=\"landscape\" size=\"A4\" style={styles.contactPage}>\r\n            <View fixed style={styles.headerSection}>\r\n\r\n                <Text style={styles.headerText}>Contact</Text>\r\n\r\n\r\n            </View>\r\n            <Image style={styles.contactPageBackground} src=\"https://res.cloudinary.com/drlfedqyz/image/upload/v1610357459/lion_light_dptptx.jpg\"></Image>\r\n\r\n            <Text style={styles.contactPageText1} >For further information, please contact:</Text>\r\n            <Text style={styles.contactPageText2} >{agent !== undefined ? agent.name : \"\"}</Text>\r\n            <Text style={styles.contactPageText2} >{agent !== undefined ? agent.mobile : \"\"}</Text>\r\n            <Text style={styles.contactPageText2} >{agent !== undefined ? agent.email : \"\"}</Text>\r\n\r\n            <Text style={styles.contactPageText3} >Whilst every effort has been made to ensure accuracy, no liability will be accepted for any errors or omissions and the prospective tenant/ purchaser is required to verify details prior to contract</Text>\r\n\r\n            <View fixed style={styles.footerSection}>\r\n                <View style={styles.footerImageSection}>\r\n                    <Image style={styles.footerImageStyles} src=\"https://res.cloudinary.com/drlfedqyz/image/upload/v1610187102/EBLogoHeader_ypjyj5.jpg\"></Image>\r\n                </View>\r\n            </View>\r\n\r\n        </Page>\r\n    </Document>\r\n);\r\n\r\nexport default PropertyListLargeImagesPDF","C:\\Users\\ruper\\Desktop\\Web\\Own Projects\\Property Stock App V2\\psafrontendv2\\src\\components\\PDFOutput\\SelectedPropertyListPDF.tsx",[],"C:\\Users\\ruper\\Desktop\\Web\\Own Projects\\Property Stock App V2\\psafrontendv2\\src\\components\\UpdatePropertyModal.tsx",["528","529","530","531","532","533","534","535","536","537","538","539","540","541","542","543","544","545","546","547","548"],"import React, { useState } from 'react';\r\nimport { useId, useBoolean } from '@uifabric/react-hooks';\r\nimport { TextField, ITextFieldStyles } from 'office-ui-fabric-react/lib/TextField';\r\nimport { Dropdown, DropdownMenuItemType, IDropdownOption, IDropdownStyles } from 'office-ui-fabric-react/lib/Dropdown';\r\nimport { Slider } from 'office-ui-fabric-react/lib/Slider';\r\nimport { IStackStyles, Stack } from 'office-ui-fabric-react/lib/Stack';\r\nimport {\r\n    getTheme,\r\n    mergeStyleSets,\r\n    FontWeights,\r\n    ContextualMenu,\r\n    Toggle,\r\n    IToggleStyles,\r\n    DefaultButton,\r\n    Modal,\r\n    IDragOptions,\r\n    IconButton,\r\n    IIconProps,\r\n    IModalStyles,\r\n    mergeStyles,\r\n    ComboBox,\r\n    Fabric,\r\n    IComboBoxOption,\r\n    IComboBox,\r\n    SelectableOptionMenuItemType,\r\n    IComboBoxStyles,\r\n    PrimaryButton,\r\n} from 'office-ui-fabric-react';\r\nimport { Pivot, PivotItem } from 'office-ui-fabric-react/lib/Pivot';\r\nimport { gql, useMutation, useQuery } from '@apollo/client';\r\nimport { GET_PROPERTIES, NEW_PROPERTY, GET_NAV_STATE, UPDATE_PROPERTY, GET_SINGLE_PROPERTY } from \"../gql/gql\"\r\nimport { Mutation, MutationUpdatePropertyArgs, Query, Property, Landlord, LandlordContact } from \"../schematypes/schematypes\"\r\nimport { navigationState } from \"../reactivevariables/reactivevariables\"\r\nimport \"./NewPremisesModal.css\"\r\n\r\n\r\n\r\n\r\nconst dragOptions: IDragOptions = {\r\n    moveMenuItemText: 'Move',\r\n    closeMenuItemText: 'Close',\r\n    menu: ContextualMenu,\r\n};\r\nconst cancelIcon: IIconProps = { iconName: 'Cancel' };\r\nconst saveIcon: IIconProps = { iconName: 'Save' };\r\n\r\ninterface Props {\r\n    showUpdatePropertyModal: boolean;\r\n    distinctSuburbsOptions: IComboBoxOption[];\r\n    distinctRegionsOptions: IComboBoxOption[];\r\n    propertyId: number\r\n    propertyData: Property\r\n    landlordsOptions: IComboBoxOption[];\r\n}\r\n\r\nexport const UpdatePropertyModal: React.FC<Props> = ({ showUpdatePropertyModal, distinctSuburbsOptions, distinctRegionsOptions, propertyId, propertyData, landlordsOptions }) => {\r\n\r\n    const hideUpdatePropertyModal = () => {\r\n        navigationState({ ...navigationState(), showUpdatePropertyModal: false })\r\n    }\r\n\r\n    \r\n\r\n\r\n    const [updatedProperty, setUpdateProperty] = React.useState(propertyData);\r\n\r\n    interface SelectedLandlord {\r\n        landlordId: number\r\n        landlordName: string\r\n        landlordData: Landlord\r\n    }\r\n\r\n    const [selectedLandlord, setSelectedLandlord] = React.useState<SelectedLandlord>(\r\n        {\r\n            landlordId: propertyData.contact?.landlordName?.landlordId!,\r\n            landlordName: propertyData.contact?.landlordName?.landlordName!,\r\n            landlordData: { \r\n                landlordId: propertyData.contact?.landlordName?.landlordId!,\r\n                landlordName: propertyData.contact?.landlordName?.landlordName!,\r\n                contactsList: propertyData.contact?.landlordName?.contactsList!\r\n            }\r\n\r\n        });\r\n\r\n\r\n    interface SelectedContact {\r\n        contactId: number\r\n        contactName: string\r\n        contactData: LandlordContact\r\n    }\r\n\r\n\r\n    const [selectedContact, setSelectedContact] = React.useState<SelectedContact>(\r\n        {\r\n            contactId: propertyData.contact?.contactId! | 0,\r\n            contactName: propertyData.contact?.name!,\r\n            contactData: { \r\n                contactId: propertyData.contact?.contactId!,\r\n                name: propertyData.contact?.name!, \r\n                email: propertyData.contact?.email!,\r\n                mobileNo: propertyData.contact?.mobileNo!,\r\n                officeNo: propertyData.contact?.officeNo!,\r\n            }\r\n\r\n        });\r\n\r\n\r\n    const [updateProperty, { data }] = useMutation<Mutation, MutationUpdatePropertyArgs>(UPDATE_PROPERTY);\r\n\r\n    const saveUpdateProperty = () => {\r\n\r\n        updateProperty({\r\n            variables: {\r\n                contactId: selectedContact.contactId,\r\n                propertyId: propertyId,\r\n                propertyName: updatedProperty.propertyName,\r\n                address: updatedProperty.address,\r\n                suburb: updatedProperty.suburb,\r\n                coordinates: updatedProperty.coordinates,\r\n                /*  earliestOccupation: UpdateProperty.earliestOccupation,\r\n                 earliestExpiry: UpdateProperty.earliestExpiry, */\r\n                erfExtent: updatedProperty.erfExtent,\r\n                totalGLA: updatedProperty.totalGLA,\r\n                vacantArea: updatedProperty.vacantArea,\r\n                buildingType: updatedProperty.buildingType,\r\n                province: updatedProperty.province,\r\n                region: updatedProperty.region,\r\n                notes: updatedProperty.notes,\r\n            },\r\n\r\n            update(cache, { data }) {\r\n\r\n                if (!data) {\r\n                    return null;\r\n                }\r\n\r\n                const getExistingProperty = cache.readQuery<Query>({ query: GET_SINGLE_PROPERTY, variables: { propertyId: propertyId } })\r\n                const existingProperty: Property = getExistingProperty ? getExistingProperty.singleProperty! : { propertyId: 1, propertyName: \"\" };\r\n\r\n                const updatedProperty = {\r\n                    ...existingProperty, propertyName: data.updateProperty.propertyName,\r\n                    address: data.updateProperty.address,\r\n                    suburb: data.updateProperty.suburb,\r\n                    coordinates: data.updateProperty.coordinates,\r\n                    /*  earliestOccupation: UpdateProperty.earliestOccupation,\r\n                     earliestExpiry: UpdateProperty.earliestExpiry, */\r\n                    erfExtent: data.updateProperty.erfExtent,\r\n                    totalGLA: data.updateProperty.totalGLA,\r\n                    vacantArea: data.updateProperty.vacantArea,\r\n                    buildingType: data.updateProperty.buildingType,\r\n                    province: data.updateProperty.province,\r\n                    region: data.updateProperty.region,\r\n                    notes: data.updateProperty.notes,\r\n                    contact:  data.updateProperty.contact\r\n                }\r\n\r\n\r\n\r\n\r\n                if (existingProperty)\r\n                    cache.writeQuery<Query>({\r\n                        query: GET_SINGLE_PROPERTY,\r\n                        variables: { propertyId: propertyId },\r\n                        data: { singleProperty: updatedProperty }\r\n                    });\r\n            }\r\n\r\n\r\n        })\r\n\r\n\r\n        hideUpdatePropertyModal()\r\n    }\r\n\r\n\r\n\r\n    /* const [isModalOpen, { setTrue: showModal, setFalse: hideModal }] = useBoolean(false);\r\n    const [isDraggable, { toggle: toggleIsDraggable }] = useBoolean(false); */\r\n\r\n    // Use useId() to ensure that the IDs are unique on the page.\r\n    // (It's also okay to use plain strings and manually ensure uniqueness.)\r\n\r\n\r\n    const textFieldStyles: Partial<ITextFieldStyles> = { fieldGroup: { width: 200, marginRight: 20 } };\r\n    const textFieldPropertyNameStyles: Partial<ITextFieldStyles> = { fieldGroup: { width: 300, marginRight: 20 } };\r\n    const textFieldAddressStyles: Partial<ITextFieldStyles> = { fieldGroup: { width: 300, marginRight: 20 } };\r\n    const textFieldCoordinatesStyles: Partial<ITextFieldStyles> = { fieldGroup: { width: 150, marginRight: 20 } };\r\n    const textFieldErfStyles: Partial<ITextFieldStyles> = { fieldGroup: { width: 200, marginRight: 20 } };\r\n    const textFieldNotesStyles: Partial<ITextFieldStyles> = { fieldGroup: { width: 500, marginRight: 20 } };\r\n    const dropdownStyles: Partial<IDropdownStyles> = { dropdown: { width: 150, marginRight: 20 } };\r\n    const dropdownSectorStyles: Partial<IDropdownStyles> = { dropdown: { width: 420, marginRight: 20 } };\r\n    const dropdownProvinceStyles: Partial<IDropdownStyles> = { dropdown: { width: 140, marginRight: 20 } };\r\n    const comboBoxStyles: Partial<IComboBoxStyles> = { root: { width: 140, marginRight: 20 } }\r\n\r\n    const comboBoxLandlordStyles: Partial<IComboBoxStyles> = { root: { width: 220, marginRight: 20 } }\r\n    const textFieldLandlordStyles: Partial<ITextFieldStyles> = { root: { width: \"100%\", marginRight: 20, marginTop: \"20px !important\" } };\r\n\r\n    const textFieldLandlordEmailStyles: Partial<ITextFieldStyles> = { root: { width: \"100%\", marginRight: 20, marginTop: \"20px !important\" } };\r\n\r\n    const modalStyles: Partial<IModalStyles> = { main: { position: \"absolute\", top: 150 }, layer: {zIndex: 55000} };\r\n\r\n    const buttonStyles = { root: { width: 100, marginRight: \"auto !important\", marginBottom: \"auto\", marginTop: \"60px !important\", marginLeft: \"auto !important\", height: 40 } };\r\n\r\n    const headerIconStackStyles: Partial<IStackStyles> = { root: { marginRight: 0, marginLeft: \"auto\", } }\r\n\r\n    const buildingTypeOptions = [\r\n\r\n        { key: 'Office', text: 'Office' },\r\n        { key: 'Industrial', text: 'Industrial' },\r\n        { key: 'Retail', text: 'Retail' },\r\n        { key: 'Mixed Use', text: 'Mixed Use' },\r\n    ];\r\n\r\n\r\n\r\n    const [selectedItem, setSelectedItem] = React.useState<IDropdownOption>({ key: updatedProperty.buildingType!, text: updatedProperty.buildingType! });\r\n\r\n\r\n\r\n    const onChangeBuildingType = (event: React.FormEvent<HTMLDivElement>, item: IDropdownOption | undefined): void => {\r\n        if (item !== undefined) {\r\n            setSelectedItem(item);\r\n            setUpdateProperty({ ...updatedProperty, buildingType: item.text });\r\n        }\r\n    };\r\n\r\n\r\n\r\n    const propertyProvinceOptions = [\r\n\r\n        { key: 'WC', text: 'WC' },\r\n        { key: 'Gau', text: 'GAU' },\r\n        { key: 'KZN', text: 'KZN' },\r\n        { key: 'Other', text: 'Other Provinces' },\r\n\r\n    ];\r\n\r\n    const [selectedProvince, setSelectedProvince] = React.useState<IDropdownOption>({ key: updatedProperty.province!, text: updatedProperty.province! });\r\n\r\n    const onChangePropertyProvince = (event: React.FormEvent<HTMLDivElement>, item: IDropdownOption | undefined): void => {\r\n        if (item !== undefined) {\r\n            setSelectedProvince(item);\r\n            setUpdateProperty({ ...updatedProperty, province: item.text });\r\n        }\r\n    };\r\n\r\n    const suburbComboOptions: IComboBoxOption[] = distinctSuburbsOptions\r\n\r\n\r\n    /* [\r\n        { key: 'Header1', text: 'First heading', itemType: SelectableOptionMenuItemType.Header },\r\n        { key: 'A', text: 'Option A' },\r\n        { key: 'B', text: 'Option B' },\r\n        { key: 'C', text: 'Option C' },\r\n        { key: 'D', text: 'Option D' },\r\n        { key: 'divider', text: '-', itemType: SelectableOptionMenuItemType.Divider },\r\n        { key: 'Header2', text: 'Second heading', itemType: SelectableOptionMenuItemType.Header },\r\n        { key: 'E', text: 'Option E' },\r\n        { key: 'F', text: 'Option F', disabled: true },\r\n        { key: 'G', text: 'Option G' },\r\n        { key: 'H', text: 'Option H' },\r\n        { key: 'I', text: 'Option I' },\r\n        { key: 'J', text: 'Option J' },\r\n      ]; */\r\n\r\n    const [selectedSuburb, setSelectedSuburb] = React.useState<string | number | undefined>(updatedProperty.suburb);\r\n\r\n    const onChangePropertySuburb = React.useCallback(\r\n        (event: React.FormEvent<IComboBox>, option?: IComboBoxOption, index?: number, value?: string) => {\r\n            setSelectedSuburb(option?.key);\r\n            if (option !== undefined) {\r\n                setUpdateProperty({ ...updatedProperty, suburb: option!.text })\r\n            } else {\r\n                setUpdateProperty({ ...updatedProperty, suburb: value })\r\n            }\r\n        },\r\n        [updatedProperty],\r\n    );\r\n\r\n    const regionComboOptions: IComboBoxOption[] = distinctRegionsOptions\r\n\r\n    const [selectedRegion, setSelectedRegion] = React.useState<string | number | undefined>(updatedProperty.region);\r\n\r\n    const onChangePropertyRegion = React.useCallback(\r\n        (event: React.FormEvent<IComboBox>, option?: IComboBoxOption, index?: number, value?: string) => {\r\n            setSelectedRegion(option?.key);\r\n            if (option !== undefined) {\r\n                setUpdateProperty({ ...updatedProperty, region: option!.text })\r\n            } else {\r\n                setUpdateProperty({ ...updatedProperty, region: value })\r\n            }\r\n        },\r\n        [updatedProperty],\r\n    );\r\n\r\n    const landlordComboOptions: IComboBoxOption[] = landlordsOptions\r\n\r\n    const onChangeLandlord = React.useCallback(\r\n        (event: React.FormEvent<IComboBox>, option?: IComboBoxOption, index?: number, value?: string) => {\r\n            setSelectedLandlord({\r\n                landlordName: option?.text!,\r\n                landlordId: option?.data.landlordId,\r\n                landlordData: option?.data\r\n            });\r\n            setSelectedContact({\r\n                contactName: \"\",\r\n                contactId: 0,\r\n                contactData: { contactId: 0 }\r\n            });\r\n\r\n        },\r\n        [selectedLandlord],\r\n    );\r\n\r\n   \r\n\r\n    const contactsFormatted = selectedLandlord.landlordData?.contactsList?.map((contact) => {\r\n        return { key: contact.name!, text: contact.name!, data: contact }\r\n    })\r\n    var contactsOptions: IComboBoxOption[] = []\r\n\r\n    if (contactsFormatted !== undefined) {\r\n        contactsOptions = [...contactsFormatted]\r\n    }\r\n\r\n    const contactComboOptions: IComboBoxOption[] = contactsOptions\r\n\r\n    const onChangeContact = React.useCallback(\r\n        (event: React.FormEvent<IComboBox>, option?: IComboBoxOption, index?: number, value?: string) => {\r\n            setSelectedContact({\r\n                contactName: option?.text!,\r\n                contactId: option?.data.contactId,\r\n                contactData: option?.data\r\n            });\r\n           \r\n        },\r\n        [selectedLandlord],\r\n    );\r\n\r\n\r\n    const stackTokens = { childrenGap: 15 };\r\n\r\n\r\n\r\n    const onChangePropertyName = React.useCallback(\r\n        (event: React.FormEvent<HTMLInputElement | HTMLTextAreaElement>, newValue?: string) => {\r\n            setUpdateProperty({ ...updatedProperty, propertyName: newValue || '' });\r\n        },\r\n        [updatedProperty],\r\n    );\r\n\r\n    const onChangeAddress = React.useCallback(\r\n        (event: React.FormEvent<HTMLInputElement | HTMLTextAreaElement>, newValue?: string) => {\r\n            setUpdateProperty({ ...updatedProperty, address: newValue || '' });\r\n        },\r\n        [updatedProperty],\r\n    );\r\n    const onChangeCoordinates = React.useCallback(\r\n        (event: React.FormEvent<HTMLInputElement | HTMLTextAreaElement>, newValue?: string) => {\r\n            setUpdateProperty({ ...updatedProperty, coordinates: newValue || '' });\r\n        },\r\n        [updatedProperty],\r\n    );\r\n    const onChangeErfExtent = React.useCallback(\r\n        (event: React.FormEvent<HTMLInputElement | HTMLTextAreaElement>, newValue?: string) => {\r\n            setUpdateProperty({ ...updatedProperty, erfExtent: parseFloat(newValue!) || 0 });\r\n        },\r\n        [updatedProperty],\r\n    );\r\n    const onChangeTotalGLA = React.useCallback(\r\n        (event: React.FormEvent<HTMLInputElement | HTMLTextAreaElement>, newValue?: string) => {\r\n            setUpdateProperty({ ...updatedProperty, totalGLA: parseFloat(newValue!) || 0 });\r\n        },\r\n        [updatedProperty],\r\n    );\r\n    const onChangeNotes = React.useCallback(\r\n        (event: React.FormEvent<HTMLInputElement | HTMLTextAreaElement>, newValue?: string) => {\r\n            setUpdateProperty({ ...updatedProperty, notes: newValue || '' });\r\n        },\r\n        [updatedProperty],\r\n    );\r\n\r\n    const handleManageLandlords = () => {\r\n\r\n        navigationState({ ...navigationState(), showManageLandlordsPanel: true })\r\n\r\n    }\r\n\r\n    const [selectedKey, setSelectedKey] = React.useState('Property Details');\r\n\r\n    const handleLinkClick = (item?: PivotItem, ev?: React.MouseEvent<HTMLElement>) => {\r\n\r\n        setSelectedKey(item!.props.itemKey!);\r\n    };\r\n\r\n    const getTabId = (itemKey: string | undefined) => {\r\n        return `NewPropertyPivot_${itemKey}`;\r\n    };\r\n\r\n    const titleId = useId('New Property');\r\n\r\n\r\n    const newPropertyTab = () => {\r\n\r\n        switch (selectedKey) {\r\n            case \"Property Details\":\r\n                return (\r\n                    <>\r\n                        <Stack horizontal\r\n                            styles={{\r\n                                root: {\r\n                                    /* width: '400px', */\r\n                                    /*  margin: '10px', */\r\n\r\n                                    color: '#605e5c',\r\n\r\n                                    marginLeft: \"0\",\r\n                                    marginRight: \"auto\",\r\n                                    /* display: \"block\" */\r\n\r\n                                }\r\n                            }}>\r\n\r\n\r\n                            <TextField\r\n                                label=\"Property Name\"\r\n                                value={updatedProperty.propertyName}\r\n                                onChange={onChangePropertyName}\r\n                                styles={textFieldPropertyNameStyles}\r\n\r\n                            />\r\n\r\n                            <Dropdown\r\n                                label=\"Buidling Type\"\r\n                                selectedKey={selectedItem ? selectedItem.key : undefined}\r\n                                // eslint-disable-next-line react/jsx-no-bind\r\n                                onChange={onChangeBuildingType}\r\n                                placeholder=\"Select type\"\r\n                                options={buildingTypeOptions}\r\n                                styles={dropdownStyles}\r\n                            />\r\n\r\n\r\n\r\n                        </Stack>\r\n\r\n                        <Stack horizontal>\r\n\r\n                            <TextField\r\n                                label=\"Address\"\r\n                                value={updatedProperty.address}\r\n                                onChange={onChangeAddress}\r\n                                styles={textFieldAddressStyles}\r\n                            />\r\n                            <TextField\r\n                                label=\"Coordinates\"\r\n                                value={updatedProperty.coordinates}\r\n                                onChange={onChangeCoordinates}\r\n                                styles={textFieldCoordinatesStyles}\r\n                            />\r\n\r\n                        </Stack>\r\n\r\n                        <Stack horizontal>\r\n\r\n                            <ComboBox\r\n                                label=\"Suburb\"\r\n                                allowFreeform={true}\r\n                                autoComplete={\"on\"}\r\n                                options={suburbComboOptions}\r\n                                selectedKey={selectedSuburb}\r\n                                onChange={onChangePropertySuburb}\r\n                                styles={comboBoxStyles}\r\n                                text={updatedProperty.suburb}\r\n                            />\r\n\r\n                            <ComboBox\r\n                                label=\"Region\"\r\n                                allowFreeform={true}\r\n                                autoComplete={\"on\"}\r\n                                options={regionComboOptions}\r\n                                selectedKey={selectedRegion}\r\n                                onChange={onChangePropertyRegion}\r\n                                styles={comboBoxStyles}\r\n                                text={updatedProperty.region}\r\n                            />\r\n\r\n                            <Dropdown\r\n                                placeholder=\"Select Province\"\r\n                                label=\"Province\"\r\n                                selectedKey={selectedProvince ? selectedProvince.key : undefined}\r\n                                // eslint-disable-next-line react/jsx-no-bind\r\n                                onChange={onChangePropertyProvince}\r\n                                options={propertyProvinceOptions}\r\n                                styles={dropdownProvinceStyles}\r\n                            />\r\n\r\n                        </Stack>\r\n\r\n\r\n                        <Stack horizontal>\r\n\r\n\r\n\r\n                            <TextField\r\n                                label=\"Erf Extent\"\r\n                                type=\"number\"\r\n                                value={String(updatedProperty.erfExtent)}\r\n                                onChange={onChangeErfExtent}\r\n                                styles={textFieldErfStyles}\r\n                                suffix=\"m²\"\r\n                            />\r\n                            <TextField\r\n                                label=\"Total GLA\"\r\n                                type=\"number\"\r\n                                value={String(updatedProperty.totalGLA)}\r\n                                onChange={onChangeTotalGLA}\r\n                                styles={textFieldErfStyles}\r\n                                suffix=\"m²\"\r\n                            />\r\n\r\n                        </Stack>\r\n\r\n\r\n\r\n\r\n                    </>\r\n                )\r\n\r\n            case \"Landlord Details\":\r\n\r\n                return (\r\n                    <>\r\n                        <Stack verticalFill>\r\n\r\n                            <Stack horizontal>\r\n\r\n                                <ComboBox\r\n                                    label=\"Landlord\"\r\n                                    allowFreeform={true}\r\n                                    autoComplete={\"on\"}\r\n                                    options={landlordComboOptions}\r\n                                    selectedKey={selectedLandlord.landlordId}\r\n                                    onChange={onChangeLandlord}\r\n                                    styles={comboBoxLandlordStyles}\r\n                                    text={selectedLandlord.landlordName}\r\n                                />\r\n\r\n                                <ComboBox\r\n                                    label=\"Contact\"\r\n                                    allowFreeform={true}\r\n                                    autoComplete={\"on\"}\r\n                                    options={contactComboOptions}\r\n                                    selectedKey={selectedContact !== undefined ? selectedContact.contactId : \"\"}\r\n                                    onChange={onChangeContact}\r\n                                    styles={comboBoxLandlordStyles}\r\n                                    text={selectedContact.contactName}\r\n                                />\r\n\r\n                            </Stack>\r\n\r\n\r\n\r\n\r\n\r\n\r\n                            <Stack horizontal>\r\n\r\n                                <Stack styles={{root: {width: \"70%\"}}} verticalFill>\r\n\r\n                                    <TextField\r\n                                        underlined\r\n                                        label=\"Email\"\r\n                                        value={selectedContact.contactData !== undefined ? selectedContact.contactData.email : \"\"}\r\n\r\n                                        styles={textFieldLandlordEmailStyles}\r\n\r\n                                    />\r\n\r\n                                    <TextField\r\n                                        underlined\r\n                                        label=\"Mobile No\"\r\n                                        value={selectedContact.contactData !== undefined ? selectedContact.contactData.mobileNo : \"\"}\r\n\r\n                                        styles={textFieldLandlordStyles}\r\n                                    />\r\n                                    <TextField\r\n                                        underlined\r\n                                        label=\"Office No\"\r\n                                        value={selectedContact.contactData !== undefined ? selectedContact.contactData.officeNo : \"\"}\r\n\r\n                                        styles={textFieldLandlordStyles}\r\n                                    />\r\n\r\n                                </Stack>\r\n\r\n\r\n                                <PrimaryButton onClick={handleManageLandlords} styles={buttonStyles}>\r\n                                    Manage Landlords\r\n                                </PrimaryButton>\r\n\r\n                            </Stack>\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n                        </Stack>\r\n                    </>\r\n                )\r\n\r\n            case \"Property Notes\":\r\n\r\n                return (\r\n                    <>\r\n                        <Stack horizontal>\r\n\r\n                            <TextField\r\n                                label=\"Notes\"\r\n                                value={updatedProperty.notes}\r\n                                onChange={onChangeNotes}\r\n                                styles={textFieldNotesStyles}\r\n                                multiline\r\n                                autoAdjustHeight\r\n                            />\r\n\r\n                        </Stack>\r\n                    </>\r\n                )\r\n\r\n\r\n\r\n\r\n\r\n            default:\r\n            // code block\r\n        }\r\n\r\n    }\r\n\r\n    return (\r\n        <div>\r\n\r\n\r\n            <Modal\r\n                styles={modalStyles}\r\n\r\n                titleAriaId={titleId}\r\n                isOpen={showUpdatePropertyModal}\r\n                onDismiss={hideUpdatePropertyModal}\r\n               /*  isBlocking={true} */\r\n                containerClassName={contentStyles.container}\r\n            /* dragOptions={dragOptions} */\r\n            >\r\n                <div className={contentStyles.header}>\r\n                    <span id={titleId}>Update Property</span>\r\n                    <Stack horizontal\r\n                        styles={headerIconStackStyles}\r\n                    >\r\n\r\n                        <IconButton\r\n                            styles={iconButtonStyles}\r\n                            iconProps={saveIcon}\r\n                            ariaLabel=\"Save Investor\"\r\n                            onClick={saveUpdateProperty}\r\n                        />\r\n                        <IconButton\r\n                            styles={iconButtonStyles}\r\n                            iconProps={cancelIcon}\r\n                            ariaLabel=\"Close popup modal\"\r\n                            onClick={hideUpdatePropertyModal}\r\n                        />\r\n\r\n                    </Stack>\r\n\r\n                </div>\r\n                <div className={contentStyles.body} >\r\n\r\n                    <Stack style={{ width: 486 }} tokens={stackTokens}>\r\n\r\n                        <Pivot\r\n                            aria-label=\"Separately Rendered Content Pivot Example\"\r\n                            selectedKey={selectedKey}\r\n                            // eslint-disable-next-line react/jsx-no-bind\r\n                            onLinkClick={handleLinkClick}\r\n                            headersOnly={true}\r\n                            getTabId={getTabId}\r\n                        >\r\n                            <PivotItem headerText=\"Property Details\" itemKey=\"Property Details\" />\r\n                            <PivotItem headerText=\"Landlord Details\" itemKey=\"Landlord Details\" />\r\n                            <PivotItem headerText=\"Property Notes\" itemKey=\"Property Notes\" />\r\n\r\n                        </Pivot>\r\n\r\n                        {newPropertyTab()}\r\n\r\n\r\n\r\n\r\n\r\n                    </Stack>\r\n\r\n\r\n                </div>\r\n            </Modal>\r\n        </div>\r\n    );\r\n};\r\n\r\nconst theme = getTheme();\r\nconst contentStyles = mergeStyleSets({\r\n    container: {\r\n        display: 'flex',\r\n        flexFlow: 'column nowrap',\r\n        alignItems: 'stretch',\r\n        \r\n\r\n    },\r\n\r\n    header: [\r\n\r\n        theme.fonts.xLargePlus,\r\n        {\r\n            flex: '1 1 auto',\r\n            borderTop: `4px solid ${theme.palette.themePrimary}`,\r\n            color: theme.palette.neutralPrimary,\r\n            display: 'flex',\r\n            alignItems: 'center',\r\n            fontWeight: FontWeights.semibold,\r\n            padding: '12px 12px 14px 24px',\r\n        },\r\n    ],\r\n    body: {\r\n        flex: '4 4 auto',\r\n        padding: '0 24px 24px 24px',\r\n        overflowY: 'hidden',\r\n        selectors: {\r\n            p: { margin: '14px 0' },\r\n            'p:first-child': { marginTop: 0 },\r\n            'p:last-child': { marginBottom: 0 },\r\n        },\r\n    },\r\n});\r\n\r\nconst iconButtonStyles = {\r\n    root: {\r\n        color: theme.palette.neutralPrimary,\r\n        marginLeft: \"10px !important\",\r\n        marginTop: '4px',\r\n        marginRight: '2px',\r\n\r\n    },\r\n    rootHovered: {\r\n        color: theme.palette.neutralDark,\r\n    },\r\n    icon: {\r\n        fontSize: \"24px\",\r\n\r\n    }\r\n};\r\n\r\nexport default UpdatePropertyModal\r\n","C:\\Users\\ruper\\Desktop\\Web\\Own Projects\\Property Stock App V2\\psafrontendv2\\src\\components\\DuplicatePremisesModal.tsx",["549","550","551","552","553","554","555","556","557","558","559","560","561","562","563","564","565","566","567","568","569","570","571","572","573","574","575","576","577","578","579","580","581","582"],"import React, { useState } from 'react';\r\nimport { useId, useBoolean } from '@uifabric/react-hooks';\r\nimport { TextField, ITextFieldStyles } from 'office-ui-fabric-react/lib/TextField';\r\nimport { Dropdown, DropdownMenuItemType, IDropdownOption, IDropdownStyles } from 'office-ui-fabric-react/lib/Dropdown';\r\nimport { Slider } from 'office-ui-fabric-react/lib/Slider';\r\nimport { IStackStyles, Stack } from 'office-ui-fabric-react/lib/Stack';\r\nimport { IRenderFunction, IStyleFunctionOrObject } from 'office-ui-fabric-react/lib/Utilities';\r\nimport {\r\n    getTheme,\r\n    mergeStyleSets,\r\n    FontWeights,\r\n    ContextualMenu,\r\n    Toggle,\r\n    IToggleStyles,\r\n    DefaultButton,\r\n    Modal,\r\n    IDragOptions,\r\n    IconButton,\r\n    IIconProps,\r\n    IModalStyles,\r\n    mergeStyles,\r\n    ComboBox,\r\n    Fabric,\r\n    IComboBoxOption,\r\n    IComboBox,\r\n    SelectableOptionMenuItemType,\r\n    IComboBoxStyles,\r\n    DatePicker,\r\n    DayOfWeek,\r\n    IDatePickerStrings,\r\n    IDatePickerStyleProps,\r\n    IDatePickerStyles,\r\n    ICalendarProps\r\n} from 'office-ui-fabric-react';\r\nimport { Pivot, PivotItem } from 'office-ui-fabric-react/lib/Pivot';\r\nimport { defaultDataIdFromObject, gql, useMutation, useQuery } from '@apollo/client';\r\nimport { GET_SINGLE_PROPERTY, NEW_PREMISES, GET_NAV_STATE } from \"../gql/gql\"\r\nimport { Mutation, MutationPostPremisesArgs, Query, Property, Premises } from \"../schematypes/schematypes\"\r\nimport { navigationState } from \"../reactivevariables/reactivevariables\"\r\nimport \"./NewPremisesModal.css\"\r\n\r\n\r\n\r\n\r\nconst dragOptions: IDragOptions = {\r\n    moveMenuItemText: 'Move',\r\n    closeMenuItemText: 'Close',\r\n    menu: ContextualMenu,\r\n};\r\nconst cancelIcon: IIconProps = { iconName: 'Cancel' };\r\nconst saveIcon: IIconProps = { iconName: 'Save' };\r\n\r\ninterface Props {\r\n    propertyId: number;\r\n    premisesId: number\r\n    showDuplicatePremisesModal: boolean;\r\n}\r\n\r\nexport const DuplicatePremisesModal: React.FC<Props> = ({ showDuplicatePremisesModal, propertyId, premisesId }) => {\r\n\r\n\r\n\r\n    const {\r\n        data: propertyData,\r\n        loading: propertyLoading,\r\n        error: propertyError\r\n    } = useQuery<Query>(GET_SINGLE_PROPERTY, {\r\n        variables: { propertyId: propertyId },\r\n    });\r\n\r\n\r\n    const getPremises = propertyData?.singleProperty?.premisesList!.find(premises => premises?.premisesId === premisesId);\r\n    const handlePremisesData = React.useCallback(() => {\r\n        if (getPremises !== undefined && getPremises !== null) {\r\n            return { ...getPremises, openRatio: getPremises.openBays! / (getPremises.area! / 100), coveredRatio: getPremises.coveredBays! / (getPremises.area! / 100), shadedRatio: getPremises.shadedBays! / (getPremises.area! / 100), }\r\n        } else {\r\n            return {\r\n                floor: \"\",\r\n                area: 0,\r\n                vacant: \"true\",\r\n                type: \"\",\r\n                premisesIndex: 0,\r\n                occupation: getNextMonth(),\r\n                premisesNotes: \"\",\r\n                netRental: 0,\r\n                opCosts: 0,\r\n                other: 0,\r\n                grossRental: 0,\r\n                esc: 0,\r\n                openBays: 0,\r\n                openRate: 0,\r\n                openRatio: 0,\r\n                coveredBays: 0,\r\n                coveredRate: 0,\r\n                coveredRatio: 0,\r\n                shadedBays: 0,\r\n                shadedRate: 0,\r\n                shadedRatio: 0,\r\n                parkingRatio: 0,\r\n                tenantName: \"-\",\r\n                leaseExpiry: getNextMonth(),\r\n                tenantNotes: \"\",\r\n                yard: 0,\r\n                height: 0,\r\n                doors: 0,\r\n                loading: \"\",\r\n                sprinklered: \"\",\r\n                canopies: \"\",\r\n                power: \"\",\r\n\r\n            }\r\n        }\r\n    }, [getPremises])\r\n\r\n\r\n    React.useEffect(() => {\r\n        setDuplicatedPremises(handlePremisesData)\r\n        setSelectedPremisesType({ key: handlePremisesData().type!, text: handlePremisesData().type! })\r\n        setSelectedPremisesIndex(({ key: handlePremisesData().premisesIndex!, text: String(handlePremisesData().premisesIndex!) }))\r\n\r\n    }, [handlePremisesData])\r\n\r\n\r\n\r\n\r\n    const hideDuplicatePremisesModal = () => {\r\n\r\n        navigationState({ ...navigationState(), showDuplicatePremisesModal: false })\r\n\r\n    }\r\n\r\n    const getNextMonth = () => {\r\n        const date = new Date();\r\n        const today = date.getDate();\r\n        const currentMonth = date.getMonth() + 1;\r\n        const currentYear = date.getFullYear();\r\n        var newDate = new Date(currentYear, currentMonth, 1);\r\n        return newDate.toISOString()\r\n\r\n    }\r\n\r\n\r\n    const [duplicatedPremises, setDuplicatedPremises] = React.useState<any>(\r\n        {\r\n            floor: \"\",\r\n            area: 0,\r\n            vacant: \"true\",\r\n            type: \"\",\r\n            premisesIndex: 0,\r\n            occupation: getNextMonth(),\r\n            premisesNotes: \"\",\r\n            netRental: 0,\r\n            opCosts: 0,\r\n            other: 0,\r\n            grossRental: 0,\r\n            esc: 0,\r\n            openBays: 0,\r\n            openRate: 0,\r\n            openRatio: 0,\r\n            coveredBays: 0,\r\n            coveredRate: 0,\r\n            coveredRatio: 0,\r\n            shadedBays: 0,\r\n            shadedRate: 0,\r\n            shadedRatio: 0,\r\n            parkingRatio: 0,\r\n            tenantName: \"-\",\r\n            leaseExpiry: getNextMonth(),\r\n            tenantNotes: \"\",\r\n            yard: 0,\r\n            height: 0,\r\n            doors: 0,\r\n            loading: \"\",\r\n            sprinklered: \"\",\r\n            canopies: \"\",\r\n            power: \"\",\r\n\r\n        });\r\n\r\n\r\n\r\n\r\n    const [postPremises, { data }] = useMutation<Mutation, MutationPostPremisesArgs>(NEW_PREMISES);\r\n\r\n    const saveDuplicatedPremises = () => {\r\n\r\n        postPremises({\r\n            variables: {\r\n                propertyId: propertyId,\r\n                floor: duplicatedPremises.floor,\r\n                area: duplicatedPremises.area,\r\n                vacant: duplicatedPremises.vacant,\r\n                type: duplicatedPremises.type,\r\n                premisesIndex: duplicatedPremises.premisesIndex,\r\n                occupation: duplicatedPremises.occupation,\r\n                premisesNotes: duplicatedPremises.premisesNotes,\r\n                netRental: duplicatedPremises.netRental,\r\n                opCosts: duplicatedPremises.opCosts,\r\n                other: duplicatedPremises.other,\r\n                grossRental: duplicatedPremises.grossRental,\r\n                esc: duplicatedPremises.esc,\r\n                openBays: duplicatedPremises.openBays,\r\n                openRate: duplicatedPremises.openRate,\r\n                coveredBays: duplicatedPremises.coveredBays,\r\n                coveredRate: duplicatedPremises.coveredRate,\r\n                shadedBays: duplicatedPremises.shadedBays,\r\n                shadedRate: duplicatedPremises.shadedRate,\r\n                parkingRatio: duplicatedPremises.parkingRatio,\r\n                tenantName: duplicatedPremises.tenantName,\r\n                leaseExpiry: duplicatedPremises.leaseExpiry,\r\n                tenantNotes: duplicatedPremises.tenantNotes,\r\n                yard: duplicatedPremises.yard,\r\n                height: duplicatedPremises.height,\r\n                doors: duplicatedPremises.doors,\r\n                loading: duplicatedPremises.loading,\r\n                sprinklered: duplicatedPremises.sprinklered,\r\n                canopies: duplicatedPremises.canopies,\r\n                power: duplicatedPremises.power,\r\n            },\r\n\r\n            update(cache, { data }) {\r\n\r\n                if (!data) {\r\n                    return null;\r\n                }\r\n\r\n                const getExistingProperty = cache.readQuery<Query>({ query: GET_SINGLE_PROPERTY, variables: { propertyId: propertyId } })\r\n                const existingProperty: Property = getExistingProperty ? getExistingProperty.singleProperty! : { propertyId: 1, propertyName: \"\" };\r\n\r\n                const existingPremises = getExistingProperty ? getExistingProperty.singleProperty?.premisesList : [];\r\n                const newPremises = [...existingPremises!, data.postPremises]\r\n\r\n                const newProperty = { ...existingProperty, premisesList: newPremises }\r\n                if (existingPremises)\r\n                    cache.writeQuery<Query>({\r\n                        query: GET_SINGLE_PROPERTY,\r\n                        variables: { propertyId: propertyId },\r\n                        data: { singleProperty: newProperty }\r\n                    });\r\n            }\r\n\r\n\r\n        })\r\n        hideDuplicatePremisesModal()\r\n\r\n\r\n\r\n    }\r\n\r\n\r\n\r\n    /* const [isModalOpen, { setTrue: showModal, setFalse: hideModal }] = useBoolean(false);\r\n    const [isDraggable, { toggle: toggleIsDraggable }] = useBoolean(false); */\r\n\r\n    // Use useId() to ensure that the IDs are unique on the page.\r\n    // (It's also okay to use plain strings and manually ensure uniqueness.)\r\n\r\n\r\n    const textFieldStyles: Partial<ITextFieldStyles> = { fieldGroup: { width: 200, marginRight: 20 } };\r\n    const textFieldFloorStyles: Partial<ITextFieldStyles> = { fieldGroup: { width: 200, marginRight: 20 } };\r\n    const textFieldAreaStyles: Partial<ITextFieldStyles> = { fieldGroup: { width: 150, marginRight: 20 } };\r\n    const textFieldEscStyles: Partial<ITextFieldStyles> = { fieldGroup: { width: 150, marginRight: 20 } };\r\n    const textFieldCoordinatesStyles: Partial<ITextFieldStyles> = { fieldGroup: { width: 150, marginRight: 20 } };\r\n    const textFieldErfStyles: Partial<ITextFieldStyles> = { fieldGroup: { width: 200, marginRight: 20 } };\r\n    const textFieldNotesStyles: Partial<ITextFieldStyles> = { fieldGroup: { width: 470 } };\r\n    const dropdownStyles: Partial<IDropdownStyles> = { dropdown: { width: 125, marginRight: 20 } };\r\n    const dropdownSectorStyles: Partial<IDropdownStyles> = { dropdown: { width: 420, marginRight: 20 } };\r\n    const dropdownProvinceStyles: Partial<IDropdownStyles> = { dropdown: { width: 140, marginRight: 20 } };\r\n    const comboBoxStyles: Partial<IComboBoxStyles> = { root: { width: 140, marginRight: 20 } }\r\n\r\n    const textFieldParkingBaysStyles: Partial<ITextFieldStyles> = { fieldGroup: { width: 100, marginRight: 20 } };\r\n    const textFieldParkingRateStyles: Partial<ITextFieldStyles> = { fieldGroup: { width: 185, marginRight: 20 } };\r\n    const textFieldParkingRatioStyles: Partial<ITextFieldStyles> = { fieldGroup: { width: 140, marginRight: 20 } };\r\n\r\n    const toggleStyles: Partial<IToggleStyles> = { container: { marginTop: 5 }, label: { marginLeft: 4 } };\r\n    const modalStyles: Partial<IModalStyles> = { main: { position: \"absolute\", top: 150 }, };\r\n\r\n    const datePickerStyles: IStyleFunctionOrObject<IDatePickerStyleProps, IDatePickerStyles> = { root: { width: 160, marginRight: 20 }, callout: {} }\r\n\r\n    /* const calendarProps: ICalendarProps ={styles  } */\r\n\r\n\r\n\r\n    const headerIconStackStyles: Partial<IStackStyles> = { root: { marginRight: 0, marginLeft: \"auto\", } }\r\n\r\n    const DayPickerStrings: IDatePickerStrings = {\r\n        months: [\r\n            'January',\r\n            'February',\r\n            'March',\r\n            'April',\r\n            'May',\r\n            'June',\r\n            'July',\r\n            'August',\r\n            'September',\r\n            'October',\r\n            'November',\r\n            'December',\r\n        ],\r\n\r\n        shortMonths: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],\r\n\r\n        days: ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'],\r\n\r\n        shortDays: ['S', 'M', 'T', 'W', 'T', 'F', 'S'],\r\n\r\n        goToToday: 'Go to today',\r\n        prevMonthAriaLabel: 'Go to previous month',\r\n        nextMonthAriaLabel: 'Go to next month',\r\n        prevYearAriaLabel: 'Go to previous year',\r\n        nextYearAriaLabel: 'Go to next year',\r\n        closeButtonAriaLabel: 'Close date picker',\r\n        monthPickerHeaderAriaLabel: '{0}, select to change the year',\r\n        yearPickerHeaderAriaLabel: '{0}, select to change the month',\r\n    };\r\n\r\n    const controlClass = mergeStyleSets({\r\n        control: {\r\n            margin: '0 0 15px 0',\r\n            maxWidth: '300px',\r\n        },\r\n\r\n    });\r\n\r\n    const premisesTypeOptions = [\r\n\r\n        { key: 'Office', text: 'Office' },\r\n        { key: 'Warehouse', text: 'Warehouse' },\r\n        { key: 'Retail', text: 'Retail' },\r\n        { key: 'Stores', text: 'Stores' },\r\n        { key: 'Balcony', text: 'Balcony' },\r\n    ];\r\n\r\n    const premisesIndexOptions = [\r\n\r\n        { key: 1, text: \"1\" },\r\n        { key: 2, text: \"2\" },\r\n        { key: 3, text: \"3\" },\r\n        { key: 4, text: \"4\" },\r\n        { key: 5, text: \"5\" },\r\n        { key: 6, text: \"6\" },\r\n    ];\r\n\r\n\r\n\r\n    const [selectedPremisesType, setSelectedPremisesType] = React.useState<IDropdownOption>();\r\n    const [selectedPremisesIndex, setSelectedPremisesIndex] = React.useState<IDropdownOption>();\r\n\r\n\r\n\r\n    const onChangePremisesType = (event: React.FormEvent<HTMLDivElement>, item: IDropdownOption | undefined): void => {\r\n        if (item !== undefined) {\r\n            setSelectedPremisesType(item);\r\n            setDuplicatedPremises({ ...duplicatedPremises, type: item.text });\r\n        }\r\n    };\r\n\r\n    const onChangePremisesIndex = (event: React.FormEvent<HTMLDivElement>, item: IDropdownOption | undefined): void => {\r\n        if (item !== undefined) {\r\n            setSelectedPremisesIndex(item);\r\n            setDuplicatedPremises({ ...duplicatedPremises, premisesIndex: parseInt(item.text) });\r\n        }\r\n    };\r\n\r\n\r\n    const stackTokens = { childrenGap: 15 };\r\n\r\n\r\n\r\n    const onChangeFloor = React.useCallback(\r\n        (event: React.FormEvent<HTMLInputElement | HTMLTextAreaElement>, newValue?: string) => {\r\n            setDuplicatedPremises({ ...duplicatedPremises, floor: newValue || '' });\r\n        },\r\n        [duplicatedPremises],\r\n    );\r\n\r\n    const onChangeArea = React.useCallback(\r\n        (event: React.FormEvent<HTMLInputElement | HTMLTextAreaElement>, newValue?: string) => {\r\n            console.log(newValue)\r\n            setDuplicatedPremises({ ...duplicatedPremises, area: parseFloat(newValue!) || 0 });\r\n        },\r\n        [duplicatedPremises],\r\n    );\r\n\r\n\r\n    const handleChecked = () => {\r\n        if (duplicatedPremises.vacant === \"false\") {\r\n            return false\r\n        } else {\r\n            return true\r\n        }\r\n\r\n    }\r\n\r\n    const onChangeVacantToggle = React.useCallback(\r\n        (ev: React.MouseEvent<HTMLElement>, checked: boolean | undefined) => {\r\n            if (duplicatedPremises.vacant === \"false\") {\r\n                setDuplicatedPremises({ ...duplicatedPremises, vacant: \"true\" });\r\n\r\n            } else {\r\n                setDuplicatedPremises({ ...duplicatedPremises, vacant: \"false\" });\r\n            }\r\n        },\r\n        [duplicatedPremises])\r\n\r\n    const onSelectOccupationDate = React.useCallback(\r\n        (date: Date | null | undefined) => {\r\n            if (date !== undefined && date !== null)\r\n                setDuplicatedPremises({ ...duplicatedPremises, occupation: date.toISOString() });\r\n        },\r\n        [duplicatedPremises])\r\n\r\n    const onFormatDate = (date?: Date): string => {\r\n        return !date ? '' : date.toLocaleDateString(\r\n            'en-gb',\r\n            {\r\n                year: 'numeric',\r\n                month: 'long',\r\n                day: 'numeric'\r\n            }\r\n        );\r\n    };\r\n\r\n\r\n\r\n    const onChangePremisesNotes = React.useCallback(\r\n        (event: React.FormEvent<HTMLInputElement | HTMLTextAreaElement>, newValue?: string) => {\r\n            setDuplicatedPremises({ ...duplicatedPremises, premisesNotes: newValue || '' });\r\n        },\r\n        [duplicatedPremises],\r\n    );\r\n\r\n    const onChangeNetRental = React.useCallback(\r\n        (event: React.FormEvent<HTMLInputElement | HTMLTextAreaElement>, newValue?: string) => {\r\n            setDuplicatedPremises({ ...duplicatedPremises, netRental: parseFloat(newValue!) || 0 });\r\n        },\r\n        [duplicatedPremises],\r\n    );\r\n\r\n    const onChangeOpCosts = React.useCallback(\r\n        (event: React.FormEvent<HTMLInputElement | HTMLTextAreaElement>, newValue?: string) => {\r\n            setDuplicatedPremises({ ...duplicatedPremises, opCosts: parseFloat(newValue!) || 0 });\r\n        },\r\n        [duplicatedPremises],\r\n    );\r\n\r\n    const onChangeOther = React.useCallback(\r\n        (event: React.FormEvent<HTMLInputElement | HTMLTextAreaElement>, newValue?: string) => {\r\n            setDuplicatedPremises({ ...duplicatedPremises, other: parseFloat(newValue!) || 0 });\r\n        },\r\n        [duplicatedPremises],\r\n    );\r\n\r\n    const onChangeGrossRental = React.useCallback(\r\n        (event: React.FormEvent<HTMLInputElement | HTMLTextAreaElement>, newValue?: string) => {\r\n            setDuplicatedPremises({ ...duplicatedPremises, grossRental: parseFloat(newValue!) || 0 });\r\n        },\r\n        [duplicatedPremises],\r\n    );\r\n\r\n    const onChangeEsc = React.useCallback(\r\n        (event: React.FormEvent<HTMLInputElement | HTMLTextAreaElement>, newValue?: string) => {\r\n            setDuplicatedPremises({ ...duplicatedPremises, esc: parseFloat(newValue!) || 0 });\r\n        },\r\n        [duplicatedPremises],\r\n    );\r\n\r\n    const getOpenBays = (ratio: number) => {\r\n        return (ratio * (duplicatedPremises.area / 100))\r\n    }\r\n\r\n    const getOpenRatio = (bays: number) => {\r\n        return (bays / (duplicatedPremises.area / 100))\r\n    }\r\n\r\n    const getCoveredBays = (ratio: number) => {\r\n        return (ratio * (duplicatedPremises.area / 100))\r\n    }\r\n\r\n    const getCoveredRatio = (bays: number) => {\r\n        return (bays / (duplicatedPremises.area / 100))\r\n    }\r\n\r\n    const getShadedBays = (ratio: number) => {\r\n        return (ratio * (duplicatedPremises.area / 100))\r\n    }\r\n\r\n    const getShadedRatio = (bays: number) => {\r\n        return (bays / (duplicatedPremises.area / 100))\r\n    }\r\n\r\n    const onChangeOpenBays = React.useCallback(\r\n        (event: React.FormEvent<HTMLInputElement | HTMLTextAreaElement>, newValue?: string) => {\r\n            setDuplicatedPremises({ ...duplicatedPremises, openBays: parseFloat(newValue!) || 0, openRatio: getOpenRatio(parseFloat(newValue!)) });\r\n        },\r\n        [duplicatedPremises],\r\n    );\r\n\r\n    const onChangeOpenRate = React.useCallback(\r\n        (event: React.FormEvent<HTMLInputElement | HTMLTextAreaElement>, newValue?: string) => {\r\n            setDuplicatedPremises({ ...duplicatedPremises, openRate: parseFloat(newValue!) || 0 });\r\n        },\r\n        [duplicatedPremises],\r\n    );\r\n\r\n\r\n    const onChangeOpenRatio = React.useCallback(\r\n        (event: React.FormEvent<HTMLInputElement | HTMLTextAreaElement>, newValue?: string) => {\r\n            setDuplicatedPremises({ ...duplicatedPremises, openRatio: parseFloat(newValue!) || 0, openBays: getOpenBays(parseFloat(newValue!)) });\r\n        },\r\n        [duplicatedPremises],\r\n    );\r\n\r\n    const onChangeCoveredBays = React.useCallback(\r\n        (event: React.FormEvent<HTMLInputElement | HTMLTextAreaElement>, newValue?: string) => {\r\n            setDuplicatedPremises({ ...duplicatedPremises, coveredBays: parseFloat(newValue!) || 0, coveredRatio: getCoveredRatio(parseFloat(newValue!)) });\r\n        },\r\n        [duplicatedPremises],\r\n    );\r\n\r\n    const onChangeCoveredRate = React.useCallback(\r\n        (event: React.FormEvent<HTMLInputElement | HTMLTextAreaElement>, newValue?: string) => {\r\n            setDuplicatedPremises({ ...duplicatedPremises, coveredRate: parseFloat(newValue!) || 0 });\r\n        },\r\n        [duplicatedPremises],\r\n    );\r\n\r\n    const onChangeCoveredRatio = React.useCallback(\r\n        (event: React.FormEvent<HTMLInputElement | HTMLTextAreaElement>, newValue?: string) => {\r\n            setDuplicatedPremises({ ...duplicatedPremises, coveredRatio: parseFloat(newValue!) || 0, coveredBays: getCoveredBays(parseFloat(newValue!)) });\r\n        },\r\n        [duplicatedPremises],\r\n    );\r\n\r\n    const onChangeShadedBays = React.useCallback(\r\n        (event: React.FormEvent<HTMLInputElement | HTMLTextAreaElement>, newValue?: string) => {\r\n            setDuplicatedPremises({ ...duplicatedPremises, shadedBays: parseFloat(newValue!) || 0, shadedRatio: getShadedRatio(parseFloat(newValue!)) });\r\n        },\r\n        [duplicatedPremises],\r\n    );\r\n\r\n    const onChangeShadedRate = React.useCallback(\r\n        (event: React.FormEvent<HTMLInputElement | HTMLTextAreaElement>, newValue?: string) => {\r\n            setDuplicatedPremises({ ...duplicatedPremises, shadedRate: parseFloat(newValue!) || 0 });\r\n        },\r\n        [duplicatedPremises],\r\n    );\r\n\r\n    const onChangeShadedRatio = React.useCallback(\r\n        (event: React.FormEvent<HTMLInputElement | HTMLTextAreaElement>, newValue?: string) => {\r\n            setDuplicatedPremises({ ...duplicatedPremises, shadedRatio: parseFloat(newValue!) || 0, shadedBays: getShadedBays(parseFloat(newValue!)) });\r\n        },\r\n        [duplicatedPremises],\r\n    );\r\n\r\n    const onChangeParkingRatio = React.useCallback(\r\n        (event: React.FormEvent<HTMLInputElement | HTMLTextAreaElement>, newValue?: string) => {\r\n            setDuplicatedPremises({ ...duplicatedPremises, parkingRatio: parseFloat(newValue!) || 0 });\r\n        },\r\n        [duplicatedPremises],\r\n    );\r\n\r\n    const onChangeTenantName = React.useCallback(\r\n        (event: React.FormEvent<HTMLInputElement | HTMLTextAreaElement>, newValue?: string) => {\r\n            setDuplicatedPremises({ ...duplicatedPremises, tenantName: newValue || '' });\r\n        },\r\n        [duplicatedPremises],\r\n    );\r\n\r\n    const onSelectLeaseExpiry = React.useCallback(\r\n        (date: Date | null | undefined) => {\r\n            if (date !== undefined && date !== null)\r\n                setDuplicatedPremises({ ...duplicatedPremises, leaseExpiry: date.toISOString() });\r\n        },\r\n        [duplicatedPremises])\r\n\r\n    const onChangeTenantNotes = React.useCallback(\r\n        (event: React.FormEvent<HTMLInputElement | HTMLTextAreaElement>, newValue?: string) => {\r\n            setDuplicatedPremises({ ...duplicatedPremises, tenantNotes: newValue || '' });\r\n        },\r\n        [duplicatedPremises],\r\n    );\r\n\r\n\r\n\r\n\r\n    /* const onChangeCoordinates = React.useCallback(\r\n        (event: React.FormEvent<HTMLInputElement | HTMLTextAreaElement>, newValue?: string) => {\r\n            setNewProperty({ ...newProperty, coordinates: newValue || '' });\r\n        },\r\n        [newProperty],\r\n    );\r\n    const onChangeErfExtent = React.useCallback(\r\n        (event: React.FormEvent<HTMLInputElement | HTMLTextAreaElement>, newValue?: string) => {\r\n            setNewProperty({ ...newProperty, erfExtent: parseInt(newValue!) || 0 });\r\n        },\r\n        [newProperty],\r\n    );\r\n    const onChangeTotalGLA = React.useCallback(\r\n        (event: React.FormEvent<HTMLInputElement | HTMLTextAreaElement>, newValue?: string) => {\r\n            setNewProperty({ ...newProperty, totalGLA: parseInt(newValue!) || 0 });\r\n        },\r\n        [newProperty],\r\n    );\r\n    const onChangeNotes = React.useCallback(\r\n        (event: React.FormEvent<HTMLInputElement | HTMLTextAreaElement>, newValue?: string) => {\r\n            setNewProperty({ ...newProperty, notes: newValue || '' });\r\n        },\r\n        [newProperty],\r\n    ); */\r\n\r\n    const [selectedKey, setSelectedKey] = React.useState('Premises Details');\r\n\r\n    const handleLinkClick = (item?: PivotItem, ev?: React.MouseEvent<HTMLElement>) => {\r\n\r\n        setSelectedKey(item!.props.itemKey!);\r\n    };\r\n\r\n    const getTabId = (itemKey: string | undefined) => {\r\n        return `NewPremisesPivot_${itemKey}`;\r\n    };\r\n\r\n    const titleId = useId('title');\r\n\r\n\r\n\r\n    const DuplicatePremisesTab = () => {\r\n\r\n        switch (selectedKey) {\r\n            case \"Premises Details\":\r\n                return (\r\n                    <>\r\n                        <Stack horizontal /* style={{marginLeft: 50}} */\r\n                            styles={{\r\n                                root: {\r\n                                    /* width: '400px', */\r\n                                    /*  margin: '10px', */\r\n\r\n                                    color: '#605e5c',\r\n\r\n                                    marginLeft: \"0px\",\r\n                                    marginRight: \"auto\",\r\n                                    /* display: \"block\" */\r\n\r\n                                }\r\n\r\n                            }}>\r\n                            <TextField\r\n                                label=\"Floor/Unit\"\r\n                                value={duplicatedPremises.floor}\r\n                                onChange={onChangeFloor}\r\n                                styles={textFieldFloorStyles}\r\n\r\n                            />\r\n                            <TextField\r\n                                label=\"Area\"\r\n                                type=\"number\"\r\n                                value={duplicatedPremises.area === 0 ? \"\" : String(duplicatedPremises.area)}\r\n                                onChange={onChangeArea}\r\n                                styles={textFieldAreaStyles}\r\n                                suffix=\"m²\"\r\n                            />\r\n\r\n                            <Toggle styles={toggleStyles} label=\"Vacant?\" checked={handleChecked()} onChange={onChangeVacantToggle} />\r\n\r\n\r\n\r\n                        </Stack>\r\n\r\n                        <Stack horizontal styles={{\r\n                            root: {\r\n                                /* width: '400px', */\r\n                                /*  margin: '10px', */\r\n\r\n                                color: '#605e5c',\r\n\r\n                                marginLeft: \"0px\",\r\n                                marginRight: \"auto\",\r\n                                /* display: \"block\" */\r\n\r\n                            }\r\n\r\n                        }}>\r\n\r\n                            <Dropdown\r\n                                label=\"Premises Type\"\r\n                                selectedKey={selectedPremisesType ? selectedPremisesType.key : undefined}\r\n                                // eslint-disable-next-line react/jsx-no-bind\r\n                                onChange={onChangePremisesType}\r\n                                placeholder=\"Select type\"\r\n                                options={premisesTypeOptions}\r\n                                styles={dropdownStyles}\r\n                            />\r\n\r\n                            <Dropdown\r\n                                label=\"Premises Index\"\r\n                                selectedKey={selectedPremisesIndex ? selectedPremisesIndex.key : undefined}\r\n                                // eslint-disable-next-line react/jsx-no-bind\r\n                                onChange={onChangePremisesIndex}\r\n                                placeholder=\"Select index\"\r\n                                options={premisesIndexOptions}\r\n                                styles={dropdownStyles}\r\n                            />\r\n\r\n                            <DatePicker\r\n                                label=\"Occupation Date\"\r\n                                className={controlClass.control}\r\n                                firstDayOfWeek={DayOfWeek.Monday}\r\n                                strings={DayPickerStrings}\r\n                                placeholder=\"Select a date...\"\r\n                                ariaLabel=\"Select a date\"\r\n                                value={new Date(duplicatedPremises.occupation)}\r\n                                onSelectDate={onSelectOccupationDate}\r\n                                formatDate={onFormatDate}\r\n                                styles={datePickerStyles}\r\n\r\n                            />\r\n\r\n                        </Stack>\r\n\r\n                        <Stack horizontal>\r\n\r\n                            <TextField\r\n                                label=\"Premises Notes\"\r\n                                value={duplicatedPremises.premisesNotes}\r\n                                onChange={onChangePremisesNotes}\r\n                                styles={textFieldNotesStyles}\r\n                                multiline\r\n                                autoAdjustHeight\r\n                            />\r\n\r\n                        </Stack>\r\n                    </>\r\n                )\r\n\r\n            case \"Rental Details\":\r\n\r\n                return (\r\n                    <>\r\n                        <Stack horizontal\r\n                            styles={{\r\n                                root: {\r\n                                    /* width: '400px', */\r\n                                    /*  margin: '10px', */\r\n\r\n                                    color: '#605e5c',\r\n\r\n                                    marginLeft: \"auto\",\r\n                                    marginRight: \"auto\",\r\n                                    /* display: \"block\" */\r\n\r\n                                }\r\n                            }}>\r\n                            <TextField\r\n                                label=\"Net Rental\"\r\n                                type=\"number\"\r\n                                value={duplicatedPremises.netRental === 0 ? \"\" : String(duplicatedPremises.netRental)}\r\n                                onChange={onChangeNetRental}\r\n                                styles={textFieldFloorStyles}\r\n\r\n                                prefix=\"R\"\r\n                                suffix=\"/m²/month\"\r\n                            />\r\n                            <TextField\r\n                                label=\"Op Costs\"\r\n                                type=\"number\"\r\n                                value={duplicatedPremises.opCosts === 0 ? \"\" : String(duplicatedPremises.opCosts)}\r\n                                onChange={onChangeOpCosts}\r\n                                styles={textFieldFloorStyles}\r\n                                prefix=\"R\"\r\n                                suffix=\"/m²/month\"\r\n                            />\r\n\r\n                        </Stack>\r\n\r\n                        <Stack horizontal\r\n                            styles={{\r\n                                root: {\r\n                                    /* width: '400px', */\r\n                                    /*  margin: '10px', */\r\n\r\n                                    color: '#605e5c',\r\n\r\n                                    marginLeft: \"auto\",\r\n                                    marginRight: \"auto\",\r\n                                    /* display: \"block\" */\r\n\r\n                                }\r\n                            }}>\r\n                            <TextField\r\n                                label=\"Other\"\r\n                                type=\"number\"\r\n                                value={duplicatedPremises.other === 0 ? \"\" : String(duplicatedPremises.other)}\r\n                                onChange={onChangeOther}\r\n                                styles={textFieldFloorStyles}\r\n                                prefix=\"R\"\r\n                                suffix=\"/m²/month\"\r\n                            />\r\n                            <TextField\r\n                                label=\"Gross Rental\"\r\n                                type=\"number\"\r\n                                value={duplicatedPremises.grossRental === 0 ? \"\" : String(duplicatedPremises.grossRental)}\r\n                                onChange={onChangeGrossRental}\r\n                                styles={textFieldFloorStyles}\r\n                                prefix=\"R\"\r\n                                suffix=\"/m²/month\"\r\n                            />\r\n\r\n\r\n\r\n                        </Stack>\r\n\r\n                        <Stack horizontal\r\n                            styles={{\r\n                                root: {\r\n                                    /* width: '400px', */\r\n                                    /*  margin: '10px', */\r\n\r\n                                    color: '#605e5c',\r\n\r\n                                    marginLeft: \"auto\",\r\n                                    marginRight: \"auto\",\r\n                                    /* display: \"block\" */\r\n\r\n                                }\r\n                            }}>\r\n\r\n\r\n                            <TextField\r\n                                label=\"Esc\"\r\n                                type=\"number\"\r\n                                value={duplicatedPremises.esc === 0 ? \"\" : String(duplicatedPremises.esc)}\r\n                                onChange={onChangeEsc}\r\n                                styles={textFieldEscStyles}\r\n                                suffix=\"% per annum\"\r\n                            />\r\n\r\n                        </Stack>\r\n                    </>\r\n                )\r\n\r\n            case \"Parking Details\":\r\n\r\n                return (\r\n                    <>\r\n                        <Stack horizontal\r\n                            styles={{\r\n                                root: {\r\n                                    /* width: '400px', */\r\n                                    /*  margin: '10px', */\r\n\r\n                                    color: '#605e5c',\r\n\r\n                                    marginLeft: \"auto\",\r\n                                    marginRight: \"auto\",\r\n                                    /* display: \"block\" */\r\n\r\n                                }\r\n                            }}>\r\n                            <TextField\r\n                                label=\"Open Bays\"\r\n                                type=\"number\"\r\n                                value={duplicatedPremises.openBays === 0 ? \"\" : String(duplicatedPremises.openBays)}\r\n                                onChange={onChangeOpenBays}\r\n                                styles={textFieldParkingBaysStyles}\r\n                                suffix=\"bays\"\r\n                            />\r\n                            <TextField\r\n                                label=\"Open Rate\"\r\n                                type=\"number\"\r\n                                value={duplicatedPremises.openRate === 0 ? \"\" : String(duplicatedPremises.openRate)}\r\n                                onChange={onChangeOpenRate}\r\n                                styles={textFieldParkingRateStyles}\r\n                                prefix=\"R\"\r\n                                suffix=\"/bay/month\"\r\n                            />\r\n\r\n                            <TextField\r\n                                label=\"Open Ratio\"\r\n                                type=\"number\"\r\n                                value={duplicatedPremises.openRatio === 0 ? \"\" : String(duplicatedPremises.openRatio.toFixed(1).replace(/[.,]0$/, \"\"))}\r\n                                onChange={onChangeOpenRatio}\r\n                                styles={textFieldParkingRatioStyles}\r\n\r\n                                suffix=\"bays/100m²\"\r\n                            />\r\n\r\n                        </Stack>\r\n\r\n                        <Stack horizontal\r\n                            styles={{\r\n                                root: {\r\n                                    /* width: '400px', */\r\n                                    /*  margin: '10px', */\r\n\r\n                                    color: '#605e5c',\r\n\r\n                                    marginLeft: \"auto\",\r\n                                    marginRight: \"auto\",\r\n                                    /* display: \"block\" */\r\n\r\n                                }\r\n                            }}>\r\n                            <TextField\r\n                                label=\"Covered Bays\"\r\n                                type=\"number\"\r\n                                value={duplicatedPremises.coveredBays === 0 ? \"\" : String(duplicatedPremises.coveredBays)}\r\n                                onChange={onChangeCoveredBays}\r\n                                styles={textFieldParkingBaysStyles}\r\n                                suffix=\"bays\"\r\n                            />\r\n                            <TextField\r\n                                label=\"Covered Rate\"\r\n                                type=\"number\"\r\n                                value={duplicatedPremises.coveredRate === 0 ? \"\" : String(duplicatedPremises.coveredRate)}\r\n                                onChange={onChangeCoveredRate}\r\n                                styles={textFieldParkingRateStyles}\r\n                                prefix=\"R\"\r\n                                suffix=\"/bay/month\"\r\n                            />\r\n\r\n                            <TextField\r\n                                label=\"Covered Ratio\"\r\n                                type=\"number\"\r\n                                value={duplicatedPremises.coveredRatio === 0 ? \"\" : String(duplicatedPremises.coveredRatio.toFixed(1).replace(/[.,]0$/, \"\"))}\r\n                                onChange={onChangeCoveredRatio}\r\n                                styles={textFieldParkingRatioStyles}\r\n\r\n                                suffix=\"bays/100m²\"\r\n                            />\r\n\r\n\r\n\r\n                        </Stack>\r\n\r\n                        <Stack horizontal\r\n                            styles={{\r\n                                root: {\r\n                                    /* width: '400px', */\r\n                                    /*  margin: '10px', */\r\n\r\n                                    color: '#605e5c',\r\n\r\n                                    marginLeft: \"auto\",\r\n                                    marginRight: \"auto\",\r\n                                    /* display: \"block\" */\r\n\r\n                                }\r\n                            }}>\r\n\r\n\r\n                            <TextField\r\n                                label=\"Shaded Bays\"\r\n                                type=\"number\"\r\n                                value={duplicatedPremises.shadedBays === 0 ? \"\" : String(duplicatedPremises.shadedBays)}\r\n                                onChange={onChangeShadedBays}\r\n                                styles={textFieldParkingBaysStyles}\r\n                                suffix=\"bays\"\r\n                            />\r\n                            <TextField\r\n                                label=\"Shaded Rate\"\r\n                                type=\"number\"\r\n                                value={duplicatedPremises.shadedRate === 0 ? \"\" : String(duplicatedPremises.shadedRate)}\r\n                                onChange={onChangeShadedRate}\r\n                                styles={textFieldParkingRateStyles}\r\n                                prefix=\"R\"\r\n                                suffix=\"/bay/month\"\r\n                            />\r\n\r\n                            <TextField\r\n                                label=\"Shaded Ratio\"\r\n                                type=\"number\"\r\n                                value={duplicatedPremises.shadedRatio === 0 ? \"\" : String(duplicatedPremises.shadedRatio.toFixed(1).replace(/[.,]0$/, \"\"))}\r\n                                onChange={onChangeShadedRatio}\r\n                                styles={textFieldParkingRatioStyles}\r\n\r\n                                suffix=\"bays/100m²\"\r\n                            />\r\n\r\n                        </Stack>\r\n                        <Stack horizontal\r\n                            styles={{\r\n                                root: {\r\n                                    /* width: '400px', */\r\n                                    /*  margin: '10px', */\r\n\r\n                                    color: '#605e5c',\r\n\r\n                                    marginLeft: \"auto\",\r\n                                    marginRight: \"auto\",\r\n                                    /* display: \"block\" */\r\n\r\n                                }\r\n                            }}>\r\n\r\n\r\n                            <TextField\r\n                                label=\"Parking Ratio\"\r\n                                type=\"number\"\r\n                                value={duplicatedPremises.parkingRatio === 0 ? \"\" : String(duplicatedPremises.parkingRatio.toFixed(1).replace(/[.,]0$/, \"\"))}\r\n                                onChange={onChangeParkingRatio}\r\n                                styles={textFieldFloorStyles}\r\n\r\n                                suffix=\"bays/100m²\"\r\n                            />\r\n\r\n\r\n                        </Stack>\r\n                    </>\r\n                )\r\n\r\n\r\n            case \"Tenant Details\":\r\n\r\n                return (\r\n                    <>\r\n\r\n\r\n                        <Stack horizontal styles={{\r\n                            root: {\r\n                                /* width: '400px', */\r\n                                /*  margin: '10px', */\r\n\r\n                                color: '#605e5c',\r\n\r\n                                marginLeft: \"0px\",\r\n                                marginRight: \"auto\",\r\n                                /* display: \"block\" */\r\n\r\n                            }\r\n\r\n                        }}>\r\n\r\n                            <TextField\r\n                                label=\"Tenant Name\"\r\n                                value={duplicatedPremises.tenantName === \"-\" ? \"\" : duplicatedPremises.tenantName}\r\n                                onChange={onChangeTenantName}\r\n                                styles={textFieldFloorStyles}\r\n\r\n                            />\r\n\r\n                            <DatePicker\r\n                                label=\"Lease Expiry Date\"\r\n                                className={controlClass.control}\r\n                                firstDayOfWeek={DayOfWeek.Monday}\r\n                                strings={DayPickerStrings}\r\n                                placeholder=\"Select a date...\"\r\n                                ariaLabel=\"Select a date\"\r\n                                value={new Date(duplicatedPremises.leaseExpiry)}\r\n                                onSelectDate={onSelectLeaseExpiry}\r\n                                formatDate={onFormatDate}\r\n                                styles={datePickerStyles}\r\n\r\n                            />\r\n\r\n                        </Stack>\r\n\r\n                        <Stack horizontal>\r\n\r\n                            <TextField\r\n                                label=\"Tenant Notes\"\r\n                                value={duplicatedPremises.tenantNotes}\r\n                                onChange={onChangeTenantNotes}\r\n                                styles={textFieldNotesStyles}\r\n                                multiline\r\n                                autoAdjustHeight\r\n                            />\r\n\r\n                        </Stack>\r\n                    </>\r\n                )\r\n\r\n\r\n            default:\r\n            // code block\r\n        }\r\n\r\n    }\r\n\r\n    return (\r\n        <div>\r\n\r\n\r\n            <Modal\r\n                styles={modalStyles}\r\n\r\n                titleAriaId={titleId}\r\n                isOpen={showDuplicatePremisesModal}\r\n                /*  onDismiss={hideDuplicatePremisesModal} */\r\n                isBlocking={false}\r\n                containerClassName={contentStyles.container}\r\n            /* dragOptions={dragOptions} */\r\n            >\r\n                <div className={contentStyles.header}>\r\n                    <span id={titleId}>New Premises</span>\r\n                    <Stack horizontal\r\n                        styles={headerIconStackStyles}\r\n                    >\r\n\r\n                        <IconButton\r\n                            styles={iconButtonStyles}\r\n                            iconProps={saveIcon}\r\n                            ariaLabel=\"Save Premises\"\r\n                            onClick={saveDuplicatedPremises}\r\n                        />\r\n                        <IconButton\r\n                            styles={iconButtonStyles}\r\n                            iconProps={cancelIcon}\r\n                            ariaLabel=\"Close popup modal\"\r\n                            onClick={hideDuplicatePremisesModal}\r\n                        />\r\n\r\n                    </Stack>\r\n\r\n                </div>\r\n                <div className={contentStyles.body} >\r\n\r\n                    <Stack tokens={stackTokens}>\r\n\r\n                        <Pivot\r\n                            aria-label=\"Separately Rendered Content Pivot Example\"\r\n                            selectedKey={selectedKey}\r\n                            // eslint-disable-next-line react/jsx-no-bind\r\n                            onLinkClick={handleLinkClick}\r\n                            headersOnly={true}\r\n                            getTabId={getTabId}\r\n                        >\r\n                            <PivotItem headerText=\"Premises Details\" itemKey=\"Premises Details\" />\r\n                            <PivotItem headerText=\"Rental Details\" itemKey=\"Rental Details\" />\r\n                            <PivotItem headerText=\"Parking Details\" itemKey=\"Parking Details\" />\r\n                            <PivotItem headerText=\"Tenant Details\" itemKey=\"Tenant Details\" />\r\n                        </Pivot>\r\n\r\n                        {DuplicatePremisesTab()}\r\n\r\n\r\n\r\n\r\n\r\n                    </Stack>\r\n\r\n\r\n                </div>\r\n            </Modal>\r\n        </div>\r\n    );\r\n};\r\n\r\nconst theme = getTheme();\r\nconst contentStyles = mergeStyleSets({\r\n    container: {\r\n        display: 'flex',\r\n        flexFlow: 'column nowrap',\r\n        alignItems: 'stretch',\r\n        /*  width: 525, */\r\n\r\n    },\r\n\r\n    header: [\r\n\r\n        theme.fonts.xLargePlus,\r\n        {\r\n            flex: '1 1 auto',\r\n            borderTop: `4px solid ${theme.palette.themePrimary}`,\r\n            color: theme.palette.neutralPrimary,\r\n            display: 'flex',\r\n            alignItems: 'center',\r\n            fontWeight: FontWeights.semibold,\r\n            padding: '12px 12px 14px 24px',\r\n        },\r\n    ],\r\n    body: {\r\n        flex: '4 4 auto',\r\n        padding: '0 24px 24px 24px',\r\n        overflowY: 'hidden',\r\n        selectors: {\r\n            p: { margin: '14px 0' },\r\n            'p:first-child': { marginTop: 0 },\r\n            'p:last-child': { marginBottom: 0 },\r\n        },\r\n    },\r\n});\r\n\r\nconst iconButtonStyles = {\r\n    root: {\r\n        color: theme.palette.neutralPrimary,\r\n        marginLeft: \"10px !important\",\r\n        marginTop: '4px',\r\n        marginRight: '2px',\r\n\r\n    },\r\n    rootHovered: {\r\n        color: theme.palette.neutralDark,\r\n    },\r\n    icon: {\r\n        fontSize: \"24px\",\r\n\r\n    }\r\n};\r\n\r\nexport default DuplicatePremisesModal\r\n","C:\\Users\\ruper\\Desktop\\Web\\Own Projects\\Property Stock App V2\\psafrontendv2\\src\\components\\PremisesNotesModal.tsx",["583","584","585","586","587","588","589","590","591","592","593","594","595"],"import * as React from 'react';\r\nimport { useId, useBoolean } from '@uifabric/react-hooks';\r\nimport {\r\n    getTheme,\r\n    mergeStyleSets,\r\n    FontWeights,\r\n    ContextualMenu,\r\n    Toggle,\r\n    DefaultButton,\r\n    Modal,\r\n    IModalStyles,\r\n    IDragOptions,\r\n    IconButton,\r\n    IIconProps,\r\n    ILayerProps,\r\n    IModalProps,\r\n    Stack,\r\n    Text,\r\n    IStackStyles\r\n} from 'office-ui-fabric-react';\r\n\r\nimport { GET_SINGLE_PROPERTY, } from \"../gql/gql\"\r\nimport { Query, NavigationState } from \"../schematypes/schematypes\"\r\nimport { useQuery, } from '@apollo/client';\r\nimport { navigationState as navigationStateVar } from \"../reactivevariables/reactivevariables\"\r\n\r\n\r\n\r\n\r\n\r\ntype Maybe<T> = T | null;\r\nconst cancelIcon: IIconProps = { iconName: 'Cancel' };\r\n\r\ninterface Props {\r\n    propertyId: number\r\n    premisesId: number\r\n    showPremisesNotesModal: boolean;\r\n    /* imagesArray: Maybe<string>[] */\r\n}\r\n\r\nconst PremisesNotesModal: React.FC<Props> = ({ showPremisesNotesModal, propertyId, premisesId }) => {\r\n\r\n\r\n\r\n    const {\r\n        data: propertyData,\r\n        loading: propertyLoading,\r\n        error: propertyError\r\n    } = useQuery<Query>(GET_SINGLE_PROPERTY, {\r\n        variables: { propertyId: propertyId },\r\n    });\r\n\r\n    const getPremises = propertyData?.singleProperty?.premisesList!.find(premises => premises?.premisesId === premisesId);\r\n\r\n\r\n    /* const {\r\n      data: navigationStateData,\r\n      loading: navigationLoading,\r\n      error: navigationError\r\n    } = useQuery<Query>(GET_NAV_STATE);\r\n  \r\n    \r\n  const navStateQuery =() => {\r\n      const {\r\n          data: navigationStateData,\r\n          loading: navigationLoading,\r\n          error: navigationError\r\n        } = useQuery<Query>(GET_NAV_STATE);\r\n  \r\n  } */\r\n\r\n\r\n    /* console.log(navigationStateData?.navigationState) */\r\n\r\n    const hidePremisesNotesModal = () => {\r\n        navigationStateVar({ ...navigationStateVar(), showPremisesNotesModal: false })\r\n    }\r\n\r\n    \r\n\r\n    const modalStyles: Partial<IModalStyles> = { main: { position: \"absolute\", top: 150 }, };\r\n\r\n    const boldStyle = { root: { fontWeight: FontWeights.semibold } };\r\n    const notesHeadingStyles = { alignSelf: \"start\", fontSize: \"18px\", paddingLeft: \"15px\" }\r\n    const notesStyles = { alignSelf: \"start\", fontSize: \"14px\", paddingLeft: \"15px\", marginLeft:20 }\r\n\r\n    const featuresStyles = { alignSelf: \"start\", fontSize: \"14px\", paddingLeft: \"15px\" }\r\n    const featuresHeadingStyles = { alignSelf: \"start\", fontSize: \"14px\", paddingLeft: \"15px\" }\r\n\r\n    /* const onLayerDidMount: ILayerProps ={\r\n        onLayerDidMount: true\r\n    } */\r\n\r\n    // Use useId() to ensure that the IDs are unique on the page.\r\n    // (It's also okay to use plain strings and manually ensure uniqueness.)\r\n    const titleId = useId('Notes&Features');\r\n\r\n    return (\r\n        <div>\r\n\r\n            <Modal\r\n                titleAriaId={titleId}\r\n                isOpen={showPremisesNotesModal}\r\n                /* onDismiss={hideImageGalleryModal} */\r\n                isBlocking={true}\r\n                containerClassName={contentStyles.container}\r\n                styles={modalStyles}\r\n            /* modalProps={modalProps} */\r\n            /*  layerProps={onLayerDidMount} */\r\n\r\n            >\r\n                <div className={contentStyles.header}>\r\n                    <span id={titleId}>{`Notes & Features`}</span>\r\n                    <IconButton\r\n                        styles={iconButtonStyles}\r\n                        iconProps={cancelIcon}\r\n                        ariaLabel={\"Close Notes & Features Modal\"}\r\n                        onClick={hidePremisesNotesModal}\r\n                    />\r\n                </div>\r\n                <div className={contentStyles.body}>\r\n\r\n                    <Stack verticalFill styles={{\r\n                        root: {\r\n                            marginTop: \"0 !important\",\r\n                            marginBottom: 20,\r\n                        },\r\n                    }}\r\n                        gap={15}>\r\n                        <Text styles={boldStyle} style={notesHeadingStyles}>Industrial Features:</Text>\r\n                        <Stack horizontal styles={{\r\n                        root: {\r\n                            marginLeft:20\r\n                        },\r\n                    }}>\r\n                            <Text styles={boldStyle} style={featuresHeadingStyles}>Yard Size:</Text>\r\n                            <Text /* styles={boldStyle} */ style={featuresStyles}>{`${getPremises?.yard} m²`}</Text>\r\n\r\n                            <Text styles={boldStyle} style={featuresHeadingStyles}>Floor to Eave Height:</Text>\r\n                            <Text /* styles={boldStyle} */ style={featuresStyles}>{`${getPremises?.height} m`}</Text>\r\n\r\n                            <Text styles={boldStyle} style={featuresHeadingStyles}>No of Doors:</Text>\r\n                            <Text /* styles={boldStyle} */ style={featuresStyles}>{`${getPremises?.doors}`}</Text>\r\n                        </Stack>\r\n\r\n                        <Stack horizontal styles={{\r\n                        root: {\r\n                            marginLeft:20\r\n                        },\r\n                    }}>\r\n                            <Text styles={boldStyle} style={featuresHeadingStyles}>Loading Type:</Text>\r\n                            <Text /* styles={boldStyle} */ style={featuresStyles}>{`${getPremises?.loading}`}</Text>\r\n\r\n                            <Text styles={boldStyle} style={featuresHeadingStyles}>Sprinkler Type:</Text>\r\n                            <Text /* styles={boldStyle} */ style={featuresStyles}>{`${getPremises?.sprinklered}`}</Text>\r\n\r\n                            \r\n                        </Stack>\r\n\r\n                        <Stack horizontal styles={{\r\n                        root: {\r\n                            marginLeft:20\r\n                        },\r\n                    }}>\r\n                            <Text styles={boldStyle} style={featuresHeadingStyles}>Canopy Details:</Text>\r\n                            <Text /* styles={boldStyle} */ style={featuresStyles}>{`${getPremises?.canopies}`}</Text>\r\n\r\n                            <Text styles={boldStyle} style={featuresHeadingStyles}>Power:</Text>\r\n                            <Text /* styles={boldStyle} */ style={featuresStyles}>{`${getPremises?.power}`}</Text>\r\n\r\n                            \r\n                        </Stack>\r\n\r\n\r\n\r\n                    </Stack>\r\n\r\n                    <Stack verticalFill styles={{\r\n                        root: {\r\n                            marginTop: \"0 !important\",\r\n                            marginBottom: 20,\r\n                        },\r\n                    }}\r\n                        gap={15}>\r\n                        <Text styles={boldStyle} style={notesHeadingStyles}>Premises Notes:</Text>\r\n                        <Text /* styles={boldStyle} */ style={notesStyles}>{getPremises?.premisesNotes}</Text>\r\n\r\n\r\n                    </Stack>\r\n\r\n                    <Stack verticalFill styles={{\r\n                        root: {\r\n                            marginTop: \"0 !important\"\r\n                        },\r\n                    }}\r\n                        gap={15}>\r\n                        <Text styles={boldStyle} style={notesHeadingStyles}>Tenant Notes:</Text>\r\n                        <Text /* styles={boldStyle} */ style={notesStyles}>{getPremises?.tenantNotes}</Text>\r\n\r\n\r\n                    </Stack>\r\n\r\n\r\n\r\n                </div>\r\n            </Modal>\r\n        </div>\r\n    );\r\n};\r\n\r\nconst theme = getTheme();\r\nconst contentStyles = mergeStyleSets({\r\n    container: {\r\n        display: 'flex',\r\n        flexFlow: 'column nowrap',\r\n        alignItems: 'stretch',\r\n        width: 550\r\n    },\r\n    header: [\r\n\r\n        theme.fonts.xLargePlus,\r\n        {\r\n            flex: '1 1 auto',\r\n            borderTop: `4px solid ${theme.palette.themePrimary}`,\r\n            color: theme.palette.neutralPrimary,\r\n            display: 'flex',\r\n            alignItems: 'center',\r\n            fontWeight: FontWeights.semibold,\r\n            padding: '12px 12px 14px 24px',\r\n        },\r\n    ],\r\n    body: {\r\n        flex: '4 4 auto',\r\n        padding: '0 24px 24px 24px',\r\n        overflowY: 'hidden',\r\n        selectors: {\r\n            p: { margin: '14px 0' },\r\n            'p:first-child': { marginTop: 0 },\r\n            'p:last-child': { marginBottom: 0 },\r\n        },\r\n    },\r\n});\r\nconst toggleStyles = { root: { marginBottom: '20px' } };\r\nconst iconButtonStyles = {\r\n    root: {\r\n        color: theme.palette.neutralPrimary,\r\n        marginLeft: 'auto',\r\n        marginTop: '4px',\r\n        marginRight: '2px',\r\n    },\r\n    rootHovered: {\r\n        color: theme.palette.neutralDark,\r\n    },\r\n};\r\n\r\nexport default PremisesNotesModal","C:\\Users\\ruper\\Desktop\\Web\\Own Projects\\Property Stock App V2\\psafrontendv2\\src\\components\\UpdatePremisesModal.tsx",["596","597","598","599","600","601","602","603","604","605","606","607","608","609","610","611","612","613","614","615","616","617","618","619","620","621","622","623","624","625","626","627","628","629"],"import React, { useState } from 'react';\r\nimport { useId, useBoolean } from '@uifabric/react-hooks';\r\nimport { TextField, ITextFieldStyles } from 'office-ui-fabric-react/lib/TextField';\r\nimport { Dropdown, DropdownMenuItemType, IDropdownOption, IDropdownStyles } from 'office-ui-fabric-react/lib/Dropdown';\r\nimport { Slider } from 'office-ui-fabric-react/lib/Slider';\r\nimport { IStackStyles, Stack } from 'office-ui-fabric-react/lib/Stack';\r\nimport { IRenderFunction, IStyleFunctionOrObject } from 'office-ui-fabric-react/lib/Utilities';\r\nimport {\r\n    getTheme,\r\n    mergeStyleSets,\r\n    FontWeights,\r\n    ContextualMenu,\r\n    Toggle,\r\n    IToggleStyles,\r\n    DefaultButton,\r\n    Modal,\r\n    IDragOptions,\r\n    IconButton,\r\n    IIconProps,\r\n    IModalStyles,\r\n    mergeStyles,\r\n    ComboBox,\r\n    Fabric,\r\n    IComboBoxOption,\r\n    IComboBox,\r\n    SelectableOptionMenuItemType,\r\n    IComboBoxStyles,\r\n    DatePicker,\r\n    DayOfWeek,\r\n    IDatePickerStrings,\r\n    IDatePickerStyleProps,\r\n    IDatePickerStyles,\r\n    ICalendarProps\r\n} from 'office-ui-fabric-react';\r\nimport { Pivot, PivotItem } from 'office-ui-fabric-react/lib/Pivot';\r\nimport { defaultDataIdFromObject, gql, useMutation, useQuery } from '@apollo/client';\r\nimport { GET_SINGLE_PROPERTY, UPDATE_PREMISES, GET_NAV_STATE } from \"../gql/gql\"\r\nimport { Mutation, MutationUpdatePremisesArgs, Query, Property, Premises } from \"../schematypes/schematypes\"\r\nimport { navigationState } from \"../reactivevariables/reactivevariables\"\r\nimport \"./NewPremisesModal.css\"\r\n\r\n\r\n\r\n\r\nconst dragOptions: IDragOptions = {\r\n    moveMenuItemText: 'Move',\r\n    closeMenuItemText: 'Close',\r\n    menu: ContextualMenu,\r\n};\r\nconst cancelIcon: IIconProps = { iconName: 'Cancel' };\r\nconst saveIcon: IIconProps = { iconName: 'Save' };\r\n\r\ninterface Props {\r\n    propertyId: number;\r\n    premisesId: number\r\n    showUpdatePremisesModal: boolean;\r\n}\r\n\r\nexport const UpdatePremisesModal: React.FC<Props> = ({ showUpdatePremisesModal, propertyId, premisesId }) => {\r\n\r\n\r\n\r\n    const {\r\n        data: propertyData,\r\n        loading: propertyLoading,\r\n        error: propertyError\r\n    } = useQuery<Query>(GET_SINGLE_PROPERTY, {\r\n        variables: { propertyId: propertyId },\r\n    });\r\n\r\n\r\n    const getPremises = propertyData?.singleProperty?.premisesList!.find(premises => premises?.premisesId === premisesId);\r\n    const handlePremisesData = React.useCallback(() => {\r\n        if (getPremises !== undefined && getPremises !== null) {\r\n            return { ...getPremises, openRatio: getPremises.openBays! / (getPremises.area! / 100), coveredRatio: getPremises.coveredBays! / (getPremises.area! / 100), shadedRatio: getPremises.shadedBays! / (getPremises.area! / 100), }\r\n        } else {\r\n            return {\r\n                floor: \"\",\r\n                area: 0,\r\n                vacant: \"true\",\r\n                type: \"\",\r\n                premisesIndex: 0,\r\n                occupation: getNextMonth(),\r\n                premisesNotes: \"\",\r\n                netRental: 0,\r\n                opCosts: 0,\r\n                other: 0,\r\n                grossRental: 0,\r\n                esc: 0,\r\n                openBays: 0,\r\n                openRate: 0,\r\n                openRatio: 0,\r\n                coveredBays: 0,\r\n                coveredRate: 0,\r\n                coveredRatio: 0,\r\n                shadedBays: 0,\r\n                shadedRate: 0,\r\n                shadedRatio: 0,\r\n                parkingRatio: 0,\r\n                tenantName: \"-\",\r\n                leaseExpiry: getNextMonth(),\r\n                tenantNotes: \"\",\r\n                yard: 0,\r\n                height: 0,\r\n                doors: 0,\r\n                loading: \"\",\r\n                sprinklered: \"\",\r\n                canopies: \"\",\r\n                power: \"\",\r\n\r\n            }\r\n        }\r\n    }, [getPremises])\r\n\r\n\r\n    React.useEffect(() => {\r\n        setUpdatedPremises(handlePremisesData)\r\n        setSelectedPremisesType({ key: handlePremisesData().type!, text: handlePremisesData().type! })\r\n        setSelectedPremisesIndex(({ key: handlePremisesData().premisesIndex!, text: String(handlePremisesData().premisesIndex!) }))\r\n\r\n    }, [handlePremisesData])\r\n\r\n\r\n\r\n\r\n    const hideUpdatePremisesModal = () => {\r\n\r\n        navigationState({ ...navigationState(), showUpdatePremisesModal: false })\r\n\r\n    }\r\n\r\n    const getNextMonth = () => {\r\n        const date = new Date();\r\n        const today = date.getDate();\r\n        const currentMonth = date.getMonth() + 1;\r\n        const currentYear = date.getFullYear();\r\n        var newDate = new Date(currentYear, currentMonth, 1);\r\n        return newDate.toISOString()\r\n\r\n    }\r\n\r\n\r\n    const [updatedPremises, setUpdatedPremises] = React.useState<any>(\r\n        {\r\n            floor: \"\",\r\n            area: 0,\r\n            vacant: \"true\",\r\n            type: \"\",\r\n            premisesIndex: 0,\r\n            occupation: getNextMonth(),\r\n            premisesNotes: \"\",\r\n            netRental: 0,\r\n            opCosts: 0,\r\n            other: 0,\r\n            grossRental: 0,\r\n            esc: 0,\r\n            openBays: 0,\r\n            openRate: 0,\r\n            openRatio: 0,\r\n            coveredBays: 0,\r\n            coveredRate: 0,\r\n            coveredRatio: 0,\r\n            shadedBays: 0,\r\n            shadedRate: 0,\r\n            shadedRatio: 0,\r\n            parkingRatio: 0,\r\n            tenantName: \"-\",\r\n            leaseExpiry: getNextMonth(),\r\n            tenantNotes: \"\",\r\n            yard: 0,\r\n            height: 0,\r\n            doors: 0,\r\n            loading: \"\",\r\n            sprinklered: \"\",\r\n            canopies: \"\",\r\n            power: \"\",\r\n\r\n        });\r\n\r\n\r\n\r\n\r\n    const [updatePremises, { data }] = useMutation<Mutation, MutationUpdatePremisesArgs>(UPDATE_PREMISES);\r\n\r\n    const saveUpdatedPremises = () => {\r\n\r\n        updatePremises({\r\n            variables: {\r\n                premisesId: premisesId,\r\n                floor: updatedPremises.floor,\r\n                area: updatedPremises.area,\r\n                vacant: updatedPremises.vacant,\r\n                type: updatedPremises.type,\r\n                premisesIndex: updatedPremises.premisesIndex,\r\n                occupation: updatedPremises.occupation,\r\n                premisesNotes: updatedPremises.premisesNotes,\r\n                netRental: updatedPremises.netRental,\r\n                opCosts: updatedPremises.opCosts,\r\n                other: updatedPremises.other,\r\n                grossRental: updatedPremises.grossRental,\r\n                esc: updatedPremises.esc,\r\n                openBays: updatedPremises.openBays,\r\n                openRate: updatedPremises.openRate,\r\n                coveredBays: updatedPremises.coveredBays,\r\n                coveredRate: updatedPremises.coveredRate,\r\n                shadedBays: updatedPremises.shadedBays,\r\n                shadedRate: updatedPremises.shadedRate,\r\n                parkingRatio: updatedPremises.parkingRatio,\r\n                tenantName: updatedPremises.tenantName,\r\n                leaseExpiry: updatedPremises.leaseExpiry,\r\n                tenantNotes: updatedPremises.tenantNotes,\r\n                yard: updatedPremises.yard,\r\n                height: updatedPremises.height,\r\n                doors: updatedPremises.doors,\r\n                loading: updatedPremises.loading,\r\n                sprinklered: updatedPremises.sprinklered,\r\n                canopies: updatedPremises.canopies,\r\n                power: updatedPremises.power,\r\n            },\r\n\r\n            update(cache, { data }) {\r\n\r\n                if (!data) {\r\n                    return null;\r\n                }\r\n\r\n                const getExistingProperty = cache.readQuery<Query>({ query: GET_SINGLE_PROPERTY, variables: { propertyId: propertyId } })\r\n                const existingProperty: Property = getExistingProperty ? getExistingProperty.singleProperty! : { propertyId: 1, propertyName: \"\" };\r\n\r\n                const existingPremises = getExistingProperty ? getExistingProperty.singleProperty?.premisesList : [];\r\n                const filteredPremises = existingPremises?.filter(premises => {\r\n                    return premises.premisesId !== premisesId\r\n                })\r\n\r\n                const updatedPremises = data.updatePremises\r\n\r\n                const newPremisesList = [...filteredPremises!, updatedPremises]\r\n\r\n                const newProperty = { ...existingProperty, premisesList: newPremisesList }\r\n                if (existingPremises)\r\n                    cache.writeQuery<Query>({\r\n                        query: GET_SINGLE_PROPERTY,\r\n                        variables: { propertyId: propertyId },\r\n                        data: { singleProperty: newProperty }\r\n                    });\r\n            }\r\n\r\n\r\n        })\r\n        hideUpdatePremisesModal()\r\n\r\n\r\n\r\n    }\r\n\r\n\r\n\r\n    /* const [isModalOpen, { setTrue: showModal, setFalse: hideModal }] = useBoolean(false);\r\n    const [isDraggable, { toggle: toggleIsDraggable }] = useBoolean(false); */\r\n\r\n    // Use useId() to ensure that the IDs are unique on the page.\r\n    // (It's also okay to use plain strings and manually ensure uniqueness.)\r\n\r\n\r\n    const textFieldStyles: Partial<ITextFieldStyles> = { fieldGroup: { width: 200, marginRight: 20 } };\r\n    const textFieldFloorStyles: Partial<ITextFieldStyles> = { fieldGroup: { width: 200, marginRight: 20 } };\r\n    const textFieldAreaStyles: Partial<ITextFieldStyles> = { fieldGroup: { width: 150, marginRight: 20 } };\r\n    const textFieldYardStyles: Partial<ITextFieldStyles> = { fieldGroup: { width: 125, marginRight: 20 } };\r\n    const textFieldPowerStyles: Partial<ITextFieldStyles> = { fieldGroup: { width: 200, marginRight: 20 } };\r\n    const textFieldEscStyles: Partial<ITextFieldStyles> = { fieldGroup: { width: 150, marginRight: 20 } };\r\n    const textFieldCoordinatesStyles: Partial<ITextFieldStyles> = { fieldGroup: { width: 150, marginRight: 20 } };\r\n    const textFieldErfStyles: Partial<ITextFieldStyles> = { fieldGroup: { width: 200, marginRight: 20 } };\r\n    const textFieldNotesStyles: Partial<ITextFieldStyles> = { fieldGroup: { width: 470 } };\r\n    const dropdownStyles: Partial<IDropdownStyles> = { dropdown: { width: 125, marginRight: 20 } };\r\n    const dropdownSectorStyles: Partial<IDropdownStyles> = { dropdown: { width: 420, marginRight: 20 } };\r\n    const dropdownProvinceStyles: Partial<IDropdownStyles> = { dropdown: { width: 140, marginRight: 20 } };\r\n    const comboBoxStyles: Partial<IComboBoxStyles> = { root: { width: 140, marginRight: 20 } }\r\n\r\n    const textFieldParkingBaysStyles: Partial<ITextFieldStyles> = { fieldGroup: { width: 100, marginRight: 20 } };\r\n    const textFieldParkingRateStyles: Partial<ITextFieldStyles> = { fieldGroup: { width: 185, marginRight: 20 } };\r\n    const textFieldParkingRatioStyles: Partial<ITextFieldStyles> = { fieldGroup: { width: 140, marginRight: 20 } };\r\n\r\n    const toggleStyles: Partial<IToggleStyles> = { container: { marginTop: 5 }, label: { marginLeft: 4 } };\r\n    const modalStyles: Partial<IModalStyles> = { main: { position: \"absolute\", top: 150 }, };\r\n\r\n    const datePickerStyles: IStyleFunctionOrObject<IDatePickerStyleProps, IDatePickerStyles> = { root: { width: 160, marginRight: 20 }, callout: {} }\r\n\r\n    /* const calendarProps: ICalendarProps ={styles  } */\r\n\r\n\r\n\r\n    const headerIconStackStyles: Partial<IStackStyles> = { root: { marginRight: 0, marginLeft: \"auto\", } }\r\n\r\n    const DayPickerStrings: IDatePickerStrings = {\r\n        months: [\r\n            'January',\r\n            'February',\r\n            'March',\r\n            'April',\r\n            'May',\r\n            'June',\r\n            'July',\r\n            'August',\r\n            'September',\r\n            'October',\r\n            'November',\r\n            'December',\r\n        ],\r\n\r\n        shortMonths: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],\r\n\r\n        days: ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'],\r\n\r\n        shortDays: ['S', 'M', 'T', 'W', 'T', 'F', 'S'],\r\n\r\n        goToToday: 'Go to today',\r\n        prevMonthAriaLabel: 'Go to previous month',\r\n        nextMonthAriaLabel: 'Go to next month',\r\n        prevYearAriaLabel: 'Go to previous year',\r\n        nextYearAriaLabel: 'Go to next year',\r\n        closeButtonAriaLabel: 'Close date picker',\r\n        monthPickerHeaderAriaLabel: '{0}, select to change the year',\r\n        yearPickerHeaderAriaLabel: '{0}, select to change the month',\r\n    };\r\n\r\n    const controlClass = mergeStyleSets({\r\n        control: {\r\n            margin: '0 0 15px 0',\r\n            maxWidth: '300px',\r\n        },\r\n\r\n    });\r\n\r\n    const premisesTypeOptions = [\r\n\r\n        { key: 'Office', text: 'Office' },\r\n        { key: 'Warehouse', text: 'Warehouse' },\r\n        { key: 'Retail', text: 'Retail' },\r\n        { key: 'Stores', text: 'Stores' },\r\n        { key: 'Balcony', text: 'Balcony' },\r\n    ];\r\n\r\n    const premisesIndexOptions = [\r\n\r\n        { key: 1, text: \"1\" },\r\n        { key: 2, text: \"2\" },\r\n        { key: 3, text: \"3\" },\r\n        { key: 4, text: \"4\" },\r\n        { key: 5, text: \"5\" },\r\n        { key: 6, text: \"6\" },\r\n    ];\r\n\r\n\r\n\r\n    const [selectedPremisesType, setSelectedPremisesType] = React.useState<IDropdownOption>();\r\n    const [selectedPremisesIndex, setSelectedPremisesIndex] = React.useState<IDropdownOption>();\r\n\r\n\r\n    const onChangePremisesType = (event: React.FormEvent<HTMLDivElement>, item: IDropdownOption | undefined): void => {\r\n        if (item !== undefined) {\r\n            setSelectedPremisesType(item);\r\n            setUpdatedPremises({ ...updatedPremises, type: item.text });\r\n        }\r\n    };\r\n\r\n    const onChangePremisesIndex = (event: React.FormEvent<HTMLDivElement>, item: IDropdownOption | undefined): void => {\r\n        if (item !== undefined) {\r\n            setSelectedPremisesIndex(item);\r\n            setUpdatedPremises({ ...updatedPremises, premisesIndex: parseInt(item.text) });\r\n        }\r\n    };\r\n\r\n\r\n    const stackTokens = { childrenGap: 15 };\r\n\r\n\r\n\r\n    const onChangeFloor = React.useCallback(\r\n        (event: React.FormEvent<HTMLInputElement | HTMLTextAreaElement>, newValue?: string) => {\r\n            setUpdatedPremises({ ...updatedPremises, floor: newValue || '' });\r\n        },\r\n        [updatedPremises],\r\n    );\r\n\r\n    const onChangeArea = React.useCallback(\r\n        (event: React.FormEvent<HTMLInputElement | HTMLTextAreaElement>, newValue?: string) => {\r\n            console.log(newValue)\r\n            setUpdatedPremises({ ...updatedPremises, area: parseFloat(newValue!) || 0 });\r\n        },\r\n        [updatedPremises],\r\n    );\r\n\r\n\r\n    const handleChecked = () => {\r\n        if (updatedPremises.vacant === \"false\") {\r\n            return false\r\n        } else {\r\n            return true\r\n        }\r\n\r\n    }\r\n\r\n    const onChangeVacantToggle = React.useCallback(\r\n        (ev: React.MouseEvent<HTMLElement>, checked: boolean | undefined) => {\r\n            if (updatedPremises.vacant === \"false\") {\r\n                setUpdatedPremises({ ...updatedPremises, vacant: \"true\" });\r\n\r\n            } else {\r\n                setUpdatedPremises({ ...updatedPremises, vacant: \"false\" });\r\n            }\r\n        },\r\n        [updatedPremises])\r\n\r\n    const onSelectOccupationDate = React.useCallback(\r\n        (date: Date | null | undefined) => {\r\n            if (date !== undefined && date !== null)\r\n                setUpdatedPremises({ ...updatedPremises, occupation: date.toISOString() });\r\n        },\r\n        [updatedPremises])\r\n\r\n    const onFormatDate = (date?: Date): string => {\r\n        return !date ? '' : date.toLocaleDateString(\r\n            'en-gb',\r\n            {\r\n                year: 'numeric',\r\n                month: 'long',\r\n                day: 'numeric'\r\n            }\r\n        );\r\n    };\r\n\r\n\r\n\r\n    const onChangePremisesNotes = React.useCallback(\r\n        (event: React.FormEvent<HTMLInputElement | HTMLTextAreaElement>, newValue?: string) => {\r\n            setUpdatedPremises({ ...updatedPremises, premisesNotes: newValue || '' });\r\n        },\r\n        [updatedPremises],\r\n    );\r\n\r\n    const onChangeNetRental = React.useCallback(\r\n        (event: React.FormEvent<HTMLInputElement | HTMLTextAreaElement>, newValue?: string) => {\r\n            setUpdatedPremises({ ...updatedPremises, netRental: parseFloat(newValue!) || 0 });\r\n        },\r\n        [updatedPremises],\r\n    );\r\n\r\n    const onChangeOpCosts = React.useCallback(\r\n        (event: React.FormEvent<HTMLInputElement | HTMLTextAreaElement>, newValue?: string) => {\r\n            setUpdatedPremises({ ...updatedPremises, opCosts: parseFloat(newValue!) || 0 });\r\n        },\r\n        [updatedPremises],\r\n    );\r\n\r\n    const onChangeOther = React.useCallback(\r\n        (event: React.FormEvent<HTMLInputElement | HTMLTextAreaElement>, newValue?: string) => {\r\n            setUpdatedPremises({ ...updatedPremises, other: parseFloat(newValue!) || 0 });\r\n        },\r\n        [updatedPremises],\r\n    );\r\n\r\n    const onChangeGrossRental = React.useCallback(\r\n        (event: React.FormEvent<HTMLInputElement | HTMLTextAreaElement>, newValue?: string) => {\r\n            setUpdatedPremises({ ...updatedPremises, grossRental: parseFloat(newValue!) || 0 });\r\n        },\r\n        [updatedPremises],\r\n    );\r\n\r\n    const onChangeEsc = React.useCallback(\r\n        (event: React.FormEvent<HTMLInputElement | HTMLTextAreaElement>, newValue?: string) => {\r\n            setUpdatedPremises({ ...updatedPremises, esc: parseFloat(newValue!) || 0 });\r\n        },\r\n        [updatedPremises],\r\n    );\r\n\r\n    const getOpenBays = (ratio: number) => {\r\n        return (ratio * (updatedPremises.area / 100))\r\n    }\r\n\r\n    const getOpenRatio = (bays: number) => {\r\n        return (bays / (updatedPremises.area / 100))\r\n    }\r\n\r\n    const getCoveredBays = (ratio: number) => {\r\n        return (ratio * (updatedPremises.area / 100))\r\n    }\r\n\r\n    const getCoveredRatio = (bays: number) => {\r\n        return (bays / (updatedPremises.area / 100))\r\n    }\r\n\r\n    const getShadedBays = (ratio: number) => {\r\n        return (ratio * (updatedPremises.area / 100))\r\n    }\r\n\r\n    const getShadedRatio = (bays: number) => {\r\n        return (bays / (updatedPremises.area / 100))\r\n    }\r\n\r\n    const onChangeOpenBays = React.useCallback(\r\n        (event: React.FormEvent<HTMLInputElement | HTMLTextAreaElement>, newValue?: string) => {\r\n            setUpdatedPremises({ ...updatedPremises, openBays: parseFloat(newValue!) || 0, openRatio: getOpenRatio(parseFloat(newValue!)) });\r\n        },\r\n        [updatedPremises],\r\n    );\r\n\r\n    const onChangeOpenRate = React.useCallback(\r\n        (event: React.FormEvent<HTMLInputElement | HTMLTextAreaElement>, newValue?: string) => {\r\n            setUpdatedPremises({ ...updatedPremises, openRate: parseFloat(newValue!) || 0 });\r\n        },\r\n        [updatedPremises],\r\n    );\r\n\r\n\r\n    const onChangeOpenRatio = React.useCallback(\r\n        (event: React.FormEvent<HTMLInputElement | HTMLTextAreaElement>, newValue?: string) => {\r\n            setUpdatedPremises({ ...updatedPremises, openRatio: parseFloat(newValue!) || 0, openBays: getOpenBays(parseFloat(newValue!)) });\r\n        },\r\n        [updatedPremises],\r\n    );\r\n\r\n    const onChangeCoveredBays = React.useCallback(\r\n        (event: React.FormEvent<HTMLInputElement | HTMLTextAreaElement>, newValue?: string) => {\r\n            setUpdatedPremises({ ...updatedPremises, coveredBays: parseFloat(newValue!) || 0, coveredRatio: getCoveredRatio(parseFloat(newValue!)) });\r\n        },\r\n        [updatedPremises],\r\n    );\r\n\r\n    const onChangeCoveredRate = React.useCallback(\r\n        (event: React.FormEvent<HTMLInputElement | HTMLTextAreaElement>, newValue?: string) => {\r\n            setUpdatedPremises({ ...updatedPremises, coveredRate: parseFloat(newValue!) || 0 });\r\n        },\r\n        [updatedPremises],\r\n    );\r\n\r\n    const onChangeCoveredRatio = React.useCallback(\r\n        (event: React.FormEvent<HTMLInputElement | HTMLTextAreaElement>, newValue?: string) => {\r\n            setUpdatedPremises({ ...updatedPremises, coveredRatio: parseFloat(newValue!) || 0, coveredBays: getCoveredBays(parseFloat(newValue!)) });\r\n        },\r\n        [updatedPremises],\r\n    );\r\n\r\n    const onChangeShadedBays = React.useCallback(\r\n        (event: React.FormEvent<HTMLInputElement | HTMLTextAreaElement>, newValue?: string) => {\r\n            setUpdatedPremises({ ...updatedPremises, shadedBays: parseFloat(newValue!) || 0, shadedRatio: getShadedRatio(parseFloat(newValue!)) });\r\n        },\r\n        [updatedPremises],\r\n    );\r\n\r\n    const onChangeShadedRate = React.useCallback(\r\n        (event: React.FormEvent<HTMLInputElement | HTMLTextAreaElement>, newValue?: string) => {\r\n            setUpdatedPremises({ ...updatedPremises, shadedRate: parseFloat(newValue!) || 0 });\r\n        },\r\n        [updatedPremises],\r\n    );\r\n\r\n    const onChangeShadedRatio = React.useCallback(\r\n        (event: React.FormEvent<HTMLInputElement | HTMLTextAreaElement>, newValue?: string) => {\r\n            setUpdatedPremises({ ...updatedPremises, shadedRatio: parseFloat(newValue!) || 0, shadedBays: getShadedBays(parseFloat(newValue!)) });\r\n        },\r\n        [updatedPremises],\r\n    );\r\n\r\n    const onChangeParkingRatio = React.useCallback(\r\n        (event: React.FormEvent<HTMLInputElement | HTMLTextAreaElement>, newValue?: string) => {\r\n            setUpdatedPremises({ ...updatedPremises, parkingRatio: parseFloat(newValue!) || 0 });\r\n        },\r\n        [updatedPremises],\r\n    );\r\n\r\n    const onChangeTenantName = React.useCallback(\r\n        (event: React.FormEvent<HTMLInputElement | HTMLTextAreaElement>, newValue?: string) => {\r\n            setUpdatedPremises({ ...updatedPremises, tenantName: newValue || '' });\r\n        },\r\n        [updatedPremises],\r\n    );\r\n\r\n    const onSelectLeaseExpiry = React.useCallback(\r\n        (date: Date | null | undefined) => {\r\n            if (date !== undefined && date !== null)\r\n                setUpdatedPremises({ ...updatedPremises, leaseExpiry: date.toISOString() });\r\n        },\r\n        [updatedPremises])\r\n\r\n    const onChangeTenantNotes = React.useCallback(\r\n        (event: React.FormEvent<HTMLInputElement | HTMLTextAreaElement>, newValue?: string) => {\r\n            setUpdatedPremises({ ...updatedPremises, tenantNotes: newValue || '' });\r\n        },\r\n        [updatedPremises],\r\n    );\r\n\r\n    const onChangeYard = React.useCallback(\r\n        (event: React.FormEvent<HTMLInputElement | HTMLTextAreaElement>, newValue?: string) => {\r\n            setUpdatedPremises({ ...updatedPremises, yard: parseFloat(newValue!) || 0 });\r\n        },\r\n        [updatedPremises],\r\n    );\r\n\r\n    const onChangeHeight = React.useCallback(\r\n        (event: React.FormEvent<HTMLInputElement | HTMLTextAreaElement>, newValue?: string) => {\r\n            setUpdatedPremises({ ...updatedPremises, height: parseFloat(newValue!) || 0 });\r\n        },\r\n        [updatedPremises],\r\n    );\r\n\r\n    const onChangeDoors = React.useCallback(\r\n        (event: React.FormEvent<HTMLInputElement | HTMLTextAreaElement>, newValue?: string) => {\r\n            setUpdatedPremises({ ...updatedPremises, doors: parseFloat(newValue!) || 0 });\r\n        },\r\n        [updatedPremises],\r\n    );\r\n\r\n    const onChangeLoading = React.useCallback(\r\n        (event: React.FormEvent<HTMLInputElement | HTMLTextAreaElement>, newValue?: string) => {\r\n            setUpdatedPremises({ ...updatedPremises, loading: newValue || '' });\r\n        },\r\n        [updatedPremises],\r\n    );\r\n\r\n    const onChangeSprinklered = React.useCallback(\r\n        (event: React.FormEvent<HTMLInputElement | HTMLTextAreaElement>, newValue?: string) => {\r\n            setUpdatedPremises({ ...updatedPremises, sprinklered: newValue || '' });\r\n        },\r\n        [updatedPremises],\r\n    );\r\n\r\n    const onChangeCanopies = React.useCallback(\r\n        (event: React.FormEvent<HTMLInputElement | HTMLTextAreaElement>, newValue?: string) => {\r\n            setUpdatedPremises({ ...updatedPremises, canopies: newValue || '' });\r\n        },\r\n        [updatedPremises],\r\n    );\r\n\r\n    const onChangePower = React.useCallback(\r\n        (event: React.FormEvent<HTMLInputElement | HTMLTextAreaElement>, newValue?: string) => {\r\n            setUpdatedPremises({ ...updatedPremises, power: newValue || '' });\r\n        },\r\n        [updatedPremises],\r\n    );\r\n\r\n\r\n\r\n\r\n    /* const onChangeCoordinates = React.useCallback(\r\n        (event: React.FormEvent<HTMLInputElement | HTMLTextAreaElement>, newValue?: string) => {\r\n            setNewProperty({ ...newProperty, coordinates: newValue || '' });\r\n        },\r\n        [newProperty],\r\n    );\r\n    const onChangeErfExtent = React.useCallback(\r\n        (event: React.FormEvent<HTMLInputElement | HTMLTextAreaElement>, newValue?: string) => {\r\n            setNewProperty({ ...newProperty, erfExtent: parseInt(newValue!) || 0 });\r\n        },\r\n        [newProperty],\r\n    );\r\n    const onChangeTotalGLA = React.useCallback(\r\n        (event: React.FormEvent<HTMLInputElement | HTMLTextAreaElement>, newValue?: string) => {\r\n            setNewProperty({ ...newProperty, totalGLA: parseInt(newValue!) || 0 });\r\n        },\r\n        [newProperty],\r\n    );\r\n    const onChangeNotes = React.useCallback(\r\n        (event: React.FormEvent<HTMLInputElement | HTMLTextAreaElement>, newValue?: string) => {\r\n            setNewProperty({ ...newProperty, notes: newValue || '' });\r\n        },\r\n        [newProperty],\r\n    ); */\r\n\r\n    const [selectedKey, setSelectedKey] = React.useState('Premises Details');\r\n\r\n    const handleLinkClick = (item?: PivotItem, ev?: React.MouseEvent<HTMLElement>) => {\r\n\r\n        setSelectedKey(item!.props.itemKey!);\r\n    };\r\n\r\n    const getTabId = (itemKey: string | undefined) => {\r\n        return `NewPremisesPivot_${itemKey}`;\r\n    };\r\n\r\n    const titleId = useId('title');\r\n\r\n\r\n\r\n    const updatePremisesTab = () => {\r\n\r\n        switch (selectedKey) {\r\n            case \"Premises Details\":\r\n                return (\r\n                    <>\r\n                        <Stack horizontal /* style={{marginLeft: 50}} */\r\n                            styles={{\r\n                                root: {\r\n                                    /* width: '400px', */\r\n                                    /*  margin: '10px', */\r\n\r\n                                    color: '#605e5c',\r\n\r\n                                    marginLeft: \"0px\",\r\n                                    marginRight: \"auto\",\r\n                                    /* display: \"block\" */\r\n\r\n                                }\r\n\r\n                            }}>\r\n                            <TextField\r\n                                label=\"Floor/Unit\"\r\n                                value={updatedPremises.floor}\r\n                                onChange={onChangeFloor}\r\n                                styles={textFieldFloorStyles}\r\n\r\n                            />\r\n                            <TextField\r\n                                label=\"Area\"\r\n                                type=\"number\"\r\n                                value={updatedPremises.area === 0 ? \"\" : String(updatedPremises.area)}\r\n                                onChange={onChangeArea}\r\n                                styles={textFieldAreaStyles}\r\n                                suffix=\"m²\"\r\n                            />\r\n\r\n                            <Toggle styles={toggleStyles} label=\"Vacant?\" checked={handleChecked()} onChange={onChangeVacantToggle} />\r\n\r\n\r\n\r\n                        </Stack>\r\n\r\n                        <Stack horizontal styles={{\r\n                            root: {\r\n                                /* width: '400px', */\r\n                                /*  margin: '10px', */\r\n\r\n                                color: '#605e5c',\r\n\r\n                                marginLeft: \"0px\",\r\n                                marginRight: \"auto\",\r\n                                /* display: \"block\" */\r\n\r\n                            }\r\n\r\n                        }}>\r\n\r\n                            <Dropdown\r\n                                label=\"Premises Type\"\r\n                                selectedKey={selectedPremisesType ? selectedPremisesType.key : undefined}\r\n                                // eslint-disable-next-line react/jsx-no-bind\r\n                                onChange={onChangePremisesType}\r\n                                placeholder=\"Select type\"\r\n                                options={premisesTypeOptions}\r\n                                styles={dropdownStyles}\r\n                            />\r\n\r\n                            <Dropdown\r\n                                label=\"Premises Index\"\r\n                                selectedKey={selectedPremisesIndex ? selectedPremisesIndex.key : undefined}\r\n                                // eslint-disable-next-line react/jsx-no-bind\r\n                                onChange={onChangePremisesIndex}\r\n                                placeholder=\"Select index\"\r\n                                options={premisesIndexOptions}\r\n                                styles={dropdownStyles}\r\n                            />\r\n\r\n                            <DatePicker\r\n                                label=\"Occupation Date\"\r\n                                className={controlClass.control}\r\n                                firstDayOfWeek={DayOfWeek.Monday}\r\n                                strings={DayPickerStrings}\r\n                                placeholder=\"Select a date...\"\r\n                                ariaLabel=\"Select a date\"\r\n                                value={new Date(updatedPremises.occupation)}\r\n                                onSelectDate={onSelectOccupationDate}\r\n                                formatDate={onFormatDate}\r\n                                styles={datePickerStyles}\r\n\r\n                            />\r\n\r\n                        </Stack>\r\n\r\n                        <Stack horizontal>\r\n\r\n                            <TextField\r\n                                label=\"Premises Notes\"\r\n                                value={updatedPremises.premisesNotes}\r\n                                onChange={onChangePremisesNotes}\r\n                                styles={textFieldNotesStyles}\r\n                                multiline\r\n                                autoAdjustHeight\r\n                            />\r\n\r\n                        </Stack>\r\n                    </>\r\n                )\r\n\r\n            case \"Rental Details\":\r\n\r\n                return (\r\n                    <>\r\n                        <Stack horizontal\r\n                            styles={{\r\n                                root: {\r\n                                    /* width: '400px', */\r\n                                    /*  margin: '10px', */\r\n\r\n                                    color: '#605e5c',\r\n\r\n                                    marginLeft: \"auto\",\r\n                                    marginRight: \"auto\",\r\n                                    /* display: \"block\" */\r\n\r\n                                }\r\n                            }}>\r\n                            <TextField\r\n                                label=\"Net Rental\"\r\n                                type=\"number\"\r\n                                value={updatedPremises.netRental === 0 ? \"\" : String(updatedPremises.netRental)}\r\n                                onChange={onChangeNetRental}\r\n                                styles={textFieldFloorStyles}\r\n\r\n                                prefix=\"R\"\r\n                                suffix=\"/m²/month\"\r\n                            />\r\n                            <TextField\r\n                                label=\"Op Costs\"\r\n                                type=\"number\"\r\n                                value={updatedPremises.opCosts === 0 ? \"\" : String(updatedPremises.opCosts)}\r\n                                onChange={onChangeOpCosts}\r\n                                styles={textFieldFloorStyles}\r\n                                prefix=\"R\"\r\n                                suffix=\"/m²/month\"\r\n                            />\r\n\r\n                        </Stack>\r\n\r\n                        <Stack horizontal\r\n                            styles={{\r\n                                root: {\r\n                                    /* width: '400px', */\r\n                                    /*  margin: '10px', */\r\n\r\n                                    color: '#605e5c',\r\n\r\n                                    marginLeft: \"auto\",\r\n                                    marginRight: \"auto\",\r\n                                    /* display: \"block\" */\r\n\r\n                                }\r\n                            }}>\r\n                            <TextField\r\n                                label=\"Other\"\r\n                                type=\"number\"\r\n                                value={updatedPremises.other === 0 ? \"\" : String(updatedPremises.other)}\r\n                                onChange={onChangeOther}\r\n                                styles={textFieldFloorStyles}\r\n                                prefix=\"R\"\r\n                                suffix=\"/m²/month\"\r\n                            />\r\n                            <TextField\r\n                                label=\"Gross Rental\"\r\n                                type=\"number\"\r\n                                value={updatedPremises.grossRental === 0 ? \"\" : String(updatedPremises.grossRental)}\r\n                                onChange={onChangeGrossRental}\r\n                                styles={textFieldFloorStyles}\r\n                                prefix=\"R\"\r\n                                suffix=\"/m²/month\"\r\n                            />\r\n\r\n\r\n\r\n                        </Stack>\r\n\r\n                        <Stack horizontal\r\n                            styles={{\r\n                                root: {\r\n                                    /* width: '400px', */\r\n                                    /*  margin: '10px', */\r\n\r\n                                    color: '#605e5c',\r\n\r\n                                    marginLeft: \"auto\",\r\n                                    marginRight: \"auto\",\r\n                                    /* display: \"block\" */\r\n\r\n                                }\r\n                            }}>\r\n\r\n\r\n                            <TextField\r\n                                label=\"Esc\"\r\n                                type=\"number\"\r\n                                value={updatedPremises.esc === 0 ? \"\" : String(updatedPremises.esc)}\r\n                                onChange={onChangeEsc}\r\n                                styles={textFieldEscStyles}\r\n                                suffix=\"% per annum\"\r\n                            />\r\n\r\n                        </Stack>\r\n                    </>\r\n                )\r\n\r\n            case \"Parking Details\":\r\n\r\n                return (\r\n                    <>\r\n                        <Stack horizontal\r\n                            styles={{\r\n                                root: {\r\n                                    /* width: '400px', */\r\n                                    /*  margin: '10px', */\r\n\r\n                                    color: '#605e5c',\r\n\r\n                                    marginLeft: \"auto\",\r\n                                    marginRight: \"auto\",\r\n                                    /* display: \"block\" */\r\n\r\n                                }\r\n                            }}>\r\n                            <TextField\r\n                                label=\"Open Bays\"\r\n                                type=\"number\"\r\n                                value={updatedPremises.openBays === 0 ? \"\" : String(updatedPremises.openBays)}\r\n                                onChange={onChangeOpenBays}\r\n                                styles={textFieldParkingBaysStyles}\r\n                                suffix=\"bays\"\r\n                            />\r\n                            <TextField\r\n                                label=\"Open Rate\"\r\n                                type=\"number\"\r\n                                value={updatedPremises.openRate === 0 ? \"\" : String(updatedPremises.openRate)}\r\n                                onChange={onChangeOpenRate}\r\n                                styles={textFieldParkingRateStyles}\r\n                                prefix=\"R\"\r\n                                suffix=\"/bay/month\"\r\n                            />\r\n\r\n                            <TextField\r\n                                label=\"Open Ratio\"\r\n                                type=\"number\"\r\n                                value={updatedPremises.openRatio === 0 ? \"\" : String(updatedPremises.openRatio.toFixed(1).replace(/[.,]0$/, \"\"))}\r\n                                onChange={onChangeOpenRatio}\r\n                                styles={textFieldParkingRatioStyles}\r\n\r\n                                suffix=\"bays/100m²\"\r\n                            />\r\n\r\n                        </Stack>\r\n\r\n                        <Stack horizontal\r\n                            styles={{\r\n                                root: {\r\n                                    /* width: '400px', */\r\n                                    /*  margin: '10px', */\r\n\r\n                                    color: '#605e5c',\r\n\r\n                                    marginLeft: \"auto\",\r\n                                    marginRight: \"auto\",\r\n                                    /* display: \"block\" */\r\n\r\n                                }\r\n                            }}>\r\n                            <TextField\r\n                                label=\"Covered Bays\"\r\n                                type=\"number\"\r\n                                value={updatedPremises.coveredBays === 0 ? \"\" : String(updatedPremises.coveredBays)}\r\n                                onChange={onChangeCoveredBays}\r\n                                styles={textFieldParkingBaysStyles}\r\n                                suffix=\"bays\"\r\n                            />\r\n                            <TextField\r\n                                label=\"Covered Rate\"\r\n                                type=\"number\"\r\n                                value={updatedPremises.coveredRate === 0 ? \"\" : String(updatedPremises.coveredRate)}\r\n                                onChange={onChangeCoveredRate}\r\n                                styles={textFieldParkingRateStyles}\r\n                                prefix=\"R\"\r\n                                suffix=\"/bay/month\"\r\n                            />\r\n\r\n                            <TextField\r\n                                label=\"Covered Ratio\"\r\n                                type=\"number\"\r\n                                value={updatedPremises.coveredRatio === 0 ? \"\" : String(updatedPremises.coveredRatio.toFixed(1).replace(/[.,]0$/, \"\"))}\r\n                                onChange={onChangeCoveredRatio}\r\n                                styles={textFieldParkingRatioStyles}\r\n\r\n                                suffix=\"bays/100m²\"\r\n                            />\r\n\r\n\r\n\r\n                        </Stack>\r\n\r\n                        <Stack horizontal\r\n                            styles={{\r\n                                root: {\r\n                                    /* width: '400px', */\r\n                                    /*  margin: '10px', */\r\n\r\n                                    color: '#605e5c',\r\n\r\n                                    marginLeft: \"auto\",\r\n                                    marginRight: \"auto\",\r\n                                    /* display: \"block\" */\r\n\r\n                                }\r\n                            }}>\r\n\r\n\r\n                            <TextField\r\n                                label=\"Shaded Bays\"\r\n                                type=\"number\"\r\n                                value={updatedPremises.shadedBays === 0 ? \"\" : String(updatedPremises.shadedBays)}\r\n                                onChange={onChangeShadedBays}\r\n                                styles={textFieldParkingBaysStyles}\r\n                                suffix=\"bays\"\r\n                            />\r\n                            <TextField\r\n                                label=\"Shaded Rate\"\r\n                                type=\"number\"\r\n                                value={updatedPremises.shadedRate === 0 ? \"\" : String(updatedPremises.shadedRate)}\r\n                                onChange={onChangeShadedRate}\r\n                                styles={textFieldParkingRateStyles}\r\n                                prefix=\"R\"\r\n                                suffix=\"/bay/month\"\r\n                            />\r\n\r\n                            <TextField\r\n                                label=\"Shaded Ratio\"\r\n                                type=\"number\"\r\n                                value={updatedPremises.shadedRatio === 0 ? \"\" : String(updatedPremises.shadedRatio.toFixed(1).replace(/[.,]0$/, \"\"))}\r\n                                onChange={onChangeShadedRatio}\r\n                                styles={textFieldParkingRatioStyles}\r\n\r\n                                suffix=\"bays/100m²\"\r\n                            />\r\n\r\n                        </Stack>\r\n                        <Stack horizontal\r\n                            styles={{\r\n                                root: {\r\n                                    /* width: '400px', */\r\n                                    /*  margin: '10px', */\r\n\r\n                                    color: '#605e5c',\r\n\r\n                                    marginLeft: \"auto\",\r\n                                    marginRight: \"auto\",\r\n                                    /* display: \"block\" */\r\n\r\n                                }\r\n                            }}>\r\n\r\n\r\n                            <TextField\r\n                                label=\"Parking Ratio\"\r\n                                type=\"number\"\r\n                                value={updatedPremises.parkingRatio === 0 ? \"\" : String(updatedPremises.parkingRatio.toFixed(1).replace(/[.,]0$/, \"\"))}\r\n                                onChange={onChangeParkingRatio}\r\n                                styles={textFieldFloorStyles}\r\n\r\n                                suffix=\"bays/100m²\"\r\n                            />\r\n\r\n\r\n                        </Stack>\r\n                    </>\r\n                )\r\n\r\n            case \"Industrial Features\":\r\n\r\n                return (\r\n                    <>\r\n\r\n\r\n                        <Stack horizontal styles={{\r\n                            root: {\r\n                                color: '#605e5c',\r\n                                marginLeft: \"auto\",\r\n                                marginRight: \"auto\",\r\n                            }\r\n                        }}>\r\n\r\n                            <TextField\r\n                                label=\"Yard Size\"\r\n                                value={updatedPremises.yard === 0 ? \"\" : String(updatedPremises.yard)}\r\n                                onChange={onChangeYard}\r\n                                styles={textFieldYardStyles}\r\n                                suffix=\"m²\"\r\n\r\n                            />\r\n\r\n                            <TextField\r\n                                label=\"Floor to Eave Height\"\r\n                                value={updatedPremises.height === 0 ? \"\" : String(updatedPremises.height)}\r\n                                onChange={onChangeHeight}\r\n                                styles={textFieldYardStyles}\r\n                                suffix=\"m\"\r\n                            />\r\n\r\n                            <TextField\r\n                                label=\"No of Doors\"\r\n                                value={updatedPremises.doors === 0 ? \"\" : String(updatedPremises.doors)}\r\n                                onChange={onChangeDoors}\r\n                                styles={textFieldYardStyles}\r\n\r\n                            />\r\n\r\n\r\n\r\n                        </Stack>\r\n\r\n                        <Stack horizontal styles={{\r\n                            root: {\r\n                                color: '#605e5c',\r\n                                marginLeft: \"auto\",\r\n                                marginRight: \"auto\",\r\n                            }\r\n                        }}>\r\n\r\n                            <TextField\r\n                                label=\"Loading Type\"\r\n                                value={updatedPremises.loading === \"\" ? \"\" : updatedPremises.loading}\r\n                                onChange={onChangeLoading}\r\n                                styles={textFieldPowerStyles}\r\n\r\n                            />\r\n\r\n                            <TextField\r\n                                label=\"Sprinkler Type\"\r\n                                value={updatedPremises.sprinklered === \"\" ? \"\" : updatedPremises.sprinklered}\r\n                                onChange={onChangeSprinklered}\r\n                                styles={textFieldPowerStyles}\r\n\r\n                            />\r\n\r\n                        </Stack>\r\n\r\n                        <Stack horizontal styles={{\r\n                            root: {\r\n                                color: '#605e5c',\r\n                                marginLeft: \"auto\",\r\n                                marginRight: \"auto\",\r\n                            }\r\n                        }}>\r\n\r\n                            <TextField\r\n                                label=\"Canopy Details\"\r\n                                value={updatedPremises.canopies === \"\" ? \"\" : updatedPremises.canopies}\r\n                                onChange={onChangeCanopies}\r\n                                styles={textFieldPowerStyles}\r\n\r\n                            />\r\n\r\n                            <TextField\r\n                                label=\"Power\"\r\n                                value={updatedPremises.power === \"\" ? \"\" : updatedPremises.power}\r\n                                onChange={onChangePower}\r\n                                styles={textFieldPowerStyles}\r\n\r\n                            />\r\n\r\n                        </Stack>\r\n                    </>\r\n                )\r\n\r\n\r\n            case \"Tenant Details\":\r\n\r\n                return (\r\n                    <>\r\n\r\n\r\n                        <Stack horizontal styles={{\r\n                            root: {\r\n                                /* width: '400px', */\r\n                                /*  margin: '10px', */\r\n\r\n                                color: '#605e5c',\r\n\r\n                                marginLeft: \"0px\",\r\n                                marginRight: \"auto\",\r\n                                /* display: \"block\" */\r\n\r\n                            }\r\n\r\n                        }}>\r\n\r\n                            <TextField\r\n                                label=\"Tenant Name\"\r\n                                value={updatedPremises.tenantName === \"-\" ? \"\" : updatedPremises.tenantName}\r\n                                onChange={onChangeTenantName}\r\n                                styles={textFieldFloorStyles}\r\n\r\n                            />\r\n\r\n                            <DatePicker\r\n                                label=\"Lease Expiry Date\"\r\n                                className={controlClass.control}\r\n                                firstDayOfWeek={DayOfWeek.Monday}\r\n                                strings={DayPickerStrings}\r\n                                placeholder=\"Select a date...\"\r\n                                ariaLabel=\"Select a date\"\r\n                                value={new Date(updatedPremises.leaseExpiry)}\r\n                                onSelectDate={onSelectLeaseExpiry}\r\n                                formatDate={onFormatDate}\r\n                                styles={datePickerStyles}\r\n\r\n                            />\r\n\r\n                        </Stack>\r\n\r\n                        <Stack horizontal>\r\n\r\n                            <TextField\r\n                                label=\"Tenant Notes\"\r\n                                value={updatedPremises.tenantNotes}\r\n                                onChange={onChangeTenantNotes}\r\n                                styles={textFieldNotesStyles}\r\n                                multiline\r\n                                autoAdjustHeight\r\n                            />\r\n\r\n                        </Stack>\r\n                    </>\r\n                )\r\n\r\n\r\n            default:\r\n            // code block\r\n        }\r\n\r\n    }\r\n\r\n    return (\r\n        <div>\r\n\r\n\r\n            <Modal\r\n                styles={modalStyles}\r\n\r\n                titleAriaId={titleId}\r\n                isOpen={showUpdatePremisesModal}\r\n                /*  onDismiss={hideUpdatePremisesModal} */\r\n                isBlocking={false}\r\n                containerClassName={contentStyles.container}\r\n            /* dragOptions={dragOptions} */\r\n            >\r\n                <div className={contentStyles.header}>\r\n                    <span id={titleId}>Update Premises</span>\r\n                    <Stack horizontal\r\n                        styles={headerIconStackStyles}\r\n                    >\r\n\r\n                        <IconButton\r\n                            styles={iconButtonStyles}\r\n                            iconProps={saveIcon}\r\n                            ariaLabel=\"Save Premises\"\r\n                            onClick={saveUpdatedPremises}\r\n                        />\r\n                        <IconButton\r\n                            styles={iconButtonStyles}\r\n                            iconProps={cancelIcon}\r\n                            ariaLabel=\"Close popup modal\"\r\n                            onClick={hideUpdatePremisesModal}\r\n                        />\r\n\r\n                    </Stack>\r\n\r\n                </div>\r\n                <div className={contentStyles.body} >\r\n\r\n                    <Stack tokens={stackTokens}>\r\n\r\n                        <Pivot\r\n                            aria-label=\"Separately Rendered Content Pivot Example\"\r\n                            selectedKey={selectedKey}\r\n                            // eslint-disable-next-line react/jsx-no-bind\r\n                            onLinkClick={handleLinkClick}\r\n                            headersOnly={true}\r\n                            getTabId={getTabId}\r\n                            styles={{ link: {/* padding:0, margin:0, fontSize:14 */  marginRight: 20 }, linkIsSelected: {/* padding:0, margin:0, fontSize:14 */marginRight: 20 }, root: { marginLeft: \"auto\", marginRight: \"auto\" } }}\r\n                        >\r\n                            <PivotItem headerText=\"Premises\" itemKey=\"Premises Details\" />\r\n                            <PivotItem headerText=\"Rental\" itemKey=\"Rental Details\" />\r\n                            <PivotItem headerText=\"Parking\" itemKey=\"Parking Details\" />\r\n                            <PivotItem headerText=\"Industrial\" itemKey=\"Industrial Features\" />\r\n                            <PivotItem headerText=\"Tenant\" itemKey=\"Tenant Details\" />\r\n                        </Pivot>\r\n\r\n                        {updatePremisesTab()}\r\n\r\n\r\n\r\n\r\n\r\n                    </Stack>\r\n\r\n\r\n                </div>\r\n            </Modal>\r\n        </div>\r\n    );\r\n};\r\n\r\nconst theme = getTheme();\r\nconst contentStyles = mergeStyleSets({\r\n    container: {\r\n        display: 'flex',\r\n        flexFlow: 'column nowrap',\r\n        alignItems: 'stretch',\r\n        width: 525,\r\n\r\n    },\r\n\r\n    header: [\r\n\r\n        theme.fonts.xLargePlus,\r\n        {\r\n            flex: '1 1 auto',\r\n            borderTop: `4px solid ${theme.palette.themePrimary}`,\r\n            color: theme.palette.neutralPrimary,\r\n            display: 'flex',\r\n            alignItems: 'center',\r\n            fontWeight: FontWeights.semibold,\r\n            padding: '12px 12px 14px 24px',\r\n        },\r\n    ],\r\n    body: {\r\n        flex: '4 4 auto',\r\n        padding: '0 24px 24px 24px',\r\n        overflowY: 'hidden',\r\n        selectors: {\r\n            p: { margin: '14px 0' },\r\n            'p:first-child': { marginTop: 0 },\r\n            'p:last-child': { marginBottom: 0 },\r\n        },\r\n    },\r\n});\r\n\r\nconst iconButtonStyles = {\r\n    root: {\r\n        color: theme.palette.neutralPrimary,\r\n        marginLeft: \"10px !important\",\r\n        marginTop: '4px',\r\n        marginRight: '2px',\r\n\r\n    },\r\n    rootHovered: {\r\n        color: theme.palette.neutralDark,\r\n    },\r\n    icon: {\r\n        fontSize: \"24px\",\r\n\r\n    }\r\n};\r\n\r\nexport default UpdatePremisesModal\r\n","C:\\Users\\ruper\\Desktop\\Web\\Own Projects\\Property Stock App V2\\psafrontendv2\\src\\components\\ContactListItem.tsx",["630","631","632","633","634","635","636","637","638","639","640","641","642","643","644","645","646","647","648","649","650","651","652","653","654","655","656","657","658","659","660"],"import * as React from 'react';\r\nimport { getTheme } from '@fluentui/react';\r\nimport { TextField } from 'office-ui-fabric-react/lib/TextField';\r\nimport { Image, ImageFit } from 'office-ui-fabric-react/lib/Image';\r\nimport { Icon } from 'office-ui-fabric-react/lib/Icon';\r\nimport { Checkbox, ICheckboxProps } from 'office-ui-fabric-react/lib/Checkbox';\r\nimport { Query, Property, Mutation, MutationDeleteLandlordContactArgs, MutationUpdateLandlordContactArgs, LandlordContact } from \"../schematypes/schematypes\"\r\nimport { GET_SELECTED_PROPERTIES, GET_PROPERTIES, DELETE_PROPERTY, DELETE_LANDLORD_CONTACT, UPDATE_LANDLORD_CONTACT, GET_LANDLORDS } from \"../gql/gql\"\r\nimport { gql, useMutation, useQuery } from '@apollo/client';\r\nimport { selectedPropertyList } from \"../reactivevariables/reactivevariables\"\r\nimport { mergeStyles, registerIcons } from 'office-ui-fabric-react/lib/Styling';\r\nimport { CommandBarButton, IContextualMenuProps, Stack, Text, FontWeights, IconButton, IIconProps, IStackStyles, initializeIcons, DefaultButton, FocusTrapCallout, FocusZone, PrimaryButton, mergeStyleSets, ITextFieldStyles, DirectionalHint } from 'office-ui-fabric-react';\r\nimport { useBoolean } from '@uifabric/react-hooks';\r\nimport { IndustrialIcon, RetailIcon, OfficeIcon, MixedUseIcon } from \"../assets/svgIcons.js\"\r\nimport { FontIcon } from 'office-ui-fabric-react/lib/Icon';\r\nimport { navigationState } from \"../reactivevariables/reactivevariables\"\r\nimport \"./PropertyListItem.css\"\r\n\r\nimport { motion, AnimatePresence } from \"framer-motion\";\r\n\r\n\r\ninterface Props {\r\n  contact: LandlordContact\r\n  key: any\r\n  landlordId: number\r\n\r\n}\r\n\r\nexport const ContactListItem: React.FunctionComponent<Props> = ({ contact, landlordId }) => {\r\n\r\n\r\n\r\n\r\n  const [isDeleteCalloutVisible, { toggle: toggleIsDeleteCalloutVisible }] = useBoolean(false);\r\n\r\n  const [isEditContactCalloutVisible, { toggle: toggleIsEditContactCalloutVisible }] = useBoolean(false);\r\n\r\n  const [editContact, setEditContact] = React.useState({\r\n    name: contact?.name,\r\n    email: contact?.email,\r\n    mobileNo: contact?.mobileNo,\r\n    officeNo: contact?.officeNo,\r\n  })\r\n\r\n\r\n\r\n  const [deleteLandlordContact, { data: deleteLandlordContactData }] = useMutation<Mutation, MutationDeleteLandlordContactArgs>(DELETE_LANDLORD_CONTACT);\r\n\r\n  const deleteLandlordContactButton = () => {\r\n\r\n    deleteLandlordContact({\r\n      variables: {\r\n        contactId: contact.contactId\r\n      },\r\n      update(cache, { data }) {\r\n\r\n        if (!data) {\r\n            return null;\r\n        }\r\n\r\n        const getExistingLandlords = cache.readQuery<Query>({ query: GET_LANDLORDS });\r\n        // Add the new todo to the cache\r\n        const existingLandlords = getExistingLandlords ? getExistingLandlords.landlords : [];\r\n        const selectedLandlord = existingLandlords!.find(t => \r\n          t.landlordId === landlordId\r\n        )\r\n        const otherLandlords = existingLandlords!.filter (t => {\r\n          return t.landlordId !== landlordId\r\n        })\r\n        const existingContacts = selectedLandlord?.contactsList\r\n        const newContacts = existingContacts!.filter (t => {\r\n          return t.contactId !== contact.contactId\r\n        })\r\n       const updatedLandlord = {landlordId: selectedLandlord!.landlordId, landlordName: selectedLandlord!.landlordName , contactsList: [...newContacts ]}\r\n        if (existingLandlords)\r\n            cache.writeQuery<Query>({\r\n                query: GET_LANDLORDS,\r\n                data: { landlords: [updatedLandlord!, ...otherLandlords] }\r\n            });\r\n    }\r\n\r\n    })\r\n    toggleIsDeleteCalloutVisible()\r\n  }\r\n\r\n  const [updateLandlordContact, { data: updateLandlordData }] = useMutation<Mutation, MutationUpdateLandlordContactArgs>(UPDATE_LANDLORD_CONTACT);\r\n\r\n  const updateLandlordContactButton = () => {\r\n\r\n      updateLandlordContact({\r\n        variables: {\r\n          contactId: contact.contactId,\r\n          name: editContact.name,\r\n          email: editContact.email,\r\n          mobileNo: editContact.mobileNo,\r\n          officeNo: editContact.officeNo,\r\n        },\r\n\r\n        update(cache, { data }) {\r\n\r\n          if (!data) {\r\n              return null;\r\n          }\r\n  \r\n          const getExistingLandlords = cache.readQuery<Query>({ query: GET_LANDLORDS });\r\n          // Add the new todo to the cache\r\n          const existingLandlords = getExistingLandlords ? getExistingLandlords.landlords : [];\r\n          const selectedLandlord = existingLandlords!.find(t => \r\n            t.landlordId === landlordId\r\n          )\r\n          const otherLandlords = existingLandlords!.filter (t => {\r\n            return t.landlordId !== landlordId\r\n          })\r\n          const existingContacts = selectedLandlord?.contactsList\r\n          const otherContacts = existingContacts!.filter (t => {\r\n            return t.contactId !== contact.contactId\r\n          })\r\n          const newContact = data.updateLandlordContact\r\n         const updatedLandlord = {landlordId: selectedLandlord!.landlordId, landlordName: selectedLandlord!.landlordName , contactsList: [...otherContacts, newContact ]}\r\n          if (existingLandlords)\r\n              cache.writeQuery<Query>({\r\n                  query: GET_LANDLORDS,\r\n                  data: { landlords: [updatedLandlord!, ...otherLandlords] }\r\n              });\r\n      }\r\n\r\n    })\r\n    setEditContact(\r\n      {name: \"\",\r\n    email: \"\",\r\n    mobileNo: \"\",\r\n    officeNo: \"\"}\r\n    )\r\n    toggleIsEditContactCalloutVisible()\r\n  }\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n  /* const [deleteProperty, { data: deletePropertyData }] = useMutation<Mutation, MutationDeletePropertyArgs>(DELETE_PROPERTY);\r\n\r\n  const deletePropertyButton = () => {\r\n\r\n    deleteProperty({\r\n      variables: {\r\n        propertyId: property.propertyId\r\n      },\r\n      update(cache, { data }) {\r\n\r\n        if (!data) {\r\n          return null;\r\n        }\r\n\r\n        const getExistingProperties = cache.readQuery<Query>({ query: GET_PROPERTIES });\r\n        \r\n        const existingProperties = getExistingProperties ? getExistingProperties.properties : [];\r\n        const newProperties = existingProperties!.filter(t => {\r\n          if (t)\r\n            return (t.propertyId !== property.propertyId)\r\n        });  \r\n        if (existingProperties)\r\n          cache.writeQuery<Query>({\r\n            query: GET_PROPERTIES,\r\n            data: { properties: newProperties }\r\n          });\r\n      }\r\n\r\n    })\r\n\r\n  } */\r\n\r\n\r\n\r\n\r\n\r\n\r\n  const styles = mergeStyleSets({\r\n    /*  buttonArea: {\r\n       verticalAlign: 'top',\r\n       display: 'inline-block',\r\n       textAlign: 'center',\r\n       margin: '0 100px',\r\n       minWidth: 130,\r\n       height: 32,\r\n     }, */\r\n    callout: {\r\n      maxWidth: 400,\r\n    },\r\n    header: {\r\n      padding: '18px 24px 12px',\r\n    },\r\n    title: [\r\n      {\r\n        margin: 0,\r\n        fontWeight: FontWeights.bold,\r\n      },\r\n    ],\r\n    inner: {\r\n      height: '100%',\r\n      padding: '0 24px 20px',\r\n    },\r\n    actions: {\r\n      position: 'relative',\r\n      marginTop: 20,\r\n      width: '100%',\r\n      whiteSpace: 'nowrap',\r\n    },\r\n    buttons: {\r\n      display: 'flex',\r\n      justifyContent: 'flex-end',\r\n      padding: '0 24px 24px',\r\n    },\r\n    subtext: [\r\n      {\r\n        margin: 0,\r\n        fontWeight: FontWeights.semilight,\r\n      },\r\n    ],\r\n  });\r\n\r\n\r\n\r\n\r\n\r\n\r\n  const chevronClass = mergeStyles({\r\n    alignSelf: 'center',\r\n    marginLeft: 2,\r\n    /*  marginRight: 5, */\r\n    marginTop: \"0 !important\",\r\n    /* color: palette.neutralTertiary, */\r\n    fontSize: 20,\r\n    flexShrink: 0,\r\n    cursor: \"pointer\",\r\n    /* selectors: {\r\n      '&:hover': { \"transition\": \"all .2s ease-in-out\", transform: \"scale(1.1)\" },\r\n    }, */\r\n\r\n  });\r\n\r\n  const iconClass = mergeStyles({\r\n    fontSize: 50,\r\n    height: 50,\r\n    width: 50,\r\n\r\n\r\n    marginLeft: 15,\r\n    marginRight: 15,\r\n    marginTop: \"-10px !important\",\r\n    padding: \"5px\",\r\n\r\n\r\n\r\n  });\r\n\r\n  const chevronIconDiv = mergeStyles({\r\n    /* fontSize: 50, */\r\n    height: 40,\r\n    width: 40,\r\n    lineHeight: 40,\r\n    textAlign: \"center\",\r\n    marginLeft: 15,\r\n    marginRight: 15,\r\n    marginTop: \"0px !important\",\r\n    /* padding: \"5px\", */\r\n    selectors: {\r\n      '&:hover': { backgroundColor: \"rgb(0 13 255 / 14%)\", borderRadius: 30, \"transition\": \"all .2s ease-in-out\", transform: \"scale(1.2)\" },\r\n    },\r\n\r\n  });\r\n\r\n  const boldStyle = { root: { fontWeight: FontWeights.semibold } };\r\n  const propertyHeadingStyles = { alignSelf: \"start\", fontSize: \"23px\", padding: 5 }\r\n  const contactDetailsStyles = { alignSelf: \"start\", fontSize: \"14px\", padding: 5, width: \"100%\", display: \"flex\", }\r\n  const theme = getTheme();\r\n  const iconButtonStyles = {\r\n    root: {\r\n      color: theme.palette.neutralPrimary,\r\n      marginLeft: \"auto\",\r\n      marginTop: '0px !important',\r\n      marginBottom:0,\r\n      marginRight: 5,\r\n      width: 30,\r\n      height: 30,\r\n      /* visibility: isChecked() ? \"visible\" : \"hidden\", */\r\n\r\n    },\r\n    rootHovered: {\r\n      color: theme.palette.neutralDark,\r\n      backgroundColor: \"rgb(255 0 0 / 14%)\",\r\n      borderRadius: 30,\r\n      \"transition\": \"all .2s ease-in-out\", transform: \"scale(1.2)\"\r\n\r\n    },\r\n    icon: {\r\n      fontSize: \"18px\",\r\n      marginLeft: 6\r\n\r\n    }\r\n  };\r\n\r\n  const contactIconClass = mergeStyles({\r\n    transform: \"translateY(2px)\",\r\n    marginRight: 15,\r\n    fontSize: \"medium\"\r\n\r\n});\r\n\r\n  const deleteIcon: IIconProps = { iconName: 'Delete' };\r\n  const editIcon: IIconProps = { iconName: 'Edit' };\r\n\r\n  const textFieldContactStyles: Partial<ITextFieldStyles> = { fieldGroup: { width: 250 } };\r\n\r\n\r\n  const onChangeContactName = React.useCallback(\r\n    (event: React.FormEvent<HTMLInputElement | HTMLTextAreaElement>, newValue?: string) => {\r\n      setEditContact({ ...editContact, name: newValue! });\r\n    },\r\n    [editContact],\r\n  );\r\n\r\n  const onChangeContactEmail = React.useCallback(\r\n    (event: React.FormEvent<HTMLInputElement | HTMLTextAreaElement>, newValue?: string) => {\r\n      setEditContact({ ...editContact, email: newValue! });\r\n    },\r\n    [editContact],\r\n  );\r\n\r\n  const onChangeContactMobileNo = React.useCallback(\r\n    (event: React.FormEvent<HTMLInputElement | HTMLTextAreaElement>, newValue?: string) => {\r\n      setEditContact({ ...editContact, mobileNo: newValue! });\r\n    },\r\n    [editContact],\r\n  );\r\n\r\n  const onChangeContactOfficeNo = React.useCallback(\r\n    (event: React.FormEvent<HTMLInputElement | HTMLTextAreaElement>, newValue?: string) => {\r\n      setEditContact({ ...editContact, officeNo: newValue! });\r\n    },\r\n    [editContact],\r\n  );\r\n\r\n  return (\r\n\r\n\r\n\r\n    <Stack\r\n      horizontalAlign=\"start\"\r\n      verticalAlign=\"start\"\r\n      id=\"card\"\r\nverticalFill\r\n      styles={{\r\n        root: {\r\n          width: \"47%\",\r\n          marginBottom: 10,\r\n          marginLeft: \"auto !important\",\r\n          marginRight: \"auto\",\r\n          marginTop: 10,\r\n          padding: '10px',\r\n          textAlign: 'center',\r\n          color: '#605e5c',\r\n         /*  alignItems: \"center\", */\r\n          display: \"flex\",\r\n         /*  flexFlow: \"row\", */\r\n          /*  borderTop: \"4px solid #2557a2;\",\r\n           borderBottom: \"4px solid #2557a2;\", */\r\n          backgroundColor: \"white\",\r\n          background: /* isChecked() ? \"rgb(104 113 140 / 14%)\" : */ \"white\",\r\n          boxShadow: \"-1px 1px 7px 2px #d4cece\",\r\n          selectors: {\r\n            '&:hover': { background: /* palette.neutralLight */  \"rgb(104 113 140 / 14%)\" },\r\n          },\r\n\r\n        }\r\n      }}\r\n      gap={15}>\r\n\r\n\r\n\r\n     \r\n\r\n      <Stack styles={{ root: { paddingTop: 0, marginTop: \"0 !important\", marginBottom: \"auto\", width: \"100%\" } }} verticalFill>\r\n        <Text block={true} nowrap={true} style={contactDetailsStyles}><Icon className={contactIconClass} iconName=\"Contact\" /> {contact.name}</Text>\r\n        <Text block={true} nowrap={true} style={contactDetailsStyles}><Icon className={contactIconClass} iconName=\"Mail\" />{contact.email!.length <26? contact.email: `${contact.email?.slice(0,25)}...` }</Text>\r\n        <Text  style={contactDetailsStyles}><Icon className={contactIconClass} iconName=\"Phone\" />{contact.officeNo}</Text>\r\n        <Text  style={contactDetailsStyles}> <Icon className={contactIconClass} iconName=\"CellPhone\" />{contact.mobileNo}</Text>\r\n\r\n\r\n\r\n      </Stack>\r\n\r\n      <Stack styles={{root:{marginRight:5, marginLeft: \"auto !important\", marginTop:\"-30px !important\"}}} horizontal>\r\n\r\n      <IconButton\r\n        styles={iconButtonStyles}\r\n        id={`contactDeleteButton${contact.contactId}`}\r\n        iconProps={deleteIcon}\r\n        ariaLabel=\"Delete Contact\"\r\n        onClick={toggleIsDeleteCalloutVisible}\r\n      />\r\n      {isDeleteCalloutVisible ? (\r\n        <div>\r\n          <FocusTrapCallout\r\n            role=\"alertdialog\"\r\n            className={styles.callout}\r\n            gapSpace={0}\r\n            target={`#contactDeleteButton${contact.contactId}`}\r\n            onDismiss={toggleIsDeleteCalloutVisible}\r\n            setInitialFocus\r\n          >\r\n            <div className={styles.header}>\r\n              <Text className={styles.title}>Delete Contact</Text>\r\n            </div>\r\n            <div className={styles.inner}>\r\n              <div>\r\n                <Text className={styles.subtext}>\r\n                  Are you sure you want to delete this contact?\r\n                </Text>\r\n              </div>\r\n            </div>\r\n            <FocusZone>\r\n              <Stack className={styles.buttons} gap={8} horizontal>\r\n                <PrimaryButton onClick={deleteLandlordContactButton}>Confirm</PrimaryButton>\r\n                <DefaultButton onClick={toggleIsDeleteCalloutVisible}>Cancel</DefaultButton>\r\n              </Stack>\r\n            </FocusZone>\r\n          </FocusTrapCallout>\r\n        </div>\r\n      ) : null}\r\n\r\n      <IconButton\r\n        styles={iconButtonStyles}\r\n        id={`editContactButton${contact.contactId}`}\r\n        iconProps={editIcon}\r\n        ariaLabel=\"Edit Contact\"\r\n        onClick={toggleIsEditContactCalloutVisible}\r\n      />\r\n      {isEditContactCalloutVisible ? (\r\n          <div>\r\n            <FocusTrapCallout\r\n              role=\"alertdialog\"\r\n              className={styles.callout}\r\n              gapSpace={0}\r\n              target={`#editContactButton${contact.contactId}`}\r\n              onDismiss={toggleIsEditContactCalloutVisible}\r\n              setInitialFocus\r\n              directionalHint={DirectionalHint.bottomCenter}\r\n            >\r\n              <div className={styles.header}>\r\n                <Text className={styles.title}>Edit Contact</Text>\r\n              </div>\r\n              <div className={styles.inner}>\r\n                <div>\r\n\r\n                  <TextField\r\n                    styles={textFieldContactStyles}\r\n                    label=\"Name\"\r\n                    value={editContact.name}\r\n                    onChange={onChangeContactName}>\r\n                  </TextField>\r\n                  <TextField\r\n                    styles={textFieldContactStyles}\r\n                    label=\"Email\"\r\n                    value={editContact.email}\r\n                    onChange={onChangeContactEmail}>\r\n                  </TextField>\r\n                  <TextField\r\n                    styles={textFieldContactStyles}\r\n                    label=\"Mobile No\"\r\n                    value={editContact.mobileNo}\r\n                    onChange={onChangeContactMobileNo}>\r\n                  </TextField>\r\n                  <TextField\r\n                    styles={textFieldContactStyles}\r\n                    label=\"Office No\"\r\n                    value={editContact.officeNo}\r\n                    onChange={onChangeContactOfficeNo}>\r\n                  </TextField>\r\n                </div>\r\n              </div>\r\n              <FocusZone>\r\n                <Stack className={styles.buttons} gap={8} horizontal>\r\n                  <PrimaryButton onClick={updateLandlordContactButton}>Confirm</PrimaryButton>\r\n                  <DefaultButton onClick={toggleIsEditContactCalloutVisible}>Cancel</DefaultButton>\r\n                </Stack>\r\n              </FocusZone>\r\n            </FocusTrapCallout>\r\n          </div>\r\n        ) : null}\r\n\r\n\r\n      </Stack>\r\n      \r\n\r\n\r\n    </Stack>\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n  );\r\n};\r\n\r\nexport default ContactListItem","C:\\Users\\ruper\\Desktop\\Web\\Own Projects\\Property Stock App V2\\psafrontendv2\\src\\components\\PremisesList.tsx",["661","662","663","664","665","666","667","668","669"],"import * as React from 'react';\r\nimport { Image, ImageFit } from 'office-ui-fabric-react/lib/Image';\r\nimport { Icon } from 'office-ui-fabric-react/lib/Icon';\r\nimport { Checkbox, ICheckboxProps } from 'office-ui-fabric-react/lib/Checkbox';\r\nimport { Query, Property } from \"../schematypes/schematypes\"\r\nimport { useQuery } from '@apollo/client';\r\nimport { selectedPropertyList } from \"../reactivevariables/reactivevariables\"\r\nimport PremisesListItem from \"./PremisesListItem\"\r\nimport { Text, Stack, ITextStyles, IStyleFunctionOrObject, IconButton, IIconProps } from 'office-ui-fabric-react';\r\n/* import { DeepPartial  } from 'office-ui-fabric-react/lib/Styling'; */\r\nimport { TooltipHost, ITooltipHostStyles, ITooltipHostStyleProps, } from 'office-ui-fabric-react/lib/Tooltip';\r\nimport { useId } from '@uifabric/react-hooks';\r\nimport { getTheme } from '@fluentui/react';\r\nimport { navigationState } from \"../reactivevariables/reactivevariables\"\r\nconst calloutProps = { gapSpace: 0 };\r\n// The TooltipHost root uses display: inline by default.\r\n// If that's causing sizing issues or tooltip positioning issues, try overriding to inline-block.\r\n\r\n\r\n\r\n\r\n\r\n\r\ninterface Props {\r\n    singleProperty: Property | undefined\r\n}\r\n\r\nexport const PremisesList: React.FunctionComponent<Props> = ({ singleProperty }) => {\r\n\r\n   \r\n\r\n    const tooltipNetRentalId = useId('NetRental');\r\n    const tooltipOpCostsId = useId('NetRental');\r\n    const tooltipOtherId = useId('NetRental');\r\n    const tooltipGrossRentalId = useId('NetRental');\r\n    const tooltipOpenRateId = useId('NetRental');\r\n    const tooltipCoveredRateId = useId('NetRental');\r\n    const tooltipShadedRateId = useId('NetRental');\r\n    const tooltipEscId = useId('NetRental');\r\n    const tooltipParkingRatioId = useId('NetRental');\r\n\r\n    const tooltipHostStyles: IStyleFunctionOrObject<ITooltipHostStyleProps, ITooltipHostStyles> = { root: { display: \"flex\" } }\r\n\r\n    var originalPropertyData = singleProperty\r\n    var originalPremises = originalPropertyData!.premisesList!\r\n    var indexSortedPremises = originalPremises.slice().sort((a, b) => {\r\n        return (a.premisesIndex!) - (b.premisesIndex!)\r\n    });\r\n\r\n    var floorSortedPremises = indexSortedPremises.slice().sort((a, b) => {\r\n        var floorA = a.floor!.toUpperCase();\r\n        var floorB = b.floor!.toUpperCase();\r\n        if (floorA < floorB && a.premisesIndex=== b.premisesIndex) {\r\n            return -1;\r\n        }\r\n        if (floorA > floorB && a.premisesIndex=== b.premisesIndex) {\r\n            return 1;\r\n        }\r\n        return 0;\r\n    });\r\n\r\n\r\n    const tableCellStyles: ITextStyles = { root: { alignSelf: \"start\", fontSize: \"14px\", padding: 5, marginTop: \"auto !important\", marginBottom: \"auto\", width: 45, /* fontStyle : \"italic\", */ fontWeight: 600, } }\r\n    const tableCellTenantStyles: ITextStyles = { root: {height: 19, marginTop: \"9.5px !important\", marginBottom:9.5 , alignSelf: \"start\", fontSize: \"14px\", padding: 5,   /* fontStyle : \"italic\", */ fontWeight: 600, } }\r\n    const tableCellNotesStyles: ITextStyles = { root: {height: 19, marginTop: \"auto !important\", marginBottom:18 , alignSelf: \"start\", fontSize: \"14px\", padding: 5,   /* fontStyle : \"italic\", */ fontWeight: 600, } }\r\n    const tableHeadingStyles: ITextStyles = { root: { fontSize: \"18px\", paddingTop: 5, fontWeight: 600, } }\r\n    const tableCellBelowStyles: ITextStyles = { root: { alignSelf: \"start\", fontSize: \"10px\", padding: 0, marginTop: \"auto !important\", marginBottom: \"auto\", width: 50, } }\r\n    const theme = getTheme();\r\n    const iconButtonStyles = {\r\n        root: {\r\n            color: theme.palette.neutralPrimary,\r\n            marginLeft: 20,\r\n            marginTop: '0px !important',\r\n            marginRight: 5,\r\n            width: 35,\r\n            height: 35,\r\n            /*  visibility: isChecked() ? \"visible\" : \"hidden\", */\r\n\r\n        },\r\n        rootHovered: {\r\n            color: theme.palette.neutralDark,\r\n            backgroundColor: \"rgb(3 122 212 / 16%);\",\r\n            /* borderRadius: 30, */\r\n            \"transition\": \"all .2s ease-in-out\", transform: \"scale(1.1)\"\r\n\r\n        },\r\n        icon: {\r\n            fontSize: \"24px\",\r\n            marginLeft: 6\r\n\r\n        }\r\n    };\r\n\r\n    const addIcon: IIconProps = { iconName: 'Add' };\r\n\r\n    /* const onFilterChanged = (_: any, text: string): void => {\r\n      setItems(originalItems.filter(item => item.name.toLowerCase().indexOf(text.toLowerCase()) >= 0));\r\n    }; */\r\n\r\n    return (\r\n        <div>\r\n\r\n            <Stack\r\n                horizontalAlign=\"start\"\r\n                verticalAlign=\"start\"\r\n                id=\"premisesListHeadings\"\r\n\r\n                styles={{\r\n                    root: {\r\n                        width: \"fit-content\",\r\n                        marginBottom: 10,\r\n                        marginTop: 20,\r\n                        marginLeft: 20,\r\n                        marginRight: \"auto\",\r\n                        /* padding: '10px', */\r\n                        textAlign: 'center',\r\n                        color: '#605e5c',\r\n                        alignItems: \"center\",\r\n                        display: \"flex\",\r\n                        flexFlow: \"row\",\r\n                        /*  borderTop: \"4px solid #2557a2;\",\r\n                         borderBottom: \"4px solid #2557a2;\", */\r\n                        backgroundColor: \"white\",\r\n                        /*  background: isChecked() ? \"rgb(104 113 140 / 14%)\" : \"white\", */\r\n                        /* boxShadow: \"-1px 1px 7px 2px #d4cece\", */\r\n                        /* selectors: {\r\n                            '&:hover': { background:   \"rgb(104 113 140 / 14%)\" },\r\n                        }, */\r\n\r\n                    }\r\n                }}\r\n            >\r\n\r\n                {/*  <Stack verticalAlign=\"start\" horizontalAlign=\"start\" styles={{\r\n                    root: {\r\n                        textAlign: 'center',\r\n                        alignItems: \"center\",\r\n                        display: \"flex\",\r\n                        flexFlow: \"row\",\r\n                    }\r\n                }}>\r\n                    <div style={{ width: 50, display: \"flex\" }}></div>\r\n                    <div style={{ width: 350, display: \"flex\" }}>Premises Details</div>\r\n                    <div style={{ width: 250, display: \"flex\" }}>Rental Details</div>\r\n                    <div style={{ width: 390, display: \"flex\" }}>Parking Details</div>\r\n                    <div style={{ width: 275, display: \"flex\" }}>Tenant Details</div>\r\n                    <div style={{ width: 50, display: \"flex\" }}></div>\r\n\r\n\r\n\r\n\r\n\r\n\r\n                </Stack> */}\r\n\r\n                <Stack verticalAlign=\"start\" horizontalAlign=\"start\" styles={{\r\n                    root: {\r\n                        textAlign: 'center',\r\n                        alignItems: \"center\",\r\n                        display: \"flex\",\r\n                        flexFlow: \"row\",\r\n                    }\r\n                }}>\r\n\r\n                    <div style={{ width: 80, display: \"flex\" }}>\r\n                        <IconButton\r\n                            styles={iconButtonStyles}\r\n                            iconProps={addIcon}\r\n                            ariaLabel=\"Add Premises\"\r\n                            onClick={() => navigationState({ ...navigationState(), showNewPremisesModal: true })}\r\n                        />\r\n                    </div>\r\n\r\n\r\n                    <div style={{\r\n                        display: \"flex\",\r\n                        flexFlow: \"column\",\r\n                        borderTop: \"3px solid rgb(210 26 69 / 42%)\",\r\n                        borderRight: \"3px solid rgb(210 26 69 / 42%)\",\r\n                        borderLeft: \"3px solid rgb(210 26 69 / 42%)\",\r\n                        marginRight: 2,\r\n                        marginLeft: 2,\r\n                    }}>\r\n                        <Text styles={tableHeadingStyles}>Premises Details</Text>\r\n                        <div style={{ display: \"flex\", flexFlow: \"row\" }}>\r\n                            <Text styles={tableCellStyles} style={{ width: 100 }}>Floor/ Unit</Text>\r\n                            <Text styles={tableCellStyles}>Area</Text>\r\n                            <Text styles={tableCellStyles}>Vacant</Text>\r\n                            <Text styles={tableCellStyles} style={{ width: 55 }}>Type</Text>\r\n                            <Text styles={tableCellStyles} style={{ width: 100 }}>Occupation Date</Text>\r\n                        </div>\r\n                    </div>\r\n                    <div style={{\r\n                        display: \"flex\",\r\n                        flexFlow: \"column\",\r\n                        borderTop: \"3px solid rgb(63 55 189 / 42%)\",\r\n                        borderRight: \"3px solid rgb(63 55 189 / 42%)\",\r\n                        borderLeft: \"3px solid rgb(63 55 189 / 42%)\",\r\n                        marginRight: 2,\r\n                        marginLeft: 2,\r\n                    }}>\r\n                        <Text styles={tableHeadingStyles}>Rental Details</Text>\r\n                        <div style={{ display: \"flex\", flexFlow: \"row\" }}>\r\n                            <TooltipHost styles={tooltipHostStyles} content=\"R/m²/month\" id={tooltipNetRentalId} calloutProps={calloutProps}> <Text styles={tableCellStyles}>Net Rental</Text> </TooltipHost>\r\n                            <TooltipHost styles={tooltipHostStyles} content=\"R/m²/month\" id={tooltipOpCostsId} calloutProps={calloutProps}> <Text styles={tableCellStyles}>Op Costs</Text></TooltipHost>\r\n                            <TooltipHost styles={tooltipHostStyles} content=\"R/m²/month\" id={tooltipOtherId} calloutProps={calloutProps}> <Text styles={tableCellStyles}>Other Costs</Text></TooltipHost>\r\n                            <TooltipHost styles={tooltipHostStyles} content=\"R/m²/month\" id={tooltipGrossRentalId} calloutProps={calloutProps}> <Text styles={tableCellStyles}>Gross Rental</Text></TooltipHost>\r\n                            <TooltipHost styles={tooltipHostStyles} content=\"annual %\" id={tooltipEscId} calloutProps={calloutProps}> <Text styles={tableCellStyles}>Esc</Text></TooltipHost>\r\n                        </div>\r\n                    </div>\r\n                    <div style={{\r\n                        display: \"flex\",\r\n                        flexFlow: \"column\",\r\n                        borderTop: \"3px solid rgb(61 177 123 / 42%)\",\r\n                        borderRight: \"3px solid rgb(61 177 123 / 42%)\",\r\n                        borderLeft: \"3px solid rgb(61 177 123 / 42%)\",\r\n                        marginRight: 2,\r\n                        marginLeft: 2,\r\n                    }}>\r\n                        <Text styles={tableHeadingStyles}>Parking Details</Text>\r\n                        <div style={{ display: \"flex\", flexFlow: \"row\" }}>\r\n                            <Text styles={tableCellStyles}>Open Bays</Text>\r\n                            <TooltipHost styles={tooltipHostStyles} content=\"R/bay/month\" id={tooltipOpenRateId} calloutProps={calloutProps}><Text styles={tableCellStyles}>Open Rate</Text></TooltipHost>\r\n                            <Text styles={tableCellStyles} style={{ width: 50 }}>Covered Bays</Text>\r\n                            <TooltipHost styles={tooltipHostStyles} content=\"R/bay/month\" id={tooltipCoveredRateId} calloutProps={calloutProps}> <Text styles={tableCellStyles} style={{ width: 50 }}>Covered Rate</Text></TooltipHost>\r\n                            <Text styles={tableCellStyles} style={{ width: 50 }}>Shaded Bays</Text>\r\n                            <TooltipHost styles={tooltipHostStyles} content=\"R/bay/month\" id={tooltipShadedRateId} calloutProps={calloutProps}><Text styles={tableCellStyles} style={{ width: 50 }}>Shaded Rate</Text></TooltipHost>\r\n                            <TooltipHost styles={tooltipHostStyles} content=\"bays/100m²\" id={tooltipParkingRatioId} calloutProps={calloutProps}><Text styles={tableCellStyles} style={{ width: 50 }}>Parking Ratio</Text></TooltipHost>\r\n                        </div>\r\n                    </div>\r\n                    <div style={{\r\n                        display: \"flex\",\r\n                        flexFlow: \"column\",\r\n                        borderTop: \"3px solid rgb(212 236 10 / 42%)\",\r\n                        borderRight: \"3px solid rgb(212 236 10 / 42%)\",\r\n                        borderLeft: \"3px solid rgb(212 236 10 / 42%)\",\r\n                        marginRight: 2,\r\n                        marginLeft: 2,\r\n                    }}>\r\n                        <Text styles={tableHeadingStyles}>Tenant Details</Text>\r\n                        <div style={{ display: \"flex\", flexFlow: \"row\" }}>\r\n                            <Text styles={tableCellTenantStyles} style={{ width: 125, height: 19, marginTop: \"9.5px !important\", marginBottom:9.5 }}>Tenant Name</Text>\r\n                            <Text styles={tableCellTenantStyles} style={{ width: 100 }}>Lease Expiry </Text>\r\n                        </div>\r\n                    </div>\r\n                    <Text style={{ width: 60 }} styles={tableCellNotesStyles}>{`Notes & Features`}</Text>\r\n                </Stack>\r\n            </Stack>\r\n\r\n\r\n            {floorSortedPremises.map(premises => {\r\n\r\n                return (\r\n                    <PremisesListItem key={premises?.premisesId} premises={premises!} propertyId={singleProperty?.propertyId!}> </PremisesListItem>\r\n                )\r\n\r\n            })}\r\n\r\n        </div>\r\n\r\n    );\r\n};\r\n\r\nexport default PremisesList","C:\\Users\\ruper\\Desktop\\Web\\Own Projects\\Property Stock App V2\\psafrontendv2\\src\\components\\ImageGalleryModal.tsx",["670","671","672","673","674","675","676","677","678","679","680","681","682","683","684"],"import * as React from 'react';\r\nimport { useId, useBoolean } from '@uifabric/react-hooks';\r\nimport {\r\n  getTheme,\r\n  mergeStyleSets,\r\n  FontWeights,\r\n  ContextualMenu,\r\n  Toggle,\r\n  DefaultButton,\r\n  Modal,\r\n  IDragOptions,\r\n  IconButton,\r\n  IIconProps,\r\n  ILayerProps,\r\n  IModalProps\r\n} from 'office-ui-fabric-react';\r\n\r\nimport { GET_NAV_STATE, } from \"../gql/gql\"\r\nimport { Query, NavigationState } from \"../schematypes/schematypes\"\r\nimport { gql, useQuery, } from '@apollo/client';\r\nimport {navigationState as navigationStateVar} from \"../reactivevariables/reactivevariables\"\r\nimport ImageSlider from \"./ImageSlider\"\r\n\r\ntype Maybe<T> = T | null;\r\nconst cancelIcon: IIconProps = { iconName: 'Cancel' };\r\n\r\ninterface Props {\r\n    propertyId: number;\r\n    showImageGalleryModal: boolean;\r\n    /* imagesArray: Maybe<string>[] */\r\n}\r\n\r\nconst ImageGalleryModal: React.FC<Props> = ({showImageGalleryModal, propertyId}) => {\r\n  const [isModalOpen, { setTrue: showModal, setFalse: hideModal }] = useBoolean(false);\r\n  \r\n  /* const {\r\n    data: navigationStateData,\r\n    loading: navigationLoading,\r\n    error: navigationError\r\n  } = useQuery<Query>(GET_NAV_STATE);\r\n\r\n  \r\nconst navStateQuery =() => {\r\n    const {\r\n        data: navigationStateData,\r\n        loading: navigationLoading,\r\n        error: navigationError\r\n      } = useQuery<Query>(GET_NAV_STATE);\r\n\r\n} */\r\n\r\n\r\n  /* console.log(navigationStateData?.navigationState) */\r\n\r\n  const hideImageGalleryModal = () => {\r\n    navigationStateVar({ ...navigationStateVar(), showImageGalleryModal: false })\r\n}\r\n\r\nconst modalProps: IModalProps = {\r\n    isBlocking: false,\r\n    styles: { main: { maxWidth: 450 } },\r\n  };\r\n\r\n/* const onLayerDidMount: ILayerProps ={\r\n    onLayerDidMount: true\r\n} */\r\n\r\n  // Use useId() to ensure that the IDs are unique on the page.\r\n  // (It's also okay to use plain strings and manually ensure uniqueness.)\r\n  const titleId = useId('ImageGallery');\r\n\r\n  return (\r\n    <div>\r\n      \r\n      <Modal\r\n        titleAriaId={titleId}\r\n        isOpen={showImageGalleryModal}\r\n        onDismiss={hideModal}\r\n        isBlocking={true}\r\n        containerClassName={contentStyles.container}\r\n        /* modalProps={modalProps} */\r\n       /*  layerProps={onLayerDidMount} */\r\n        \r\n      >\r\n        <div className={contentStyles.header}>\r\n          <span id={titleId}>Image Gallery</span>\r\n          <IconButton\r\n            styles={iconButtonStyles}\r\n            iconProps={cancelIcon}\r\n            ariaLabel=\"Close image gallery\"\r\n            onClick={hideImageGalleryModal}\r\n          />\r\n        </div>\r\n        <div className={contentStyles.body}>\r\n        <ImageSlider propertyId={propertyId} ></ImageSlider>\r\n        </div>\r\n      </Modal>\r\n    </div>\r\n  );\r\n};\r\n\r\nconst theme = getTheme();\r\nconst contentStyles = mergeStyleSets({\r\n  container: {\r\n    display: 'flex',\r\n    flexFlow: 'column nowrap',\r\n    alignItems: 'stretch',\r\n  },\r\n  header: [\r\n    \r\n    theme.fonts.xLargePlus,\r\n    {\r\n      flex: '1 1 auto',\r\n      borderTop: `4px solid ${theme.palette.themePrimary}`,\r\n      color: theme.palette.neutralPrimary,\r\n      display: 'flex',\r\n      alignItems: 'center',\r\n      fontWeight: FontWeights.semibold,\r\n      padding: '12px 12px 14px 24px',\r\n    },\r\n  ],\r\n  body: {\r\n    flex: '4 4 auto',\r\n    padding: '0 24px 24px 24px',\r\n    overflowY: 'hidden',\r\n    selectors: {\r\n      p: { margin: '14px 0' },\r\n      'p:first-child': { marginTop: 0 },\r\n      'p:last-child': { marginBottom: 0 },\r\n    },\r\n  },\r\n});\r\nconst toggleStyles = { root: { marginBottom: '20px' } };\r\nconst iconButtonStyles = {\r\n  root: {\r\n    color: theme.palette.neutralPrimary,\r\n    marginLeft: 'auto',\r\n    marginTop: '4px',\r\n    marginRight: '2px',\r\n  },\r\n  rootHovered: {\r\n    color: theme.palette.neutralDark,\r\n  },\r\n};\r\n\r\nexport default ImageGalleryModal","C:\\Users\\ruper\\Desktop\\Web\\Own Projects\\Property Stock App V2\\psafrontendv2\\src\\components\\NewPremisesModal.tsx",["685","686","687","688","689","690","691","692","693","694","695","696","697","698","699","700","701","702","703","704","705","706","707","708","709","710","711","712","713","714","715","716"],"import React, { useState } from 'react';\r\nimport { useId, useBoolean } from '@uifabric/react-hooks';\r\nimport { TextField, ITextFieldStyles } from 'office-ui-fabric-react/lib/TextField';\r\nimport { Dropdown, DropdownMenuItemType, IDropdownOption, IDropdownStyles } from 'office-ui-fabric-react/lib/Dropdown';\r\nimport { Slider } from 'office-ui-fabric-react/lib/Slider';\r\nimport { IStackStyles, Stack } from 'office-ui-fabric-react/lib/Stack';\r\nimport { IRenderFunction, IStyleFunctionOrObject } from 'office-ui-fabric-react/lib/Utilities';\r\nimport {\r\n    getTheme,\r\n    mergeStyleSets,\r\n    FontWeights,\r\n    ContextualMenu,\r\n    Toggle,\r\n    IToggleStyles,\r\n    DefaultButton,\r\n    Modal,\r\n    IDragOptions,\r\n    IconButton,\r\n    IIconProps,\r\n    IModalStyles,\r\n    mergeStyles,\r\n    ComboBox,\r\n    Fabric,\r\n    IComboBoxOption,\r\n    IComboBox,\r\n    SelectableOptionMenuItemType,\r\n    IComboBoxStyles,\r\n    DatePicker,\r\n    DayOfWeek,\r\n    IDatePickerStrings,\r\n    IDatePickerStyleProps,\r\n    IDatePickerStyles,\r\n    ICalendarProps\r\n} from 'office-ui-fabric-react';\r\nimport { Pivot, PivotItem } from 'office-ui-fabric-react/lib/Pivot';\r\nimport { defaultDataIdFromObject, gql, useMutation, useQuery } from '@apollo/client';\r\nimport { GET_SINGLE_PROPERTY, NEW_PREMISES, GET_NAV_STATE } from \"../gql/gql\"\r\nimport { Mutation, MutationPostPremisesArgs, Query, Property } from \"../schematypes/schematypes\"\r\nimport { navigationState } from \"../reactivevariables/reactivevariables\"\r\nimport \"./NewPremisesModal.css\"\r\n\r\n\r\n\r\n\r\nconst dragOptions: IDragOptions = {\r\n    moveMenuItemText: 'Move',\r\n    closeMenuItemText: 'Close',\r\n    menu: ContextualMenu,\r\n};\r\nconst cancelIcon: IIconProps = { iconName: 'Cancel' };\r\nconst saveIcon: IIconProps = { iconName: 'Save' };\r\n\r\ninterface Props {\r\n    propertyId: number;\r\n    showNewPremisesModal: boolean;\r\n}\r\n\r\nexport const NewPremisesModal: React.FC<Props> = ({ showNewPremisesModal, propertyId }) => {\r\n\r\n    const hideNewPremisesModal = () => {\r\n        navigationState({ ...navigationState(), showNewPremisesModal: false })\r\n        setSelectedPremisesType(undefined)\r\n        setSelectedPremisesIndex(undefined)\r\n        setNewPremises({\r\n            floor: \"\",\r\n            area: 0,\r\n            vacant: \"true\",\r\n            type: \"\",\r\n            premisesIndex: 0,\r\n            occupation: getNextMonth(),\r\n            premisesNotes: \"\",\r\n            netRental: 0,\r\n            opCosts: 0,\r\n            other: 0,\r\n            grossRental: 0,\r\n            esc: 0,\r\n            openBays: 0,\r\n            openRate: 0,\r\n            openRatio: 0,\r\n            coveredBays: 0,\r\n            coveredRate: 0,\r\n            coveredRatio: 0,\r\n            shadedBays: 0,\r\n            shadedRate: 0,\r\n            shadedRatio: 0,\r\n            parkingRatio: 0,\r\n            tenantName: \"-\",\r\n            leaseExpiry: getNextMonth(),\r\n            tenantNotes: \"\",\r\n            yard: 0,\r\n            height: 0,\r\n            doors: 0,\r\n            loading: \"\",\r\n            sprinklered: \"\",\r\n            canopies: \"\",\r\n            power: \"\",\r\n        })\r\n\r\n    }\r\n\r\n    const getNextMonth = () => {\r\n        const date = new Date();\r\n        const today = date.getDate();\r\n        const currentMonth = date.getMonth() + 1;\r\n        const currentYear = date.getFullYear();\r\n        var newDate = new Date(currentYear, currentMonth, 1);\r\n        return newDate.toISOString()\r\n\r\n    }\r\n\r\n\r\n    const [newPremises, setNewPremises] = React.useState(\r\n        {\r\n            floor: \"\",\r\n            area: 0,\r\n            vacant: \"true\",\r\n            type: \"\",\r\n            premisesIndex: 0,\r\n            occupation: getNextMonth(),\r\n            premisesNotes: \"\",\r\n            netRental: 0,\r\n            opCosts: 0,\r\n            other: 0,\r\n            grossRental: 0,\r\n            esc: 0,\r\n            openBays: 0,\r\n            openRate: 0,\r\n            openRatio: 0,\r\n            coveredBays: 0,\r\n            coveredRate: 0,\r\n            coveredRatio: 0,\r\n            shadedBays: 0,\r\n            shadedRate: 0,\r\n            shadedRatio: 0,\r\n            parkingRatio: 0,\r\n            tenantName: \"-\",\r\n            leaseExpiry: getNextMonth(),\r\n            tenantNotes: \"\",\r\n            yard: 0,\r\n            height: 0,\r\n            doors: 0,\r\n            loading: \"\",\r\n            sprinklered: \"\",\r\n            canopies: \"\",\r\n            power: \"\",\r\n\r\n        });\r\n\r\n\r\n\r\n    const [postPremises, { data }] = useMutation<Mutation, MutationPostPremisesArgs>(NEW_PREMISES);\r\n\r\n    const saveNewPremises = () => {\r\n\r\n        postPremises({\r\n            variables: {\r\n                propertyId: propertyId,\r\n                floor: newPremises.floor,\r\n                area: newPremises.area,\r\n                vacant: newPremises.vacant,\r\n                type: newPremises.type,\r\n                premisesIndex: newPremises.premisesIndex,\r\n                occupation: newPremises.occupation,\r\n                premisesNotes: newPremises.premisesNotes,\r\n                netRental: newPremises.netRental,\r\n                opCosts: newPremises.opCosts,\r\n                other: newPremises.other,\r\n                grossRental: newPremises.grossRental,\r\n                esc: newPremises.esc,\r\n                openBays: newPremises.openBays,\r\n                openRate: newPremises.openRate,\r\n                coveredBays: newPremises.coveredBays,\r\n                coveredRate: newPremises.coveredRate,\r\n                shadedBays: newPremises.shadedBays,\r\n                shadedRate: newPremises.shadedRate,\r\n                parkingRatio: newPremises.parkingRatio,\r\n                tenantName: newPremises.tenantName,\r\n                leaseExpiry: newPremises.leaseExpiry,\r\n                tenantNotes: newPremises.tenantNotes,\r\n                yard: newPremises.yard,\r\n                height: newPremises.height,\r\n                doors: newPremises.doors,\r\n                loading: newPremises.loading,\r\n                sprinklered: newPremises.sprinklered,\r\n                canopies: newPremises.canopies,\r\n                power: newPremises.power,\r\n            },\r\n\r\n            update(cache, { data }) {\r\n\r\n                if (!data) {\r\n                    return null;\r\n                }\r\n\r\n                const getExistingProperty = cache.readQuery<Query>({ query: GET_SINGLE_PROPERTY, variables: { propertyId: propertyId } })\r\n                const existingProperty: Property = getExistingProperty ? getExistingProperty.singleProperty! : { propertyId: 1, propertyName: \"\" };\r\n\r\n                const existingPremises = getExistingProperty ? getExistingProperty.singleProperty?.premisesList : [];\r\n                const newPremises = [...existingPremises!, data.postPremises]\r\n\r\n                const newProperty = { ...existingProperty, premisesList: newPremises }\r\n                if (existingPremises)\r\n                    cache.writeQuery<Query>({\r\n                        query: GET_SINGLE_PROPERTY,\r\n                        variables: { propertyId: propertyId },\r\n                        data: { singleProperty: newProperty }\r\n                    });\r\n            }\r\n\r\n\r\n        })\r\n        hideNewPremisesModal()\r\n\r\n\r\n    }\r\n\r\n\r\n\r\n    /* const [isModalOpen, { setTrue: showModal, setFalse: hideModal }] = useBoolean(false);\r\n    const [isDraggable, { toggle: toggleIsDraggable }] = useBoolean(false); */\r\n\r\n    // Use useId() to ensure that the IDs are unique on the page.\r\n    // (It's also okay to use plain strings and manually ensure uniqueness.)\r\n\r\n\r\n    const textFieldStyles: Partial<ITextFieldStyles> = { fieldGroup: { width: 200, marginRight: 20 } };\r\n    const textFieldFloorStyles: Partial<ITextFieldStyles> = { fieldGroup: { width: 200, marginRight: 20 } };\r\n    const textFieldAreaStyles: Partial<ITextFieldStyles> = { fieldGroup: { width: 150, marginRight: 20 } };\r\n    const textFieldEscStyles: Partial<ITextFieldStyles> = { fieldGroup: { width: 150, marginRight: 20 } };\r\n    const textFieldYardStyles: Partial<ITextFieldStyles> = { fieldGroup: { width: 125, marginRight: 20 } };\r\n    const textFieldPowerStyles: Partial<ITextFieldStyles> = { fieldGroup: { width: 200, marginRight: 20 } };\r\n    const textFieldCoordinatesStyles: Partial<ITextFieldStyles> = { fieldGroup: { width: 150, marginRight: 20 } };\r\n    const textFieldErfStyles: Partial<ITextFieldStyles> = { fieldGroup: { width: 200, marginRight: 20 } };\r\n    const textFieldNotesStyles: Partial<ITextFieldStyles> = { fieldGroup: { width: 470 } };\r\n    const dropdownStyles: Partial<IDropdownStyles> = { dropdown: { width: 125, marginRight: 20 } };\r\n    const dropdownSectorStyles: Partial<IDropdownStyles> = { dropdown: { width: 420, marginRight: 20 } };\r\n    const dropdownProvinceStyles: Partial<IDropdownStyles> = { dropdown: { width: 140, marginRight: 20 } };\r\n    const comboBoxStyles: Partial<IComboBoxStyles> = { root: { width: 140, marginRight: 20 } }\r\n\r\n    const toggleStyles: Partial<IToggleStyles> = { container: { marginTop: 5 }, label: { marginLeft: 4 } };\r\n    const modalStyles: Partial<IModalStyles> = { main: { position: \"absolute\", top: 150 }, };\r\n\r\n    const textFieldParkingBaysStyles: Partial<ITextFieldStyles> = { fieldGroup: { width: 100, marginRight: 20 } };\r\n    const textFieldParkingRateStyles: Partial<ITextFieldStyles> = { fieldGroup: { width: 185, marginRight: 20 } };\r\n    const textFieldParkingRatioStyles: Partial<ITextFieldStyles> = { fieldGroup: { width: 140, marginRight: 20 } };\r\n\r\n    const datePickerStyles: IStyleFunctionOrObject<IDatePickerStyleProps, IDatePickerStyles> = { root: { width: 160, marginRight: 20 }, callout: {} }\r\n\r\n    /* const calendarProps: ICalendarProps ={styles  } */\r\n\r\n\r\n\r\n    const headerIconStackStyles: Partial<IStackStyles> = { root: { marginRight: 0, marginLeft: \"auto\", } }\r\n\r\n    const DayPickerStrings: IDatePickerStrings = {\r\n        months: [\r\n            'January',\r\n            'February',\r\n            'March',\r\n            'April',\r\n            'May',\r\n            'June',\r\n            'July',\r\n            'August',\r\n            'September',\r\n            'October',\r\n            'November',\r\n            'December',\r\n        ],\r\n\r\n        shortMonths: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],\r\n\r\n        days: ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'],\r\n\r\n        shortDays: ['S', 'M', 'T', 'W', 'T', 'F', 'S'],\r\n\r\n        goToToday: 'Go to today',\r\n        prevMonthAriaLabel: 'Go to previous month',\r\n        nextMonthAriaLabel: 'Go to next month',\r\n        prevYearAriaLabel: 'Go to previous year',\r\n        nextYearAriaLabel: 'Go to next year',\r\n        closeButtonAriaLabel: 'Close date picker',\r\n        monthPickerHeaderAriaLabel: '{0}, select to change the year',\r\n        yearPickerHeaderAriaLabel: '{0}, select to change the month',\r\n    };\r\n\r\n    const controlClass = mergeStyleSets({\r\n        control: {\r\n            margin: '0 0 15px 0',\r\n            maxWidth: '300px',\r\n        },\r\n\r\n    });\r\n\r\n    const premisesTypeOptions = [\r\n\r\n        { key: 'Office', text: 'Office' },\r\n        { key: 'Warehouse', text: 'Warehouse' },\r\n        { key: 'Retail', text: 'Retail' },\r\n        { key: 'Stores', text: 'Stores' },\r\n        { key: 'Balcony', text: 'Balcony' },\r\n    ];\r\n\r\n    const premisesIndexOptions = [\r\n\r\n        { key: '1', text: '1' },\r\n        { key: '2', text: '2' },\r\n        { key: '3', text: '3' },\r\n        { key: '4', text: '5' },\r\n        { key: '5', text: '5' },\r\n        { key: '6', text: '6' },\r\n    ];\r\n\r\n\r\n\r\n    const [selectedPremisesType, setSelectedPremisesType] = React.useState<IDropdownOption>();\r\n    const [selectedPremisesIndex, setSelectedPremisesIndex] = React.useState<IDropdownOption>();\r\n\r\n\r\n\r\n    const onChangePremisesType = (event: React.FormEvent<HTMLDivElement>, item: IDropdownOption | undefined): void => {\r\n        if (item !== undefined) {\r\n            setSelectedPremisesType(item);\r\n            setNewPremises({ ...newPremises, type: item.text });\r\n        }\r\n    };\r\n\r\n    const onChangePremisesIndex = (event: React.FormEvent<HTMLDivElement>, item: IDropdownOption | undefined): void => {\r\n        if (item !== undefined) {\r\n            setSelectedPremisesIndex(item);\r\n            setNewPremises({ ...newPremises, premisesIndex: parseInt(item.text) });\r\n        }\r\n    };\r\n\r\n\r\n    const stackTokens = { childrenGap: 15 };\r\n\r\n\r\n\r\n    const onChangeFloor = React.useCallback(\r\n        (event: React.FormEvent<HTMLInputElement | HTMLTextAreaElement>, newValue?: string) => {\r\n            setNewPremises({ ...newPremises, floor: newValue || '' });\r\n        },\r\n        [newPremises],\r\n    );\r\n\r\n    const onChangeArea = React.useCallback(\r\n        (event: React.FormEvent<HTMLInputElement | HTMLTextAreaElement>, newValue?: string) => {\r\n            console.log(newValue)\r\n            setNewPremises({ ...newPremises, area: parseFloat(newValue!) || 0 });\r\n        },\r\n        [newPremises],\r\n    );\r\n\r\n\r\n    const handleChecked = () => {\r\n        if (newPremises.vacant === \"false\") {\r\n            return false\r\n        } else {\r\n            return true\r\n        }\r\n\r\n    }\r\n\r\n    const onChangeVacantToggle = React.useCallback(\r\n        (ev: React.MouseEvent<HTMLElement>, checked: boolean | undefined) => {\r\n            if (newPremises.vacant === \"false\") {\r\n                setNewPremises({ ...newPremises, vacant: \"true\" });\r\n\r\n            } else {\r\n                setNewPremises({ ...newPremises, vacant: \"false\" });\r\n            }\r\n        },\r\n        [newPremises])\r\n\r\n    const onSelectOccupationDate = React.useCallback(\r\n        (date: Date | null | undefined) => {\r\n            if (date !== undefined && date !== null)\r\n                setNewPremises({ ...newPremises, occupation: date.toISOString() });\r\n        },\r\n        [newPremises])\r\n\r\n    const onFormatDate = (date?: Date): string => {\r\n        return !date ? '' : date.toLocaleDateString(\r\n            'en-gb',\r\n            {\r\n                year: 'numeric',\r\n                month: 'long',\r\n                day: 'numeric'\r\n            }\r\n        );\r\n    };\r\n\r\n\r\n\r\n    const onChangePremisesNotes = React.useCallback(\r\n        (event: React.FormEvent<HTMLInputElement | HTMLTextAreaElement>, newValue?: string) => {\r\n            setNewPremises({ ...newPremises, premisesNotes: newValue || '' });\r\n        },\r\n        [newPremises],\r\n    );\r\n\r\n    const onChangeNetRental = React.useCallback(\r\n        (event: React.FormEvent<HTMLInputElement | HTMLTextAreaElement>, newValue?: string) => {\r\n            setNewPremises({ ...newPremises, netRental: parseFloat(newValue!) || 0 });\r\n        },\r\n        [newPremises],\r\n    );\r\n\r\n    const onChangeOpCosts = React.useCallback(\r\n        (event: React.FormEvent<HTMLInputElement | HTMLTextAreaElement>, newValue?: string) => {\r\n            setNewPremises({ ...newPremises, opCosts: parseFloat(newValue!) || 0 });\r\n        },\r\n        [newPremises],\r\n    );\r\n\r\n    const onChangeOther = React.useCallback(\r\n        (event: React.FormEvent<HTMLInputElement | HTMLTextAreaElement>, newValue?: string) => {\r\n            setNewPremises({ ...newPremises, other: parseFloat(newValue!) || 0 });\r\n        },\r\n        [newPremises],\r\n    );\r\n\r\n    const onChangeGrossRental = React.useCallback(\r\n        (event: React.FormEvent<HTMLInputElement | HTMLTextAreaElement>, newValue?: string) => {\r\n            setNewPremises({ ...newPremises, grossRental: parseFloat(newValue!) || 0 });\r\n        },\r\n        [newPremises],\r\n    );\r\n\r\n    const onChangeEsc = React.useCallback(\r\n        (event: React.FormEvent<HTMLInputElement | HTMLTextAreaElement>, newValue?: string) => {\r\n            setNewPremises({ ...newPremises, esc: parseFloat(newValue!) || 0 });\r\n        },\r\n        [newPremises],\r\n    );\r\n\r\n    const getOpenBays = (ratio: number) => {\r\n        return (ratio * (newPremises.area / 100))\r\n    }\r\n\r\n    const getOpenRatio = (bays: number) => {\r\n        return (bays / (newPremises.area/100 ))\r\n    }\r\n\r\n    const getCoveredBays = (ratio: number) => {\r\n        return (ratio * (newPremises.area / 100))\r\n    }\r\n\r\n    const getCoveredRatio = (bays: number) => {\r\n        return (bays / (newPremises.area/100 ))\r\n    }\r\n\r\n    const getShadedBays = (ratio: number) => {\r\n        return (ratio * (newPremises.area / 100))\r\n    }\r\n\r\n    const getShadedRatio = (bays: number) => {\r\n        return (bays / (newPremises.area/100 ))\r\n    }\r\n\r\n\r\n    const onChangeOpenBays = React.useCallback(\r\n        (event: React.FormEvent<HTMLInputElement | HTMLTextAreaElement>, newValue?: string) => {\r\n            setNewPremises({ ...newPremises, openBays: parseFloat(newValue!) || 0, openRatio: getOpenRatio(parseFloat(newValue!)) } );\r\n        },\r\n        [newPremises],\r\n    );\r\n\r\n    const onChangeOpenRate = React.useCallback(\r\n        (event: React.FormEvent<HTMLInputElement | HTMLTextAreaElement>, newValue?: string) => {\r\n            setNewPremises({ ...newPremises, openRate: parseFloat(newValue!) || 0 });\r\n        },\r\n        [newPremises],\r\n    );\r\n\r\n   \r\n    const onChangeOpenRatio = React.useCallback(\r\n        (event: React.FormEvent<HTMLInputElement | HTMLTextAreaElement>, newValue?: string) => {\r\n            setNewPremises({ ...newPremises, openRatio: parseFloat(newValue!) || 0, openBays: getOpenBays(parseFloat(newValue!)) });\r\n        },\r\n        [newPremises],\r\n    );\r\n\r\n    const onChangeCoveredBays = React.useCallback(\r\n        (event: React.FormEvent<HTMLInputElement | HTMLTextAreaElement>, newValue?: string) => {\r\n            setNewPremises({ ...newPremises, coveredBays: parseFloat(newValue!) || 0, coveredRatio: getCoveredRatio(parseFloat(newValue!)) } );\r\n        },\r\n        [newPremises],\r\n    );\r\n\r\n    const onChangeCoveredRate = React.useCallback(\r\n        (event: React.FormEvent<HTMLInputElement | HTMLTextAreaElement>, newValue?: string) => {\r\n            setNewPremises({ ...newPremises, coveredRate: parseFloat(newValue!) || 0 });\r\n        },\r\n        [newPremises],\r\n    );\r\n\r\n    const onChangeCoveredRatio = React.useCallback(\r\n        (event: React.FormEvent<HTMLInputElement | HTMLTextAreaElement>, newValue?: string) => {\r\n            setNewPremises({ ...newPremises, coveredRatio: parseFloat(newValue!) || 0, coveredBays: getCoveredBays(parseFloat(newValue!)) });\r\n        },\r\n        [newPremises],\r\n    );\r\n\r\n    const onChangeShadedBays = React.useCallback(\r\n        (event: React.FormEvent<HTMLInputElement | HTMLTextAreaElement>, newValue?: string) => {\r\n            setNewPremises({ ...newPremises, shadedBays: parseFloat(newValue!) || 0, shadedRatio: getShadedRatio(parseFloat(newValue!)) } );\r\n        },\r\n        [newPremises],\r\n    );\r\n\r\n    const onChangeShadedRate = React.useCallback(\r\n        (event: React.FormEvent<HTMLInputElement | HTMLTextAreaElement>, newValue?: string) => {\r\n            setNewPremises({ ...newPremises, shadedRate: parseFloat(newValue!) || 0 });\r\n        },\r\n        [newPremises],\r\n    );\r\n\r\n    const onChangeShadedRatio = React.useCallback(\r\n        (event: React.FormEvent<HTMLInputElement | HTMLTextAreaElement>, newValue?: string) => {\r\n            setNewPremises({ ...newPremises, shadedRatio: parseFloat(newValue!) || 0, shadedBays: getShadedBays(parseFloat(newValue!)) });\r\n        },\r\n        [newPremises],\r\n    );\r\n\r\n    const onChangeParkingRatio = React.useCallback(\r\n        (event: React.FormEvent<HTMLInputElement | HTMLTextAreaElement>, newValue?: string) => {\r\n            setNewPremises({ ...newPremises, parkingRatio: parseFloat(newValue!) || 0 });\r\n        },\r\n        [newPremises],\r\n    );\r\n\r\n    const onChangeTenantName = React.useCallback(\r\n        (event: React.FormEvent<HTMLInputElement | HTMLTextAreaElement>, newValue?: string) => {\r\n            setNewPremises({ ...newPremises, tenantName: newValue || '' });\r\n        },\r\n        [newPremises],\r\n    );\r\n\r\n    const onSelectLeaseExpiry = React.useCallback(\r\n        (date: Date | null | undefined) => {\r\n            if (date !== undefined && date !== null)\r\n                setNewPremises({ ...newPremises, leaseExpiry: date.toISOString() });\r\n        },\r\n        [newPremises])\r\n\r\n    const onChangeTenantNotes = React.useCallback(\r\n        (event: React.FormEvent<HTMLInputElement | HTMLTextAreaElement>, newValue?: string) => {\r\n            setNewPremises({ ...newPremises, tenantNotes: newValue || '' });\r\n        },\r\n        [newPremises],\r\n    );\r\n\r\n    const onChangeYard = React.useCallback(\r\n        (event: React.FormEvent<HTMLInputElement | HTMLTextAreaElement>, newValue?: string) => {\r\n            setNewPremises({ ...newPremises, yard: parseFloat(newValue!) || 0 });\r\n        },\r\n        [newPremises],\r\n    );\r\n\r\n    const onChangeHeight = React.useCallback(\r\n        (event: React.FormEvent<HTMLInputElement | HTMLTextAreaElement>, newValue?: string) => {\r\n            setNewPremises({ ...newPremises, height: parseFloat(newValue!) || 0 });\r\n        },\r\n        [newPremises],\r\n    );\r\n\r\n    const onChangeDoors = React.useCallback(\r\n        (event: React.FormEvent<HTMLInputElement | HTMLTextAreaElement>, newValue?: string) => {\r\n            setNewPremises({ ...newPremises, doors: parseFloat(newValue!) || 0 });\r\n        },\r\n        [newPremises],\r\n    );\r\n\r\n    const onChangeLoading = React.useCallback(\r\n        (event: React.FormEvent<HTMLInputElement | HTMLTextAreaElement>, newValue?: string) => {\r\n            setNewPremises({ ...newPremises, loading: newValue || '' });\r\n        },\r\n        [newPremises],\r\n    );\r\n\r\n    const onChangeSprinklered = React.useCallback(\r\n        (event: React.FormEvent<HTMLInputElement | HTMLTextAreaElement>, newValue?: string) => {\r\n            setNewPremises({ ...newPremises, sprinklered: newValue || '' });\r\n        },\r\n        [newPremises],\r\n    );\r\n\r\n    const onChangeCanopies = React.useCallback(\r\n        (event: React.FormEvent<HTMLInputElement | HTMLTextAreaElement>, newValue?: string) => {\r\n            setNewPremises({ ...newPremises, canopies: newValue || '' });\r\n        },\r\n        [newPremises],\r\n    );\r\n\r\n    const onChangePower = React.useCallback(\r\n        (event: React.FormEvent<HTMLInputElement | HTMLTextAreaElement>, newValue?: string) => {\r\n            setNewPremises({ ...newPremises, power: newValue || '' });\r\n        },\r\n        [newPremises],\r\n    );\r\n\r\n\r\n    const [selectedKey, setSelectedKey] = React.useState('Premises Details');\r\n\r\n    const handleLinkClick = (item?: PivotItem, ev?: React.MouseEvent<HTMLElement>) => {\r\n\r\n        setSelectedKey(item!.props.itemKey!);\r\n    };\r\n\r\n    const getTabId = (itemKey: string | undefined) => {\r\n        return `NewPremisesPivot_${itemKey}`;\r\n    };\r\n\r\n    const titleId = useId('New Premises');\r\n\r\n\r\n    const newPremisesTab = () => {\r\n\r\n        switch (selectedKey) {\r\n            case \"Premises Details\":\r\n                return (\r\n                    <>\r\n                        <Stack horizontal /* style={{marginLeft: 50}} */\r\n                            styles={{\r\n                                root: {\r\n                                    /* width: '400px', */\r\n                                    /*  margin: '10px', */\r\n\r\n                                    color: '#605e5c',\r\n\r\n                                    marginLeft: \"0px\",\r\n                                    marginRight: \"auto\",\r\n                                    /* display: \"block\" */\r\n\r\n                                }\r\n\r\n                            }}>\r\n                            <TextField\r\n                                label=\"Floor/Unit\"\r\n                                value={newPremises.floor}\r\n                                onChange={onChangeFloor}\r\n                                styles={textFieldFloorStyles}\r\n\r\n                            />\r\n                            <TextField\r\n                                label=\"Area\"\r\n                                type=\"number\"\r\n                                value={newPremises.area === 0 ? \"\" : String(newPremises.area)}\r\n                                onChange={onChangeArea}\r\n                                styles={textFieldAreaStyles}\r\n                                suffix=\"m²\"\r\n                            />\r\n\r\n                            <Toggle styles={toggleStyles} label=\"Vacant?\" checked={handleChecked()} onChange={onChangeVacantToggle} />\r\n\r\n\r\n\r\n                        </Stack>\r\n\r\n                        <Stack horizontal styles={{\r\n                            root: {\r\n                                /* width: '400px', */\r\n                                /*  margin: '10px', */\r\n\r\n                                color: '#605e5c',\r\n\r\n                                marginLeft: \"0px\",\r\n                                marginRight: \"auto\",\r\n                                /* display: \"block\" */\r\n\r\n                            }\r\n\r\n                        }}>\r\n\r\n                            <Dropdown\r\n                                label=\"Premises Type\"\r\n                                selectedKey={selectedPremisesType ? selectedPremisesType.key : undefined}\r\n                                // eslint-disable-next-line react/jsx-no-bind\r\n                                onChange={onChangePremisesType}\r\n                                placeholder=\"Select type\"\r\n                                options={premisesTypeOptions}\r\n                                styles={dropdownStyles}\r\n                            />\r\n\r\n                            <Dropdown\r\n                                label=\"Premises Index\"\r\n                                selectedKey={selectedPremisesIndex ? selectedPremisesIndex.key : undefined}\r\n                                // eslint-disable-next-line react/jsx-no-bind\r\n                                onChange={onChangePremisesIndex}\r\n                                placeholder=\"Select index\"\r\n                                options={premisesIndexOptions}\r\n                                styles={dropdownStyles}\r\n                            />\r\n\r\n                            <DatePicker\r\n                                label=\"Occupation Date\"\r\n                                className={controlClass.control}\r\n                                firstDayOfWeek={DayOfWeek.Monday}\r\n                                strings={DayPickerStrings}\r\n                                placeholder=\"Select a date...\"\r\n                                ariaLabel=\"Select a date\"\r\n                                value={new Date(newPremises.occupation)}\r\n                                onSelectDate={onSelectOccupationDate}\r\n                                formatDate={onFormatDate}\r\n                                styles={datePickerStyles}\r\n\r\n                            />\r\n\r\n                        </Stack>\r\n\r\n                        <Stack horizontal>\r\n\r\n                            <TextField\r\n                                label=\"Premises Notes\"\r\n                                value={newPremises.premisesNotes}\r\n                                onChange={onChangePremisesNotes}\r\n                                styles={textFieldNotesStyles}\r\n                                multiline\r\n                                autoAdjustHeight\r\n                            />\r\n\r\n                        </Stack>\r\n                    </>\r\n                )\r\n\r\n            case \"Rental Details\":\r\n\r\n                return (\r\n                    <>\r\n                        <Stack horizontal\r\n                            styles={{\r\n                                root: {\r\n                                    /* width: '400px', */\r\n                                    /*  margin: '10px', */\r\n\r\n                                    color: '#605e5c',\r\n\r\n                                    marginLeft: \"auto\",\r\n                                    marginRight: \"auto\",\r\n                                    /* display: \"block\" */\r\n\r\n                                }\r\n                            }}>\r\n                            <TextField\r\n                                label=\"Net Rental\"\r\n                                type=\"number\"\r\n                                value={newPremises.netRental === 0 ? \"\" : String(newPremises.netRental)}\r\n                                onChange={onChangeNetRental}\r\n                                styles={textFieldFloorStyles}\r\n\r\n                                prefix=\"R\"\r\n                                suffix=\"/m²/month\"\r\n                            />\r\n                            <TextField\r\n                                label=\"Op Costs\"\r\n                                type=\"number\"\r\n                                value={newPremises.opCosts === 0 ? \"\" : String(newPremises.opCosts)}\r\n                                onChange={onChangeOpCosts}\r\n                                styles={textFieldFloorStyles}\r\n                                prefix=\"R\"\r\n                                suffix=\"/m²/month\"\r\n                            />\r\n\r\n                        </Stack>\r\n\r\n                        <Stack horizontal\r\n                            styles={{\r\n                                root: {\r\n                                    /* width: '400px', */\r\n                                    /*  margin: '10px', */\r\n\r\n                                    color: '#605e5c',\r\n\r\n                                    marginLeft: \"auto\",\r\n                                    marginRight: \"auto\",\r\n                                    /* display: \"block\" */\r\n\r\n                                }\r\n                            }}>\r\n                            <TextField\r\n                                label=\"Other\"\r\n                                type=\"number\"\r\n                                value={newPremises.other === 0 ? \"\" : String(newPremises.other)}\r\n                                onChange={onChangeOther}\r\n                                styles={textFieldFloorStyles}\r\n                                prefix=\"R\"\r\n                                suffix=\"/m²/month\"\r\n                            />\r\n                            <TextField\r\n                                label=\"Gross Rental\"\r\n                                type=\"number\"\r\n                                value={newPremises.grossRental === 0 ? \"\" : String(newPremises.grossRental)}\r\n                                onChange={onChangeGrossRental}\r\n                                styles={textFieldFloorStyles}\r\n                                prefix=\"R\"\r\n                                suffix=\"/m²/month\"\r\n                            />\r\n\r\n\r\n\r\n                        </Stack>\r\n\r\n                        <Stack horizontal\r\n                            styles={{\r\n                                root: {\r\n                                    /* width: '400px', */\r\n                                    /*  margin: '10px', */\r\n\r\n                                    color: '#605e5c',\r\n\r\n                                    marginLeft: \"auto\",\r\n                                    marginRight: \"auto\",\r\n                                    /* display: \"block\" */\r\n\r\n                                }\r\n                            }}>\r\n\r\n\r\n                            <TextField\r\n                                label=\"Esc\"\r\n                                type=\"number\"\r\n                                value={newPremises.esc === 0 ? \"\" : String(newPremises.esc)}\r\n                                onChange={onChangeEsc}\r\n                                styles={textFieldEscStyles}\r\n                                suffix=\"% per annum\"\r\n                            />\r\n\r\n                        </Stack>\r\n                    </>\r\n                )\r\n\r\n            case \"Parking Details\":\r\n\r\n                return (\r\n                    <>\r\n                        <Stack horizontal\r\n                            styles={{\r\n                                root: {\r\n                                    /* width: '400px', */\r\n                                    /*  margin: '10px', */\r\n\r\n                                    color: '#605e5c',\r\n\r\n                                    marginLeft: \"auto\",\r\n                                    marginRight: \"auto\",\r\n                                    /* display: \"block\" */\r\n\r\n                                }\r\n                            }}>\r\n                            <TextField\r\n                                label=\"Open Bays\"\r\n                                type=\"number\"\r\n                                value={newPremises.openBays === 0 ? \"\" : String(newPremises.openBays)}\r\n                                onChange={onChangeOpenBays}\r\n                                styles={textFieldParkingBaysStyles}\r\n                                suffix=\"bays\"\r\n                            />\r\n                            <TextField\r\n                                label=\"Open Rate\"\r\n                                type=\"number\"\r\n                                value={newPremises.openRate === 0 ? \"\" : String(newPremises.openRate)}\r\n                                onChange={onChangeOpenRate}\r\n                                styles={textFieldParkingRateStyles}\r\n                                prefix=\"R\"\r\n                                suffix=\"/bay/month\"\r\n                            />\r\n\r\n                            <TextField\r\n                                label=\"Open Ratio\"\r\n                                type=\"number\"\r\n                                value={newPremises.openRatio === 0 ? \"\" : String(newPremises.openRatio.toFixed(1).replace(/[.,]0$/, \"\"))}\r\n                                onChange={onChangeOpenRatio}\r\n                                styles={textFieldParkingRatioStyles}\r\n\r\n                                suffix=\"bays/100m²\"\r\n                            />\r\n\r\n                        </Stack>\r\n\r\n                        <Stack horizontal\r\n                            styles={{\r\n                                root: {\r\n                                    /* width: '400px', */\r\n                                    /*  margin: '10px', */\r\n\r\n                                    color: '#605e5c',\r\n\r\n                                    marginLeft: \"auto\",\r\n                                    marginRight: \"auto\",\r\n                                    /* display: \"block\" */\r\n\r\n                                }\r\n                            }}>\r\n                            <TextField\r\n                                label=\"Covered Bays\"\r\n                                type=\"number\"\r\n                                value={newPremises.coveredBays === 0 ? \"\" : String(newPremises.coveredBays)}\r\n                                onChange={onChangeCoveredBays}\r\n                                styles={textFieldParkingBaysStyles}\r\n                                suffix=\"bays\"\r\n                            />\r\n                            <TextField\r\n                                label=\"Covered Rate\"\r\n                                type=\"number\"\r\n                                value={newPremises.coveredRate === 0 ? \"\" : String(newPremises.coveredRate)}\r\n                                onChange={onChangeCoveredRate}\r\n                                styles={textFieldParkingRateStyles}\r\n                                prefix=\"R\"\r\n                                suffix=\"/bay/month\"\r\n                            />\r\n\r\n                            <TextField\r\n                                label=\"Covered Ratio\"\r\n                                type=\"number\"\r\n                                value={newPremises.coveredRatio === 0 ? \"\" : String(newPremises.coveredRatio.toFixed(1).replace(/[.,]0$/, \"\"))}\r\n                                onChange={onChangeCoveredRatio}\r\n                                styles={textFieldParkingRatioStyles}\r\n\r\n                                suffix=\"bays/100m²\"\r\n                            />\r\n\r\n\r\n\r\n                        </Stack>\r\n\r\n                        <Stack horizontal\r\n                            styles={{\r\n                                root: {\r\n                                    /* width: '400px', */\r\n                                    /*  margin: '10px', */\r\n\r\n                                    color: '#605e5c',\r\n\r\n                                    marginLeft: \"auto\",\r\n                                    marginRight: \"auto\",\r\n                                    /* display: \"block\" */\r\n\r\n                                }\r\n                            }}>\r\n\r\n\r\n                            <TextField\r\n                                label=\"Shaded Bays\"\r\n                                type=\"number\"\r\n                                value={newPremises.shadedBays === 0 ? \"\" : String(newPremises.shadedBays)}\r\n                                onChange={onChangeShadedBays}\r\n                                styles={textFieldParkingBaysStyles}\r\n                                suffix=\"bays\"\r\n                            />\r\n                            <TextField\r\n                                label=\"Shaded Rate\"\r\n                                type=\"number\"\r\n                                value={newPremises.shadedRate === 0 ? \"\" : String(newPremises.shadedRate)}\r\n                                onChange={onChangeShadedRate}\r\n                                styles={textFieldParkingRateStyles}\r\n                                prefix=\"R\"\r\n                                suffix=\"/bay/month\"\r\n                            />\r\n\r\n                            <TextField\r\n                                label=\"Shaded Ratio\"\r\n                                type=\"number\"\r\n                                value={newPremises.shadedRatio === 0 ? \"\" : String(newPremises.shadedRatio.toFixed(1).replace(/[.,]0$/, \"\"))}\r\n                                onChange={onChangeShadedRatio}\r\n                                styles={textFieldParkingRatioStyles}\r\n\r\n                                suffix=\"bays/100m²\"\r\n                            />\r\n\r\n                        </Stack>\r\n                        <Stack horizontal\r\n                            styles={{\r\n                                root: {\r\n                                    /* width: '400px', */\r\n                                    /*  margin: '10px', */\r\n\r\n                                    color: '#605e5c',\r\n\r\n                                    marginLeft: \"auto\",\r\n                                    marginRight: \"auto\",\r\n                                    /* display: \"block\" */\r\n\r\n                                }\r\n                            }}>\r\n\r\n\r\n                            <TextField\r\n                                label=\"Overall Parking Ratio\"\r\n                                type=\"number\"\r\n                                value={newPremises.parkingRatio === 0 ? \"\" : String(newPremises.parkingRatio.toFixed(1).replace(/[.,]0$/, \"\"))}\r\n                                onChange={onChangeParkingRatio}\r\n                                styles={textFieldFloorStyles}\r\n\r\n                                suffix=\"bays/100m²\"\r\n                            />\r\n\r\n\r\n                        </Stack>\r\n                    </>\r\n                )\r\n\r\n            case \"Industrial Features\":\r\n\r\n                return (\r\n                    <>\r\n\r\n\r\n                        <Stack horizontal styles={{\r\n                            root: {\r\n                                color: '#605e5c',\r\n                                marginLeft: \"auto\",\r\n                                marginRight: \"auto\",\r\n                            }\r\n                        }}>\r\n\r\n                            <TextField\r\n                                label=\"Yard Size\"\r\n                                value={newPremises.yard === 0 ? \"\" : String(newPremises.yard)}\r\n                                onChange={onChangeYard}\r\n                                styles={textFieldYardStyles}\r\n                                suffix=\"m²\"\r\n\r\n                            />\r\n\r\n                            <TextField\r\n                                label=\"Floor to Eave Height\"\r\n                                value={newPremises.height === 0 ? \"\" : String(newPremises.height)}\r\n                                onChange={onChangeHeight}\r\n                                styles={textFieldYardStyles}\r\n                                suffix=\"m\"\r\n                            />\r\n\r\n                            <TextField\r\n                                label=\"No of Doors\"\r\n                                value={newPremises.doors === 0 ? \"\" : String(newPremises.doors)}\r\n                                onChange={onChangeDoors}\r\n                                styles={textFieldYardStyles}\r\n\r\n                            />\r\n\r\n\r\n\r\n                        </Stack>\r\n\r\n                        <Stack horizontal styles={{\r\n                            root: {\r\n                                color: '#605e5c',\r\n                                marginLeft: \"auto\",\r\n                                marginRight: \"auto\",\r\n                            }\r\n                        }}>\r\n\r\n                            <TextField\r\n                                label=\"Loading Type\"\r\n                                value={newPremises.loading === \"\" ? \"\" : newPremises.loading}\r\n                                onChange={onChangeLoading}\r\n                                styles={textFieldPowerStyles}\r\n\r\n                            />\r\n\r\n                            <TextField\r\n                                label=\"Sprinkler Type\"\r\n                                value={newPremises.sprinklered === \"\" ? \"\" : newPremises.sprinklered}\r\n                                onChange={onChangeSprinklered}\r\n                                styles={textFieldPowerStyles}\r\n\r\n                            />\r\n\r\n                        </Stack>\r\n\r\n                        <Stack horizontal styles={{\r\n                            root: {\r\n                                color: '#605e5c',\r\n                                marginLeft: \"auto\",\r\n                                marginRight: \"auto\",\r\n                            }\r\n                        }}>\r\n\r\n                            <TextField\r\n                                label=\"Canopy Details\"\r\n                                value={newPremises.canopies === \"\" ? \"\" : newPremises.canopies}\r\n                                onChange={onChangeCanopies}\r\n                                styles={textFieldPowerStyles}\r\n\r\n                            />\r\n\r\n                            <TextField\r\n                                label=\"Power\"\r\n                                value={newPremises.power === \"\" ? \"\" : newPremises.power}\r\n                                onChange={onChangePower}\r\n                                styles={textFieldPowerStyles}\r\n\r\n                            />\r\n\r\n                        </Stack>\r\n                    </>\r\n                )\r\n\r\n\r\n            case \"Tenant Details\":\r\n\r\n                return (\r\n                    <>\r\n\r\n\r\n                        <Stack horizontal styles={{\r\n                            root: {\r\n                                /* width: '400px', */\r\n                                /*  margin: '10px', */\r\n\r\n                                color: '#605e5c',\r\n\r\n                                marginLeft: \"0px\",\r\n                                marginRight: \"auto\",\r\n                                /* display: \"block\" */\r\n\r\n                            }\r\n\r\n                        }}>\r\n\r\n                            <TextField\r\n                                label=\"Tenant Name\"\r\n                                value={newPremises.tenantName === \"-\" ? \"\" : newPremises.tenantName}\r\n                                onChange={onChangeTenantName}\r\n                                styles={textFieldFloorStyles}\r\n\r\n                            />\r\n\r\n                            <DatePicker\r\n                                label=\"Lease Expiry Date\"\r\n                                className={controlClass.control}\r\n                                firstDayOfWeek={DayOfWeek.Monday}\r\n                                strings={DayPickerStrings}\r\n                                placeholder=\"Select a date...\"\r\n                                ariaLabel=\"Select a date\"\r\n                                value={new Date(newPremises.leaseExpiry)}\r\n                                onSelectDate={onSelectLeaseExpiry}\r\n                                formatDate={onFormatDate}\r\n                                styles={datePickerStyles}\r\n\r\n                            />\r\n\r\n                        </Stack>\r\n\r\n                        <Stack horizontal>\r\n\r\n                            <TextField\r\n                                label=\"Tenant Notes\"\r\n                                value={newPremises.tenantNotes}\r\n                                onChange={onChangeTenantNotes}\r\n                                styles={textFieldNotesStyles}\r\n                                multiline\r\n                                autoAdjustHeight\r\n                            />\r\n\r\n                        </Stack>\r\n                    </>\r\n                )\r\n\r\n\r\n            default:\r\n            // code block\r\n        }\r\n\r\n    }\r\n\r\n    return (\r\n        <div>\r\n\r\n\r\n            <Modal\r\n                styles={modalStyles}\r\n\r\n                titleAriaId={titleId}\r\n                isOpen={showNewPremisesModal}\r\n                /* onDismiss={hideNewPremisesModal} */\r\n                isBlocking={false}\r\n                containerClassName={contentStyles.container}\r\n            /* dragOptions={dragOptions} */\r\n            >\r\n                <div className={contentStyles.header}>\r\n                    <span id={titleId}>New Premises</span>\r\n                    <Stack horizontal\r\n                        styles={headerIconStackStyles}\r\n                    >\r\n\r\n                        <IconButton\r\n                            styles={iconButtonStyles}\r\n                            iconProps={saveIcon}\r\n                            ariaLabel=\"Save Premises\"\r\n                            onClick={saveNewPremises}\r\n                        />\r\n                        <IconButton\r\n                            styles={iconButtonStyles}\r\n                            iconProps={cancelIcon}\r\n                            ariaLabel=\"Close popup modal\"\r\n                            onClick={hideNewPremisesModal}\r\n                        />\r\n\r\n                    </Stack>\r\n\r\n                </div>\r\n                <div className={contentStyles.body} >\r\n\r\n                    <Stack tokens={stackTokens}>\r\n\r\n                        <Pivot\r\n                            aria-label=\"Separately Rendered Content Pivot Example\"\r\n                            selectedKey={selectedKey}\r\n                            // eslint-disable-next-line react/jsx-no-bind\r\n                            onLinkClick={handleLinkClick}\r\n                            headersOnly={true}\r\n                            getTabId={getTabId}\r\n                            styles={{ link: {/* padding:0, margin:0, fontSize:14 */  marginRight: 20 }, linkIsSelected: {/* padding:0, margin:0, fontSize:14 */marginRight: 20 }, root: { marginLeft: \"auto\", marginRight: \"auto\" } }}\r\n                        >\r\n                            <PivotItem headerText=\"Premises\" itemKey=\"Premises Details\" />\r\n                            <PivotItem headerText=\"Rental\" itemKey=\"Rental Details\" />\r\n                            <PivotItem headerText=\"Parking\" itemKey=\"Parking Details\" />\r\n                            <PivotItem headerText=\"Industrial\" itemKey=\"Industrial Features\" />\r\n                            <PivotItem headerText=\"Tenant\" itemKey=\"Tenant Details\" />\r\n                        </Pivot>\r\n\r\n                        {newPremisesTab()}\r\n\r\n\r\n\r\n\r\n\r\n                    </Stack>\r\n\r\n\r\n                </div>\r\n            </Modal>\r\n        </div>\r\n    );\r\n};\r\n\r\nconst theme = getTheme();\r\nconst contentStyles = mergeStyleSets({\r\n    container: {\r\n        display: 'flex',\r\n        flexFlow: 'column nowrap',\r\n        alignItems: 'stretch',\r\n        width: 525,\r\n\r\n    },\r\n\r\n    header: [\r\n\r\n        theme.fonts.xLargePlus,\r\n        {\r\n            flex: '1 1 auto',\r\n            borderTop: `4px solid ${theme.palette.themePrimary}`,\r\n            color: theme.palette.neutralPrimary,\r\n            display: 'flex',\r\n            alignItems: 'center',\r\n            fontWeight: FontWeights.semibold,\r\n            padding: '12px 12px 14px 24px',\r\n        },\r\n    ],\r\n    body: {\r\n        flex: '4 4 auto',\r\n        padding: '0 24px 24px 24px',\r\n        overflowY: 'hidden',\r\n        selectors: {\r\n            p: { margin: '14px 0' },\r\n            'p:first-child': { marginTop: 0 },\r\n            'p:last-child': { marginBottom: 0 },\r\n        },\r\n    },\r\n});\r\n\r\nconst iconButtonStyles = {\r\n    root: {\r\n        color: theme.palette.neutralPrimary,\r\n        marginLeft: \"10px !important\",\r\n        marginTop: '4px',\r\n        marginRight: '2px',\r\n\r\n    },\r\n    rootHovered: {\r\n        color: theme.palette.neutralDark,\r\n    },\r\n    icon: {\r\n        fontSize: \"24px\",\r\n\r\n    }\r\n};\r\n\r\nexport default NewPremisesModal\r\n","C:\\Users\\ruper\\Desktop\\Web\\Own Projects\\Property Stock App V2\\psafrontendv2\\src\\components\\Map.tsx",["717","718","719","720","721"],"import React, { useState, useEffect } from 'react';\r\nimport MapGL, { Marker, NavigationControl } from 'react-map-gl';\r\nimport Pin from \"../assets/pin\";\r\nimport { Dropdown, DropdownMenuItemType, IDropdownOption, IDropdownStyles } from 'office-ui-fabric-react/lib/Dropdown';\r\nimport {\r\n    FontWeights,\r\n    Text,\r\n    IconButton,\r\n    getTheme,\r\n    IIconProps\r\n    \r\n} from 'office-ui-fabric-react';\r\nimport { useMutation, useQuery } from '@apollo/client';\r\nimport { UPDATE_COORDINATES, GET_SINGLE_PROPERTY } from \"../gql/gql\"\r\nimport { Mutation, MutationUpdatePropertyArgs, Query } from \"../schematypes/schematypes\"\r\n\r\nconst MAPBOX_TOKEN = process.env.REACT_APP_MAPBOX_TOKEN;\r\n\r\ninterface Props {\r\n    coordinatesArray: string[] | undefined,\r\n    propertyId: number,\r\n    contactId: number\r\n}\r\n\r\nexport const Map: React.FC<Props> = ({ coordinatesArray, propertyId, contactId }) => {\r\n\r\n    const [updateProperty, { data }] = useMutation<Mutation, MutationUpdatePropertyArgs>(UPDATE_COORDINATES);\r\n\r\n    const saveUpdatedCoordinates = () => {\r\n\r\n        updateProperty({\r\n            variables: {\r\n                contactId: contactId,\r\n                propertyId: propertyId,\r\n                coordinates: `${marker.latitude},${marker.longitude}`\r\n            },\r\n\r\n            update(cache, { data }) {\r\n\r\n                if (!data) {\r\n                    return null;\r\n                }\r\n\r\n                const getExistingProperty = cache.readQuery<Query>({ query: GET_SINGLE_PROPERTY, variables: { propertyId: propertyId } })\r\n\r\n                const updatedProperty = data.updateProperty!;\r\n                console.log(updatedProperty)\r\n                if (getExistingProperty)\r\n                    cache.writeQuery<Query>({\r\n                        query: GET_SINGLE_PROPERTY,\r\n                        variables: { propertyId: propertyId },\r\n                        data: { singleProperty: updatedProperty }\r\n                    });\r\n            }\r\n        })\r\n       \r\n        \r\n    }\r\n\r\n\r\n    var latitude = -33.973564350686324\r\n    var longitude = 18.456012615707248\r\n\r\n    console.log(coordinatesArray)\r\n\r\n    if (coordinatesArray !== undefined && coordinatesArray !== null && isNaN(Number(coordinatesArray[0])) === false && isNaN(Number(coordinatesArray[1])) === false) {\r\n        latitude = Number(coordinatesArray[0])\r\n        longitude = Number(coordinatesArray[1])\r\n    } else {\r\n        latitude = -33.973564350686324\r\n        longitude = 18.456012615707248\r\n\r\n    }\r\n\r\n    const navStyle: any = {\r\n        position: \"absolute\",\r\n        top: 0,\r\n        left: 0,\r\n        padding: '10px'\r\n    };\r\n\r\n    const dropdownStyle: any = {\r\n        position: \"absolute\",\r\n        top: 0,\r\n        right: 0,\r\n        padding: '10px'\r\n    };\r\n\r\n    const coordinatesStyle: any = {\r\n        position: \"absolute\",\r\n        bottom: 0,\r\n        left: \"35%\",\r\n        margin: 10,\r\n        paddingLeft: '5px',\r\n        border: \"1px solid\",\r\n        display: \"flex\",\r\n        alignItems: \"center\",\r\n        backgroundColor: \"white\"\r\n    };\r\n\r\n    const theme = getTheme();\r\n    const saveIconStyles = {\r\n        root: {\r\n            color: theme.palette.neutralPrimary,\r\n             marginLeft: 5,\r\n             \r\n\r\n        },\r\n        rootHovered: {\r\n            color: theme.palette.neutralDark,\r\n        },\r\n        icon: {\r\n            fontSize: \"16px\",\r\n\r\n        }\r\n    };\r\n\r\n    const saveIcon: IIconProps = { iconName: 'Save' };\r\n\r\n    const [viewport, setViewport] = useState({\r\n        width: 600,\r\n        height: 400,\r\n        latitude: latitude,\r\n        longitude: longitude,\r\n        zoom: 15\r\n    });\r\n\r\n\r\n    const [marker, setMarker] = useState({\r\n        latitude: latitude,\r\n        longitude: longitude\r\n    });\r\n\r\n\r\n\r\n    const handleDragEnd: any | undefined = (event: any) => {\r\n\r\n        setMarker({\r\n            longitude: event.lngLat[0],\r\n            latitude: event.lngLat[1]\r\n        })\r\n    }\r\n\r\n    const mapTypeOptions = [\r\n\r\n        { key: \"mapbox://styles/mapbox/outdoors-v11\", text: 'Default' },\r\n        { key: \"mapbox://styles/mapbox/satellite-streets-v11\", text: 'Satelite' },\r\n    \r\n    ];\r\n\r\n\r\n\r\n    const [selectedMapType, setSelectedMapType] = React.useState<IDropdownOption>({ key: \"mapbox://styles/mapbox/outdoors-v11\", text: 'Default' });\r\n\r\n\r\n\r\n    const onChangeMapType = (event: React.FormEvent<HTMLDivElement>, item: IDropdownOption | undefined): void => {\r\n        if (item !== undefined) {\r\n            setSelectedMapType(item);\r\n           \r\n        }\r\n    };\r\n\r\n    const dropdownStyles: Partial<IDropdownStyles> = { dropdown: { width: 100, marginRight: 5 } };\r\n\r\n    return (\r\n        <MapGL\r\n            {...viewport}\r\n            /* width=\"100%\"\r\n            height=\"100%\" */\r\n            mapStyle={String(selectedMapType.key)}\r\n            onViewportChange={setViewport}\r\n            mapboxApiAccessToken={MAPBOX_TOKEN}\r\n        >\r\n            <Marker\r\n                longitude={marker.longitude}\r\n                latitude={marker.latitude}\r\n                offsetTop={-20}\r\n                offsetLeft={-10}\r\n                draggable\r\n                /* onDragStart={this._onMarkerDragStart}\r\n                onDrag={this._onMarkerDrag} */\r\n                onDragEnd={handleDragEnd}\r\n            >\r\n                <Pin size={20} />\r\n            </Marker>\r\n\r\n            <div className=\"nav\" style={navStyle}>\r\n                <NavigationControl onViewportChange={setViewport} />\r\n            </div>\r\n\r\n            <div className=\"dropdown\" style={dropdownStyle}>\r\n            <Dropdown\r\n                                \r\n                                selectedKey={selectedMapType ? selectedMapType.key : undefined}\r\n                                // eslint-disable-next-line react/jsx-no-bind\r\n                                onChange={onChangeMapType}\r\n                                placeholder=\"Select type\"\r\n                                options={mapTypeOptions}\r\n                                styles={dropdownStyles}\r\n                            />\r\n            </div>\r\n\r\n            <div className=\"coordinates\" style={coordinatesStyle}>\r\n                \r\n                <Text>{`${marker.latitude.toFixed(4)} ,${marker.longitude.toFixed(4)}`}</Text>\r\n                <IconButton\r\n                    styles={saveIconStyles}\r\n                    iconProps={saveIcon}\r\n                    ariaLabel=\"Close panel\"\r\n                    onClick={saveUpdatedCoordinates}\r\n                />\r\n            </div>\r\n\r\n            \r\n\r\n\r\n        </MapGL>\r\n\r\n    );\r\n}\r\n\r\nexport default Map;","C:\\Users\\ruper\\Desktop\\Web\\Own Projects\\Property Stock App V2\\psafrontendv2\\src\\components\\PropertyListItem.tsx",["722","723","724","725","726","727","728","729","730","731","732","733","734","735","736"],"C:\\Users\\ruper\\Desktop\\Web\\Own Projects\\Property Stock App V2\\psafrontendv2\\src\\assets\\svgIcons.js",[],["737","738"],"C:\\Users\\ruper\\Desktop\\Web\\Own Projects\\Property Stock App V2\\psafrontendv2\\src\\assets\\pin.js",[],"C:\\Users\\ruper\\Desktop\\Web\\Own Projects\\Property Stock App V2\\psafrontendv2\\src\\components\\PremisesListItem.tsx",["739","740","741","742","743","744","745","746","747","748","749","750","751","752","753","754","755","756","757","758","759","760","761","762","763","764","765","766"],"import * as React from 'react';\r\nimport { getTheme } from '@fluentui/react';\r\nimport { TextField } from 'office-ui-fabric-react/lib/TextField';\r\nimport { Image, ImageFit } from 'office-ui-fabric-react/lib/Image';\r\nimport { Icon } from 'office-ui-fabric-react/lib/Icon';\r\nimport { Checkbox, ICheckboxProps } from 'office-ui-fabric-react/lib/Checkbox';\r\nimport { Query, Premises, Mutation, MutationDeletePremisesArgs, Property } from \"../schematypes/schematypes\"\r\nimport { GET_SELECTED_PROPERTIES, GET_PREMISES, DELETE_PREMISES, GET_SINGLE_PROPERTY } from \"../gql/gql\"\r\nimport { gql, useMutation, useQuery } from '@apollo/client';\r\nimport { selectedPropertyList } from \"../reactivevariables/reactivevariables\"\r\nimport { mergeStyles, registerIcons } from 'office-ui-fabric-react/lib/Styling';\r\nimport { CommandBarButton, IContextualMenuProps, Stack, Text, FontWeights, IconButton, IIconProps, IStackStyles, initializeIcons, DefaultButton, FocusTrapCallout, FocusZone, PrimaryButton, mergeStyleSets, ITextStyles, } from 'office-ui-fabric-react';\r\nimport { useBoolean } from '@uifabric/react-hooks';\r\nimport { IndustrialIcon, RetailIcon, OfficeIcon, MixedUseIcon } from \"../assets/svgIcons.js\"\r\nimport { FontIcon } from 'office-ui-fabric-react/lib/Icon';\r\nimport { navigationState } from \"../reactivevariables/reactivevariables\"\r\nimport \"./PropertyListItem.css\"\r\n\r\n\r\n\r\n\r\ninterface Props {\r\n    premises: Premises\r\n    propertyId: number,\r\n    key: any\r\n}\r\n\r\nexport const PremisesListItem: React.FunctionComponent<Props> = ({ premises, propertyId }) => {\r\n\r\n\r\n\r\n    const [isDeleteCalloutVisible, { toggle: toggleIsDeleteCalloutVisible }] = useBoolean(false);\r\n\r\n    \r\n\r\n\r\n    /* var selectedItems = data!.selectedItemsList!.propertyIds\r\n  \r\n  \r\n    const onChange = React.useCallback((): void => {\r\n  \r\n      const found = !!selectedItemsList().propertyIds.find((t) => t === property.propertyId);\r\n  \r\n      console.log(found)\r\n      console.log(selectedItemsList().propertyIds)\r\n      if (found) {\r\n        selectedItemsList({\r\n          propertyIds: selectedItems.filter((t) => t !== property.propertyId)\r\n        })\r\n      } else {\r\n        selectedItemsList({\r\n          propertyIds: selectedItems.concat(property.propertyId)\r\n        })\r\n      }\r\n  \r\n    }, [selectedItems]);\r\n  \r\n    var isChecked = () => {\r\n      const found = !!selectedItems.find((t) => t === property.propertyId);\r\n      console.log(found)\r\n      if (found) {\r\n        return true\r\n      } else {\r\n        return false\r\n      }\r\n    } */\r\n\r\n    const [deletePremises, { data: deletePremisesData }] = useMutation<Mutation, MutationDeletePremisesArgs>(DELETE_PREMISES);\r\n\r\n    const deletePremisesButton = () => {\r\n\r\n        deletePremises({\r\n            variables: {\r\n                premisesId: premises.premisesId\r\n            },\r\n            update(cache, { data }) {\r\n\r\n                if (!data) {\r\n                    return null;\r\n                }\r\n\r\n                const getExistingProperty = cache.readQuery<Query>({ query: GET_SINGLE_PROPERTY, variables: { propertyId: propertyId } })\r\n                const existingProperty: Property = getExistingProperty ? getExistingProperty.singleProperty! : {propertyId:1, propertyName:\"\"};\r\n             \r\n                const existingPremises = getExistingProperty ? getExistingProperty.singleProperty?.premisesList : [];\r\n                const newPremises = existingPremises!.filter(t => {\r\n                    if (t)\r\n                        return (t.premisesId !== premises.premisesId)\r\n                });  /* .returning[0] */;\r\n\r\n            const newProperty= {...existingProperty, premisesList: newPremises}\r\n                if (existingPremises)\r\n                    cache.writeQuery<Query>({\r\n                        query: GET_SINGLE_PROPERTY,\r\n                        variables: { propertyId: propertyId},\r\n                        data: { singleProperty: newProperty }\r\n                    });\r\n            }\r\n\r\n        })\r\n        toggleIsDeleteCalloutVisible()\r\n    }\r\n\r\n    /* const getPropertyIconType =() => {\r\n      var buildingType= \"\"\r\n      switch(property.buildingType) {\r\n        case \"Office\":\r\n          buildingType = \"office\"\r\n          break;\r\n        case \"Industrial\":\r\n          buildingType = \"industrial\"\r\n          break;\r\n          case \"Retail\":\r\n            buildingType = \"retail\"\r\n            break;\r\n          case \"Mixed Use\":\r\n            buildingType = \"mixeduse\"\r\n            break;\r\n        default:\r\n          buildingType = \"mixeduse\"\r\n      }\r\n      return buildingType\r\n    } */\r\n\r\n    /*  const handleSelectedPropertyClick = () => {\r\n       navigationState ( {...navigationState(), selectedPropertyId: property.propertyId})\r\n     } */\r\n\r\n\r\n    const styles = mergeStyleSets({\r\n        /*  buttonArea: {\r\n           verticalAlign: 'top',\r\n           display: 'inline-block',\r\n           textAlign: 'center',\r\n           margin: '0 100px',\r\n           minWidth: 130,\r\n           height: 32,\r\n         }, */\r\n        callout: {\r\n            maxWidth: 400,\r\n        },\r\n        header: {\r\n            padding: '18px 24px 12px',\r\n        },\r\n        title: [\r\n            {\r\n                margin: 0,\r\n                fontWeight: FontWeights.bold,\r\n            },\r\n        ],\r\n        inner: {\r\n            height: '100%',\r\n            padding: '0 24px 20px',\r\n        },\r\n        actions: {\r\n            position: 'relative',\r\n            marginTop: 20,\r\n            width: '100%',\r\n            whiteSpace: 'nowrap',\r\n        },\r\n        buttons: {\r\n            display: 'flex',\r\n            justifyContent: 'flex-end',\r\n            padding: '0 24px 24px',\r\n        },\r\n        subtext: [\r\n            {\r\n                margin: 0,\r\n                fontWeight: FontWeights.semilight,\r\n            },\r\n        ],\r\n    });\r\n\r\n\r\n    /* const checkClass = {\r\n      root: {\r\n        marginLeft: 5,\r\n        visibility: isChecked() ? \"visible\" : \"hidden\",\r\n      },\r\n      checkbox: {\r\n        borderRadius: \"50%\"\r\n      }\r\n    } */\r\n\r\n    const imageClass = mergeStyles({\r\n        width: 100,\r\n        height: 80\r\n\r\n    });\r\n\r\n    const chevronClass = mergeStyles({\r\n        alignSelf: 'center',\r\n        marginLeft: 2,\r\n        /*  marginRight: 5, */\r\n        marginTop: \"0 !important\",\r\n        /* color: palette.neutralTertiary, */\r\n        fontSize: 20,\r\n        flexShrink: 0,\r\n        cursor: \"pointer\",\r\n        /* selectors: {\r\n          '&:hover': { \"transition\": \"all .2s ease-in-out\", transform: \"scale(1.1)\" },\r\n        }, */\r\n\r\n    });\r\n\r\n    const iconClass = mergeStyles({\r\n        fontSize: 50,\r\n        height: 50,\r\n        width: 50,\r\n\r\n\r\n        marginLeft: 15,\r\n        marginRight: 15,\r\n        marginTop: \"-10px !important\",\r\n        padding: \"5px\",\r\n\r\n\r\n\r\n    });\r\n\r\n    const chevronIconDiv = mergeStyles({\r\n        /* fontSize: 50, */\r\n        height: 40,\r\n        width: 40,\r\n        lineHeight: 40,\r\n        textAlign: \"center\",\r\n        marginLeft: 15,\r\n        marginRight: 15,\r\n        marginTop: \"0px !important\",\r\n        /* padding: \"5px\", */\r\n        selectors: {\r\n            '&:hover': { backgroundColor: \"rgb(0 13 255 / 14%)\", borderRadius: 30, \"transition\": \"all .2s ease-in-out\", transform: \"scale(1.2)\" },\r\n        },\r\n\r\n    });\r\n\r\n    const boldStyle = { root: { fontWeight: FontWeights.semibold } };\r\n    const propertyHeadingStyles = { alignSelf: \"start\", fontSize: \"23px\", padding: 5, paddingLeft: \"25px\" }\r\n    const tableCellStyles: ITextStyles = { root: { alignSelf: \"start\", fontSize: \"14px\", padding: 5, marginTop: \"auto !important\", marginBottom: \"auto\", width: 45 } }\r\n    const theme = getTheme();\r\n    const iconButtonStyles = {\r\n        root: {\r\n            color: theme.palette.neutralPrimary,\r\n            marginLeft: 5,\r\n            marginTop: '0px !important',\r\n            marginRight: 5,\r\n            width: 35,\r\n            height: 35,\r\n            /*  visibility: isChecked() ? \"visible\" : \"hidden\", */\r\n\r\n        },\r\n        rootHovered: {\r\n            color: theme.palette.neutralDark,\r\n            backgroundColor: \"rgb(3 122 212 / 16%);\",\r\n            /* borderRadius: 30, */\r\n            \"transition\": \"all .2s ease-in-out\", transform: \"scale(1.1)\"\r\n\r\n        },\r\n        icon: {\r\n            fontSize: \"24px\",\r\n            marginLeft: 6\r\n\r\n        }\r\n    };\r\n\r\n    const vacantIconStyles = {\r\n        root: {\r\n           \r\n\r\n        },\r\n        rootHovered: {\r\n            backgroundColor:  \"rgb(104 113 140 / 0%)\",\r\n        },\r\n        rootActive: {\r\n            backgroundColor:    \"rgb(104 113 140 / 0%)\",\r\n        },\r\n        icon: {\r\n            fontSize: \"24px\",\r\n            marginLeft: 6\r\n\r\n        }\r\n    };\r\n\r\n    const menuIcon: IIconProps = { iconName: 'SingleColumnEdit' };\r\n    const checkIcon: IIconProps = { iconName: 'StatusCircleCheckmark' };\r\n    const crossIcon: IIconProps = { iconName: 'StatusCircleErrorX' };\r\n    const notesIcon: IIconProps = { iconName: 'DietPlanNotebook' };\r\n\r\n    const getOccDate = () => {\r\n\r\n        var date = new Date(premises.occupation)\r\n        return date.toLocaleDateString(\r\n            'en-gb',\r\n            {\r\n                year: 'numeric',\r\n                month: 'short',\r\n                day: 'numeric'\r\n            }\r\n        );\r\n    }\r\n\r\n    const getExpDate = () => {\r\n\r\n        var date = new Date(premises.leaseExpiry)\r\n        return date.toLocaleDateString(\r\n            'en-gb',\r\n            {\r\n                year: 'numeric',\r\n                month: 'short',\r\n                day: 'numeric'\r\n            }\r\n        );\r\n    }\r\n\r\n\r\n    const handlePremisesNotesClick =() => {\r\n        navigationState({ ...navigationState(), selectedPremisesId: premises.premisesId! })\r\n        navigationState({ ...navigationState(), showPremisesNotesModal: true })\r\n    \r\n    }\r\n\r\n    const handlePremisesEditClick =() => {\r\n        navigationState({ ...navigationState(), selectedPremisesId: premises.premisesId! })\r\n        navigationState({ ...navigationState(), showUpdatePremisesModal: true })\r\n    \r\n    }\r\n\r\n    const handlePremisesDuplicateClick =() => {\r\n        navigationState({ ...navigationState(), selectedPremisesId: premises.premisesId! })\r\n        navigationState({ ...navigationState(), showDuplicatePremisesModal: true })\r\n    \r\n    }\r\n\r\n    const menuProps: IContextualMenuProps = {\r\n        items: [\r\n          {\r\n            key: 'Delete Premises',\r\n            text: 'Delete Premises',\r\n            iconProps: { iconName: 'Delete' },\r\n            onClick: toggleIsDeleteCalloutVisible\r\n          },\r\n          {\r\n            key: 'Edit Premises',\r\n            text: 'Edit Premises',\r\n            iconProps: { iconName: 'Edit' },\r\n            onClick: handlePremisesEditClick\r\n          },\r\n          {\r\n            key: 'Duplicate Premises',\r\n            text: 'Duplicate Premises',\r\n            iconProps: { iconName: 'DuplicateRow' },\r\n            onClick: handlePremisesDuplicateClick\r\n          },\r\n        ],\r\n        directionalHintFixed: false,\r\n      };\r\n\r\n\r\n    return (\r\n\r\n        <Stack\r\n            horizontalAlign=\"start\"\r\n            verticalAlign=\"start\"\r\n            id={`premisesRow${premises.premisesId}`}\r\n\r\n            styles={{\r\n                root: {\r\n                     width: \"fit-content\",\r\n                    marginBottom: 10,\r\n                    marginLeft: 20,\r\n                    marginRight:\"auto\",\r\n                    /* padding: '10px', */\r\n                    textAlign: 'center',\r\n                    color: '#605e5c',\r\n                    alignItems: \"center\",\r\n                    display: \"flex\",\r\n                    flexFlow: \"row\",\r\n                    /*  borderTop: \"4px solid #2557a2;\",\r\n                     borderBottom: \"4px solid #2557a2;\", */\r\n                    backgroundColor: \"white\",\r\n                    /*  background: isChecked() ? \"rgb(104 113 140 / 14%)\" : \"white\", */\r\n                    boxShadow: \"-1px 1px 7px 2px #d4cece\",\r\n                    selectors: {\r\n                        '&:hover': { background: /* palette.neutralLight */  \"rgb(104 113 140 / 14%)\" },\r\n                    },\r\n\r\n                }\r\n            }}\r\n        >\r\n\r\n\r\n\r\n            <Stack horizontalAlign=\"start\" styles={{\r\n                root: {\r\n                   /*  width:60, */\r\n                   marginRight: 10,\r\n                    textAlign: 'center',\r\n                    color: '#605e5c',\r\n                    alignItems: \"center\",\r\n                    display: \"flex\",\r\n                    flexFlow: \"row\",\r\n                }\r\n            }}>\r\n                <IconButton\r\n                    styles={iconButtonStyles}\r\n                    id={`deletePremisesButton${premises.premisesId}`}\r\n                    menuProps={menuProps}\r\n                    iconProps={menuIcon}\r\n                    ariaLabel=\"Delete Premises\"\r\n                   /*  onClick={toggleIsDeleteCalloutVisible} */\r\n                />\r\n                {isDeleteCalloutVisible ? (\r\n                    <div>\r\n                        <FocusTrapCallout\r\n                            role=\"alertdialog\"\r\n                            className={styles.callout}\r\n                            gapSpace={0}\r\n                            target={`#deletePremisesButton${premises.premisesId}`}\r\n                            onDismiss={toggleIsDeleteCalloutVisible}\r\n                            setInitialFocus\r\n                        >\r\n                            <div className={styles.header}>\r\n                                <Text className={styles.title}>Delete Premises</Text>\r\n                            </div>\r\n                            <div className={styles.inner}>\r\n                                <div>\r\n                                    <Text className={styles.subtext}>\r\n                                        Are you sure you want to delete this premises?\r\n                </Text>\r\n                                </div>\r\n                            </div>\r\n                            <FocusZone>\r\n                                <Stack className={styles.buttons} gap={8} horizontal>\r\n                                    <PrimaryButton onClick={deletePremisesButton}>Confirm</PrimaryButton>\r\n                                    <DefaultButton onClick={toggleIsDeleteCalloutVisible}>Cancel</DefaultButton>\r\n                                </Stack>\r\n                            </FocusZone>\r\n                        </FocusTrapCallout>\r\n                    </div>\r\n                ) : null}\r\n                {/* <IconButton\r\n                    styles={iconButtonStyles}\r\n                    id={`deletePremisesButton${premises.premisesId}`}\r\n                    iconProps={deleteIcon}\r\n                    ariaLabel=\"Delete Premises\"\r\n                    onClick={toggleIsDeleteCalloutVisible}\r\n                /> */}\r\n\r\n            </Stack>\r\n\r\n\r\n\r\n            <Text styles={tableCellStyles} style={{ width: 100, borderLeft: \"3px solid rgba(210, 26, 69, 0.42) \"}}>{premises.floor}</Text>\r\n            <Text styles={tableCellStyles}>{premises.area}</Text>\r\n            <Text styles={tableCellStyles}>{premises.vacant === \"true\"?\r\n            <IconButton\r\n                    styles={vacantIconStyles}\r\n                    iconProps={checkIcon}\r\n                    ariaLabel=\"Vacant\"\r\n                />: <IconButton\r\n                styles={vacantIconStyles}\r\n                iconProps={crossIcon}\r\n                ariaLabel=\"Not vacant\"\r\n            /> }</Text>\r\n            <Text styles={tableCellStyles} style={{ width: 55,}}>{premises.type}</Text>\r\n            <Text styles={tableCellStyles} style={{ width: 100, borderRight: \"3px solid rgba(210, 26, 69, 0.42) \" , marginRight:2 }}>{getOccDate()}</Text>\r\n           {/*  <Text styles={tableCellStyles} style={{ width: 70 }}>{premises.premisesNotes}</Text> */}\r\n            <Text styles={tableCellStyles} style={{ borderLeft: \"3px solid rgba(63, 55, 189, 0.42) \", marginLeft:2}}>{premises.netRental}</Text>\r\n            <Text styles={tableCellStyles}>{premises.opCosts}</Text>\r\n            <Text styles={tableCellStyles}>{premises.other}</Text>\r\n            <Text styles={tableCellStyles}>{premises.grossRental}</Text>\r\n            <Text styles={tableCellStyles} style={{borderRight: \"3px solid rgba(63, 55, 189, 0.42) \", marginRight:2 }}>{premises.esc}</Text>\r\n            <Text styles={tableCellStyles} style={{ borderLeft: \"3px solid rgba(61, 177, 123, 0.42) \" , marginLeft:2}}>{premises.openBays?.toFixed(1).replace(/[.,]0$/, \"\")}</Text>\r\n            <Text styles={tableCellStyles}>{premises.openRate}</Text>\r\n            <Text styles={tableCellStyles} style={{ width: 50 }}>{premises.coveredBays?.toFixed(1).replace(/[.,]0$/, \"\")}</Text>\r\n            <Text styles={tableCellStyles} style={{ width: 50 }}>{premises.coveredRate}</Text>\r\n            <Text styles={tableCellStyles} style={{ width: 50 }}>{premises.shadedBays?.toFixed(1).replace(/[.,]0$/, \"\")}</Text>\r\n            <Text styles={tableCellStyles} style={{ width: 50 }}>{premises.shadedRate}</Text>\r\n            <Text styles={tableCellStyles} style={{ width: 50, borderRight: \"3px solid rgba(61, 177, 123, 0.42) \", marginRight:2 }}>{premises.parkingRatio?.toFixed(1).replace(/[.,]0$/, \"\")}</Text>\r\n            <Text styles={tableCellStyles}  style={{ width: 125, borderLeft: \"3px solid rgba(212, 236, 10, 0.42) \" , marginLeft:2 }}>{premises.tenantName}</Text>\r\n            <Text styles={tableCellStyles} style={{ width: 100, borderRight: \"3px solid rgba(212, 236, 10, 0.42) \", marginRight:2 }}>{getExpDate()}</Text>\r\n            <div style={{ width: 60, marginLeft: 10, marginRight: \"auto\", display: \"flex\" }}>\r\n                    <IconButton\r\n                    styles={iconButtonStyles}\r\n                    iconProps={notesIcon}\r\n                    ariaLabel=\"Premises Notes\"\r\n                    onClick={handlePremisesNotesClick}\r\n                />\r\n                    </div>\r\n\r\n\r\n\r\n\r\n        </Stack>\r\n\r\n    );\r\n};\r\n\r\nexport default PremisesListItem","C:\\Users\\ruper\\Desktop\\Web\\Own Projects\\Property Stock App V2\\psafrontendv2\\src\\components\\ImageSlider.tsx",["767","768","769","770","771","772","773","774","775","776","777","778","779","780","781","782","783","784","785","786","787","788","789","790","791","792"],"import * as React from \"react\";\r\nimport { useState } from \"react\";\r\nimport { motion, AnimatePresence } from \"framer-motion\";\r\nimport { wrap } from \"popmotion\";\r\nimport { mergeStyles } from 'office-ui-fabric-react/lib/Styling';\r\nimport { Icon } from 'office-ui-fabric-react/lib/Icon';\r\nimport { Image, Video, Transformation, CloudinaryContext, } from 'cloudinary-react';\r\nimport { useMutation, useQuery } from '@apollo/client';\r\nimport { UPDATE_IMAGES, GET_SINGLE_PROPERTY, GET_NAV_STATE } from \"../gql/gql\"\r\nimport { Mutation, MutationUpdatePropertyArgs, Query } from \"../schematypes/schematypes\"\r\nimport { ContextualMenu, DefaultButton, IContextualMenuProps, IIconProps, IContextualMenuItem, DirectionalHint, IContextualMenuStyles, IStyleFunctionOrObject, IContextualMenuStyleProps, FocusTrapCallout, FocusZone, Stack, Text, PrimaryButton, FontWeights, mergeStyleSets } from 'office-ui-fabric-react';\r\nimport { useBoolean } from '@uifabric/react-hooks';\r\nconst variants = {\r\n    enter: (direction: number) => {\r\n        return {\r\n            x: direction > 0 ? 1000 : -1000,\r\n            opacity: 0\r\n        };\r\n    },\r\n    center: {\r\n        zIndex: 1,\r\n        x: 0,\r\n        opacity: 1\r\n    },\r\n    exit: (direction: number) => {\r\n        return {\r\n            zIndex: 0,\r\n            x: direction < 0 ? 1000 : -1000,\r\n            opacity: 0\r\n        };\r\n    }\r\n};\r\n\r\n/**\r\n * Experimenting with distilling swipe offset and velocity into a single variable, so the\r\n * less distance a user has swiped, the more velocity they need to register as a swipe.\r\n * Should accomodate longer swipes and short flicks without having binary checks on\r\n * just distance thresholds and velocity > 0.\r\n */\r\nconst swipeConfidenceThreshold = 10000;\r\nconst swipePower = (offset: number, velocity: number) => {\r\n    return Math.abs(offset) * velocity;\r\n};\r\n\r\nconst CLOUD_NAME = process.env.REACT_APP_CLOUD_NAME\r\n\r\ntype Maybe<T> = T /* | null */;\r\n\r\ninterface Props {\r\n    propertyId: number,\r\n    /*  imagesArray: Maybe<string>[] */\r\n}\r\n\r\nexport const ImageSlider: React.FC<Props> = ({ propertyId }) => {\r\n\r\n\r\n    var locality: Maybe<string> = \"\"\r\n    var aerial: Maybe<string> = \"\"\r\n    var imagesArray: Maybe<string>[] = []\r\n    var combinedArray: Maybe<string>[] = []\r\n\r\n    \r\n\r\n    /* const {\r\n        data: navigationStateData,\r\n        loading: navigationLoading,\r\n        error: navigationError\r\n      } = useQuery<Query>(GET_NAV_STATE); */\r\n\r\n\r\n\r\n    const {\r\n        data: propertyData,\r\n        loading: propertyLoading,\r\n        error: propertyError\r\n    } = useQuery<Query>(GET_SINGLE_PROPERTY, {\r\n        variables: { propertyId: propertyId },\r\n    });\r\n\r\n    if (propertyData?.singleProperty) {\r\n        locality = propertyData?.singleProperty?.locality!\r\n        aerial = propertyData?.singleProperty?.aerial!\r\n        imagesArray = propertyData?.singleProperty?.images!\r\n\r\n        if (locality !== \"\" && locality !== null && locality !== undefined) {\r\n            combinedArray = [locality]\r\n        }\r\n        if (aerial !== \"\" && aerial !== null && aerial !== undefined) {\r\n            combinedArray = [...combinedArray, aerial]\r\n        }\r\n        combinedArray = [...combinedArray, ...imagesArray]\r\n    }\r\n\r\n    const [[page, direction], setPage] = useState([0, 0]);\r\n\r\n    const imageIndex = wrap(0, combinedArray.length, page);\r\n\r\n    const paginate = (newDirection: number) => {\r\n        setPage([page + newDirection, newDirection]);\r\n\r\n    };\r\n\r\n\r\n\r\n    const getContactId = () => {\r\n        if (propertyData?.singleProperty?.contact?.contactId === undefined || propertyData?.singleProperty?.contact?.contactId === null) {\r\n            return 45\r\n        } else {\r\n            return propertyData?.singleProperty?.contact?.contactId\r\n        }\r\n    }\r\n\r\n    const [updateProperty, { data }] = useMutation<Mutation, MutationUpdatePropertyArgs>(UPDATE_IMAGES);\r\n\r\n    const saveUpdatedImages = () => {\r\n\r\n        updateProperty({\r\n            variables: {\r\n                propertyId: propertyId,\r\n                locality: locality,\r\n                aerial: aerial,\r\n                images: imagesArray,\r\n                contactId: getContactId()\r\n            },\r\n\r\n            update(cache, { data }) {\r\n\r\n                if (!data) {\r\n                    return null;\r\n                }\r\n\r\n                const getExistingProperty = cache.readQuery<Query>({ query: GET_SINGLE_PROPERTY, variables: { propertyId: propertyId } })\r\n\r\n                const updatedProperty = data.updateProperty!;\r\n                console.log(updatedProperty)\r\n                if (getExistingProperty)\r\n                    cache.writeQuery<Query>({\r\n                        query: GET_SINGLE_PROPERTY,\r\n                        variables: { propertyId: propertyId },\r\n                        data: { singleProperty: updatedProperty }\r\n                    });\r\n            }\r\n        })\r\n        /* toggleIsDeleteCalloutVisible() */\r\n    }\r\n\r\n    const onChange = (ev?: React.MouseEvent<HTMLElement, MouseEvent> | React.KeyboardEvent<HTMLElement> | undefined, item?: IContextualMenuItem | undefined) => {\r\n        /* setSelectedItem(item); */\r\n\r\n        if (item?.key !== \"Penultimate\" && item?.key !== \"Final\") {\r\n            var selectedImage = combinedArray[imageIndex]\r\n            var rest = imagesArray.filter(image => {\r\n                return image !== selectedImage\r\n            })\r\n\r\n            var beforeSelectedImage = rest.slice(0, parseInt(item?.key!) - 1)\r\n            var afterSelectedImage = rest.slice(parseInt(item?.key!) - 1)\r\n            imagesArray = [...beforeSelectedImage, selectedImage, ...afterSelectedImage]\r\n        }\r\n\r\n        if (item?.key === \"Locality\") {\r\n            var selectedImage = combinedArray[imageIndex]\r\n            var rest = imagesArray.filter(image => {\r\n                return image !== selectedImage\r\n            })\r\n            imagesArray = rest\r\n            locality = selectedImage\r\n        }\r\n        if (item?.key === \"Aerial\") {\r\n            var selectedImage = combinedArray[imageIndex]\r\n            var rest = imagesArray.filter(image => {\r\n                return image !== selectedImage\r\n            })\r\n            imagesArray = rest\r\n            aerial = selectedImage\r\n        }\r\n        if (item?.key === \"Penultimate\") {\r\n            var penultimate = combinedArray[imageIndex]\r\n\r\n            var rest = imagesArray.filter(image => {\r\n                return image !== penultimate\r\n            })\r\n            var final = rest[rest.length - 1]\r\n            var restLessFinal = rest.slice(0, rest.length - 1)\r\n\r\n            imagesArray = [...restLessFinal, penultimate, final]\r\n        }\r\n        if (item?.key === \"Final\") {\r\n            var final = combinedArray[imageIndex]\r\n\r\n            var rest = imagesArray.filter(image => {\r\n                return image !== final\r\n            })\r\n\r\n\r\n            imagesArray = [...rest, final]\r\n        }\r\n        saveUpdatedImages()\r\n    };\r\n\r\n    \r\n\r\n    const deleteImage = () => {\r\n\r\n        switch (getImageName()) {\r\n\r\n            case \"Aerial\":\r\n\r\n                updateProperty({\r\n                    variables: {\r\n                        propertyId: propertyId,\r\n                        aerial: \"\",\r\n                        contactId: getContactId()\r\n                    },\r\n\r\n                    update(cache, { data }) {\r\n\r\n                        if (!data) {\r\n                            return null;\r\n                        }\r\n\r\n                        const getExistingProperty = cache.readQuery<Query>({ query: GET_SINGLE_PROPERTY, variables: { propertyId: propertyId } })\r\n\r\n                        const updatedProperty = data.updateProperty!;\r\n                        console.log(updatedProperty)\r\n                        if (getExistingProperty)\r\n                            cache.writeQuery<Query>({\r\n                                query: GET_SINGLE_PROPERTY,\r\n                                variables: { propertyId: propertyId },\r\n                                data: { singleProperty: updatedProperty }\r\n                            });\r\n                    }\r\n                })\r\n\r\n                break;\r\n            case \"Locality\":\r\n\r\n                updateProperty({\r\n                    variables: {\r\n                        propertyId: propertyId,\r\n                        locality: \"\",\r\n                        contactId: getContactId()\r\n                    },\r\n\r\n                    update(cache, { data }) {\r\n\r\n                        if (!data) {\r\n                            return null;\r\n                        }\r\n\r\n                        const getExistingProperty = cache.readQuery<Query>({ query: GET_SINGLE_PROPERTY, variables: { propertyId: propertyId } })\r\n\r\n                        const updatedProperty = data.updateProperty!;\r\n                        console.log(updatedProperty)\r\n                        if (getExistingProperty)\r\n                            cache.writeQuery<Query>({\r\n                                query: GET_SINGLE_PROPERTY,\r\n                                variables: { propertyId: propertyId },\r\n                                data: { singleProperty: updatedProperty }\r\n                            });\r\n                    }\r\n                })\r\n\r\n                break;\r\n\r\n            default:\r\n\r\n                updateProperty({\r\n                    variables: {\r\n                        propertyId: propertyId,\r\n                        images: imagesArray.filter(image => {\r\n                            return image !== combinedArray[imageIndex]\r\n                        }),\r\n                        contactId: getContactId()\r\n                    },\r\n\r\n                    update(cache, { data }) {\r\n\r\n                        if (!data) {\r\n                            return null;\r\n                        }\r\n\r\n                        const getExistingProperty = cache.readQuery<Query>({ query: GET_SINGLE_PROPERTY, variables: { propertyId: propertyId } })\r\n\r\n                        const updatedProperty = data.updateProperty!;\r\n                        console.log(updatedProperty)\r\n                        if (getExistingProperty)\r\n                            cache.writeQuery<Query>({\r\n                                query: GET_SINGLE_PROPERTY,\r\n                                variables: { propertyId: propertyId },\r\n                                data: { singleProperty: updatedProperty }\r\n                            });\r\n                    }\r\n                })\r\n\r\n        }\r\n        toggleIsDeleteCalloutVisible()\r\n    }\r\n\r\n    const dropdownMenuStyles: IStyleFunctionOrObject<IContextualMenuStyleProps, IContextualMenuStyles> = { container: { width: 125 } };\r\n\r\n    const menuProps: IContextualMenuProps = {\r\n        styles: dropdownMenuStyles,\r\n        // For example: disable dismiss if shift key is held down while dismissing\r\n        directionalHint: DirectionalHint.topRightEdge,\r\n        onDismiss: ev => {\r\n            if (ev && ev.shiftKey) {\r\n                ev.preventDefault();\r\n            }\r\n        },\r\n        items: [\r\n            {\r\n                key: 'Locality',\r\n                text: 'Locality',\r\n                onClick: onChange\r\n            },\r\n            {\r\n                key: 'Aerial',\r\n                text: 'Aerial',\r\n                onClick: onChange\r\n            },\r\n            {\r\n                key: '1',\r\n                text: '1',\r\n                onClick: onChange\r\n            },\r\n            {\r\n                key: '2',\r\n                text: '2',\r\n                onClick: onChange\r\n            },\r\n            {\r\n                key: '3',\r\n                text: '3',\r\n                onClick: onChange\r\n            },\r\n            {\r\n                key: '4',\r\n                text: '4',\r\n                onClick: onChange\r\n            },\r\n            {\r\n                key: '5',\r\n                text: '5',\r\n                onClick: onChange\r\n            },\r\n            {\r\n                key: '6',\r\n                text: '6',\r\n                onClick: onChange\r\n            },\r\n            {\r\n                key: '7',\r\n                text: '7',\r\n                onClick: onChange\r\n            },\r\n            {\r\n                key: '8',\r\n                text: '8',\r\n                onClick: onChange\r\n            },\r\n            {\r\n                key: 'Penultimate',\r\n                text: 'Penultimate',\r\n                onClick: onChange\r\n            },\r\n            {\r\n                key: 'Final',\r\n                text: 'Final',\r\n                onClick: onChange\r\n            },\r\n        ],\r\n        directionalHintFixed: true,\r\n    };\r\n\r\n    const getImageName = () => {\r\n\r\n        if (locality !== \"\" && locality !== null && locality !== undefined && aerial !== \"\" && aerial !== null && aerial !== undefined) {\r\n            switch (imageIndex) {\r\n                /* case 0:\r\n                  return \"Image 1\"\r\n                  break;\r\n                case 1:\r\n                    return \"Image 2\"\r\n                  break;\r\n                  case 2:\r\n                    return \"Tertiary\"\r\n                  break; */\r\n                case 0:\r\n                    return \"Locality\"\r\n                    break;\r\n                case 1:\r\n                    return \"Aerial\"\r\n                    break;\r\n                case combinedArray.length - 2:\r\n                    return \"Penultimate\"\r\n                    break;\r\n                case combinedArray.length - 1:\r\n                    return \"Final\"\r\n                    break;\r\n                default:\r\n                    return `Image ${imageIndex - 1}`\r\n            }\r\n        }\r\n\r\n        if ((locality === \"\" || locality === null || locality === undefined) && (aerial === \"\" || aerial === null || aerial === undefined)) {\r\n            switch (imageIndex) {\r\n                /* case 0:\r\n                  return \"Image 1\"\r\n                  break;\r\n                case 1:\r\n                    return \"Image 2\"\r\n                  break;\r\n                  case 2:\r\n                    return \"Tertiary\"\r\n                  break; */\r\n\r\n                case combinedArray.length - 2:\r\n                    return \"Penultimate\"\r\n                    break;\r\n                case combinedArray.length - 1:\r\n                    return \"Final\"\r\n                    break;\r\n                default:\r\n                    return `Image ${imageIndex + 1}`\r\n            }\r\n        }\r\n\r\n        if (locality === \"\" || locality === null || locality === undefined) {\r\n            switch (imageIndex) {\r\n                /* case 0:\r\n                  return \"Image 1\"\r\n                  break;\r\n                case 1:\r\n                    return \"Image 2\"\r\n                  break;\r\n                  case 2:\r\n                    return \"Tertiary\"\r\n                  break; */\r\n                case 0:\r\n                    return \"Aerial\"\r\n                    break;\r\n                case combinedArray.length - 2:\r\n                    return \"Penultimate\"\r\n                    break;\r\n                case combinedArray.length - 1:\r\n                    return \"Final\"\r\n                    break;\r\n                default:\r\n                    return `Image ${imageIndex}`\r\n            }\r\n        }\r\n\r\n        if (aerial === \"\" || aerial === null || aerial === undefined) {\r\n            switch (imageIndex) {\r\n                /* case 0:\r\n                  return \"Image 1\"\r\n                  break;\r\n                case 1:\r\n                    return \"Image 2\"\r\n                  break;\r\n                  case 2:\r\n                    return \"Tertiary\"\r\n                  break; */\r\n                case 0:\r\n                    return \"Locality\"\r\n                    break;\r\n                case combinedArray.length - 2:\r\n                    return \"Penultimate\"\r\n                    break;\r\n                case combinedArray.length - 1:\r\n                    return \"Final\"\r\n                    break;\r\n                default:\r\n                    return `Image ${imageIndex}`\r\n            }\r\n        }\r\n    }\r\n\r\n    console.log(getImageName())\r\n\r\n    function _getMenu(props: IContextualMenuProps): JSX.Element {\r\n        // Customize contextual menu with menuAs\r\n        return <ContextualMenu {...props} />;\r\n    }\r\n\r\n    function _onMenuClick(ev?: React.SyntheticEvent<any>) {\r\n        console.log(ev);\r\n    }\r\n\r\n\r\n    const dropdownStyles: Partial<IContextualMenuStyles> = { root: { /* position: \"absolute\", bottom: 10, right: 10, zIndex: 5  */ marginRight: 5, marginLeft: 5 }, container: { width: 150 } };\r\n    const deleteButtonStyles: Partial<IContextualMenuStyles> = { root: { /* position: \"absolute\", bottom: 10, right: 10, zIndex: 5  */marginLeft: \"auto\", marginRight: 5 }, container: { width: 150 } };\r\n    const chevronUpIcon: IIconProps = { iconName: 'ChevronUp' };\r\n    const deleteIcon: IIconProps = { iconName: 'Delete' };\r\n\r\n\r\n    \r\n\r\n    const sliderContainerClass: any = {\r\n        \"position\": \"relative\",\r\n        height: 500,\r\n        width: 600,\r\n        overflow: \"hidden\",\r\n        padding: 0,\r\n        margin: 0,\r\n        display: \"flex\",\r\n        justifyContent: \"center\",\r\n        alignItems: \"center\",\r\n    }\r\n\r\n\r\n    const chevronIconDivRight = mergeStyles({\r\n        /* fontSize: 50, */\r\n        height: 40,\r\n        width: 40,\r\n        lineHeight: 40,\r\n        textAlign: \"center\",\r\n        marginLeft: \"auto\",\r\n        marginRight: 10,\r\n        marginTop: \"0px !important\",\r\n        zIndex: 2,\r\n        /* padding: \"5px\", */\r\n        selectors: {\r\n            '&:hover': { backgroundColor: \"rgb(208 209 230 / 81%)\", borderRadius: 30, \"transition\": \"all .2s ease-in-out\", transform: \"scale(1.2)\" },\r\n        },\r\n\r\n    });\r\n\r\n    const chevronIconDivLeft = mergeStyles({\r\n        /* fontSize: 50, */\r\n        height: 40,\r\n        width: 40,\r\n        lineHeight: 40,\r\n        textAlign: \"center\",\r\n        marginLeft: 10,\r\n        marginRight: \"auto\",\r\n        marginTop: \"0px !important\",\r\n        zIndex: 2,\r\n        /*  backgroundColor: \"rgb(208 209 230 / 50%)\",\r\n         borderRadius: 30, */\r\n        /* padding: \"5px\", */\r\n        selectors: {\r\n            '&:hover': { backgroundColor: \"rgb(208 209 230 / 81%)\", borderRadius: 30, \"transition\": \"all .2s ease-in-out\", transform: \"scale(1.2)\" },\r\n        },\r\n\r\n    });\r\n\r\n    const chevronClassRight = mergeStyles({\r\n        alignSelf: 'center',\r\n        marginLeft: 2,\r\n        color: \"rgb(240 255 255)\",\r\n        marginTop: \"0 !important\",\r\n\r\n        fontSize: 20,\r\n        flexShrink: 0,\r\n        cursor: \"pointer\",\r\n\r\n\r\n    });\r\n\r\n    const chevronClassLeft = mergeStyles({\r\n        alignSelf: 'center',\r\n        /* marginLeft: 2, */\r\n        color: \"rgb(240 255 255)\",\r\n        marginTop: \"0 !important\",\r\n\r\n        fontSize: 20,\r\n        flexShrink: 0,\r\n        cursor: \"pointer\",\r\n        transform: \"scale(-1)\",\r\n\r\n    });\r\n\r\n    const imgStyles: any = {\r\n        \"position\": \"absolute\",\r\n        maxWidth: 600,\r\n\r\n    }\r\n\r\n    const [isDeleteCalloutVisible, { toggle: toggleIsDeleteCalloutVisible }] = useBoolean(false);\r\n\r\n    const styles = mergeStyleSets({\r\n        /*  buttonArea: {\r\n           verticalAlign: 'top',\r\n           display: 'inline-block',\r\n           textAlign: 'center',\r\n           margin: '0 100px',\r\n           minWidth: 130,\r\n           height: 32,\r\n         }, */\r\n        callout: {\r\n            maxWidth: 400,\r\n        },\r\n        header: {\r\n            padding: '18px 24px 12px',\r\n        },\r\n        title: [\r\n            {\r\n                margin: 0,\r\n                fontWeight: FontWeights.bold,\r\n            },\r\n        ],\r\n        inner: {\r\n            height: '100%',\r\n            padding: '0 24px 20px',\r\n        },\r\n        actions: {\r\n            position: 'relative',\r\n            marginTop: 20,\r\n            width: '100%',\r\n            whiteSpace: 'nowrap',\r\n        },\r\n        buttons: {\r\n            display: 'flex',\r\n            justifyContent: 'flex-end',\r\n            padding: '0 24px 24px',\r\n        },\r\n        subtext: [\r\n            {\r\n                margin: 0,\r\n                fontWeight: FontWeights.semilight,\r\n            },\r\n        ],\r\n    });\r\n\r\n    const boldStyle = { root: { fontWeight: FontWeights.semibold } };\r\n    const textStyles = { alignSelf: \"start\", fontSize: \"24px\", paddingLeft: 10, paddingRight: 10, \"white-space\": \"nowrap\" }\r\n\r\n    return (\r\n        <div style={sliderContainerClass}>\r\n            <AnimatePresence initial={false} custom={direction}>\r\n                <motion.div\r\n\r\n                    style={imgStyles}\r\n                    key={page}\r\n                    /*  src={images[imageIndex]} */\r\n                    custom={direction}\r\n                    variants={variants}\r\n                    initial=\"enter\"\r\n                    animate=\"center\"\r\n                    exit=\"exit\"\r\n                    transition={{\r\n                        x: { type: \"spring\", stiffness: 300, damping: 30 },\r\n                        opacity: { duration: 0.2 }\r\n                    }}\r\n                    drag=\"x\"\r\n                    dragConstraints={{ left: 0, right: 0 }}\r\n                    dragElastic={1}\r\n                    onDragEnd={(e, { offset, velocity }) => {\r\n                        const swipe = swipePower(offset.x, velocity.x);\r\n\r\n                        if (swipe < -swipeConfidenceThreshold) {\r\n                            paginate(1);\r\n                        } else if (swipe > swipeConfidenceThreshold) {\r\n                            paginate(-1);\r\n                        }\r\n                    }}\r\n                >\r\n\r\n                    <Image cloudName={CLOUD_NAME} publicId={combinedArray[imageIndex]} width=\"600\" height=\"400\" crop=\"fill_pad\" gravity=\"auto\" />\r\n\r\n\r\n                </motion.div>\r\n            </AnimatePresence>\r\n\r\n\r\n\r\n            <div className={chevronIconDivLeft} onClick={() => paginate(-1)}><Icon className={chevronClassLeft} iconName={'ChevronRight'} /></div>\r\n            <div className={chevronIconDivRight} onClick={() => paginate(1)}><Icon className={chevronClassRight} iconName={'ChevronRight'} /></div>\r\n\r\n            <div style={{ display: \"flex\", position: \"absolute\", bottom: 5, left: 20, zIndex: 5 }}>\r\n                <Text styles={boldStyle} style={textStyles}> {getImageName()}</Text>\r\n            </div>\r\n\r\n            <div style={{ display: \"flex\", position: \"absolute\", bottom: 0, right: 0, zIndex: 5 }}>\r\n\r\n                <DefaultButton\r\n                    id={`deleteImageButton_${propertyId}_Image_${imageIndex}`}\r\n                    styles={deleteButtonStyles}\r\n                    text=\"Delete Image\"\r\n                    iconProps={deleteIcon}\r\n                    onClick={toggleIsDeleteCalloutVisible}\r\n                />\r\n                {isDeleteCalloutVisible ? (\r\n                    <div>\r\n                        <FocusTrapCallout\r\n                            role=\"alertdialog\"\r\n                            className={styles.callout}\r\n                            gapSpace={0}\r\n                            target={`#deleteImageButton_${propertyId}_Image_${imageIndex}`}\r\n                            onDismiss={toggleIsDeleteCalloutVisible}\r\n                            setInitialFocus\r\n                        >\r\n                            <div className={styles.header}>\r\n                                <Text className={styles.title}>Delete Image</Text>\r\n                            </div>\r\n                            <div className={styles.inner}>\r\n                                <div>\r\n                                    <Text className={styles.subtext}>\r\n                                        Are you sure you want to delete this image?\r\n</Text>\r\n                                </div>\r\n                            </div>\r\n                            <FocusZone>\r\n                                <Stack className={styles.buttons} gap={8} horizontal>\r\n                                    <PrimaryButton onClick={deleteImage}>Confirm</PrimaryButton>\r\n                                    <DefaultButton onClick={toggleIsDeleteCalloutVisible}>Cancel</DefaultButton>\r\n                                </Stack>\r\n                            </FocusZone>\r\n                        </FocusTrapCallout>\r\n                    </div>\r\n                ) : null}\r\n                <DefaultButton\r\n                    styles={dropdownStyles}\r\n                    text=\"Set Image\"\r\n                    menuIconProps={chevronUpIcon}\r\n                    menuProps={menuProps}\r\n                    menuAs={_getMenu}\r\n                    onMenuClick={_onMenuClick}\r\n                />\r\n\r\n            </div>\r\n\r\n\r\n        </div>\r\n\r\n    );\r\n};\r\n\r\nexport default ImageSlider","C:\\Users\\ruper\\Desktop\\Web\\Own Projects\\Property Stock App V2\\psafrontendv2\\src\\components\\PDFOutput\\PropertyListScheduleNoImages.tsx",[],"C:\\Users\\ruper\\Desktop\\Web\\Own Projects\\Property Stock App V2\\psafrontendv2\\src\\components\\FilterModal.tsx",["793","794","795","796","797","798","799","800","801","802","803","804","805","806","807","808","809","810","811","812","813","814","815","816","817","818","819","820","821","822","823","824","825","826","827","828","829","830","831","832","833","834","835","836","837","838","839","840","841"],"import React, { CSSProperties, useState } from 'react';\r\nimport { useId, useBoolean } from '@uifabric/react-hooks';\r\nimport { TextField, ITextFieldStyles } from 'office-ui-fabric-react/lib/TextField';\r\nimport { Dropdown, DropdownMenuItemType, IDropdownOption, IDropdownStyles } from 'office-ui-fabric-react/lib/Dropdown';\r\nimport { Slider } from 'office-ui-fabric-react/lib/Slider';\r\nimport { IStackStyles, Stack } from 'office-ui-fabric-react/lib/Stack';\r\nimport { IRenderFunction, IStyleFunctionOrObject } from 'office-ui-fabric-react/lib/Utilities';\r\nimport {\r\n    getTheme,\r\n    mergeStyleSets,\r\n    FontWeights,\r\n    ContextualMenu,\r\n    Toggle,\r\n    IToggleStyles,\r\n    DefaultButton,\r\n    Modal,\r\n    IDragOptions,\r\n    IconButton,\r\n    IIconProps,\r\n    IModalStyles,\r\n    mergeStyles,\r\n    ComboBox,\r\n    Fabric,\r\n    IComboBoxOption,\r\n    IComboBox,\r\n    SelectableOptionMenuItemType,\r\n    IComboBoxStyles,\r\n    DatePicker,\r\n    DayOfWeek,\r\n    IDatePickerStrings,\r\n    IDatePickerStyleProps,\r\n    IDatePickerStyles,\r\n    ICalendarProps,\r\n    Label\r\n} from 'office-ui-fabric-react';\r\nimport { Pivot, PivotItem } from 'office-ui-fabric-react/lib/Pivot';\r\nimport { defaultDataIdFromObject, gql, useMutation, useQuery } from '@apollo/client';\r\nimport { GET_SINGLE_PROPERTY, NEW_PREMISES, GET_NAV_STATE, GET_FILTER_VARIABLES } from \"../gql/gql\"\r\nimport { Mutation, MutationPostPremisesArgs, Query, Property, Premises, FilterVariables } from \"../schematypes/schematypes\"\r\nimport { navigationState, filterVariables as filterVariablesVar } from \"../reactivevariables/reactivevariables\"\r\nimport Select from 'react-select';\r\n\r\nimport \"./NewPremisesModal.css\"\r\n\r\n\r\n\r\nconst dragOptions: IDragOptions = {\r\n    moveMenuItemText: 'Move',\r\n    closeMenuItemText: 'Close',\r\n    menu: ContextualMenu,\r\n};\r\nconst cancelIcon: IIconProps = { iconName: 'Cancel' };\r\nconst filterIcon: IIconProps = { iconName: 'Filter' };\r\nconst clearFilterIcon: IIconProps = { iconName: 'ClearFilter' };\r\n\r\ntype FilterFormattedOptions = {\r\n    value: string;\r\n    label: string;\r\n}\r\n\r\ntype DistinctSuburbFilterOptions = {\r\n    label: string,\r\n    options: FilterFormattedOptions[],\r\n}[]\r\n\r\ntype DistinctRegionFilterOptions = {\r\n    label: string,\r\n    options: FilterFormattedOptions[],\r\n}[]\r\n\r\ninterface Props {\r\n    showFilterModal: boolean\r\n    distinctSuburbsFilterOptions: DistinctSuburbFilterOptions;\r\n    distinctRegionFilterOptions: DistinctRegionFilterOptions\r\n    landlordsFilterOptions: FilterFormattedOptions[];\r\n}\r\n\r\nexport const FilterModal: React.FC<Props> = ({ showFilterModal, distinctSuburbsFilterOptions, distinctRegionFilterOptions, landlordsFilterOptions }) => {\r\n\r\n\r\n\r\n    const {\r\n        data: filterData,\r\n        loading: filterLoading,\r\n        error: filterError\r\n    } = useQuery<Query>(GET_FILTER_VARIABLES);\r\n\r\n    const [filterVariables, setFilterVariables] = React.useState<FilterVariables>(filterData?.filterVariables!);\r\n\r\n    const applyFilter = () => {\r\n        filterVariablesVar({\r\n            suburb: filterVariables.suburb,\r\n            region: filterVariables.region,\r\n            province: filterVariables.province,\r\n            buildingType: filterVariables.buildingType,\r\n            erfExtentMin: filterVariables.erfExtentMin,\r\n            erfExtentMax: filterVariables.erfExtentMax,\r\n            totalGLAMin: filterVariables.totalGLAMin,\r\n            totalGLAMax: filterVariables.totalGLAMax,\r\n            vacantGLAMin: filterVariables.vacantGLAMin,\r\n            vacantGLAMax: filterVariables.vacantGLAMax,\r\n            earliestOccMin: filterVariables.earliestOccMin,\r\n            earliestOccMax: filterVariables.earliestOccMax,\r\n            earliestExpMin: filterVariables.earliestExpMin,\r\n            earliestExpMax: filterVariables.earliestExpMax,\r\n            landlord: filterVariables.landlord,\r\n        })\r\n    }\r\n\r\n    const clearFilter = () => {\r\n        suburbRef.current.select.clearValue();\r\n        regionRef.current.select.clearValue();\r\n        provinceRef.current.select.clearValue();\r\n        buildingTypeRef.current.select.clearValue();\r\n        landlordRef.current.select.clearValue();\r\n\r\n        filterVariablesVar({\r\n            suburb: [],\r\n            region: [],\r\n            province: [],\r\n            buildingType: [],\r\n            erfExtentMin: 0,\r\n            erfExtentMax: 0,\r\n            totalGLAMin: 0,\r\n            totalGLAMax: 0,\r\n            vacantGLAMin: 0,\r\n            vacantGLAMax: 0,\r\n            earliestOccMin: new Date(\"01/01/2020\"),\r\n            earliestOccMax: new Date(\"01/01/2020\"),\r\n            earliestExpMin: new Date(\"01/01/2020\"),\r\n            earliestExpMax: new Date(\"01/01/2020\"),\r\n            landlord: [],\r\n        })\r\n\r\n        setFilterVariables({\r\n            suburb: [],\r\n            region: [],\r\n            province: [],\r\n            buildingType: [],\r\n            erfExtentMin: 0,\r\n            erfExtentMax: 0,\r\n            totalGLAMin: 0,\r\n            totalGLAMax: 0,\r\n            vacantGLAMin: 0,\r\n            vacantGLAMax: 0,\r\n            earliestOccMin: new Date(\"01/01/2020\"),\r\n            earliestOccMax: new Date(\"01/01/2020\"),\r\n            earliestExpMin: new Date(\"01/01/2020\"),\r\n            earliestExpMax: new Date(\"01/01/2020\"),\r\n            landlord: [],\r\n        })\r\n\r\n\r\n    }\r\n\r\n\r\n\r\n    console.log(filterData)\r\n\r\n\r\n\r\n\r\n\r\n    const hideFilterModal = () => {\r\n\r\n        navigationState({ ...navigationState(), showFilterModal: false })\r\n\r\n    }\r\n\r\n    const getNextMonth = () => {\r\n        const date = new Date();\r\n        const today = date.getDate();\r\n        const currentMonth = date.getMonth() + 1;\r\n        const currentYear = date.getFullYear();\r\n        var newDate = new Date(currentYear, currentMonth, 1);\r\n        return newDate.toISOString()\r\n\r\n    }\r\n\r\n\r\n\r\n\r\n    const onSelectSuburb = React.useCallback(\r\n        (value: any) => {\r\n\r\n            setFilterVariables({ ...filterVariables, suburb: value.map((suburb: any) => { return suburb.value }) });\r\n        }, [filterVariables])\r\n\r\n    const onSelectRegion = React.useCallback(\r\n        (value: any) => {\r\n\r\n            setFilterVariables({ ...filterVariables, region: value.map((region: any) => { return region.value }) });\r\n        }, [filterVariables])\r\n\r\n    const onSelectProvince = React.useCallback(\r\n        (value: any) => {\r\n\r\n            setFilterVariables({ ...filterVariables, province: value.map((province: any) => { return province.value }) });\r\n        }, [filterVariables])\r\n\r\n    const onSelectBuildingType = React.useCallback(\r\n        (value: any) => {\r\n\r\n            setFilterVariables({ ...filterVariables, buildingType: value.map((buildingType: any) => { return buildingType.value }) });\r\n        }, [filterVariables])\r\n\r\n    const onSelectLandlord = React.useCallback(\r\n        (value: any) => {\r\n\r\n            setFilterVariables({ ...filterVariables, landlord: value.map((landlord: any) => { return landlord.value }) });\r\n        }, [filterVariables])\r\n\r\n\r\n    const getSliderMinGLAValue = React.useCallback(\r\n        () => {\r\n            if (filterData !== undefined) {\r\n                return filterVariables.vacantGLAMin\r\n            } else return undefined\r\n\r\n        }, [filterVariables, filterData])\r\n\r\n    const getSliderMaxGLAValue = () => {\r\n        if (filterData !== undefined) {\r\n            return filterVariables.vacantGLAMax\r\n        } else return undefined\r\n\r\n    }\r\n\r\n    const sliderMinGLAOnChange = React.useCallback(\r\n        (value: number) => {\r\n            setFilterVariables({ ...filterVariables, vacantGLAMin: value });\r\n        }, [filterVariables])\r\n\r\n    const sliderMaxGLAOnChange = React.useCallback(\r\n        (value: number) => {\r\n            setFilterVariables({ ...filterVariables, vacantGLAMax: value });\r\n        }, [filterVariables])\r\n\r\n\r\n\r\n    const sliderAriaValueText = (value: number) => `${value}m²`;\r\n    const sliderValueFormat = (value: number) => `${value}m²`;\r\n\r\n    const onSelectMinOccupationDate = React.useCallback(\r\n        (date: Date | null | undefined) => {\r\n            if (date !== undefined && date !== null)\r\n                setFilterVariables({ ...filterVariables, earliestOccMin: date });\r\n        },\r\n        [filterVariables])\r\n\r\n    const onSelectMaxOccupationDate = React.useCallback(\r\n        (date: Date | null | undefined) => {\r\n            if (date !== undefined && date !== null)\r\n                setFilterVariables({ ...filterVariables, earliestOccMax: date });\r\n        },\r\n        [filterVariables])\r\n\r\n    const onFormatDate = (date?: Date): string => {\r\n        return !date ? '' : date.toLocaleDateString(\r\n            'en-gb',\r\n            {\r\n                year: 'numeric',\r\n                month: 'long',\r\n                day: 'numeric'\r\n            }\r\n        );\r\n    };\r\n\r\n    const checkDates = (first: Date | undefined, second: Date | undefined) => {\r\n        if (first && second)\r\n            if (first.getFullYear() === second.getFullYear() &&\r\n                first.getMonth() === second.getMonth() &&\r\n                first.getDate() === second.getDate()) {\r\n                return true\r\n            } else return false\r\n    }\r\n\r\n   \r\n\r\n    var startDate = new Date(\"01/01/2020\")\r\n\r\n\r\n\r\n\r\n    const textFieldStyles: Partial<ITextFieldStyles> = { fieldGroup: { width: 200, marginRight: 20 } };\r\n    const textFieldFloorStyles: Partial<ITextFieldStyles> = { fieldGroup: { width: 200, marginRight: 20 } };\r\n    const textFieldAreaStyles: Partial<ITextFieldStyles> = { fieldGroup: { width: 150, marginRight: 20 } };\r\n    const textFieldEscStyles: Partial<ITextFieldStyles> = { fieldGroup: { width: 150, marginRight: 20 } };\r\n    const textFieldCoordinatesStyles: Partial<ITextFieldStyles> = { fieldGroup: { width: 150, marginRight: 20 } };\r\n    const textFieldErfStyles: Partial<ITextFieldStyles> = { fieldGroup: { width: 200, marginRight: 20 } };\r\n    const textFieldNotesStyles: Partial<ITextFieldStyles> = { fieldGroup: { width: 470 } };\r\n    const dropdownStyles: Partial<IDropdownStyles> = { dropdown: { width: 125, marginRight: 20 } };\r\n    const dropdownSectorStyles: Partial<IDropdownStyles> = { dropdown: { width: 420, marginRight: 20 } };\r\n    const dropdownProvinceStyles: Partial<IDropdownStyles> = { dropdown: { width: 140, marginRight: 20 } };\r\n    const comboBoxStyles: Partial<IComboBoxStyles> = { root: { width: 140, marginRight: 20 } }\r\n\r\n    const textFieldParkingBaysStyles: Partial<ITextFieldStyles> = { fieldGroup: { width: 100, marginRight: 20 } };\r\n    const textFieldParkingRateStyles: Partial<ITextFieldStyles> = { fieldGroup: { width: 185, marginRight: 20 } };\r\n    const textFieldParkingRatioStyles: Partial<ITextFieldStyles> = { fieldGroup: { width: 140, marginRight: 20 } };\r\n\r\n    const toggleStyles: Partial<IToggleStyles> = { container: { marginTop: 5 }, label: { marginLeft: 4 } };\r\n    const modalStyles: Partial<IModalStyles> = { main: { position: \"absolute\", top: 150 }, };\r\n\r\n    const datePickerStyles: IStyleFunctionOrObject<IDatePickerStyleProps, IDatePickerStyles> = { root: { width: 160, marginRight: 20 }, callout: {} }\r\n\r\n    /* const calendarProps: ICalendarProps ={styles  } */\r\n\r\n    const groupStyles = {\r\n        display: 'flex',\r\n        alignItems: 'center',\r\n        justifyContent: 'space-between',\r\n    };\r\n    const groupBadgeStyles: CSSProperties = {\r\n        backgroundColor: '#EBECF0',\r\n        borderRadius: '2em',\r\n        color: '#172B4D',\r\n        display: 'inline-block',\r\n        fontSize: 12,\r\n        fontWeight: 'normal',\r\n        lineHeight: '1',\r\n        minWidth: 1,\r\n        padding: '0.16666666666667em 0.5em',\r\n        textAlign: 'center',\r\n\r\n    };\r\n\r\n    const formatGroupLabel = (data: any) => {\r\n        return (\r\n            <div style={groupStyles}>\r\n                <span>{data.label}</span>\r\n                <span style={groupBadgeStyles}>{data.options.length}</span>\r\n            </div>\r\n        )\r\n    };\r\n\r\n    const customStyles = {\r\n        menu: (provided: any, state: any) => ({\r\n            ...provided,\r\n            width: \"100%\",\r\n            borderBottom: '1px dotted pink',\r\n            color: state.selectProps.menuColor,\r\n            padding: 5,\r\n        }),\r\n        menuList: (provided: any, state: any) => ({\r\n            ...provided,\r\n            height: \"200px\",\r\n            width: \"100%\",\r\n        }),\r\n        container: (provided: any, state: any) => ({\r\n            ...provided,\r\n            width: \"100%\",\r\n            height: \"fit-content\"\r\n        }),\r\n    }\r\n\r\n    const customStylesProvince = {\r\n        menu: (provided: any, state: any) => ({\r\n            ...provided,\r\n            width: \"100%\",\r\n            borderBottom: '1px dotted pink',\r\n            color: state.selectProps.menuColor,\r\n            padding: 5,\r\n        }),\r\n        menuList: (provided: any, state: any) => ({\r\n            ...provided,\r\n            height: \"150px\",\r\n            width: \"100%\",\r\n        }),\r\n        container: (provided: any, state: any) => ({\r\n            ...provided,\r\n            width: \"100%\",\r\n            height: \"fit-content\"\r\n        }),\r\n    }\r\n\r\n    const customStylesBuildingType = {\r\n        menu: (provided: any, state: any) => ({\r\n            ...provided,\r\n            width: \"100%\",\r\n            borderBottom: '1px dotted pink',\r\n            color: state.selectProps.menuColor,\r\n            padding: 5,\r\n        }),\r\n        menuList: (provided: any, state: any) => ({\r\n            ...provided,\r\n            height: \"150px\",\r\n            width: \"100%\",\r\n        }),\r\n        container: (provided: any, state: any) => ({\r\n            ...provided,\r\n            width: \"100%\",\r\n            height: \"fit-content\"\r\n        }),\r\n    }\r\n\r\n\r\n\r\n    const headerIconStackStyles: Partial<IStackStyles> = { root: { marginRight: 0, marginLeft: \"auto\", } }\r\n\r\n    const DayPickerStrings: IDatePickerStrings = {\r\n        months: [\r\n            'January',\r\n            'February',\r\n            'March',\r\n            'April',\r\n            'May',\r\n            'June',\r\n            'July',\r\n            'August',\r\n            'September',\r\n            'October',\r\n            'November',\r\n            'December',\r\n        ],\r\n\r\n        shortMonths: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],\r\n\r\n        days: ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'],\r\n\r\n        shortDays: ['S', 'M', 'T', 'W', 'T', 'F', 'S'],\r\n\r\n        goToToday: 'Go to today',\r\n        prevMonthAriaLabel: 'Go to previous month',\r\n        nextMonthAriaLabel: 'Go to next month',\r\n        prevYearAriaLabel: 'Go to previous year',\r\n        nextYearAriaLabel: 'Go to next year',\r\n        closeButtonAriaLabel: 'Close date picker',\r\n        monthPickerHeaderAriaLabel: '{0}, select to change the year',\r\n        yearPickerHeaderAriaLabel: '{0}, select to change the month',\r\n    };\r\n\r\n    const controlClass = mergeStyleSets({\r\n        control: {\r\n            margin: '0 0 15px 0',\r\n            maxWidth: '300px',\r\n        },\r\n\r\n    });\r\n\r\n    const provinceOptions = [\r\n\r\n        { value: 'WC', label: 'Western Cape' },\r\n        { value: 'GAU', label: 'Gauteng' },\r\n        { value: 'KZN', label: 'KwaZulu Natal' },\r\n        { value: 'Other', label: 'Other' },\r\n\r\n    ];\r\n\r\n    const buildingTypeOptions = [\r\n\r\n        { value: 'Office', label: 'Office' },\r\n        { value: 'Industrial', label: 'Industrial' },\r\n        { value: 'Retail', label: 'Retail' },\r\n        { value: 'Mixed Use', label: 'Mixed Use' },\r\n\r\n    ];\r\n\r\n\r\n\r\n    console.log(distinctSuburbsFilterOptions)\r\n\r\n    const suburbRef: any = React.useRef()\r\n    const regionRef: any = React.useRef()\r\n    const provinceRef: any = React.useRef()\r\n    const buildingTypeRef: any = React.useRef()\r\n    const landlordRef: any = React.useRef()\r\n\r\n    return (\r\n        <div>\r\n\r\n\r\n            <Modal\r\n                styles={modalStyles}\r\n\r\n\r\n                isOpen={showFilterModal}\r\n                /*  onDismiss={hideDuplicatePremisesModal} */\r\n                isBlocking={false}\r\n                containerClassName={contentStyles.container}\r\n            /* dragOptions={dragOptions} */\r\n            >\r\n                <div className={contentStyles.header}>\r\n                    <span >Filter Properties</span>\r\n                    <Stack horizontal\r\n                        styles={headerIconStackStyles}\r\n                    >\r\n\r\n                        <IconButton\r\n                            styles={iconButtonStyles}\r\n                            iconProps={filterIcon}\r\n                            ariaLabel=\"Apply Filter\"\r\n                            onClick={applyFilter}\r\n                        />\r\n                        <IconButton\r\n                            styles={iconButtonStyles}\r\n                            iconProps={clearFilterIcon}\r\n                            ariaLabel=\"Clear Filter\"\r\n                            onClick={clearFilter}\r\n                        />\r\n                        <IconButton\r\n                            styles={iconButtonStyles}\r\n                            iconProps={cancelIcon}\r\n                            ariaLabel=\"Close popup modal\"\r\n                            onClick={hideFilterModal}\r\n                        />\r\n\r\n                    </Stack>\r\n\r\n                </div>\r\n                <div className={contentStyles.body} >\r\n\r\n                    <Stack /* tokens={stackTokens} */>\r\n\r\n                        <Stack verticalFill\r\n                            styles={{\r\n                                root: {\r\n                                    color: '#605e5c',\r\n                                    marginLeft: \"0px\",\r\n                                }\r\n                            }}>\r\n\r\n                            <Label>Suburb</Label>\r\n\r\n                            <Select\r\n                                ref={suburbRef}\r\n                                key=\"suburb\"\r\n                                isMulti\r\n                                styles={customStyles}\r\n                                /*  defaultValue={colourOptions[1]} */\r\n                                options={distinctSuburbsFilterOptions}\r\n                                formatGroupLabel={formatGroupLabel}\r\n                                onChange={onSelectSuburb}\r\n                                values={filterVariables.suburb!.map((suburb) => { return { value: suburb, label: suburb } })}\r\n                                defaultValue={filterVariables.suburb!.map((suburb) => { return { value: suburb, label: suburb } })}\r\n\r\n                            />\r\n                        </Stack>\r\n\r\n                        <Stack verticalFill\r\n                            styles={{\r\n                                root: {\r\n                                    color: '#605e5c',\r\n                                    marginLeft: \"0px\",\r\n                                    marginTop: \"5px !important\"\r\n                                }\r\n                            }}>\r\n\r\n                            <Label>Region</Label>\r\n\r\n                            <Select\r\n                                ref={regionRef}\r\n                                key=\"region\"\r\n                                isMulti\r\n                                styles={customStyles}\r\n                                /*  defaultValue={colourOptions[1]} */\r\n                                options={distinctRegionFilterOptions}\r\n                                formatGroupLabel={formatGroupLabel}\r\n                                onChange={onSelectRegion}\r\n                                values={filterVariables.region!.map((region) => { return { value: region, label: region } })}\r\n                                defaultValue={filterVariables.region!.map((region) => { return { value: region, label: region } })}\r\n                            />\r\n                        </Stack>\r\n\r\n                        <Stack verticalFill\r\n                            styles={{\r\n                                root: {\r\n                                    color: '#605e5c',\r\n                                    marginLeft: \"0px\",\r\n                                    marginTop: \"5px !important\"\r\n                                }\r\n                            }}>\r\n\r\n                            <Label>Province</Label>\r\n\r\n                            <Select\r\n                                ref={provinceRef}\r\n                                key=\"province\"\r\n                                isMulti\r\n                                styles={customStylesProvince}\r\n                                /*  defaultValue={colourOptions[1]} */\r\n                                options={provinceOptions}\r\n                                formatGroupLabel={formatGroupLabel}\r\n                                onChange={onSelectProvince}\r\n                                values={filterVariables.province!.map((province) => { return { value: province, label: province } })}\r\n                                defaultValue={filterVariables.province!.map((province) => { return { value: province, label: province } })}\r\n                            />\r\n                        </Stack>\r\n\r\n                        <Stack horizontal>\r\n\r\n                            <Stack verticalFill\r\n                                styles={{\r\n                                    root: {\r\n                                        color: '#605e5c',\r\n                                        marginLeft: \"0px\",\r\n                                        width: \"60%\",\r\n                                        marginTop: \"5px !important\"\r\n                                    }\r\n                                }}>\r\n\r\n                                <Label>Building Type</Label>\r\n\r\n                                <Select\r\n                                    ref={buildingTypeRef}\r\n                                    key=\"buildingType\"\r\n                                    isMulti\r\n                                    styles={customStylesBuildingType}\r\n                                    /*  defaultValue={colourOptions[1]} */\r\n                                    options={buildingTypeOptions}\r\n                                    formatGroupLabel={formatGroupLabel}\r\n                                    onChange={onSelectBuildingType}\r\n                                    values={filterVariables.buildingType!.map((buildingType) => { return { value: buildingType, label: buildingType } })}\r\n                                    defaultValue={filterVariables.buildingType!.map((buildingType) => { return { value: buildingType, label: buildingType } })}\r\n                                />\r\n                            </Stack>\r\n\r\n                            <Stack verticalFill\r\n                                styles={{\r\n                                    root: {\r\n                                        color: '#605e5c',\r\n                                        marginLeft: \"auto !important\",\r\n                                        marginRight: 0,\r\n                                        width: \"35%\",\r\n                                        marginTop: \"5px !important\"\r\n                                    }\r\n                                }}>\r\n\r\n                                <Label>Landlord</Label>\r\n\r\n                                <Select\r\n                                    ref={landlordRef}\r\n                                    key=\"landlord\"\r\n                                    isMulti\r\n                                    styles={customStyles}\r\n                                    /*  defaultValue={colourOptions[1]} */\r\n                                    options={landlordsFilterOptions}\r\n                                    formatGroupLabel={formatGroupLabel}\r\n                                    onChange={onSelectLandlord}\r\n                                    values={filterVariables.landlord!.map((landlord) => { return { value: landlord, label: landlord } })}\r\n                                    defaultValue={filterVariables.landlord!.map((landlord) => { return { value: landlord, label: landlord } })}\r\n                                />\r\n                            </Stack>\r\n\r\n                        </Stack>\r\n\r\n                        <Stack styles={{ root: { marginTop: \"10px !important\" } }}>\r\n\r\n                            <Slider\r\n                                label=\"Minimum Vacant GLA\"\r\n                                max={20000}\r\n                                value={getSliderMinGLAValue()}\r\n\r\n                                showValue\r\n                                step={20}\r\n                                ariaValueText={sliderAriaValueText}\r\n                                valueFormat={sliderValueFormat}\r\n                                // eslint-disable-next-line react/jsx-no-bind\r\n                                onChange={sliderMinGLAOnChange}\r\n                            />\r\n\r\n                        </Stack>\r\n\r\n                        <Stack styles={{ root: { marginTop: \"5px !important\" } }}>\r\n\r\n                            <Slider\r\n                                label=\"Maximum Vacant GLA\"\r\n                                max={20000}\r\n                                value={getSliderMaxGLAValue()}\r\n                                showValue\r\n                                step={20}\r\n                                ariaValueText={sliderAriaValueText}\r\n                                valueFormat={sliderValueFormat}\r\n                                // eslint-disable-next-line react/jsx-no-bind\r\n                                onChange={sliderMaxGLAOnChange}\r\n                            />\r\n\r\n                        </Stack>\r\n\r\n\r\n\r\n\r\n\r\n                        <Stack horizontal styles={{\r\n                            root: {\r\n                                /* width: '400px', */\r\n                                /*  margin: '10px', */\r\n\r\n                                color: '#605e5c',\r\n\r\n                                marginLeft: \"0px\",\r\n                                marginRight: \"auto\",\r\n                                marginBottom: 10,\r\n                                marginTop: \"5px !important\"\r\n                                /* display: \"block\" */\r\n\r\n                            }\r\n\r\n                        }}>\r\n\r\n\r\n\r\n                            <DatePicker\r\n                                label=\"Min Occupation Date\"\r\n                                className={controlClass.control}\r\n                                firstDayOfWeek={DayOfWeek.Monday}\r\n                                strings={DayPickerStrings}\r\n                                placeholder=\"Select a date...\"\r\n                                ariaLabel=\"Select a date\"\r\n                                value={filterVariables === undefined || checkDates(filterVariables.earliestOccMin, startDate) ? undefined : filterVariables.earliestOccMin}\r\n                                onSelectDate={onSelectMinOccupationDate}\r\n                                formatDate={onFormatDate}\r\n                                styles={datePickerStyles}\r\n\r\n                            />\r\n\r\n                            <DatePicker\r\n                                label=\"Max Occupation Date\"\r\n                                className={controlClass.control}\r\n                                firstDayOfWeek={DayOfWeek.Monday}\r\n                                strings={DayPickerStrings}\r\n                                placeholder=\"Select a date...\"\r\n                                ariaLabel=\"Select a date\"\r\n                                value={filterVariables === undefined || checkDates(filterVariables.earliestOccMax, startDate) ? undefined : filterVariables.earliestOccMax}\r\n                                onSelectDate={onSelectMaxOccupationDate}\r\n                                formatDate={onFormatDate}\r\n                                styles={datePickerStyles}\r\n\r\n                            />\r\n\r\n                        </Stack>\r\n\r\n                    </Stack>\r\n\r\n\r\n                </div>\r\n            </Modal>\r\n        </div>\r\n    );\r\n};\r\n\r\nconst theme = getTheme();\r\nconst contentStyles = mergeStyleSets({\r\n    container: {\r\n        display: 'flex',\r\n        flexFlow: 'column nowrap',\r\n        alignItems: 'stretch',\r\n        width: 525,\r\n\r\n    },\r\n\r\n    header: [\r\n\r\n        theme.fonts.xLargePlus,\r\n        {\r\n            flex: '1 1 auto',\r\n            borderTop: `4px solid ${theme.palette.themePrimary}`,\r\n            color: theme.palette.neutralPrimary,\r\n            display: 'flex',\r\n            alignItems: 'center',\r\n            fontWeight: FontWeights.semibold,\r\n            padding: '12px 12px 14px 24px',\r\n        },\r\n    ],\r\n    body: {\r\n        flex: '4 4 auto',\r\n        padding: '0 24px 24px 24px',\r\n        overflowY: 'hidden',\r\n        selectors: {\r\n            p: { margin: '14px 0' },\r\n            'p:first-child': { marginTop: 0 },\r\n            'p:last-child': { marginBottom: 0 },\r\n        },\r\n    },\r\n});\r\n\r\nconst iconButtonStyles = {\r\n    root: {\r\n        color: theme.palette.neutralPrimary,\r\n        marginLeft: \"10px !important\",\r\n        marginTop: '4px',\r\n        marginRight: '2px',\r\n\r\n    },\r\n    rootHovered: {\r\n        color: theme.palette.neutralDark,\r\n    },\r\n    icon: {\r\n        fontSize: \"24px\",\r\n\r\n    }\r\n};\r\n\r\nexport default FilterModal\r\n","C:\\Users\\ruper\\Desktop\\Web\\Own Projects\\Property Stock App V2\\psafrontendv2\\src\\components\\AnimatedListItem.tsx",[],{"ruleId":"842","severity":1,"message":"843","line":6,"column":10,"nodeType":"844","messageId":"845","endLine":6,"endColumn":20},{"ruleId":"842","severity":1,"message":"846","line":8,"column":10,"nodeType":"844","messageId":"845","endLine":8,"endColumn":20},{"ruleId":"842","severity":1,"message":"847","line":9,"column":10,"nodeType":"844","messageId":"845","endLine":9,"endColumn":19},{"ruleId":"842","severity":1,"message":"848","line":13,"column":3,"nodeType":"844","messageId":"845","endLine":13,"endColumn":16},{"ruleId":"842","severity":1,"message":"849","line":14,"column":3,"nodeType":"844","messageId":"845","endLine":14,"endColumn":6},{"ruleId":"842","severity":1,"message":"850","line":17,"column":3,"nodeType":"844","messageId":"845","endLine":17,"endColumn":13},{"ruleId":"842","severity":1,"message":"851","line":18,"column":13,"nodeType":"844","messageId":"845","endLine":18,"endColumn":21},{"ruleId":"852","replacedBy":"853"},{"ruleId":"854","replacedBy":"855"},{"ruleId":"842","severity":1,"message":"856","line":17,"column":11,"nodeType":"844","messageId":"845","endLine":17,"endColumn":22},{"ruleId":"842","severity":1,"message":"857","line":21,"column":11,"nodeType":"844","messageId":"845","endLine":21,"endColumn":23},{"ruleId":"842","severity":1,"message":"858","line":2,"column":8,"nodeType":"844","messageId":"845","endLine":2,"endColumn":12},{"ruleId":"842","severity":1,"message":"859","line":7,"column":10,"nodeType":"844","messageId":"845","endLine":7,"endColumn":14},{"ruleId":"842","severity":1,"message":"860","line":7,"column":16,"nodeType":"844","messageId":"845","endLine":7,"endColumn":20},{"ruleId":"842","severity":1,"message":"861","line":7,"column":22,"nodeType":"844","messageId":"845","endLine":7,"endColumn":33},{"ruleId":"842","severity":1,"message":"862","line":8,"column":3,"nodeType":"844","messageId":"845","endLine":8,"endColumn":12},{"ruleId":"842","severity":1,"message":"863","line":12,"column":34,"nodeType":"844","messageId":"845","endLine":12,"endColumn":54},{"ruleId":"842","severity":1,"message":"849","line":13,"column":10,"nodeType":"844","messageId":"845","endLine":13,"endColumn":13},{"ruleId":"842","severity":1,"message":"864","line":13,"column":25,"nodeType":"844","messageId":"845","endLine":13,"endColumn":40},{"ruleId":"842","severity":1,"message":"865","line":25,"column":10,"nodeType":"844","messageId":"845","endLine":25,"endColumn":19},{"ruleId":"842","severity":1,"message":"866","line":25,"column":21,"nodeType":"844","messageId":"845","endLine":25,"endColumn":36},{"ruleId":"842","severity":1,"message":"867","line":25,"column":38,"nodeType":"844","messageId":"845","endLine":25,"endColumn":46},{"ruleId":"842","severity":1,"message":"868","line":25,"column":48,"nodeType":"844","messageId":"845","endLine":25,"endColumn":52},{"ruleId":"842","severity":1,"message":"869","line":32,"column":7,"nodeType":"844","messageId":"845","endLine":32,"endColumn":9},{"ruleId":"842","severity":1,"message":"870","line":45,"column":14,"nodeType":"844","messageId":"845","endLine":45,"endColumn":27},{"ruleId":"842","severity":1,"message":"871","line":46,"column":12,"nodeType":"844","messageId":"845","endLine":46,"endColumn":23},{"ruleId":"842","severity":1,"message":"872","line":51,"column":14,"nodeType":"844","messageId":"845","endLine":51,"endColumn":27},{"ruleId":"842","severity":1,"message":"873","line":52,"column":12,"nodeType":"844","messageId":"845","endLine":52,"endColumn":23},{"ruleId":"842","severity":1,"message":"874","line":58,"column":12,"nodeType":"844","messageId":"845","endLine":58,"endColumn":27},{"ruleId":"842","severity":1,"message":"875","line":63,"column":14,"nodeType":"844","messageId":"845","endLine":63,"endColumn":24},{"ruleId":"842","severity":1,"message":"876","line":64,"column":12,"nodeType":"844","messageId":"845","endLine":64,"endColumn":20},{"ruleId":"842","severity":1,"message":"877","line":69,"column":14,"nodeType":"844","messageId":"845","endLine":69,"endColumn":33},{"ruleId":"842","severity":1,"message":"878","line":70,"column":12,"nodeType":"844","messageId":"845","endLine":70,"endColumn":29},{"ruleId":"842","severity":1,"message":"879","line":75,"column":12,"nodeType":"844","messageId":"845","endLine":75,"endColumn":25},{"ruleId":"842","severity":1,"message":"880","line":76,"column":10,"nodeType":"844","messageId":"845","endLine":76,"endColumn":21},{"ruleId":"842","severity":1,"message":"881","line":282,"column":14,"nodeType":"844","messageId":"845","endLine":282,"endColumn":29},{"ruleId":"842","severity":1,"message":"882","line":283,"column":12,"nodeType":"844","messageId":"845","endLine":283,"endColumn":25},{"ruleId":"842","severity":1,"message":"883","line":310,"column":12,"nodeType":"844","messageId":"845","endLine":310,"endColumn":32},{"ruleId":"842","severity":1,"message":"884","line":311,"column":10,"nodeType":"844","messageId":"845","endLine":311,"endColumn":28},{"ruleId":"842","severity":1,"message":"885","line":3,"column":10,"nodeType":"844","messageId":"845","endLine":3,"endColumn":15},{"ruleId":"842","severity":1,"message":"886","line":7,"column":28,"nodeType":"844","messageId":"845","endLine":7,"endColumn":48},{"ruleId":"842","severity":1,"message":"887","line":7,"column":100,"nodeType":"844","messageId":"845","endLine":7,"endColumn":106},{"ruleId":"842","severity":1,"message":"888","line":7,"column":123,"nodeType":"844","messageId":"845","endLine":7,"endColumn":136},{"ruleId":"842","severity":1,"message":"889","line":9,"column":10,"nodeType":"844","messageId":"845","endLine":9,"endColumn":23},{"ruleId":"842","severity":1,"message":"890","line":13,"column":10,"nodeType":"844","messageId":"845","endLine":13,"endColumn":25},{"ruleId":"842","severity":1,"message":"891","line":18,"column":3,"nodeType":"844","messageId":"845","endLine":18,"endColumn":12},{"ruleId":"842","severity":1,"message":"892","line":19,"column":3,"nodeType":"844","messageId":"845","endLine":19,"endColumn":15},{"ruleId":"842","severity":1,"message":"893","line":28,"column":7,"nodeType":"844","messageId":"845","endLine":28,"endColumn":41},{"ruleId":"842","severity":1,"message":"894","line":49,"column":7,"nodeType":"844","messageId":"845","endLine":49,"endColumn":43},{"ruleId":"842","severity":1,"message":"895","line":51,"column":7,"nodeType":"844","messageId":"845","endLine":51,"endColumn":30},{"ruleId":"842","severity":1,"message":"896","line":53,"column":7,"nodeType":"844","messageId":"845","endLine":53,"endColumn":15},{"ruleId":"842","severity":1,"message":"897","line":73,"column":9,"nodeType":"844","messageId":"845","endLine":73,"endColumn":24},{"ruleId":"842","severity":1,"message":"898","line":89,"column":9,"nodeType":"844","messageId":"845","endLine":89,"endColumn":43},{"ruleId":"842","severity":1,"message":"899","line":176,"column":9,"nodeType":"844","messageId":"845","endLine":176,"endColumn":52},{"ruleId":"842","severity":1,"message":"900","line":2,"column":10,"nodeType":"844","messageId":"845","endLine":2,"endColumn":19},{"ruleId":"842","severity":1,"message":"901","line":8,"column":3,"nodeType":"844","messageId":"845","endLine":8,"endColumn":11},{"ruleId":"842","severity":1,"message":"902","line":9,"column":3,"nodeType":"844","messageId":"845","endLine":9,"endColumn":17},{"ruleId":"842","severity":1,"message":"861","line":10,"column":3,"nodeType":"844","messageId":"845","endLine":10,"endColumn":14},{"ruleId":"842","severity":1,"message":"903","line":11,"column":3,"nodeType":"844","messageId":"845","endLine":11,"endColumn":17},{"ruleId":"842","severity":1,"message":"859","line":12,"column":3,"nodeType":"844","messageId":"845","endLine":12,"endColumn":7},{"ruleId":"842","severity":1,"message":"888","line":13,"column":3,"nodeType":"844","messageId":"845","endLine":13,"endColumn":16},{"ruleId":"842","severity":1,"message":"904","line":15,"column":3,"nodeType":"844","messageId":"845","endLine":15,"endColumn":16},{"ruleId":"842","severity":1,"message":"905","line":16,"column":3,"nodeType":"844","messageId":"845","endLine":16,"endColumn":13},{"ruleId":"842","severity":1,"message":"906","line":24,"column":7,"nodeType":"844","messageId":"845","endLine":24,"endColumn":49},{"ruleId":"842","severity":1,"message":"899","line":25,"column":7,"nodeType":"844","messageId":"845","endLine":25,"endColumn":50},{"ruleId":"842","severity":1,"message":"907","line":26,"column":7,"nodeType":"844","messageId":"845","endLine":26,"endColumn":29},{"ruleId":"842","severity":1,"message":"900","line":3,"column":10,"nodeType":"844","messageId":"845","endLine":3,"endColumn":19},{"ruleId":"842","severity":1,"message":"908","line":4,"column":10,"nodeType":"844","messageId":"845","endLine":4,"endColumn":15},{"ruleId":"842","severity":1,"message":"909","line":4,"column":17,"nodeType":"844","messageId":"845","endLine":4,"endColumn":25},{"ruleId":"842","severity":1,"message":"910","line":5,"column":10,"nodeType":"844","messageId":"845","endLine":5,"endColumn":14},{"ruleId":"842","severity":1,"message":"911","line":6,"column":10,"nodeType":"844","messageId":"845","endLine":6,"endColumn":18},{"ruleId":"842","severity":1,"message":"912","line":6,"column":20,"nodeType":"844","messageId":"845","endLine":6,"endColumn":34},{"ruleId":"842","severity":1,"message":"913","line":7,"column":37,"nodeType":"844","messageId":"845","endLine":7,"endColumn":52},{"ruleId":"842","severity":1,"message":"914","line":9,"column":10,"nodeType":"844","messageId":"845","endLine":9,"endColumn":30},{"ruleId":"842","severity":1,"message":"879","line":26,"column":14,"nodeType":"844","messageId":"845","endLine":26,"endColumn":27},{"ruleId":"842","severity":1,"message":"880","line":27,"column":12,"nodeType":"844","messageId":"845","endLine":27,"endColumn":23},{"ruleId":"915","severity":1,"message":"916","line":34,"column":42,"nodeType":"917","messageId":"918","endLine":34,"endColumn":44},{"ruleId":"915","severity":1,"message":"919","line":106,"column":70,"nodeType":"917","messageId":"920","endLine":106,"endColumn":72},{"ruleId":"842","severity":1,"message":"921","line":2,"column":10,"nodeType":"844","messageId":"845","endLine":2,"endColumn":26},{"ruleId":"842","severity":1,"message":"860","line":6,"column":10,"nodeType":"844","messageId":"845","endLine":6,"endColumn":14},{"ruleId":"842","severity":1,"message":"922","line":8,"column":10,"nodeType":"844","messageId":"845","endLine":8,"endColumn":33},{"ruleId":"842","severity":1,"message":"923","line":8,"column":35,"nodeType":"844","messageId":"845","endLine":8,"endColumn":48},{"ruleId":"842","severity":1,"message":"924","line":8,"column":50,"nodeType":"844","messageId":"845","endLine":8,"endColumn":70},{"ruleId":"842","severity":1,"message":"925","line":8,"column":72,"nodeType":"844","messageId":"845","endLine":8,"endColumn":92},{"ruleId":"842","severity":1,"message":"926","line":8,"column":94,"nodeType":"844","messageId":"845","endLine":8,"endColumn":107},{"ruleId":"842","severity":1,"message":"927","line":10,"column":20,"nodeType":"844","messageId":"845","endLine":10,"endColumn":42},{"ruleId":"842","severity":1,"message":"890","line":10,"column":51,"nodeType":"844","messageId":"845","endLine":10,"endColumn":66},{"ruleId":"842","severity":1,"message":"928","line":10,"column":68,"nodeType":"844","messageId":"845","endLine":10,"endColumn":76},{"ruleId":"842","severity":1,"message":"929","line":10,"column":100,"nodeType":"844","messageId":"845","endLine":10,"endColumn":108},{"ruleId":"842","severity":1,"message":"930","line":10,"column":110,"nodeType":"844","messageId":"845","endLine":10,"endColumn":115},{"ruleId":"842","severity":1,"message":"931","line":10,"column":147,"nodeType":"844","messageId":"845","endLine":10,"endColumn":159},{"ruleId":"842","severity":1,"message":"866","line":12,"column":10,"nodeType":"844","messageId":"845","endLine":12,"endColumn":25},{"ruleId":"842","severity":1,"message":"932","line":12,"column":27,"nodeType":"844","messageId":"845","endLine":12,"endColumn":39},{"ruleId":"842","severity":1,"message":"910","line":13,"column":10,"nodeType":"844","messageId":"845","endLine":13,"endColumn":14},{"ruleId":"842","severity":1,"message":"933","line":14,"column":8,"nodeType":"844","messageId":"845","endLine":14,"endColumn":23},{"ruleId":"842","severity":1,"message":"903","line":24,"column":5,"nodeType":"844","messageId":"845","endLine":24,"endColumn":19},{"ruleId":"842","severity":1,"message":"887","line":25,"column":5,"nodeType":"844","messageId":"845","endLine":25,"endColumn":11},{"ruleId":"842","severity":1,"message":"934","line":26,"column":5,"nodeType":"844","messageId":"845","endLine":26,"endColumn":18},{"ruleId":"842","severity":1,"message":"935","line":29,"column":5,"nodeType":"844","messageId":"845","endLine":29,"endColumn":10},{"ruleId":"842","severity":1,"message":"936","line":30,"column":5,"nodeType":"844","messageId":"845","endLine":30,"endColumn":17},{"ruleId":"842","severity":1,"message":"937","line":33,"column":5,"nodeType":"844","messageId":"845","endLine":33,"endColumn":17},{"ruleId":"842","severity":1,"message":"938","line":34,"column":5,"nodeType":"844","messageId":"845","endLine":34,"endColumn":16},{"ruleId":"842","severity":1,"message":"939","line":35,"column":5,"nodeType":"844","messageId":"845","endLine":35,"endColumn":13},{"ruleId":"842","severity":1,"message":"940","line":36,"column":5,"nodeType":"844","messageId":"845","endLine":36,"endColumn":11},{"ruleId":"842","severity":1,"message":"941","line":37,"column":5,"nodeType":"844","messageId":"845","endLine":37,"endColumn":20},{"ruleId":"842","severity":1,"message":"862","line":38,"column":5,"nodeType":"844","messageId":"845","endLine":38,"endColumn":14},{"ruleId":"842","severity":1,"message":"942","line":39,"column":5,"nodeType":"844","messageId":"845","endLine":39,"endColumn":33},{"ruleId":"842","severity":1,"message":"943","line":40,"column":5,"nodeType":"844","messageId":"845","endLine":40,"endColumn":20},{"ruleId":"842","severity":1,"message":"944","line":43,"column":5,"nodeType":"844","messageId":"845","endLine":43,"endColumn":17},{"ruleId":"842","severity":1,"message":"912","line":55,"column":5,"nodeType":"844","messageId":"845","endLine":55,"endColumn":19},{"ruleId":"842","severity":1,"message":"945","line":59,"column":8,"nodeType":"844","messageId":"845","endLine":59,"endColumn":31},{"ruleId":"842","severity":1,"message":"875","line":72,"column":18,"nodeType":"844","messageId":"845","endLine":72,"endColumn":28},{"ruleId":"842","severity":1,"message":"876","line":73,"column":16,"nodeType":"844","messageId":"845","endLine":73,"endColumn":24},{"ruleId":"842","severity":1,"message":"946","line":80,"column":18,"nodeType":"844","messageId":"845","endLine":80,"endColumn":41},{"ruleId":"842","severity":1,"message":"947","line":81,"column":16,"nodeType":"844","messageId":"845","endLine":81,"endColumn":37},{"ruleId":"842","severity":1,"message":"948","line":94,"column":38,"nodeType":"844","messageId":"845","endLine":94,"endColumn":58},{"ruleId":"842","severity":1,"message":"949","line":317,"column":11,"nodeType":"844","messageId":"845","endLine":317,"endColumn":29},{"ruleId":"842","severity":1,"message":"950","line":387,"column":11,"nodeType":"844","messageId":"845","endLine":387,"endColumn":51},{"ruleId":"842","severity":1,"message":"951","line":411,"column":11,"nodeType":"844","messageId":"845","endLine":411,"endColumn":20},{"ruleId":"842","severity":1,"message":"952","line":412,"column":11,"nodeType":"844","messageId":"845","endLine":412,"endColumn":32},{"ruleId":"842","severity":1,"message":"953","line":414,"column":11,"nodeType":"844","messageId":"845","endLine":414,"endColumn":21},{"ruleId":"842","severity":1,"message":"954","line":415,"column":11,"nodeType":"844","messageId":"845","endLine":415,"endColumn":39},{"ruleId":"842","severity":1,"message":"955","line":416,"column":11,"nodeType":"844","messageId":"845","endLine":416,"endColumn":30},{"ruleId":"956","severity":1,"message":"957","line":463,"column":9,"nodeType":"958","endLine":463,"endColumn":11,"suggestions":"959"},{"ruleId":"956","severity":1,"message":"960","line":587,"column":9,"nodeType":"958","endLine":587,"endColumn":22,"suggestions":"961"},{"ruleId":"842","severity":1,"message":"962","line":1,"column":17,"nodeType":"844","messageId":"845","endLine":1,"endColumn":25},{"ruleId":"842","severity":1,"message":"963","line":2,"column":17,"nodeType":"844","messageId":"845","endLine":2,"endColumn":27},{"ruleId":"842","severity":1,"message":"964","line":4,"column":20,"nodeType":"844","messageId":"845","endLine":4,"endColumn":40},{"ruleId":"842","severity":1,"message":"965","line":5,"column":10,"nodeType":"844","messageId":"845","endLine":5,"endColumn":16},{"ruleId":"842","severity":1,"message":"887","line":12,"column":5,"nodeType":"844","messageId":"845","endLine":12,"endColumn":11},{"ruleId":"842","severity":1,"message":"934","line":13,"column":5,"nodeType":"844","messageId":"845","endLine":13,"endColumn":18},{"ruleId":"842","severity":1,"message":"888","line":14,"column":5,"nodeType":"844","messageId":"845","endLine":14,"endColumn":18},{"ruleId":"842","severity":1,"message":"938","line":20,"column":5,"nodeType":"844","messageId":"845","endLine":20,"endColumn":16},{"ruleId":"842","severity":1,"message":"940","line":22,"column":5,"nodeType":"844","messageId":"845","endLine":22,"endColumn":11},{"ruleId":"842","severity":1,"message":"942","line":25,"column":5,"nodeType":"844","messageId":"845","endLine":25,"endColumn":33},{"ruleId":"842","severity":1,"message":"849","line":30,"column":10,"nodeType":"844","messageId":"845","endLine":30,"endColumn":13},{"ruleId":"842","severity":1,"message":"851","line":30,"column":28,"nodeType":"844","messageId":"845","endLine":30,"endColumn":36},{"ruleId":"842","severity":1,"message":"923","line":31,"column":40,"nodeType":"844","messageId":"845","endLine":31,"endColumn":53},{"ruleId":"842","severity":1,"message":"966","line":31,"column":55,"nodeType":"844","messageId":"845","endLine":31,"endColumn":68},{"ruleId":"842","severity":1,"message":"967","line":39,"column":7,"nodeType":"844","messageId":"845","endLine":39,"endColumn":32},{"ruleId":"842","severity":1,"message":"968","line":123,"column":28,"nodeType":"844","messageId":"845","endLine":123,"endColumn":32},{"ruleId":"842","severity":1,"message":"906","line":196,"column":11,"nodeType":"844","messageId":"845","endLine":196,"endColumn":53},{"ruleId":"842","severity":1,"message":"969","line":203,"column":11,"nodeType":"844","messageId":"845","endLine":203,"endColumn":57},{"ruleId":"956","severity":1,"message":"970","line":324,"column":9,"nodeType":"958","endLine":324,"endColumn":27,"suggestions":"971"},{"ruleId":"956","severity":1,"message":"970","line":349,"column":9,"nodeType":"958","endLine":349,"endColumn":27,"suggestions":"972"},{"ruleId":"842","severity":1,"message":"921","line":2,"column":10,"nodeType":"844","messageId":"845","endLine":2,"endColumn":26},{"ruleId":"842","severity":1,"message":"973","line":5,"column":10,"nodeType":"844","messageId":"845","endLine":5,"endColumn":18},{"ruleId":"842","severity":1,"message":"974","line":5,"column":20,"nodeType":"844","messageId":"845","endLine":5,"endColumn":35},{"ruleId":"842","severity":1,"message":"860","line":6,"column":10,"nodeType":"844","messageId":"845","endLine":6,"endColumn":14},{"ruleId":"842","severity":1,"message":"975","line":8,"column":10,"nodeType":"844","messageId":"845","endLine":8,"endColumn":29},{"ruleId":"842","severity":1,"message":"923","line":8,"column":31,"nodeType":"844","messageId":"845","endLine":8,"endColumn":44},{"ruleId":"842","severity":1,"message":"924","line":8,"column":46,"nodeType":"844","messageId":"845","endLine":8,"endColumn":66},{"ruleId":"842","severity":1,"message":"925","line":8,"column":68,"nodeType":"844","messageId":"845","endLine":8,"endColumn":88},{"ruleId":"842","severity":1,"message":"926","line":8,"column":90,"nodeType":"844","messageId":"845","endLine":8,"endColumn":103},{"ruleId":"842","severity":1,"message":"851","line":9,"column":23,"nodeType":"844","messageId":"845","endLine":9,"endColumn":31},{"ruleId":"842","severity":1,"message":"890","line":10,"column":53,"nodeType":"844","messageId":"845","endLine":10,"endColumn":68},{"ruleId":"842","severity":1,"message":"928","line":10,"column":70,"nodeType":"844","messageId":"845","endLine":10,"endColumn":78},{"ruleId":"842","severity":1,"message":"910","line":12,"column":10,"nodeType":"844","messageId":"845","endLine":12,"endColumn":14},{"ruleId":"842","severity":1,"message":"903","line":22,"column":3,"nodeType":"844","messageId":"845","endLine":22,"endColumn":17},{"ruleId":"842","severity":1,"message":"887","line":23,"column":3,"nodeType":"844","messageId":"845","endLine":23,"endColumn":9},{"ruleId":"842","severity":1,"message":"934","line":24,"column":3,"nodeType":"844","messageId":"845","endLine":24,"endColumn":16},{"ruleId":"842","severity":1,"message":"935","line":26,"column":3,"nodeType":"844","messageId":"845","endLine":26,"endColumn":8},{"ruleId":"842","severity":1,"message":"936","line":27,"column":3,"nodeType":"844","messageId":"845","endLine":27,"endColumn":15},{"ruleId":"842","severity":1,"message":"937","line":30,"column":3,"nodeType":"844","messageId":"845","endLine":30,"endColumn":15},{"ruleId":"842","severity":1,"message":"938","line":31,"column":3,"nodeType":"844","messageId":"845","endLine":31,"endColumn":14},{"ruleId":"842","severity":1,"message":"939","line":32,"column":3,"nodeType":"844","messageId":"845","endLine":32,"endColumn":11},{"ruleId":"842","severity":1,"message":"940","line":33,"column":3,"nodeType":"844","messageId":"845","endLine":33,"endColumn":9},{"ruleId":"842","severity":1,"message":"941","line":34,"column":3,"nodeType":"844","messageId":"845","endLine":34,"endColumn":18},{"ruleId":"842","severity":1,"message":"862","line":35,"column":3,"nodeType":"844","messageId":"845","endLine":35,"endColumn":12},{"ruleId":"842","severity":1,"message":"942","line":36,"column":3,"nodeType":"844","messageId":"845","endLine":36,"endColumn":31},{"ruleId":"842","severity":1,"message":"943","line":37,"column":3,"nodeType":"844","messageId":"845","endLine":37,"endColumn":18},{"ruleId":"842","severity":1,"message":"944","line":40,"column":3,"nodeType":"844","messageId":"845","endLine":40,"endColumn":15},{"ruleId":"842","severity":1,"message":"968","line":67,"column":26,"nodeType":"844","messageId":"845","endLine":67,"endColumn":30},{"ruleId":"956","severity":1,"message":"976","line":108,"column":5,"nodeType":"958","endLine":108,"endColumn":22,"suggestions":"977"},{"ruleId":"842","severity":1,"message":"978","line":150,"column":9,"nodeType":"844","messageId":"845","endLine":150,"endColumn":29},{"ruleId":"842","severity":1,"message":"979","line":151,"column":9,"nodeType":"844","messageId":"845","endLine":151,"endColumn":40},{"ruleId":"842","severity":1,"message":"950","line":152,"column":9,"nodeType":"844","messageId":"845","endLine":152,"endColumn":49},{"ruleId":"842","severity":1,"message":"951","line":175,"column":9,"nodeType":"844","messageId":"845","endLine":175,"endColumn":18},{"ruleId":"842","severity":1,"message":"952","line":176,"column":9,"nodeType":"844","messageId":"845","endLine":176,"endColumn":30},{"ruleId":"842","severity":1,"message":"980","line":177,"column":9,"nodeType":"844","messageId":"845","endLine":177,"endColumn":38},{"ruleId":"842","severity":1,"message":"953","line":179,"column":9,"nodeType":"844","messageId":"845","endLine":179,"endColumn":19},{"ruleId":"842","severity":1,"message":"954","line":180,"column":9,"nodeType":"844","messageId":"845","endLine":180,"endColumn":37},{"ruleId":"842","severity":1,"message":"955","line":181,"column":9,"nodeType":"844","messageId":"845","endLine":181,"endColumn":28},{"ruleId":"915","severity":1,"message":"919","line":236,"column":64,"nodeType":"917","messageId":"920","endLine":236,"endColumn":66},{"ruleId":"956","severity":1,"message":"981","line":274,"column":5,"nodeType":"958","endLine":274,"endColumn":7,"suggestions":"982"},{"ruleId":"842","severity":1,"message":"921","line":2,"column":10,"nodeType":"844","messageId":"845","endLine":2,"endColumn":26},{"ruleId":"842","severity":1,"message":"973","line":5,"column":10,"nodeType":"844","messageId":"845","endLine":5,"endColumn":18},{"ruleId":"842","severity":1,"message":"974","line":5,"column":20,"nodeType":"844","messageId":"845","endLine":5,"endColumn":35},{"ruleId":"842","severity":1,"message":"860","line":6,"column":10,"nodeType":"844","messageId":"845","endLine":6,"endColumn":14},{"ruleId":"842","severity":1,"message":"963","line":7,"column":10,"nodeType":"844","messageId":"845","endLine":7,"endColumn":20},{"ruleId":"842","severity":1,"message":"922","line":8,"column":10,"nodeType":"844","messageId":"845","endLine":8,"endColumn":33},{"ruleId":"842","severity":1,"message":"923","line":8,"column":35,"nodeType":"844","messageId":"845","endLine":8,"endColumn":48},{"ruleId":"842","severity":1,"message":"924","line":8,"column":50,"nodeType":"844","messageId":"845","endLine":8,"endColumn":70},{"ruleId":"842","severity":1,"message":"925","line":8,"column":72,"nodeType":"844","messageId":"845","endLine":8,"endColumn":92},{"ruleId":"842","severity":1,"message":"926","line":8,"column":94,"nodeType":"844","messageId":"845","endLine":8,"endColumn":107},{"ruleId":"842","severity":1,"message":"983","line":9,"column":10,"nodeType":"844","messageId":"845","endLine":9,"endColumn":21},{"ruleId":"842","severity":1,"message":"984","line":10,"column":10,"nodeType":"844","messageId":"845","endLine":10,"endColumn":18},{"ruleId":"842","severity":1,"message":"985","line":10,"column":20,"nodeType":"844","messageId":"845","endLine":10,"endColumn":46},{"ruleId":"842","severity":1,"message":"890","line":10,"column":55,"nodeType":"844","messageId":"845","endLine":10,"endColumn":70},{"ruleId":"842","severity":1,"message":"928","line":10,"column":72,"nodeType":"844","messageId":"845","endLine":10,"endColumn":80},{"ruleId":"842","severity":1,"message":"929","line":10,"column":104,"nodeType":"844","messageId":"845","endLine":10,"endColumn":112},{"ruleId":"842","severity":1,"message":"986","line":11,"column":73,"nodeType":"844","messageId":"845","endLine":11,"endColumn":96},{"ruleId":"842","severity":1,"message":"910","line":12,"column":10,"nodeType":"844","messageId":"845","endLine":12,"endColumn":14},{"ruleId":"842","severity":1,"message":"945","line":15,"column":8,"nodeType":"844","messageId":"845","endLine":15,"endColumn":31},{"ruleId":"842","severity":1,"message":"866","line":18,"column":21,"nodeType":"844","messageId":"845","endLine":18,"endColumn":36},{"ruleId":"842","severity":1,"message":"867","line":18,"column":38,"nodeType":"844","messageId":"845","endLine":18,"endColumn":46},{"ruleId":"842","severity":1,"message":"868","line":18,"column":48,"nodeType":"844","messageId":"845","endLine":18,"endColumn":52},{"ruleId":"842","severity":1,"message":"902","line":25,"column":5,"nodeType":"844","messageId":"845","endLine":25,"endColumn":19},{"ruleId":"842","severity":1,"message":"903","line":27,"column":5,"nodeType":"844","messageId":"845","endLine":27,"endColumn":19},{"ruleId":"842","severity":1,"message":"887","line":28,"column":5,"nodeType":"844","messageId":"845","endLine":28,"endColumn":11},{"ruleId":"842","severity":1,"message":"934","line":29,"column":5,"nodeType":"844","messageId":"845","endLine":29,"endColumn":18},{"ruleId":"842","severity":1,"message":"888","line":30,"column":5,"nodeType":"844","messageId":"845","endLine":30,"endColumn":18},{"ruleId":"842","severity":1,"message":"935","line":31,"column":5,"nodeType":"844","messageId":"845","endLine":31,"endColumn":10},{"ruleId":"842","severity":1,"message":"936","line":32,"column":5,"nodeType":"844","messageId":"845","endLine":32,"endColumn":17},{"ruleId":"842","severity":1,"message":"937","line":35,"column":5,"nodeType":"844","messageId":"845","endLine":35,"endColumn":17},{"ruleId":"842","severity":1,"message":"938","line":36,"column":5,"nodeType":"844","messageId":"845","endLine":36,"endColumn":16},{"ruleId":"842","severity":1,"message":"939","line":37,"column":5,"nodeType":"844","messageId":"845","endLine":37,"endColumn":13},{"ruleId":"842","severity":1,"message":"940","line":38,"column":5,"nodeType":"844","messageId":"845","endLine":38,"endColumn":11},{"ruleId":"842","severity":1,"message":"941","line":39,"column":5,"nodeType":"844","messageId":"845","endLine":39,"endColumn":20},{"ruleId":"842","severity":1,"message":"862","line":40,"column":5,"nodeType":"844","messageId":"845","endLine":40,"endColumn":14},{"ruleId":"842","severity":1,"message":"942","line":41,"column":5,"nodeType":"844","messageId":"845","endLine":41,"endColumn":33},{"ruleId":"842","severity":1,"message":"943","line":42,"column":5,"nodeType":"844","messageId":"845","endLine":42,"endColumn":20},{"ruleId":"842","severity":1,"message":"859","line":44,"column":5,"nodeType":"844","messageId":"845","endLine":44,"endColumn":9},{"ruleId":"842","severity":1,"message":"944","line":45,"column":5,"nodeType":"844","messageId":"845","endLine":45,"endColumn":17},{"ruleId":"842","severity":1,"message":"875","line":62,"column":18,"nodeType":"844","messageId":"845","endLine":62,"endColumn":28},{"ruleId":"842","severity":1,"message":"876","line":63,"column":16,"nodeType":"844","messageId":"845","endLine":63,"endColumn":24},{"ruleId":"842","severity":1,"message":"946","line":68,"column":18,"nodeType":"844","messageId":"845","endLine":68,"endColumn":41},{"ruleId":"842","severity":1,"message":"947","line":69,"column":16,"nodeType":"844","messageId":"845","endLine":69,"endColumn":37},{"ruleId":"842","severity":1,"message":"987","line":123,"column":11,"nodeType":"844","messageId":"845","endLine":123,"endColumn":30},{"ruleId":"842","severity":1,"message":"978","line":124,"column":11,"nodeType":"844","messageId":"845","endLine":124,"endColumn":31},{"ruleId":"842","severity":1,"message":"988","line":125,"column":11,"nodeType":"844","messageId":"845","endLine":125,"endColumn":33},{"ruleId":"842","severity":1,"message":"950","line":127,"column":11,"nodeType":"844","messageId":"845","endLine":127,"endColumn":51},{"ruleId":"842","severity":1,"message":"951","line":150,"column":11,"nodeType":"844","messageId":"845","endLine":150,"endColumn":20},{"ruleId":"842","severity":1,"message":"952","line":151,"column":11,"nodeType":"844","messageId":"845","endLine":151,"endColumn":32},{"ruleId":"842","severity":1,"message":"953","line":153,"column":11,"nodeType":"844","messageId":"845","endLine":153,"endColumn":21},{"ruleId":"842","severity":1,"message":"954","line":154,"column":11,"nodeType":"844","messageId":"845","endLine":154,"endColumn":39},{"ruleId":"842","severity":1,"message":"955","line":155,"column":11,"nodeType":"844","messageId":"845","endLine":155,"endColumn":30},{"ruleId":"956","severity":1,"message":"989","line":183,"column":9,"nodeType":"958","endLine":183,"endColumn":11,"suggestions":"990"},{"ruleId":"842","severity":1,"message":"921","line":2,"column":10,"nodeType":"844","messageId":"845","endLine":2,"endColumn":26},{"ruleId":"842","severity":1,"message":"991","line":2,"column":88,"nodeType":"844","messageId":"845","endLine":2,"endColumn":104},{"ruleId":"842","severity":1,"message":"992","line":2,"column":106,"nodeType":"844","messageId":"845","endLine":2,"endColumn":115},{"ruleId":"842","severity":1,"message":"904","line":2,"column":117,"nodeType":"844","messageId":"845","endLine":2,"endColumn":130},{"ruleId":"842","severity":1,"message":"900","line":2,"column":132,"nodeType":"844","messageId":"845","endLine":2,"endColumn":141},{"ruleId":"842","severity":1,"message":"973","line":5,"column":10,"nodeType":"844","messageId":"845","endLine":5,"endColumn":18},{"ruleId":"842","severity":1,"message":"974","line":5,"column":20,"nodeType":"844","messageId":"845","endLine":5,"endColumn":35},{"ruleId":"842","severity":1,"message":"860","line":6,"column":10,"nodeType":"844","messageId":"845","endLine":6,"endColumn":14},{"ruleId":"842","severity":1,"message":"963","line":7,"column":10,"nodeType":"844","messageId":"845","endLine":7,"endColumn":20},{"ruleId":"842","severity":1,"message":"975","line":8,"column":10,"nodeType":"844","messageId":"845","endLine":8,"endColumn":29},{"ruleId":"842","severity":1,"message":"923","line":8,"column":31,"nodeType":"844","messageId":"845","endLine":8,"endColumn":44},{"ruleId":"842","severity":1,"message":"924","line":8,"column":46,"nodeType":"844","messageId":"845","endLine":8,"endColumn":66},{"ruleId":"842","severity":1,"message":"925","line":8,"column":68,"nodeType":"844","messageId":"845","endLine":8,"endColumn":88},{"ruleId":"842","severity":1,"message":"926","line":8,"column":90,"nodeType":"844","messageId":"845","endLine":8,"endColumn":103},{"ruleId":"842","severity":1,"message":"993","line":8,"column":105,"nodeType":"844","messageId":"845","endLine":8,"endColumn":117},{"ruleId":"842","severity":1,"message":"966","line":8,"column":119,"nodeType":"844","messageId":"845","endLine":8,"endColumn":132},{"ruleId":"842","severity":1,"message":"983","line":9,"column":10,"nodeType":"844","messageId":"845","endLine":9,"endColumn":21},{"ruleId":"842","severity":1,"message":"851","line":9,"column":23,"nodeType":"844","messageId":"845","endLine":9,"endColumn":31},{"ruleId":"842","severity":1,"message":"984","line":10,"column":10,"nodeType":"844","messageId":"845","endLine":10,"endColumn":18},{"ruleId":"842","severity":1,"message":"994","line":10,"column":20,"nodeType":"844","messageId":"845","endLine":10,"endColumn":44},{"ruleId":"842","severity":1,"message":"995","line":10,"column":46,"nodeType":"844","messageId":"845","endLine":10,"endColumn":51},{"ruleId":"842","severity":1,"message":"890","line":10,"column":53,"nodeType":"844","messageId":"845","endLine":10,"endColumn":68},{"ruleId":"842","severity":1,"message":"928","line":10,"column":70,"nodeType":"844","messageId":"845","endLine":10,"endColumn":78},{"ruleId":"842","severity":1,"message":"996","line":10,"column":80,"nodeType":"844","messageId":"845","endLine":10,"endColumn":88},{"ruleId":"842","severity":1,"message":"863","line":10,"column":104,"nodeType":"844","messageId":"845","endLine":10,"endColumn":124},{"ruleId":"842","severity":1,"message":"910","line":12,"column":10,"nodeType":"844","messageId":"845","endLine":12,"endColumn":14},{"ruleId":"842","severity":1,"message":"903","line":24,"column":3,"nodeType":"844","messageId":"845","endLine":24,"endColumn":17},{"ruleId":"842","severity":1,"message":"887","line":25,"column":3,"nodeType":"844","messageId":"845","endLine":25,"endColumn":9},{"ruleId":"842","severity":1,"message":"934","line":26,"column":3,"nodeType":"844","messageId":"845","endLine":26,"endColumn":16},{"ruleId":"842","severity":1,"message":"888","line":27,"column":3,"nodeType":"844","messageId":"845","endLine":27,"endColumn":16},{"ruleId":"842","severity":1,"message":"935","line":28,"column":3,"nodeType":"844","messageId":"845","endLine":28,"endColumn":8},{"ruleId":"842","severity":1,"message":"936","line":29,"column":3,"nodeType":"844","messageId":"845","endLine":29,"endColumn":15},{"ruleId":"842","severity":1,"message":"937","line":32,"column":3,"nodeType":"844","messageId":"845","endLine":32,"endColumn":15},{"ruleId":"842","severity":1,"message":"938","line":33,"column":3,"nodeType":"844","messageId":"845","endLine":33,"endColumn":14},{"ruleId":"842","severity":1,"message":"939","line":34,"column":3,"nodeType":"844","messageId":"845","endLine":34,"endColumn":11},{"ruleId":"842","severity":1,"message":"940","line":35,"column":3,"nodeType":"844","messageId":"845","endLine":35,"endColumn":9},{"ruleId":"842","severity":1,"message":"941","line":36,"column":3,"nodeType":"844","messageId":"845","endLine":36,"endColumn":18},{"ruleId":"842","severity":1,"message":"862","line":37,"column":3,"nodeType":"844","messageId":"845","endLine":37,"endColumn":12},{"ruleId":"842","severity":1,"message":"942","line":38,"column":3,"nodeType":"844","messageId":"845","endLine":38,"endColumn":31},{"ruleId":"842","severity":1,"message":"943","line":39,"column":3,"nodeType":"844","messageId":"845","endLine":39,"endColumn":18},{"ruleId":"842","severity":1,"message":"944","line":42,"column":3,"nodeType":"844","messageId":"845","endLine":42,"endColumn":15},{"ruleId":"842","severity":1,"message":"997","line":100,"column":9,"nodeType":"844","messageId":"845","endLine":100,"endColumn":22},{"ruleId":"842","severity":1,"message":"987","line":117,"column":9,"nodeType":"844","messageId":"845","endLine":117,"endColumn":28},{"ruleId":"842","severity":1,"message":"978","line":118,"column":9,"nodeType":"844","messageId":"845","endLine":118,"endColumn":29},{"ruleId":"842","severity":1,"message":"979","line":119,"column":9,"nodeType":"844","messageId":"845","endLine":119,"endColumn":40},{"ruleId":"842","severity":1,"message":"950","line":120,"column":9,"nodeType":"844","messageId":"845","endLine":120,"endColumn":49},{"ruleId":"842","severity":1,"message":"951","line":149,"column":9,"nodeType":"844","messageId":"845","endLine":149,"endColumn":18},{"ruleId":"842","severity":1,"message":"952","line":150,"column":9,"nodeType":"844","messageId":"845","endLine":150,"endColumn":30},{"ruleId":"842","severity":1,"message":"980","line":151,"column":9,"nodeType":"844","messageId":"845","endLine":151,"endColumn":38},{"ruleId":"842","severity":1,"message":"953","line":153,"column":9,"nodeType":"844","messageId":"845","endLine":153,"endColumn":19},{"ruleId":"842","severity":1,"message":"954","line":154,"column":9,"nodeType":"844","messageId":"845","endLine":154,"endColumn":37},{"ruleId":"842","severity":1,"message":"955","line":155,"column":9,"nodeType":"844","messageId":"845","endLine":155,"endColumn":28},{"ruleId":"842","severity":1,"message":"906","line":157,"column":9,"nodeType":"844","messageId":"845","endLine":157,"endColumn":51},{"ruleId":"842","severity":1,"message":"998","line":161,"column":9,"nodeType":"844","messageId":"845","endLine":161,"endColumn":15},{"ruleId":"915","severity":1,"message":"919","line":210,"column":72,"nodeType":"917","messageId":"920","endLine":210,"endColumn":74},{"ruleId":"956","severity":1,"message":"999","line":238,"column":5,"nodeType":"958","endLine":238,"endColumn":7,"suggestions":"1000"},{"ruleId":"842","severity":1,"message":"973","line":5,"column":10,"nodeType":"844","messageId":"845","endLine":5,"endColumn":18},{"ruleId":"842","severity":1,"message":"974","line":5,"column":20,"nodeType":"844","messageId":"845","endLine":5,"endColumn":35},{"ruleId":"842","severity":1,"message":"860","line":6,"column":10,"nodeType":"844","messageId":"845","endLine":6,"endColumn":14},{"ruleId":"842","severity":1,"message":"924","line":8,"column":46,"nodeType":"844","messageId":"845","endLine":8,"endColumn":66},{"ruleId":"842","severity":1,"message":"925","line":8,"column":68,"nodeType":"844","messageId":"845","endLine":8,"endColumn":88},{"ruleId":"842","severity":1,"message":"890","line":10,"column":55,"nodeType":"844","messageId":"845","endLine":10,"endColumn":70},{"ruleId":"842","severity":1,"message":"910","line":12,"column":10,"nodeType":"844","messageId":"845","endLine":12,"endColumn":14},{"ruleId":"842","severity":1,"message":"902","line":27,"column":5,"nodeType":"844","messageId":"845","endLine":27,"endColumn":19},{"ruleId":"842","severity":1,"message":"903","line":29,"column":5,"nodeType":"844","messageId":"845","endLine":29,"endColumn":19},{"ruleId":"842","severity":1,"message":"887","line":30,"column":5,"nodeType":"844","messageId":"845","endLine":30,"endColumn":11},{"ruleId":"842","severity":1,"message":"934","line":31,"column":5,"nodeType":"844","messageId":"845","endLine":31,"endColumn":18},{"ruleId":"842","severity":1,"message":"888","line":32,"column":5,"nodeType":"844","messageId":"845","endLine":32,"endColumn":18},{"ruleId":"842","severity":1,"message":"935","line":33,"column":5,"nodeType":"844","messageId":"845","endLine":33,"endColumn":10},{"ruleId":"842","severity":1,"message":"936","line":34,"column":5,"nodeType":"844","messageId":"845","endLine":34,"endColumn":17},{"ruleId":"842","severity":1,"message":"937","line":37,"column":5,"nodeType":"844","messageId":"845","endLine":37,"endColumn":17},{"ruleId":"842","severity":1,"message":"938","line":38,"column":5,"nodeType":"844","messageId":"845","endLine":38,"endColumn":16},{"ruleId":"842","severity":1,"message":"939","line":39,"column":5,"nodeType":"844","messageId":"845","endLine":39,"endColumn":13},{"ruleId":"842","severity":1,"message":"940","line":40,"column":5,"nodeType":"844","messageId":"845","endLine":40,"endColumn":11},{"ruleId":"842","severity":1,"message":"862","line":42,"column":5,"nodeType":"844","messageId":"845","endLine":42,"endColumn":14},{"ruleId":"842","severity":1,"message":"942","line":43,"column":5,"nodeType":"844","messageId":"845","endLine":43,"endColumn":33},{"ruleId":"842","severity":1,"message":"943","line":44,"column":5,"nodeType":"844","messageId":"845","endLine":44,"endColumn":20},{"ruleId":"842","severity":1,"message":"944","line":47,"column":5,"nodeType":"844","messageId":"845","endLine":47,"endColumn":17},{"ruleId":"842","severity":1,"message":"874","line":78,"column":16,"nodeType":"844","messageId":"845","endLine":78,"endColumn":31},{"ruleId":"842","severity":1,"message":"1001","line":106,"column":16,"nodeType":"844","messageId":"845","endLine":106,"endColumn":29},{"ruleId":"842","severity":1,"message":"1002","line":127,"column":12,"nodeType":"844","messageId":"845","endLine":127,"endColumn":18},{"ruleId":"842","severity":1,"message":"1003","line":127,"column":31,"nodeType":"844","messageId":"845","endLine":127,"endColumn":40},{"ruleId":"842","severity":1,"message":"1004","line":127,"column":52,"nodeType":"844","messageId":"845","endLine":127,"endColumn":64},{"ruleId":"915","severity":1,"message":"916","line":251,"column":66,"nodeType":"917","messageId":"918","endLine":251,"endColumn":68},{"ruleId":"956","severity":1,"message":"1005","line":279,"column":9,"nodeType":"958","endLine":279,"endColumn":11,"suggestions":"1006"},{"ruleId":"842","severity":1,"message":"1007","line":290,"column":11,"nodeType":"844","messageId":"845","endLine":290,"endColumn":22},{"ruleId":"842","severity":1,"message":"1008","line":296,"column":11,"nodeType":"844","messageId":"845","endLine":296,"endColumn":23},{"ruleId":"842","severity":1,"message":"968","line":330,"column":30,"nodeType":"844","messageId":"845","endLine":330,"endColumn":34},{"ruleId":"842","severity":1,"message":"1009","line":4,"column":91,"nodeType":"844","messageId":"845","endLine":4,"endColumn":119},{"ruleId":"842","severity":1,"message":"863","line":4,"column":135,"nodeType":"844","messageId":"845","endLine":4,"endColumn":155},{"ruleId":"842","severity":1,"message":"1010","line":5,"column":74,"nodeType":"844","messageId":"845","endLine":5,"endColumn":91},{"ruleId":"842","severity":1,"message":"912","line":8,"column":196,"nodeType":"844","messageId":"845","endLine":8,"endColumn":210},{"ruleId":"842","severity":1,"message":"1011","line":11,"column":8,"nodeType":"844","messageId":"845","endLine":11,"endColumn":23},{"ruleId":"842","severity":1,"message":"1012","line":68,"column":38,"nodeType":"844","messageId":"845","endLine":68,"endColumn":60},{"ruleId":"842","severity":1,"message":"1013","line":100,"column":38,"nodeType":"844","messageId":"845","endLine":100,"endColumn":60},{"ruleId":"842","severity":1,"message":"1014","line":341,"column":9,"nodeType":"844","messageId":"845","endLine":341,"endColumn":58},{"ruleId":"956","severity":1,"message":"1015","line":347,"column":5,"nodeType":"958","endLine":347,"endColumn":26,"suggestions":"1016"},{"ruleId":"956","severity":1,"message":"1017","line":391,"column":5,"nodeType":"958","endLine":391,"endColumn":91,"suggestions":"1018"},{"ruleId":"842","severity":1,"message":"1019","line":57,"column":34,"nodeType":"844","messageId":"845","endLine":57,"endColumn":52},{"ruleId":"842","severity":1,"message":"1020","line":89,"column":34,"nodeType":"844","messageId":"845","endLine":89,"endColumn":52},{"ruleId":"842","severity":1,"message":"968","line":125,"column":25,"nodeType":"844","messageId":"845","endLine":125,"endColumn":29},{"ruleId":"956","severity":1,"message":"1021","line":330,"column":5,"nodeType":"958","endLine":330,"endColumn":23,"suggestions":"1022"},{"ruleId":"842","severity":1,"message":"922","line":8,"column":10,"nodeType":"844","messageId":"845","endLine":8,"endColumn":33},{"ruleId":"842","severity":1,"message":"923","line":8,"column":35,"nodeType":"844","messageId":"845","endLine":8,"endColumn":48},{"ruleId":"842","severity":1,"message":"924","line":8,"column":50,"nodeType":"844","messageId":"845","endLine":8,"endColumn":70},{"ruleId":"842","severity":1,"message":"925","line":8,"column":72,"nodeType":"844","messageId":"845","endLine":8,"endColumn":92},{"ruleId":"842","severity":1,"message":"926","line":8,"column":94,"nodeType":"844","messageId":"845","endLine":8,"endColumn":107},{"ruleId":"842","severity":1,"message":"983","line":9,"column":10,"nodeType":"844","messageId":"845","endLine":9,"endColumn":21},{"ruleId":"842","severity":1,"message":"851","line":9,"column":23,"nodeType":"844","messageId":"845","endLine":9,"endColumn":31},{"ruleId":"842","severity":1,"message":"984","line":10,"column":10,"nodeType":"844","messageId":"845","endLine":10,"endColumn":18},{"ruleId":"842","severity":1,"message":"985","line":10,"column":20,"nodeType":"844","messageId":"845","endLine":10,"endColumn":46},{"ruleId":"842","severity":1,"message":"995","line":10,"column":48,"nodeType":"844","messageId":"845","endLine":10,"endColumn":53},{"ruleId":"842","severity":1,"message":"890","line":10,"column":55,"nodeType":"844","messageId":"845","endLine":10,"endColumn":70},{"ruleId":"842","severity":1,"message":"1023","line":11,"column":29,"nodeType":"844","messageId":"845","endLine":11,"endColumn":47},{"ruleId":"842","severity":1,"message":"986","line":11,"column":73,"nodeType":"844","messageId":"845","endLine":11,"endColumn":96},{"ruleId":"842","severity":1,"message":"962","line":1,"column":17,"nodeType":"844","messageId":"845","endLine":1,"endColumn":25},{"ruleId":"842","severity":1,"message":"963","line":2,"column":17,"nodeType":"844","messageId":"845","endLine":2,"endColumn":27},{"ruleId":"842","severity":1,"message":"964","line":4,"column":20,"nodeType":"844","messageId":"845","endLine":4,"endColumn":40},{"ruleId":"842","severity":1,"message":"965","line":5,"column":10,"nodeType":"844","messageId":"845","endLine":5,"endColumn":16},{"ruleId":"842","severity":1,"message":"887","line":12,"column":5,"nodeType":"844","messageId":"845","endLine":12,"endColumn":11},{"ruleId":"842","severity":1,"message":"934","line":13,"column":5,"nodeType":"844","messageId":"845","endLine":13,"endColumn":18},{"ruleId":"842","severity":1,"message":"888","line":14,"column":5,"nodeType":"844","messageId":"845","endLine":14,"endColumn":18},{"ruleId":"842","severity":1,"message":"938","line":20,"column":5,"nodeType":"844","messageId":"845","endLine":20,"endColumn":16},{"ruleId":"842","severity":1,"message":"940","line":22,"column":5,"nodeType":"844","messageId":"845","endLine":22,"endColumn":11},{"ruleId":"842","severity":1,"message":"942","line":25,"column":5,"nodeType":"844","messageId":"845","endLine":25,"endColumn":33},{"ruleId":"842","severity":1,"message":"849","line":30,"column":10,"nodeType":"844","messageId":"845","endLine":30,"endColumn":13},{"ruleId":"842","severity":1,"message":"851","line":30,"column":28,"nodeType":"844","messageId":"845","endLine":30,"endColumn":36},{"ruleId":"842","severity":1,"message":"1024","line":31,"column":10,"nodeType":"844","messageId":"845","endLine":31,"endColumn":24},{"ruleId":"842","severity":1,"message":"1025","line":31,"column":26,"nodeType":"844","messageId":"845","endLine":31,"endColumn":38},{"ruleId":"842","severity":1,"message":"923","line":31,"column":40,"nodeType":"844","messageId":"845","endLine":31,"endColumn":53},{"ruleId":"842","severity":1,"message":"967","line":39,"column":7,"nodeType":"844","messageId":"845","endLine":39,"endColumn":32},{"ruleId":"842","severity":1,"message":"968","line":108,"column":30,"nodeType":"844","messageId":"845","endLine":108,"endColumn":34},{"ruleId":"842","severity":1,"message":"906","line":184,"column":11,"nodeType":"844","messageId":"845","endLine":184,"endColumn":53},{"ruleId":"842","severity":1,"message":"969","line":191,"column":11,"nodeType":"844","messageId":"845","endLine":191,"endColumn":57},{"ruleId":"956","severity":1,"message":"970","line":312,"column":9,"nodeType":"958","endLine":312,"endColumn":27,"suggestions":"1026"},{"ruleId":"956","severity":1,"message":"970","line":337,"column":9,"nodeType":"958","endLine":337,"endColumn":27,"suggestions":"1027"},{"ruleId":"842","severity":1,"message":"962","line":1,"column":17,"nodeType":"844","messageId":"845","endLine":1,"endColumn":25},{"ruleId":"842","severity":1,"message":"963","line":2,"column":17,"nodeType":"844","messageId":"845","endLine":2,"endColumn":27},{"ruleId":"842","severity":1,"message":"964","line":4,"column":20,"nodeType":"844","messageId":"845","endLine":4,"endColumn":40},{"ruleId":"842","severity":1,"message":"965","line":5,"column":10,"nodeType":"844","messageId":"845","endLine":5,"endColumn":16},{"ruleId":"842","severity":1,"message":"1028","line":7,"column":10,"nodeType":"844","messageId":"845","endLine":7,"endColumn":25},{"ruleId":"842","severity":1,"message":"888","line":15,"column":5,"nodeType":"844","messageId":"845","endLine":15,"endColumn":18},{"ruleId":"842","severity":1,"message":"938","line":21,"column":5,"nodeType":"844","messageId":"845","endLine":21,"endColumn":16},{"ruleId":"842","severity":1,"message":"939","line":22,"column":5,"nodeType":"844","messageId":"845","endLine":22,"endColumn":13},{"ruleId":"842","severity":1,"message":"940","line":23,"column":5,"nodeType":"844","messageId":"845","endLine":23,"endColumn":11},{"ruleId":"842","severity":1,"message":"941","line":24,"column":5,"nodeType":"844","messageId":"845","endLine":24,"endColumn":20},{"ruleId":"842","severity":1,"message":"862","line":25,"column":5,"nodeType":"844","messageId":"845","endLine":25,"endColumn":14},{"ruleId":"842","severity":1,"message":"942","line":26,"column":5,"nodeType":"844","messageId":"845","endLine":26,"endColumn":33},{"ruleId":"842","severity":1,"message":"1029","line":33,"column":5,"nodeType":"844","messageId":"845","endLine":33,"endColumn":19},{"ruleId":"842","severity":1,"message":"1030","line":36,"column":10,"nodeType":"844","messageId":"845","endLine":36,"endColumn":33},{"ruleId":"842","severity":1,"message":"849","line":36,"column":35,"nodeType":"844","messageId":"845","endLine":36,"endColumn":38},{"ruleId":"842","severity":1,"message":"923","line":37,"column":45,"nodeType":"844","messageId":"845","endLine":37,"endColumn":58},{"ruleId":"842","severity":1,"message":"928","line":38,"column":63,"nodeType":"844","messageId":"845","endLine":38,"endColumn":71},{"ruleId":"842","severity":1,"message":"967","line":45,"column":7,"nodeType":"844","messageId":"845","endLine":45,"endColumn":32},{"ruleId":"842","severity":1,"message":"1031","line":65,"column":18,"nodeType":"844","messageId":"845","endLine":65,"endColumn":33},{"ruleId":"842","severity":1,"message":"1001","line":66,"column":16,"nodeType":"844","messageId":"845","endLine":66,"endColumn":29},{"ruleId":"842","severity":1,"message":"1032","line":134,"column":15,"nodeType":"844","messageId":"845","endLine":134,"endColumn":20},{"ruleId":"842","severity":1,"message":"968","line":183,"column":28,"nodeType":"844","messageId":"845","endLine":183,"endColumn":32},{"ruleId":"842","severity":1,"message":"906","line":259,"column":11,"nodeType":"844","messageId":"845","endLine":259,"endColumn":53},{"ruleId":"842","severity":1,"message":"1033","line":263,"column":11,"nodeType":"844","messageId":"845","endLine":263,"endColumn":64},{"ruleId":"842","severity":1,"message":"1034","line":264,"column":11,"nodeType":"844","messageId":"845","endLine":264,"endColumn":56},{"ruleId":"842","severity":1,"message":"969","line":267,"column":11,"nodeType":"844","messageId":"845","endLine":267,"endColumn":57},{"ruleId":"842","severity":1,"message":"1035","line":268,"column":11,"nodeType":"844","messageId":"845","endLine":268,"endColumn":59},{"ruleId":"842","severity":1,"message":"1036","line":269,"column":11,"nodeType":"844","messageId":"845","endLine":269,"endColumn":51},{"ruleId":"956","severity":1,"message":"1037","line":497,"column":9,"nodeType":"958","endLine":497,"endColumn":29,"suggestions":"1038"},{"ruleId":"956","severity":1,"message":"1039","line":512,"column":9,"nodeType":"958","endLine":512,"endColumn":29,"suggestions":"1040"},{"ruleId":"956","severity":1,"message":"1041","line":519,"column":9,"nodeType":"958","endLine":519,"endColumn":29,"suggestions":"1042"},{"ruleId":"956","severity":1,"message":"1043","line":533,"column":9,"nodeType":"958","endLine":533,"endColumn":29,"suggestions":"1044"},{"ruleId":"956","severity":1,"message":"1045","line":540,"column":9,"nodeType":"958","endLine":540,"endColumn":29,"suggestions":"1046"},{"ruleId":"956","severity":1,"message":"1047","line":554,"column":9,"nodeType":"958","endLine":554,"endColumn":29,"suggestions":"1048"},{"ruleId":"842","severity":1,"message":"963","line":2,"column":17,"nodeType":"844","messageId":"845","endLine":2,"endColumn":27},{"ruleId":"842","severity":1,"message":"903","line":7,"column":5,"nodeType":"844","messageId":"845","endLine":7,"endColumn":19},{"ruleId":"842","severity":1,"message":"887","line":8,"column":5,"nodeType":"844","messageId":"845","endLine":8,"endColumn":11},{"ruleId":"842","severity":1,"message":"888","line":9,"column":5,"nodeType":"844","messageId":"845","endLine":9,"endColumn":18},{"ruleId":"842","severity":1,"message":"936","line":12,"column":5,"nodeType":"844","messageId":"845","endLine":12,"endColumn":17},{"ruleId":"842","severity":1,"message":"1049","line":15,"column":5,"nodeType":"844","messageId":"845","endLine":15,"endColumn":16},{"ruleId":"842","severity":1,"message":"1050","line":16,"column":5,"nodeType":"844","messageId":"845","endLine":16,"endColumn":16},{"ruleId":"842","severity":1,"message":"944","line":19,"column":5,"nodeType":"844","messageId":"845","endLine":19,"endColumn":17},{"ruleId":"842","severity":1,"message":"890","line":23,"column":17,"nodeType":"844","messageId":"845","endLine":23,"endColumn":32},{"ruleId":"842","severity":1,"message":"1051","line":31,"column":6,"nodeType":"844","messageId":"845","endLine":31,"endColumn":11},{"ruleId":"842","severity":1,"message":"1031","line":47,"column":18,"nodeType":"844","messageId":"845","endLine":47,"endColumn":33},{"ruleId":"842","severity":1,"message":"1001","line":48,"column":16,"nodeType":"844","messageId":"845","endLine":48,"endColumn":29},{"ruleId":"842","severity":1,"message":"894","line":243,"column":7,"nodeType":"844","messageId":"845","endLine":243,"endColumn":19},{"ruleId":"842","severity":1,"message":"962","line":1,"column":17,"nodeType":"844","messageId":"845","endLine":1,"endColumn":25},{"ruleId":"842","severity":1,"message":"963","line":2,"column":17,"nodeType":"844","messageId":"845","endLine":2,"endColumn":27},{"ruleId":"842","severity":1,"message":"964","line":4,"column":20,"nodeType":"844","messageId":"845","endLine":4,"endColumn":40},{"ruleId":"842","severity":1,"message":"965","line":5,"column":10,"nodeType":"844","messageId":"845","endLine":5,"endColumn":16},{"ruleId":"842","severity":1,"message":"1028","line":7,"column":10,"nodeType":"844","messageId":"845","endLine":7,"endColumn":25},{"ruleId":"842","severity":1,"message":"888","line":15,"column":5,"nodeType":"844","messageId":"845","endLine":15,"endColumn":18},{"ruleId":"842","severity":1,"message":"938","line":21,"column":5,"nodeType":"844","messageId":"845","endLine":21,"endColumn":16},{"ruleId":"842","severity":1,"message":"939","line":22,"column":5,"nodeType":"844","messageId":"845","endLine":22,"endColumn":13},{"ruleId":"842","severity":1,"message":"940","line":23,"column":5,"nodeType":"844","messageId":"845","endLine":23,"endColumn":11},{"ruleId":"842","severity":1,"message":"941","line":24,"column":5,"nodeType":"844","messageId":"845","endLine":24,"endColumn":20},{"ruleId":"842","severity":1,"message":"862","line":25,"column":5,"nodeType":"844","messageId":"845","endLine":25,"endColumn":14},{"ruleId":"842","severity":1,"message":"942","line":26,"column":5,"nodeType":"844","messageId":"845","endLine":26,"endColumn":33},{"ruleId":"842","severity":1,"message":"1029","line":33,"column":5,"nodeType":"844","messageId":"845","endLine":33,"endColumn":19},{"ruleId":"842","severity":1,"message":"1030","line":36,"column":10,"nodeType":"844","messageId":"845","endLine":36,"endColumn":33},{"ruleId":"842","severity":1,"message":"849","line":36,"column":35,"nodeType":"844","messageId":"845","endLine":36,"endColumn":38},{"ruleId":"842","severity":1,"message":"923","line":37,"column":48,"nodeType":"844","messageId":"845","endLine":37,"endColumn":61},{"ruleId":"842","severity":1,"message":"928","line":38,"column":65,"nodeType":"844","messageId":"845","endLine":38,"endColumn":73},{"ruleId":"842","severity":1,"message":"967","line":45,"column":7,"nodeType":"844","messageId":"845","endLine":45,"endColumn":32},{"ruleId":"842","severity":1,"message":"1031","line":65,"column":18,"nodeType":"844","messageId":"845","endLine":65,"endColumn":33},{"ruleId":"842","severity":1,"message":"1001","line":66,"column":16,"nodeType":"844","messageId":"845","endLine":66,"endColumn":29},{"ruleId":"842","severity":1,"message":"1032","line":134,"column":15,"nodeType":"844","messageId":"845","endLine":134,"endColumn":20},{"ruleId":"842","severity":1,"message":"968","line":183,"column":30,"nodeType":"844","messageId":"845","endLine":183,"endColumn":34},{"ruleId":"842","severity":1,"message":"906","line":265,"column":11,"nodeType":"844","messageId":"845","endLine":265,"endColumn":53},{"ruleId":"842","severity":1,"message":"1033","line":271,"column":11,"nodeType":"844","messageId":"845","endLine":271,"endColumn":64},{"ruleId":"842","severity":1,"message":"1034","line":272,"column":11,"nodeType":"844","messageId":"845","endLine":272,"endColumn":56},{"ruleId":"842","severity":1,"message":"969","line":275,"column":11,"nodeType":"844","messageId":"845","endLine":275,"endColumn":57},{"ruleId":"842","severity":1,"message":"1035","line":276,"column":11,"nodeType":"844","messageId":"845","endLine":276,"endColumn":59},{"ruleId":"842","severity":1,"message":"1036","line":277,"column":11,"nodeType":"844","messageId":"845","endLine":277,"endColumn":51},{"ruleId":"956","severity":1,"message":"1037","line":504,"column":9,"nodeType":"958","endLine":504,"endColumn":26,"suggestions":"1052"},{"ruleId":"956","severity":1,"message":"1039","line":519,"column":9,"nodeType":"958","endLine":519,"endColumn":26,"suggestions":"1053"},{"ruleId":"956","severity":1,"message":"1041","line":526,"column":9,"nodeType":"958","endLine":526,"endColumn":26,"suggestions":"1054"},{"ruleId":"956","severity":1,"message":"1043","line":540,"column":9,"nodeType":"958","endLine":540,"endColumn":26,"suggestions":"1055"},{"ruleId":"956","severity":1,"message":"1045","line":547,"column":9,"nodeType":"958","endLine":547,"endColumn":26,"suggestions":"1056"},{"ruleId":"956","severity":1,"message":"1047","line":561,"column":9,"nodeType":"958","endLine":561,"endColumn":26,"suggestions":"1057"},{"ruleId":"842","severity":1,"message":"908","line":4,"column":10,"nodeType":"844","messageId":"845","endLine":4,"endColumn":15},{"ruleId":"842","severity":1,"message":"909","line":4,"column":17,"nodeType":"844","messageId":"845","endLine":4,"endColumn":25},{"ruleId":"842","severity":1,"message":"911","line":6,"column":10,"nodeType":"844","messageId":"845","endLine":6,"endColumn":18},{"ruleId":"842","severity":1,"message":"912","line":6,"column":20,"nodeType":"844","messageId":"845","endLine":6,"endColumn":34},{"ruleId":"842","severity":1,"message":"929","line":7,"column":17,"nodeType":"844","messageId":"845","endLine":7,"endColumn":25},{"ruleId":"842","severity":1,"message":"922","line":8,"column":10,"nodeType":"844","messageId":"845","endLine":8,"endColumn":33},{"ruleId":"842","severity":1,"message":"1024","line":8,"column":35,"nodeType":"844","messageId":"845","endLine":8,"endColumn":49},{"ruleId":"842","severity":1,"message":"1058","line":8,"column":51,"nodeType":"844","messageId":"845","endLine":8,"endColumn":66},{"ruleId":"842","severity":1,"message":"849","line":9,"column":10,"nodeType":"844","messageId":"845","endLine":9,"endColumn":13},{"ruleId":"842","severity":1,"message":"851","line":9,"column":28,"nodeType":"844","messageId":"845","endLine":9,"endColumn":36},{"ruleId":"842","severity":1,"message":"914","line":10,"column":10,"nodeType":"844","messageId":"845","endLine":10,"endColumn":30},{"ruleId":"842","severity":1,"message":"1059","line":11,"column":23,"nodeType":"844","messageId":"845","endLine":11,"endColumn":36},{"ruleId":"842","severity":1,"message":"921","line":12,"column":10,"nodeType":"844","messageId":"845","endLine":12,"endColumn":26},{"ruleId":"842","severity":1,"message":"886","line":12,"column":28,"nodeType":"844","messageId":"845","endLine":12,"endColumn":48},{"ruleId":"842","severity":1,"message":"944","line":12,"column":100,"nodeType":"844","messageId":"845","endLine":12,"endColumn":112},{"ruleId":"842","severity":1,"message":"1060","line":12,"column":114,"nodeType":"844","messageId":"845","endLine":12,"endColumn":129},{"ruleId":"842","severity":1,"message":"1061","line":14,"column":10,"nodeType":"844","messageId":"845","endLine":14,"endColumn":24},{"ruleId":"842","severity":1,"message":"1062","line":14,"column":26,"nodeType":"844","messageId":"845","endLine":14,"endColumn":36},{"ruleId":"842","severity":1,"message":"1063","line":14,"column":38,"nodeType":"844","messageId":"845","endLine":14,"endColumn":48},{"ruleId":"842","severity":1,"message":"1064","line":14,"column":50,"nodeType":"844","messageId":"845","endLine":14,"endColumn":62},{"ruleId":"842","severity":1,"message":"1065","line":15,"column":10,"nodeType":"844","messageId":"845","endLine":15,"endColumn":18},{"ruleId":"842","severity":1,"message":"1066","line":16,"column":10,"nodeType":"844","messageId":"845","endLine":16,"endColumn":25},{"ruleId":"842","severity":1,"message":"1067","line":19,"column":10,"nodeType":"844","messageId":"845","endLine":19,"endColumn":16},{"ruleId":"842","severity":1,"message":"1068","line":19,"column":18,"nodeType":"844","messageId":"845","endLine":19,"endColumn":33},{"ruleId":"842","severity":1,"message":"1069","line":47,"column":41,"nodeType":"844","messageId":"845","endLine":47,"endColumn":66},{"ruleId":"842","severity":1,"message":"1020","line":86,"column":41,"nodeType":"844","messageId":"845","endLine":86,"endColumn":59},{"ruleId":"842","severity":1,"message":"1070","line":230,"column":9,"nodeType":"844","messageId":"845","endLine":230,"endColumn":21},{"ruleId":"842","severity":1,"message":"1071","line":245,"column":9,"nodeType":"844","messageId":"845","endLine":245,"endColumn":18},{"ruleId":"842","severity":1,"message":"1072","line":260,"column":9,"nodeType":"844","messageId":"845","endLine":260,"endColumn":23},{"ruleId":"842","severity":1,"message":"951","line":276,"column":9,"nodeType":"844","messageId":"845","endLine":276,"endColumn":18},{"ruleId":"842","severity":1,"message":"1073","line":277,"column":9,"nodeType":"844","messageId":"845","endLine":277,"endColumn":30},{"ruleId":"842","severity":1,"message":"908","line":2,"column":10,"nodeType":"844","messageId":"845","endLine":2,"endColumn":15},{"ruleId":"842","severity":1,"message":"909","line":2,"column":17,"nodeType":"844","messageId":"845","endLine":2,"endColumn":25},{"ruleId":"842","severity":1,"message":"910","line":3,"column":10,"nodeType":"844","messageId":"845","endLine":3,"endColumn":14},{"ruleId":"842","severity":1,"message":"911","line":4,"column":10,"nodeType":"844","messageId":"845","endLine":4,"endColumn":18},{"ruleId":"842","severity":1,"message":"912","line":4,"column":20,"nodeType":"844","messageId":"845","endLine":4,"endColumn":34},{"ruleId":"842","severity":1,"message":"995","line":5,"column":10,"nodeType":"844","messageId":"845","endLine":5,"endColumn":15},{"ruleId":"842","severity":1,"message":"851","line":6,"column":10,"nodeType":"844","messageId":"845","endLine":6,"endColumn":18},{"ruleId":"842","severity":1,"message":"914","line":7,"column":10,"nodeType":"844","messageId":"845","endLine":7,"endColumn":30},{"ruleId":"842","severity":1,"message":"1074","line":67,"column":11,"nodeType":"844","messageId":"845","endLine":67,"endColumn":44},{"ruleId":"842","severity":1,"message":"903","line":7,"column":3,"nodeType":"844","messageId":"845","endLine":7,"endColumn":17},{"ruleId":"842","severity":1,"message":"887","line":8,"column":3,"nodeType":"844","messageId":"845","endLine":8,"endColumn":9},{"ruleId":"842","severity":1,"message":"888","line":9,"column":3,"nodeType":"844","messageId":"845","endLine":9,"endColumn":16},{"ruleId":"842","severity":1,"message":"936","line":11,"column":3,"nodeType":"844","messageId":"845","endLine":11,"endColumn":15},{"ruleId":"842","severity":1,"message":"1049","line":14,"column":3,"nodeType":"844","messageId":"845","endLine":14,"endColumn":14},{"ruleId":"842","severity":1,"message":"923","line":18,"column":10,"nodeType":"844","messageId":"845","endLine":18,"endColumn":23},{"ruleId":"842","severity":1,"message":"995","line":19,"column":10,"nodeType":"844","messageId":"845","endLine":19,"endColumn":15},{"ruleId":"842","severity":1,"message":"890","line":19,"column":17,"nodeType":"844","messageId":"845","endLine":19,"endColumn":32},{"ruleId":"842","severity":1,"message":"849","line":20,"column":10,"nodeType":"844","messageId":"845","endLine":20,"endColumn":13},{"ruleId":"842","severity":1,"message":"851","line":20,"column":15,"nodeType":"844","messageId":"845","endLine":20,"endColumn":23},{"ruleId":"842","severity":1,"message":"1051","line":24,"column":6,"nodeType":"844","messageId":"845","endLine":24,"endColumn":11},{"ruleId":"842","severity":1,"message":"1075","line":34,"column":10,"nodeType":"844","messageId":"845","endLine":34,"endColumn":21},{"ruleId":"842","severity":1,"message":"1076","line":34,"column":34,"nodeType":"844","messageId":"845","endLine":34,"endColumn":43},{"ruleId":"842","severity":1,"message":"1077","line":59,"column":7,"nodeType":"844","messageId":"845","endLine":59,"endColumn":30},{"ruleId":"842","severity":1,"message":"894","line":133,"column":7,"nodeType":"844","messageId":"845","endLine":133,"endColumn":19},{"ruleId":"842","severity":1,"message":"962","line":1,"column":17,"nodeType":"844","messageId":"845","endLine":1,"endColumn":25},{"ruleId":"842","severity":1,"message":"963","line":2,"column":17,"nodeType":"844","messageId":"845","endLine":2,"endColumn":27},{"ruleId":"842","severity":1,"message":"964","line":4,"column":20,"nodeType":"844","messageId":"845","endLine":4,"endColumn":40},{"ruleId":"842","severity":1,"message":"965","line":5,"column":10,"nodeType":"844","messageId":"845","endLine":5,"endColumn":16},{"ruleId":"842","severity":1,"message":"1028","line":7,"column":10,"nodeType":"844","messageId":"845","endLine":7,"endColumn":25},{"ruleId":"842","severity":1,"message":"888","line":15,"column":5,"nodeType":"844","messageId":"845","endLine":15,"endColumn":18},{"ruleId":"842","severity":1,"message":"938","line":21,"column":5,"nodeType":"844","messageId":"845","endLine":21,"endColumn":16},{"ruleId":"842","severity":1,"message":"939","line":22,"column":5,"nodeType":"844","messageId":"845","endLine":22,"endColumn":13},{"ruleId":"842","severity":1,"message":"940","line":23,"column":5,"nodeType":"844","messageId":"845","endLine":23,"endColumn":11},{"ruleId":"842","severity":1,"message":"941","line":24,"column":5,"nodeType":"844","messageId":"845","endLine":24,"endColumn":20},{"ruleId":"842","severity":1,"message":"862","line":25,"column":5,"nodeType":"844","messageId":"845","endLine":25,"endColumn":14},{"ruleId":"842","severity":1,"message":"942","line":26,"column":5,"nodeType":"844","messageId":"845","endLine":26,"endColumn":33},{"ruleId":"842","severity":1,"message":"1029","line":33,"column":5,"nodeType":"844","messageId":"845","endLine":33,"endColumn":19},{"ruleId":"842","severity":1,"message":"1030","line":36,"column":10,"nodeType":"844","messageId":"845","endLine":36,"endColumn":33},{"ruleId":"842","severity":1,"message":"849","line":36,"column":35,"nodeType":"844","messageId":"845","endLine":36,"endColumn":38},{"ruleId":"842","severity":1,"message":"851","line":36,"column":53,"nodeType":"844","messageId":"845","endLine":36,"endColumn":61},{"ruleId":"842","severity":1,"message":"923","line":37,"column":45,"nodeType":"844","messageId":"845","endLine":37,"endColumn":58},{"ruleId":"842","severity":1,"message":"967","line":45,"column":7,"nodeType":"844","messageId":"845","endLine":45,"endColumn":32},{"ruleId":"842","severity":1,"message":"1032","line":103,"column":15,"nodeType":"844","messageId":"845","endLine":103,"endColumn":20},{"ruleId":"842","severity":1,"message":"968","line":151,"column":28,"nodeType":"844","messageId":"845","endLine":151,"endColumn":32},{"ruleId":"842","severity":1,"message":"906","line":226,"column":11,"nodeType":"844","messageId":"845","endLine":226,"endColumn":53},{"ruleId":"842","severity":1,"message":"1033","line":232,"column":11,"nodeType":"844","messageId":"845","endLine":232,"endColumn":64},{"ruleId":"842","severity":1,"message":"1034","line":233,"column":11,"nodeType":"844","messageId":"845","endLine":233,"endColumn":56},{"ruleId":"842","severity":1,"message":"969","line":236,"column":11,"nodeType":"844","messageId":"845","endLine":236,"endColumn":57},{"ruleId":"842","severity":1,"message":"1035","line":237,"column":11,"nodeType":"844","messageId":"845","endLine":237,"endColumn":59},{"ruleId":"842","severity":1,"message":"1036","line":238,"column":11,"nodeType":"844","messageId":"845","endLine":238,"endColumn":51},{"ruleId":"956","severity":1,"message":"1037","line":467,"column":9,"nodeType":"958","endLine":467,"endColumn":22,"suggestions":"1078"},{"ruleId":"956","severity":1,"message":"1039","line":482,"column":9,"nodeType":"958","endLine":482,"endColumn":22,"suggestions":"1079"},{"ruleId":"956","severity":1,"message":"1041","line":489,"column":9,"nodeType":"958","endLine":489,"endColumn":22,"suggestions":"1080"},{"ruleId":"956","severity":1,"message":"1043","line":503,"column":9,"nodeType":"958","endLine":503,"endColumn":22,"suggestions":"1081"},{"ruleId":"956","severity":1,"message":"1045","line":510,"column":9,"nodeType":"958","endLine":510,"endColumn":22,"suggestions":"1082"},{"ruleId":"956","severity":1,"message":"1047","line":524,"column":9,"nodeType":"958","endLine":524,"endColumn":22,"suggestions":"1083"},{"ruleId":"842","severity":1,"message":"1084","line":1,"column":27,"nodeType":"844","messageId":"845","endLine":1,"endColumn":36},{"ruleId":"842","severity":1,"message":"964","line":4,"column":20,"nodeType":"844","messageId":"845","endLine":4,"endColumn":40},{"ruleId":"842","severity":1,"message":"861","line":6,"column":5,"nodeType":"844","messageId":"845","endLine":6,"endColumn":16},{"ruleId":"842","severity":1,"message":"851","line":13,"column":23,"nodeType":"844","messageId":"845","endLine":13,"endColumn":31},{"ruleId":"842","severity":1,"message":"968","line":27,"column":30,"nodeType":"844","messageId":"845","endLine":27,"endColumn":34},{"ruleId":"842","severity":1,"message":"900","line":3,"column":10,"nodeType":"844","messageId":"845","endLine":3,"endColumn":19},{"ruleId":"842","severity":1,"message":"908","line":4,"column":10,"nodeType":"844","messageId":"845","endLine":4,"endColumn":15},{"ruleId":"842","severity":1,"message":"909","line":4,"column":17,"nodeType":"844","messageId":"845","endLine":4,"endColumn":25},{"ruleId":"842","severity":1,"message":"912","line":6,"column":20,"nodeType":"844","messageId":"845","endLine":6,"endColumn":34},{"ruleId":"842","severity":1,"message":"849","line":9,"column":10,"nodeType":"844","messageId":"845","endLine":9,"endColumn":13},{"ruleId":"842","severity":1,"message":"921","line":12,"column":10,"nodeType":"844","messageId":"845","endLine":12,"endColumn":26},{"ruleId":"842","severity":1,"message":"886","line":12,"column":28,"nodeType":"844","messageId":"845","endLine":12,"endColumn":48},{"ruleId":"842","severity":1,"message":"944","line":12,"column":100,"nodeType":"844","messageId":"845","endLine":12,"endColumn":112},{"ruleId":"842","severity":1,"message":"1060","line":12,"column":114,"nodeType":"844","messageId":"845","endLine":12,"endColumn":129},{"ruleId":"842","severity":1,"message":"1085","line":42,"column":5,"nodeType":"844","messageId":"845","endLine":42,"endColumn":12},{"ruleId":"842","severity":1,"message":"1086","line":43,"column":5,"nodeType":"844","messageId":"845","endLine":43,"endColumn":10},{"ruleId":"956","severity":1,"message":"1087","line":70,"column":6,"nodeType":"958","endLine":70,"endColumn":26,"suggestions":"1088"},{"ruleId":"842","severity":1,"message":"1089","line":82,"column":34,"nodeType":"844","messageId":"845","endLine":82,"endColumn":52},{"ruleId":"915","severity":1,"message":"919","line":99,"column":60,"nodeType":"917","messageId":"920","endLine":99,"endColumn":62},{"ruleId":"842","severity":1,"message":"1090","line":195,"column":9,"nodeType":"844","messageId":"845","endLine":195,"endColumn":19},{"ruleId":"852","replacedBy":"853"},{"ruleId":"854","replacedBy":"855"},{"ruleId":"842","severity":1,"message":"900","line":3,"column":10,"nodeType":"844","messageId":"845","endLine":3,"endColumn":19},{"ruleId":"842","severity":1,"message":"908","line":4,"column":10,"nodeType":"844","messageId":"845","endLine":4,"endColumn":15},{"ruleId":"842","severity":1,"message":"909","line":4,"column":17,"nodeType":"844","messageId":"845","endLine":4,"endColumn":25},{"ruleId":"842","severity":1,"message":"910","line":5,"column":10,"nodeType":"844","messageId":"845","endLine":5,"endColumn":14},{"ruleId":"842","severity":1,"message":"911","line":6,"column":10,"nodeType":"844","messageId":"845","endLine":6,"endColumn":18},{"ruleId":"842","severity":1,"message":"912","line":6,"column":20,"nodeType":"844","messageId":"845","endLine":6,"endColumn":34},{"ruleId":"842","severity":1,"message":"922","line":8,"column":10,"nodeType":"844","messageId":"845","endLine":8,"endColumn":33},{"ruleId":"842","severity":1,"message":"1091","line":8,"column":35,"nodeType":"844","messageId":"845","endLine":8,"endColumn":47},{"ruleId":"842","severity":1,"message":"849","line":9,"column":10,"nodeType":"844","messageId":"845","endLine":9,"endColumn":13},{"ruleId":"842","severity":1,"message":"851","line":9,"column":28,"nodeType":"844","messageId":"845","endLine":9,"endColumn":36},{"ruleId":"842","severity":1,"message":"914","line":10,"column":10,"nodeType":"844","messageId":"845","endLine":10,"endColumn":30},{"ruleId":"842","severity":1,"message":"1059","line":11,"column":23,"nodeType":"844","messageId":"845","endLine":11,"endColumn":36},{"ruleId":"842","severity":1,"message":"921","line":12,"column":10,"nodeType":"844","messageId":"845","endLine":12,"endColumn":26},{"ruleId":"842","severity":1,"message":"944","line":12,"column":100,"nodeType":"844","messageId":"845","endLine":12,"endColumn":112},{"ruleId":"842","severity":1,"message":"1060","line":12,"column":114,"nodeType":"844","messageId":"845","endLine":12,"endColumn":129},{"ruleId":"842","severity":1,"message":"1061","line":14,"column":10,"nodeType":"844","messageId":"845","endLine":14,"endColumn":24},{"ruleId":"842","severity":1,"message":"1062","line":14,"column":26,"nodeType":"844","messageId":"845","endLine":14,"endColumn":36},{"ruleId":"842","severity":1,"message":"1063","line":14,"column":38,"nodeType":"844","messageId":"845","endLine":14,"endColumn":48},{"ruleId":"842","severity":1,"message":"1064","line":14,"column":50,"nodeType":"844","messageId":"845","endLine":14,"endColumn":62},{"ruleId":"842","severity":1,"message":"1065","line":15,"column":10,"nodeType":"844","messageId":"845","endLine":15,"endColumn":18},{"ruleId":"842","severity":1,"message":"1092","line":68,"column":36,"nodeType":"844","messageId":"845","endLine":68,"endColumn":54},{"ruleId":"915","severity":1,"message":"919","line":86,"column":64,"nodeType":"917","messageId":"920","endLine":86,"endColumn":66},{"ruleId":"842","severity":1,"message":"1090","line":185,"column":11,"nodeType":"844","messageId":"845","endLine":185,"endColumn":21},{"ruleId":"842","severity":1,"message":"1070","line":191,"column":11,"nodeType":"844","messageId":"845","endLine":191,"endColumn":23},{"ruleId":"842","severity":1,"message":"1071","line":206,"column":11,"nodeType":"844","messageId":"845","endLine":206,"endColumn":20},{"ruleId":"842","severity":1,"message":"1072","line":221,"column":11,"nodeType":"844","messageId":"845","endLine":221,"endColumn":25},{"ruleId":"842","severity":1,"message":"951","line":237,"column":11,"nodeType":"844","messageId":"845","endLine":237,"endColumn":20},{"ruleId":"842","severity":1,"message":"1073","line":238,"column":11,"nodeType":"844","messageId":"845","endLine":238,"endColumn":32},{"ruleId":"842","severity":1,"message":"1093","line":7,"column":17,"nodeType":"844","messageId":"845","endLine":7,"endColumn":22},{"ruleId":"842","severity":1,"message":"1094","line":7,"column":24,"nodeType":"844","messageId":"845","endLine":7,"endColumn":38},{"ruleId":"842","severity":1,"message":"1095","line":7,"column":40,"nodeType":"844","messageId":"845","endLine":7,"endColumn":57},{"ruleId":"842","severity":1,"message":"923","line":9,"column":46,"nodeType":"844","messageId":"845","endLine":9,"endColumn":59},{"ruleId":"842","severity":1,"message":"1031","line":74,"column":18,"nodeType":"844","messageId":"845","endLine":74,"endColumn":33},{"ruleId":"842","severity":1,"message":"1001","line":75,"column":16,"nodeType":"844","messageId":"845","endLine":75,"endColumn":29},{"ruleId":"842","severity":1,"message":"968","line":113,"column":30,"nodeType":"844","messageId":"845","endLine":113,"endColumn":34},{"ruleId":"1096","severity":1,"message":"1097","line":162,"column":17,"nodeType":"844","messageId":"1098","endLine":162,"endColumn":30},{"ruleId":"1096","severity":1,"message":"1099","line":163,"column":17,"nodeType":"844","messageId":"1098","endLine":163,"endColumn":21},{"ruleId":"1096","severity":1,"message":"1097","line":170,"column":17,"nodeType":"844","messageId":"1098","endLine":170,"endColumn":30},{"ruleId":"1096","severity":1,"message":"1099","line":171,"column":17,"nodeType":"844","messageId":"1098","endLine":171,"endColumn":21},{"ruleId":"1096","severity":1,"message":"1099","line":180,"column":17,"nodeType":"844","messageId":"1098","endLine":180,"endColumn":21},{"ruleId":"1096","severity":1,"message":"1100","line":189,"column":17,"nodeType":"844","messageId":"1098","endLine":189,"endColumn":22},{"ruleId":"1096","severity":1,"message":"1099","line":191,"column":17,"nodeType":"844","messageId":"1098","endLine":191,"endColumn":21},{"ruleId":"1101","severity":1,"message":"1102","line":391,"column":21,"nodeType":"1103","messageId":"1104","endLine":391,"endColumn":27},{"ruleId":"1101","severity":1,"message":"1102","line":394,"column":21,"nodeType":"1103","messageId":"1104","endLine":394,"endColumn":27},{"ruleId":"1101","severity":1,"message":"1102","line":397,"column":21,"nodeType":"1103","messageId":"1104","endLine":397,"endColumn":27},{"ruleId":"1101","severity":1,"message":"1102","line":400,"column":21,"nodeType":"1103","messageId":"1104","endLine":400,"endColumn":27},{"ruleId":"1101","severity":1,"message":"1102","line":420,"column":21,"nodeType":"1103","messageId":"1104","endLine":420,"endColumn":27},{"ruleId":"1101","severity":1,"message":"1102","line":423,"column":21,"nodeType":"1103","messageId":"1104","endLine":423,"endColumn":27},{"ruleId":"1101","severity":1,"message":"1102","line":442,"column":21,"nodeType":"1103","messageId":"1104","endLine":442,"endColumn":27},{"ruleId":"1101","severity":1,"message":"1102","line":445,"column":21,"nodeType":"1103","messageId":"1104","endLine":445,"endColumn":27},{"ruleId":"1101","severity":1,"message":"1102","line":448,"column":21,"nodeType":"1103","messageId":"1104","endLine":448,"endColumn":27},{"ruleId":"1101","severity":1,"message":"1102","line":467,"column":21,"nodeType":"1103","messageId":"1104","endLine":467,"endColumn":27},{"ruleId":"1101","severity":1,"message":"1102","line":470,"column":21,"nodeType":"1103","messageId":"1104","endLine":470,"endColumn":27},{"ruleId":"1101","severity":1,"message":"1102","line":473,"column":21,"nodeType":"1103","messageId":"1104","endLine":473,"endColumn":27},{"ruleId":"842","severity":1,"message":"962","line":1,"column":32,"nodeType":"844","messageId":"845","endLine":1,"endColumn":40},{"ruleId":"842","severity":1,"message":"1105","line":2,"column":10,"nodeType":"844","messageId":"845","endLine":2,"endColumn":15},{"ruleId":"842","severity":1,"message":"963","line":2,"column":17,"nodeType":"844","messageId":"845","endLine":2,"endColumn":27},{"ruleId":"842","severity":1,"message":"900","line":3,"column":10,"nodeType":"844","messageId":"845","endLine":3,"endColumn":19},{"ruleId":"842","severity":1,"message":"973","line":4,"column":10,"nodeType":"844","messageId":"845","endLine":4,"endColumn":18},{"ruleId":"842","severity":1,"message":"964","line":4,"column":20,"nodeType":"844","messageId":"845","endLine":4,"endColumn":40},{"ruleId":"842","severity":1,"message":"974","line":4,"column":42,"nodeType":"844","messageId":"845","endLine":4,"endColumn":57},{"ruleId":"842","severity":1,"message":"1028","line":7,"column":10,"nodeType":"844","messageId":"845","endLine":7,"endColumn":25},{"ruleId":"842","severity":1,"message":"887","line":13,"column":5,"nodeType":"844","messageId":"845","endLine":13,"endColumn":11},{"ruleId":"842","severity":1,"message":"888","line":15,"column":5,"nodeType":"844","messageId":"845","endLine":15,"endColumn":18},{"ruleId":"842","severity":1,"message":"938","line":21,"column":5,"nodeType":"844","messageId":"845","endLine":21,"endColumn":16},{"ruleId":"842","severity":1,"message":"939","line":22,"column":5,"nodeType":"844","messageId":"845","endLine":22,"endColumn":13},{"ruleId":"842","severity":1,"message":"940","line":23,"column":5,"nodeType":"844","messageId":"845","endLine":23,"endColumn":11},{"ruleId":"842","severity":1,"message":"941","line":24,"column":5,"nodeType":"844","messageId":"845","endLine":24,"endColumn":20},{"ruleId":"842","severity":1,"message":"862","line":25,"column":5,"nodeType":"844","messageId":"845","endLine":25,"endColumn":14},{"ruleId":"842","severity":1,"message":"942","line":26,"column":5,"nodeType":"844","messageId":"845","endLine":26,"endColumn":33},{"ruleId":"842","severity":1,"message":"1029","line":33,"column":5,"nodeType":"844","messageId":"845","endLine":33,"endColumn":19},{"ruleId":"842","severity":1,"message":"885","line":36,"column":10,"nodeType":"844","messageId":"845","endLine":36,"endColumn":15},{"ruleId":"842","severity":1,"message":"1106","line":36,"column":17,"nodeType":"844","messageId":"845","endLine":36,"endColumn":26},{"ruleId":"842","severity":1,"message":"1030","line":37,"column":10,"nodeType":"844","messageId":"845","endLine":37,"endColumn":33},{"ruleId":"842","severity":1,"message":"849","line":37,"column":35,"nodeType":"844","messageId":"845","endLine":37,"endColumn":38},{"ruleId":"842","severity":1,"message":"983","line":37,"column":40,"nodeType":"844","messageId":"845","endLine":37,"endColumn":51},{"ruleId":"842","severity":1,"message":"975","line":38,"column":10,"nodeType":"844","messageId":"845","endLine":38,"endColumn":29},{"ruleId":"842","severity":1,"message":"1107","line":38,"column":31,"nodeType":"844","messageId":"845","endLine":38,"endColumn":43},{"ruleId":"842","severity":1,"message":"923","line":38,"column":45,"nodeType":"844","messageId":"845","endLine":38,"endColumn":58},{"ruleId":"842","severity":1,"message":"984","line":39,"column":10,"nodeType":"844","messageId":"845","endLine":39,"endColumn":18},{"ruleId":"842","severity":1,"message":"1108","line":39,"column":20,"nodeType":"844","messageId":"845","endLine":39,"endColumn":44},{"ruleId":"842","severity":1,"message":"929","line":39,"column":53,"nodeType":"844","messageId":"845","endLine":39,"endColumn":61},{"ruleId":"842","severity":1,"message":"928","line":39,"column":63,"nodeType":"844","messageId":"845","endLine":39,"endColumn":71},{"ruleId":"842","severity":1,"message":"967","line":47,"column":7,"nodeType":"844","messageId":"845","endLine":47,"endColumn":32},{"ruleId":"842","severity":1,"message":"879","line":84,"column":18,"nodeType":"844","messageId":"845","endLine":84,"endColumn":31},{"ruleId":"842","severity":1,"message":"880","line":85,"column":16,"nodeType":"844","messageId":"845","endLine":85,"endColumn":27},{"ruleId":"842","severity":1,"message":"1109","line":170,"column":11,"nodeType":"844","messageId":"845","endLine":170,"endColumn":23},{"ruleId":"842","severity":1,"message":"1032","line":172,"column":15,"nodeType":"844","messageId":"845","endLine":172,"endColumn":20},{"ruleId":"842","severity":1,"message":"906","line":285,"column":11,"nodeType":"844","messageId":"845","endLine":285,"endColumn":53},{"ruleId":"842","severity":1,"message":"1110","line":286,"column":11,"nodeType":"844","messageId":"845","endLine":286,"endColumn":58},{"ruleId":"842","severity":1,"message":"1111","line":287,"column":11,"nodeType":"844","messageId":"845","endLine":287,"endColumn":57},{"ruleId":"842","severity":1,"message":"1112","line":288,"column":11,"nodeType":"844","messageId":"845","endLine":288,"endColumn":56},{"ruleId":"842","severity":1,"message":"1033","line":289,"column":11,"nodeType":"844","messageId":"845","endLine":289,"endColumn":64},{"ruleId":"842","severity":1,"message":"1034","line":290,"column":11,"nodeType":"844","messageId":"845","endLine":290,"endColumn":56},{"ruleId":"842","severity":1,"message":"1113","line":291,"column":11,"nodeType":"844","messageId":"845","endLine":291,"endColumn":58},{"ruleId":"842","severity":1,"message":"1114","line":292,"column":11,"nodeType":"844","messageId":"845","endLine":292,"endColumn":51},{"ruleId":"842","severity":1,"message":"969","line":293,"column":11,"nodeType":"844","messageId":"845","endLine":293,"endColumn":57},{"ruleId":"842","severity":1,"message":"1035","line":294,"column":11,"nodeType":"844","messageId":"845","endLine":294,"endColumn":59},{"ruleId":"842","severity":1,"message":"1036","line":295,"column":11,"nodeType":"844","messageId":"845","endLine":295,"endColumn":51},{"ruleId":"842","severity":1,"message":"1115","line":297,"column":11,"nodeType":"844","messageId":"845","endLine":297,"endColumn":64},{"ruleId":"842","severity":1,"message":"1116","line":298,"column":11,"nodeType":"844","messageId":"845","endLine":298,"endColumn":64},{"ruleId":"842","severity":1,"message":"1117","line":299,"column":11,"nodeType":"844","messageId":"845","endLine":299,"endColumn":65},{"ruleId":"842","severity":1,"message":"894","line":301,"column":11,"nodeType":"844","messageId":"845","endLine":301,"endColumn":47},"@typescript-eslint/no-unused-vars","'Customizer' is defined but never used.","Identifier","unusedVar","'AUTH_TOKEN' is defined but never used.","'resolvers' is defined but never used.","'InMemoryCache' is defined but never used.","'gql' is defined but never used.","'ApolloLink' is defined but never used.","'useQuery' is defined but never used.","no-native-reassign",["1118"],"no-negated-in-lhs",["1119"],"'ResolverMap' is defined but never used.","'AppResolvers' is defined but never used.","'logo' is defined but never used.","'Text' is defined but never used.","'Link' is defined but never used.","'FontWeights' is defined but never used.","'IComboBox' is defined but never used.","'SelectedPropertyList' is defined but never used.","'useApolloClient' is defined but never used.","'PDFViewer' is defined but never used.","'PDFDownloadLink' is defined but never used.","'Document' is defined but never used.","'Page' is defined but never used.","'cl' is assigned a value but never used.","'suburbLoading' is assigned a value but never used.","'suburbError' is assigned a value but never used.","'regionLoading' is assigned a value but never used.","'regionError' is assigned a value but never used.","'navigationError' is assigned a value but never used.","'pdfLoading' is assigned a value but never used.","'pdfError' is assigned a value but never used.","'propertyListLoading' is assigned a value but never used.","'propertyListError' is assigned a value but never used.","'filterLoading' is assigned a value but never used.","'filterError' is assigned a value but never used.","'landlordLoading' is assigned a value but never used.","'landlordError' is assigned a value but never used.","'propertyListsLoading' is assigned a value but never used.","'propertyListsError' is assigned a value but never used.","'Pivot' is defined but never used.","'IContextualMenuProps' is defined but never used.","'Toggle' is defined but never used.","'DefaultButton' is defined but never used.","'isLoggedInVar' is defined but never used.","'NavigationState' is defined but never used.","'useSpring' is defined but never used.","'useTransform' is defined but never used.","'pivotStyles' is assigned a value but never used.","'toggleStyles' is assigned a value but never used.","'signoutIcon' is assigned a value but never used.","'getTabId' is assigned a value but never used.","'handleLinkClick' is assigned a value but never used.","'onChangeSelectedPropertyListToggle' is assigned a value but never used.","'primaryButtonStyles' is assigned a value but never used.","'TextField' is defined but never used.","'getTheme' is defined but never used.","'mergeStyleSets' is defined but never used.","'ContextualMenu' is defined but never used.","'PrimaryButton' is defined but never used.","'IconButton' is defined but never used.","'textFieldStyles' is assigned a value but never used.","'signInIcon' is assigned a value but never used.","'Image' is defined but never used.","'ImageFit' is defined but never used.","'Icon' is defined but never used.","'Checkbox' is defined but never used.","'ICheckboxProps' is defined but never used.","'FilterVariables' is defined but never used.","'selectedPropertyList' is defined but never used.","array-callback-return","Array.prototype.map() expects a return value from arrow function.","ArrowFunctionExpression","expectedInside","Array.prototype.filter() expects a value to be returned at the end of arrow function.","expectedAtEnd","'CommandBarButton' is defined but never used.","'GET_SELECTED_PROPERTIES' is defined but never used.","'GET_NAV_STATE' is defined but never used.","'GET_DISTINCT_SUBURBS' is defined but never used.","'GET_DISTINCT_REGIONS' is defined but never used.","'UPDATE_IMAGES' is defined but never used.","'QueryMultiPropertyArgs' is defined but never used.","'Premises' is defined but never used.","'Property' is defined but never used.","'Agent' is defined but never used.","'PropertyList' is defined but never used.","'BlobProvider' is defined but never used.","'PreviewPDFPanel' is defined but never used.","'IToggleStyles' is defined but never used.","'Modal' is defined but never used.","'IDragOptions' is defined but never used.","'IModalStyles' is defined but never used.","'mergeStyles' is defined but never used.","'ComboBox' is defined but never used.","'Fabric' is defined but never used.","'IComboBoxOption' is defined but never used.","'SelectableOptionMenuItemType' is defined but never used.","'IComboBoxStyles' is defined but never used.","'IStackStyles' is defined but never used.","'SelectedPropertyListPDF' is defined but never used.","'propertyListDataLoading' is assigned a value but never used.","'propertyListDataError' is assigned a value but never used.","'postPropertyListData' is assigned a value but never used.","'handlePDFDDownload' is assigned a value but never used.","'commandBarStyles' is assigned a value but never used.","'boldStyle' is assigned a value but never used.","'propertyDetailsStyles' is assigned a value but never used.","'boldStyle2' is assigned a value but never used.","'propertyDetailsHeadingStyles' is assigned a value but never used.","'propertyNotesStyles' is assigned a value but never used.","react-hooks/exhaustive-deps","React Hook React.useCallback has missing dependencies: 'cancelIcon', 'cancelIconStyles', 'clearIcon', and 'clearIconStyles'. Either include them or remove the dependency array.","ArrayExpression",["1120"],"React Hook React.useCallback has missing dependencies: 'agentOptions', 'buttonStyles', 'dropdownStyles', 'handlePreviewPDF', 'menuPropsPDF', 'onChangeEnquiryName', 'postPropertyListButton', 'saveListButtonStyles', 'selectedAgent', 'textFieldStyles', and 'toggleIsOutputOptionsCalloutVisible'. Either include them or remove the dependency array.",["1121"],"'useState' is defined but never used.","'useBoolean' is defined but never used.","'DropdownMenuItemType' is defined but never used.","'Slider' is defined but never used.","'GET_LANDLORDS' is defined but never used.","'dragOptions' is assigned a value but never used.","'data' is assigned a value but never used.","'dropdownSectorStyles' is assigned a value but never used.","React Hook React.useCallback has an unnecessary dependency: 'selectedLandlord'. Either exclude it or remove the dependency array.",["1122"],["1123"],"'Dropdown' is defined but never used.","'IDropdownOption' is defined but never used.","'GET_SINGLE_PROPERTY' is defined but never used.","React Hook React.useCallback has an unnecessary dependency: 'addLandlordName'. Either exclude it or remove the dependency array.",["1124"],"'editIcon' is assigned a value but never used.","'photoCollectionIcon' is assigned a value but never used.","'propertyDetailsLandlordStyles' is assigned a value but never used.","React Hook React.useCallback has missing dependencies: 'addIcon', 'addIconStyles', 'cancelIcon', 'deleteIconStyles', and 'toggleIsAddCalloutVisible'. Either include them or remove the dependency array.",["1125"],"'useMutation' is defined but never used.","'Mutation' is defined but never used.","'MutationUpdatePropertyArgs' is defined but never used.","'selectedPropertyListVar' is defined but never used.","'addIcon' is assigned a value but never used.","'deleteIcon' is assigned a value but never used.","React Hook React.useCallback has missing dependencies: 'cancelIcon' and 'cancelIconStyles'. Either include them or remove the dependency array.",["1126"],"'FocusTrapCallout' is defined but never used.","'FocusZone' is defined but never used.","'NEW_LANDLORD' is defined but never used.","'MutationPostLandlordArgs' is defined but never used.","'Query' is defined but never used.","'Landlord' is defined but never used.","'addIconStyles' is assigned a value but never used.","'styles' is assigned a value but never used.","React Hook React.useCallback has missing dependencies: 'cancelIcon', 'clearIcon', 'clearIconStyles', and 'deleteIconStyles'. Either include them or remove the dependency array.",["1127"],"'propertyError' is assigned a value but never used.","'isOpen' is assigned a value but never used.","'openPanel' is assigned a value but never used.","'dismissPanel' is assigned a value but never used.","React Hook React.useCallback has missing dependencies: 'cancelIcon', 'deleteIconStyles', 'editIcon', and 'editIconStyles'. Either include them or remove the dependency array.",["1128"],"'getLatitude' is assigned a value but never used.","'getLongitude' is assigned a value but never used.","'MutationPostPropertyListArgs' is defined but never used.","'NEW_PROPERTY_LIST' is defined but never used.","'ContactListItem' is defined but never used.","'deletePropertyListData' is assigned a value but never used.","'updatePropertyListData' is assigned a value but never used.","'textFieldContactStyles' is assigned a value but never used.","React Hook React.useCallback has a missing dependency: 'editPropertyList'. Either include it or remove the dependency array. You can also do a functional update 'setEditPropertyList(e => ...)' if you only need 'editPropertyList' in the 'setEditPropertyList' call.",["1129"],"React Hook React.useCallback has an unnecessary dependency: 'editPropertyList.customTitle'. Either exclude it or remove the dependency array.",["1130"],"'deleteLandlordData' is assigned a value but never used.","'updateLandlordData' is assigned a value but never used.","React Hook React.useCallback has an unnecessary dependency: 'editLandlordName'. Either exclude it or remove the dependency array.",["1131"],"'navigationStateVar' is defined but never used.","'GET_PROPERTIES' is defined but never used.","'NEW_PROPERTY' is defined but never used.",["1132"],["1133"],"'IRenderFunction' is defined but never used.","'ICalendarProps' is defined but never used.","'defaultDataIdFromObject' is defined but never used.","'propertyLoading' is assigned a value but never used.","'today' is assigned a value but never used.","'textFieldCoordinatesStyles' is assigned a value but never used.","'textFieldErfStyles' is assigned a value but never used.","'dropdownProvinceStyles' is assigned a value but never used.","'comboBoxStyles' is assigned a value but never used.","React Hook React.useCallback has a missing dependency: 'getOpenRatio'. Either include it or remove the dependency array.",["1134"],"React Hook React.useCallback has a missing dependency: 'getOpenBays'. Either include it or remove the dependency array.",["1135"],"React Hook React.useCallback has a missing dependency: 'getCoveredRatio'. Either include it or remove the dependency array.",["1136"],"React Hook React.useCallback has a missing dependency: 'getCoveredBays'. Either include it or remove the dependency array.",["1137"],"React Hook React.useCallback has a missing dependency: 'getShadedRatio'. Either include it or remove the dependency array.",["1138"],"React Hook React.useCallback has a missing dependency: 'getShadedBays'. Either include it or remove the dependency array.",["1139"],"'ILayerProps' is defined but never used.","'IModalProps' is defined but never used.","'Maybe' is defined but never used.",["1140"],["1141"],["1142"],["1143"],["1144"],["1145"],"'DELETE_PROPERTY' is defined but never used.","'registerIcons' is defined but never used.","'initializeIcons' is defined but never used.","'IndustrialIcon' is defined but never used.","'RetailIcon' is defined but never used.","'OfficeIcon' is defined but never used.","'MixedUseIcon' is defined but never used.","'FontIcon' is defined but never used.","'navigationState' is defined but never used.","'motion' is defined but never used.","'AnimatePresence' is defined but never used.","'deleteLandlordContactData' is assigned a value but never used.","'chevronClass' is assigned a value but never used.","'iconClass' is assigned a value but never used.","'chevronIconDiv' is assigned a value but never used.","'propertyHeadingStyles' is assigned a value but never used.","'tableCellBelowStyles' is assigned a value but never used.","'isModalOpen' is assigned a value but never used.","'showModal' is assigned a value but never used.","'modalProps' is assigned a value but never used.",["1146"],["1147"],["1148"],["1149"],["1150"],["1151"],"'useEffect' is defined but never used.","'loading' is assigned a value but never used.","'error' is assigned a value but never used.","React Hook React.useCallback has a missing dependency: 'property'. Either include it or remove the dependency array.",["1152"],"'deletePropertyData' is assigned a value but never used.","'imageClass' is assigned a value but never used.","'GET_PREMISES' is defined but never used.","'deletePremisesData' is assigned a value but never used.","'Video' is defined but never used.","'Transformation' is defined but never used.","'CloudinaryContext' is defined but never used.","@typescript-eslint/no-redeclare","'selectedImage' is already defined.","redeclared","'rest' is already defined.","'final' is already defined.","no-unreachable","Unreachable code.","BreakStatement","unreachableCode","'useId' is defined but never used.","'PivotItem' is defined but never used.","'NEW_PREMISES' is defined but never used.","'MutationPostPremisesArgs' is defined but never used.","'getNextMonth' is assigned a value but never used.","'textFieldFloorStyles' is assigned a value but never used.","'textFieldAreaStyles' is assigned a value but never used.","'textFieldEscStyles' is assigned a value but never used.","'textFieldNotesStyles' is assigned a value but never used.","'dropdownStyles' is assigned a value but never used.","'textFieldParkingBaysStyles' is assigned a value but never used.","'textFieldParkingRateStyles' is assigned a value but never used.","'textFieldParkingRatioStyles' is assigned a value but never used.","no-global-assign","no-unsafe-negation",{"desc":"1153","fix":"1154"},{"desc":"1155","fix":"1156"},{"desc":"1157","fix":"1158"},{"desc":"1157","fix":"1159"},{"desc":"1157","fix":"1160"},{"desc":"1161","fix":"1162"},{"desc":"1163","fix":"1164"},{"desc":"1165","fix":"1166"},{"desc":"1167","fix":"1168"},{"desc":"1169","fix":"1170"},{"desc":"1171","fix":"1172"},{"desc":"1157","fix":"1173"},{"desc":"1157","fix":"1174"},{"desc":"1157","fix":"1175"},{"desc":"1176","fix":"1177"},{"desc":"1178","fix":"1179"},{"desc":"1180","fix":"1181"},{"desc":"1182","fix":"1183"},{"desc":"1184","fix":"1185"},{"desc":"1186","fix":"1187"},{"desc":"1188","fix":"1189"},{"desc":"1190","fix":"1191"},{"desc":"1192","fix":"1193"},{"desc":"1194","fix":"1195"},{"desc":"1196","fix":"1197"},{"desc":"1198","fix":"1199"},{"desc":"1200","fix":"1201"},{"desc":"1202","fix":"1203"},{"desc":"1204","fix":"1205"},{"desc":"1206","fix":"1207"},{"desc":"1208","fix":"1209"},{"desc":"1210","fix":"1211"},{"desc":"1212","fix":"1213"},"Update the dependencies array to be: [cancelIcon, cancelIconStyles, clearIcon, clearIconStyles]",{"range":"1214","text":"1215"},"Update the dependencies array to be: [agentOptions, buttonStyles, dropdownStyles, enquiryName, handlePreviewPDF, menuPropsPDF, onChangeEnquiryName, postPropertyListButton, saveListButtonStyles, selectedAgent, textFieldStyles, toggleIsOutputOptionsCalloutVisible]",{"range":"1216","text":"1217"},"Update the dependencies array to be: []",{"range":"1218","text":"1219"},{"range":"1220","text":"1219"},{"range":"1221","text":"1219"},"Update the dependencies array to be: [addIcon, addIconStyles, cancelIcon, deleteIconStyles, toggleIsAddCalloutVisible]",{"range":"1222","text":"1223"},"Update the dependencies array to be: [cancelIcon, cancelIconStyles]",{"range":"1224","text":"1225"},"Update the dependencies array to be: [cancelIcon, clearIcon, clearIconStyles, deleteIconStyles]",{"range":"1226","text":"1227"},"Update the dependencies array to be: [cancelIcon, deleteIconStyles, editIcon, editIconStyles]",{"range":"1228","text":"1229"},"Update the dependencies array to be: [editPropertyList]",{"range":"1230","text":"1231"},"Update the dependencies array to be: [editPropertyList.enquiryName, propertyList.properties]",{"range":"1232","text":"1233"},{"range":"1234","text":"1219"},{"range":"1235","text":"1219"},{"range":"1236","text":"1219"},"Update the dependencies array to be: [duplicatedPremises, getOpenRatio]",{"range":"1237","text":"1238"},"Update the dependencies array to be: [duplicatedPremises, getOpenBays]",{"range":"1239","text":"1240"},"Update the dependencies array to be: [duplicatedPremises, getCoveredRatio]",{"range":"1241","text":"1242"},"Update the dependencies array to be: [duplicatedPremises, getCoveredBays]",{"range":"1243","text":"1244"},"Update the dependencies array to be: [duplicatedPremises, getShadedRatio]",{"range":"1245","text":"1246"},"Update the dependencies array to be: [duplicatedPremises, getShadedBays]",{"range":"1247","text":"1248"},"Update the dependencies array to be: [getOpenRatio, updatedPremises]",{"range":"1249","text":"1250"},"Update the dependencies array to be: [getOpenBays, updatedPremises]",{"range":"1251","text":"1252"},"Update the dependencies array to be: [getCoveredRatio, updatedPremises]",{"range":"1253","text":"1254"},"Update the dependencies array to be: [getCoveredBays, updatedPremises]",{"range":"1255","text":"1256"},"Update the dependencies array to be: [getShadedRatio, updatedPremises]",{"range":"1257","text":"1258"},"Update the dependencies array to be: [getShadedBays, updatedPremises]",{"range":"1259","text":"1260"},"Update the dependencies array to be: [getOpenRatio, newPremises]",{"range":"1261","text":"1262"},"Update the dependencies array to be: [getOpenBays, newPremises]",{"range":"1263","text":"1264"},"Update the dependencies array to be: [getCoveredRatio, newPremises]",{"range":"1265","text":"1266"},"Update the dependencies array to be: [getCoveredBays, newPremises]",{"range":"1267","text":"1268"},"Update the dependencies array to be: [getShadedRatio, newPremises]",{"range":"1269","text":"1270"},"Update the dependencies array to be: [getShadedBays, newPremises]",{"range":"1271","text":"1272"},"Update the dependencies array to be: [property, selectedProperties]",{"range":"1273","text":"1274"},[18238,18240],"[cancelIcon, cancelIconStyles, clearIcon, clearIconStyles]",[21797,21810],"[agentOptions, buttonStyles, dropdownStyles, enquiryName, handlePreviewPDF, menuPropsPDF, onChangeEnquiryName, postPropertyListButton, saveListButtonStyles, selectedAgent, textFieldStyles, toggleIsOutputOptionsCalloutVisible]",[11766,11784],"[]",[12572,12590],[3267,3284],[7888,7890],"[addIcon, addIconStyles, cancelIcon, deleteIconStyles, toggleIsAddCalloutVisible]",[5866,5868],"[cancelIcon, cancelIconStyles]",[6864,6866],"[cancelIcon, clearIcon, clearIconStyles, deleteIconStyles]",[9166,9168],"[cancelIcon, deleteIconStyles, editIcon, editIconStyles]",[10774,10795],"[editPropertyList]",[12124,12210],"[editPropertyList.enquiryName, propertyList.properties]",[9314,9332],[12785,12803],[13605,13623],[18222,18242],"[duplicatedPremises, getOpenRatio]",[18874,18894],"[duplicatedPremises, getOpenBays]",[19235,19255],"[duplicatedPremises, getCoveredRatio]",[19903,19923],"[duplicatedPremises, getCoveredBays]",[20260,20280],"[duplicatedPremises, getShadedRatio]",[20922,20942],"[duplicatedPremises, getShadedBays]",[18433,18450],"[getOpenRatio, updatedPremises]",[19067,19084],"[getOpenBays, updatedPremises]",[19419,19436],"[getCoveredRatio, updatedPremises]",[20069,20086],"[getCoveredBays, updatedPremises]",[20417,20434],"[getShadedRatio, updatedPremises]",[21061,21078],"[getShadedBays, updatedPremises]",[16657,16670],"[getOpenRatio, newPremises]",[17270,17283],"[getOpenBays, newPremises]",[17611,17624],"[getCoveredRatio, newPremises]",[18237,18250],"[getCoveredBays, newPremises]",[18574,18587],"[getShadedRatio, newPremises]",[19194,19207],"[getShadedBays, newPremises]",[2389,2409],"[property, selectedProperties]"]